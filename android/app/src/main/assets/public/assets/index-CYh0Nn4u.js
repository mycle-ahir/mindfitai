var SV=Object.defineProperty;var IV=(t,e,n)=>e in t?SV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ed=(t,e,n)=>IV(t,typeof e!="symbol"?e+"":e,n);function NV(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ol=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $V(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var lO={exports:{}},d0={},cO={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lh=Symbol.for("react.element"),EV=Symbol.for("react.portal"),TV=Symbol.for("react.fragment"),AV=Symbol.for("react.strict_mode"),DV=Symbol.for("react.profiler"),OV=Symbol.for("react.provider"),RV=Symbol.for("react.context"),PV=Symbol.for("react.forward_ref"),_V=Symbol.for("react.suspense"),MV=Symbol.for("react.memo"),FV=Symbol.for("react.lazy"),bN=Symbol.iterator;function LV(t){return t===null||typeof t!="object"?null:(t=bN&&t[bN]||t["@@iterator"],typeof t=="function"?t:null)}var uO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dO=Object.assign,hO={};function Su(t,e,n){this.props=t,this.context=e,this.refs=hO,this.updater=n||uO}Su.prototype.isReactComponent={};Su.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Su.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fO(){}fO.prototype=Su.prototype;function Hw(t,e,n){this.props=t,this.context=e,this.refs=hO,this.updater=n||uO}var Kw=Hw.prototype=new fO;Kw.constructor=Hw;dO(Kw,Su.prototype);Kw.isPureReactComponent=!0;var wN=Array.isArray,pO=Object.prototype.hasOwnProperty,qw={current:null},mO={key:!0,ref:!0,__self:!0,__source:!0};function gO(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)pO.call(e,r)&&!mO.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Lh,type:t,key:i,ref:o,props:s,_owner:qw.current}}function jV(t,e){return{$$typeof:Lh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xw(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lh}function zV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var kN=/\/+/g;function sv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zV(""+t.key):e.toString(36)}function fm(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Lh:case EV:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+sv(o,0):r,wN(s)?(n="",t!=null&&(n=t.replace(kN,"$&/")+"/"),fm(s,e,n,"",function(c){return c})):s!=null&&(Xw(s)&&(s=jV(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(kN,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wN(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+sv(i,a);o+=fm(i,e,n,l,s)}else if(l=LV(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+sv(i,a++),o+=fm(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Np(t,e,n){if(t==null)return t;var r=[],s=0;return fm(t,r,"","",function(i){return e.call(n,i,s++)}),r}function BV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ur={current:null},pm={transition:null},WV={ReactCurrentDispatcher:ur,ReactCurrentBatchConfig:pm,ReactCurrentOwner:qw};function xO(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:Np,forEach:function(t,e,n){Np(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Np(t,function(){e++}),e},toArray:function(t){return Np(t,function(e){return e})||[]},only:function(t){if(!Xw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=Su;ze.Fragment=TV;ze.Profiler=DV;ze.PureComponent=Hw;ze.StrictMode=AV;ze.Suspense=_V;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WV;ze.act=xO;ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dO({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=qw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)pO.call(e,l)&&!mO.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Lh,type:t.type,key:s,ref:i,props:r,_owner:o}};ze.createContext=function(t){return t={$$typeof:RV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:OV,_context:t},t.Consumer=t};ze.createElement=gO;ze.createFactory=function(t){var e=gO.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:PV,render:t}};ze.isValidElement=Xw;ze.lazy=function(t){return{$$typeof:FV,_payload:{_status:-1,_result:t},_init:BV}};ze.memo=function(t,e){return{$$typeof:MV,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=pm.transition;pm.transition={};try{t()}finally{pm.transition=e}};ze.unstable_act=xO;ze.useCallback=function(t,e){return ur.current.useCallback(t,e)};ze.useContext=function(t){return ur.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return ur.current.useDeferredValue(t)};ze.useEffect=function(t,e){return ur.current.useEffect(t,e)};ze.useId=function(){return ur.current.useId()};ze.useImperativeHandle=function(t,e,n){return ur.current.useImperativeHandle(t,e,n)};ze.useInsertionEffect=function(t,e){return ur.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return ur.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return ur.current.useMemo(t,e)};ze.useReducer=function(t,e,n){return ur.current.useReducer(t,e,n)};ze.useRef=function(t){return ur.current.useRef(t)};ze.useState=function(t){return ur.current.useState(t)};ze.useSyncExternalStore=function(t,e,n){return ur.current.useSyncExternalStore(t,e,n)};ze.useTransition=function(){return ur.current.useTransition()};ze.version="18.3.1";cO.exports=ze;var N=cO.exports;const iv=Ei(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UV=N,VV=Symbol.for("react.element"),GV=Symbol.for("react.fragment"),HV=Object.prototype.hasOwnProperty,KV=UV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qV={key:!0,ref:!0,__self:!0,__source:!0};function yO(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)HV.call(e,r)&&!qV.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:VV,type:t,key:i,ref:o,props:s,_owner:KV.current}}d0.Fragment=GV;d0.jsx=yO;d0.jsxs=yO;lO.exports=d0;var v=lO.exports,vO={exports:{}},qr={},bO={exports:{}},wO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,z){var K=_.length;_.push(z);e:for(;0<K;){var Z=K-1>>>1,q=_[Z];if(0<s(q,z))_[Z]=z,_[K]=q,K=Z;else break e}}function n(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var z=_[0],K=_.pop();if(K!==z){_[0]=K;e:for(var Z=0,q=_.length,te=q>>>1;Z<te;){var ie=2*(Z+1)-1,oe=_[ie],le=ie+1,ge=_[le];if(0>s(oe,K))le<q&&0>s(ge,oe)?(_[Z]=ge,_[le]=K,Z=le):(_[Z]=oe,_[ie]=K,Z=ie);else if(le<q&&0>s(ge,K))_[Z]=ge,_[le]=K,Z=le;else break e}}return z}function s(_,z){var K=_.sortIndex-z.sortIndex;return K!==0?K:_.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(_){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=_)r(c),z.sortIndex=z.expirationTime,e(l,z);else break;z=n(c)}}function w(_){if(m=!1,b(_),!p)if(n(l)!==null)p=!0,U(k);else{var z=n(c);z!==null&&V(w,z.startTime-_)}}function k(_,z){p=!1,m&&(m=!1,g(I),I=-1),f=!0;var K=h;try{for(b(z),d=n(l);d!==null&&(!(d.expirationTime>z)||_&&!A());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,h=d.priorityLevel;var q=Z(d.expirationTime<=z);z=t.unstable_now(),typeof q=="function"?d.callback=q:d===n(l)&&r(l),b(z)}else r(l);d=n(l)}if(d!==null)var te=!0;else{var ie=n(c);ie!==null&&V(w,ie.startTime-z),te=!1}return te}finally{d=null,h=K,f=!1}}var C=!1,S=null,I=-1,$=5,E=-1;function A(){return!(t.unstable_now()-E<$)}function D(){if(S!==null){var _=t.unstable_now();E=_;var z=!0;try{z=S(!0,_)}finally{z?P():(C=!1,S=null)}}else C=!1}var P;if(typeof y=="function")P=function(){y(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,F=O.port2;O.port1.onmessage=D,P=function(){F.postMessage(null)}}else P=function(){x(D,0)};function U(_){S=_,C||(C=!0,P())}function V(_,z){I=x(function(){_(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,U(k))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var K=h;h=z;try{return _()}finally{h=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,z){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var K=h;h=_;try{return z()}finally{h=K}},t.unstable_scheduleCallback=function(_,z,K){var Z=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?Z+K:Z):K=Z,_){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=K+q,_={id:u++,callback:z,priorityLevel:_,startTime:K,expirationTime:q,sortIndex:-1},K>Z?(_.sortIndex=K,e(c,_),n(l)===null&&_===n(c)&&(m?(g(I),I=-1):m=!0,V(w,K-Z))):(_.sortIndex=q,e(l,_),p||f||(p=!0,U(k))),_},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(_){var z=h;return function(){var K=h;h=z;try{return _.apply(this,arguments)}finally{h=K}}}})(wO);bO.exports=wO;var XV=bO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YV=N,Ur=XV;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kO=new Set,Qd={};function Rl(t,e){Gc(t,e),Gc(t+"Capture",e)}function Gc(t,e){for(Qd[t]=e,t=0;t<e.length;t++)kO.add(e[t])}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yb=Object.prototype.hasOwnProperty,QV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,CN={},SN={};function ZV(t){return yb.call(SN,t)?!0:yb.call(CN,t)?!1:QV.test(t)?SN[t]=!0:(CN[t]=!0,!1)}function JV(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function e6(t,e,n,r){if(e===null||typeof e>"u"||JV(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dn[t]=new dr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dn[e]=new dr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dn[t]=new dr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dn[t]=new dr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dn[t]=new dr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dn[t]=new dr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dn[t]=new dr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dn[t]=new dr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dn[t]=new dr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yw=/[\-:]([a-z])/g;function Qw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yw,Qw);Dn[e]=new dr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yw,Qw);Dn[e]=new dr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yw,Qw);Dn[e]=new dr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dn[t]=new dr(t,1,!1,t.toLowerCase(),null,!1,!1)});Dn.xlinkHref=new dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dn[t]=new dr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zw(t,e,n,r){var s=Dn.hasOwnProperty(e)?Dn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(e6(e,n,s,r)&&(n=null),r||s===null?ZV(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lo=YV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$p=Symbol.for("react.element"),dc=Symbol.for("react.portal"),hc=Symbol.for("react.fragment"),Jw=Symbol.for("react.strict_mode"),vb=Symbol.for("react.profiler"),CO=Symbol.for("react.provider"),SO=Symbol.for("react.context"),ek=Symbol.for("react.forward_ref"),bb=Symbol.for("react.suspense"),wb=Symbol.for("react.suspense_list"),tk=Symbol.for("react.memo"),No=Symbol.for("react.lazy"),IO=Symbol.for("react.offscreen"),IN=Symbol.iterator;function td(t){return t===null||typeof t!="object"?null:(t=IN&&t[IN]||t["@@iterator"],typeof t=="function"?t:null)}var Dt=Object.assign,ov;function Cd(t){if(ov===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ov=e&&e[1]||""}return`
`+ov+t}var av=!1;function lv(t,e){if(!t||av)return"";av=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{av=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Cd(t):""}function t6(t){switch(t.tag){case 5:return Cd(t.type);case 16:return Cd("Lazy");case 13:return Cd("Suspense");case 19:return Cd("SuspenseList");case 0:case 2:case 15:return t=lv(t.type,!1),t;case 11:return t=lv(t.type.render,!1),t;case 1:return t=lv(t.type,!0),t;default:return""}}function kb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hc:return"Fragment";case dc:return"Portal";case vb:return"Profiler";case Jw:return"StrictMode";case bb:return"Suspense";case wb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SO:return(t.displayName||"Context")+".Consumer";case CO:return(t._context.displayName||"Context")+".Provider";case ek:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tk:return e=t.displayName||null,e!==null?e:kb(t.type)||"Memo";case No:e=t._payload,t=t._init;try{return kb(t(e))}catch{}}return null}function n6(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kb(e);case 8:return e===Jw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function NO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function r6(t){var e=NO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ep(t){t._valueTracker||(t._valueTracker=r6(t))}function $O(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=NO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Em(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Cb(t,e){var n=e.checked;return Dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function NN(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function EO(t,e){e=e.checked,e!=null&&Zw(t,"checked",e,!1)}function Sb(t,e){EO(t,e);var n=Zo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ib(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ib(t,e.type,Zo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $N(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ib(t,e,n){(e!=="number"||Em(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Sd=Array.isArray;function Ec(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zo(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Nb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function EN(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Sd(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zo(n)}}function TO(t,e){var n=Zo(e.value),r=Zo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function TN(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $b(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tp,DO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tp=Tp||document.createElement("div"),Tp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var _d={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},s6=["Webkit","ms","Moz","O"];Object.keys(_d).forEach(function(t){s6.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_d[e]=_d[t]})});function OO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||_d.hasOwnProperty(t)&&_d[t]?(""+e).trim():e+"px"}function RO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=OO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var i6=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eb(t,e){if(e){if(i6[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Tb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ab=null;function nk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Db=null,Tc=null,Ac=null;function AN(t){if(t=Bh(t)){if(typeof Db!="function")throw Error(se(280));var e=t.stateNode;e&&(e=g0(e),Db(t.stateNode,t.type,e))}}function PO(t){Tc?Ac?Ac.push(t):Ac=[t]:Tc=t}function _O(){if(Tc){var t=Tc,e=Ac;if(Ac=Tc=null,AN(t),e)for(t=0;t<e.length;t++)AN(e[t])}}function MO(t,e){return t(e)}function FO(){}var cv=!1;function LO(t,e,n){if(cv)return t(e,n);cv=!0;try{return MO(t,e,n)}finally{cv=!1,(Tc!==null||Ac!==null)&&(FO(),_O())}}function Jd(t,e){var n=t.stateNode;if(n===null)return null;var r=g0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var Ob=!1;if(Xi)try{var nd={};Object.defineProperty(nd,"passive",{get:function(){Ob=!0}}),window.addEventListener("test",nd,nd),window.removeEventListener("test",nd,nd)}catch{Ob=!1}function o6(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Md=!1,Tm=null,Am=!1,Rb=null,a6={onError:function(t){Md=!0,Tm=t}};function l6(t,e,n,r,s,i,o,a,l){Md=!1,Tm=null,o6.apply(a6,arguments)}function c6(t,e,n,r,s,i,o,a,l){if(l6.apply(this,arguments),Md){if(Md){var c=Tm;Md=!1,Tm=null}else throw Error(se(198));Am||(Am=!0,Rb=c)}}function Pl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function DN(t){if(Pl(t)!==t)throw Error(se(188))}function u6(t){var e=t.alternate;if(!e){if(e=Pl(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return DN(s),t;if(i===r)return DN(s),e;i=i.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function zO(t){return t=u6(t),t!==null?BO(t):null}function BO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=BO(t);if(e!==null)return e;t=t.sibling}return null}var WO=Ur.unstable_scheduleCallback,ON=Ur.unstable_cancelCallback,d6=Ur.unstable_shouldYield,h6=Ur.unstable_requestPaint,Bt=Ur.unstable_now,f6=Ur.unstable_getCurrentPriorityLevel,rk=Ur.unstable_ImmediatePriority,UO=Ur.unstable_UserBlockingPriority,Dm=Ur.unstable_NormalPriority,p6=Ur.unstable_LowPriority,VO=Ur.unstable_IdlePriority,h0=null,fi=null;function m6(t){if(fi&&typeof fi.onCommitFiberRoot=="function")try{fi.onCommitFiberRoot(h0,t,void 0,(t.current.flags&128)===128)}catch{}}var Us=Math.clz32?Math.clz32:y6,g6=Math.log,x6=Math.LN2;function y6(t){return t>>>=0,t===0?32:31-(g6(t)/x6|0)|0}var Ap=64,Dp=4194304;function Id(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Om(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Id(a):(i&=o,i!==0&&(r=Id(i)))}else o=n&~s,o!==0?r=Id(o):i!==0&&(r=Id(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Us(e),s=1<<n,r|=t[n],e&=~s;return r}function v6(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b6(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Us(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=v6(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Pb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function GO(){var t=Ap;return Ap<<=1,!(Ap&4194240)&&(Ap=64),t}function uv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function jh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Us(e),t[e]=n}function w6(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Us(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function sk(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Us(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var rt=0;function HO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KO,ik,qO,XO,YO,_b=!1,Op=[],Lo=null,jo=null,zo=null,eh=new Map,th=new Map,Ao=[],k6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RN(t,e){switch(t){case"focusin":case"focusout":Lo=null;break;case"dragenter":case"dragleave":jo=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":eh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":th.delete(e.pointerId)}}function rd(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Bh(e),e!==null&&ik(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function C6(t,e,n,r,s){switch(e){case"focusin":return Lo=rd(Lo,t,e,n,r,s),!0;case"dragenter":return jo=rd(jo,t,e,n,r,s),!0;case"mouseover":return zo=rd(zo,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return eh.set(i,rd(eh.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,th.set(i,rd(th.get(i)||null,t,e,n,r,s)),!0}return!1}function QO(t){var e=Wa(t.target);if(e!==null){var n=Pl(e);if(n!==null){if(e=n.tag,e===13){if(e=jO(n),e!==null){t.blockedOn=e,YO(t.priority,function(){qO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ab=r,n.target.dispatchEvent(r),Ab=null}else return e=Bh(n),e!==null&&ik(e),t.blockedOn=n,!1;e.shift()}return!0}function PN(t,e,n){mm(t)&&n.delete(e)}function S6(){_b=!1,Lo!==null&&mm(Lo)&&(Lo=null),jo!==null&&mm(jo)&&(jo=null),zo!==null&&mm(zo)&&(zo=null),eh.forEach(PN),th.forEach(PN)}function sd(t,e){t.blockedOn===e&&(t.blockedOn=null,_b||(_b=!0,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,S6)))}function nh(t){function e(s){return sd(s,t)}if(0<Op.length){sd(Op[0],t);for(var n=1;n<Op.length;n++){var r=Op[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Lo!==null&&sd(Lo,t),jo!==null&&sd(jo,t),zo!==null&&sd(zo,t),eh.forEach(e),th.forEach(e),n=0;n<Ao.length;n++)r=Ao[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ao.length&&(n=Ao[0],n.blockedOn===null);)QO(n),n.blockedOn===null&&Ao.shift()}var Dc=lo.ReactCurrentBatchConfig,Rm=!0;function I6(t,e,n,r){var s=rt,i=Dc.transition;Dc.transition=null;try{rt=1,ok(t,e,n,r)}finally{rt=s,Dc.transition=i}}function N6(t,e,n,r){var s=rt,i=Dc.transition;Dc.transition=null;try{rt=4,ok(t,e,n,r)}finally{rt=s,Dc.transition=i}}function ok(t,e,n,r){if(Rm){var s=Mb(t,e,n,r);if(s===null)bv(t,e,r,Pm,n),RN(t,r);else if(C6(s,t,e,n,r))r.stopPropagation();else if(RN(t,r),e&4&&-1<k6.indexOf(t)){for(;s!==null;){var i=Bh(s);if(i!==null&&KO(i),i=Mb(t,e,n,r),i===null&&bv(t,e,r,Pm,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else bv(t,e,r,null,n)}}var Pm=null;function Mb(t,e,n,r){if(Pm=null,t=nk(r),t=Wa(t),t!==null)if(e=Pl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Pm=t,null}function ZO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f6()){case rk:return 1;case UO:return 4;case Dm:case p6:return 16;case VO:return 536870912;default:return 16}default:return 16}}var Ro=null,ak=null,gm=null;function JO(){if(gm)return gm;var t,e=ak,n=e.length,r,s="value"in Ro?Ro.value:Ro.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return gm=s.slice(t,1<r?1-r:void 0)}function xm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Rp(){return!0}function _N(){return!1}function Xr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Rp:_N,this.isPropagationStopped=_N,this}return Dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Rp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Rp)},persist:function(){},isPersistent:Rp}),e}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lk=Xr(Iu),zh=Dt({},Iu,{view:0,detail:0}),$6=Xr(zh),dv,hv,id,f0=Dt({},zh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ck,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==id&&(id&&t.type==="mousemove"?(dv=t.screenX-id.screenX,hv=t.screenY-id.screenY):hv=dv=0,id=t),dv)},movementY:function(t){return"movementY"in t?t.movementY:hv}}),MN=Xr(f0),E6=Dt({},f0,{dataTransfer:0}),T6=Xr(E6),A6=Dt({},zh,{relatedTarget:0}),fv=Xr(A6),D6=Dt({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),O6=Xr(D6),R6=Dt({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),P6=Xr(R6),_6=Dt({},Iu,{data:0}),FN=Xr(_6),M6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},L6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j6(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=L6[t])?!!e[t]:!1}function ck(){return j6}var z6=Dt({},zh,{key:function(t){if(t.key){var e=M6[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?F6[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ck,charCode:function(t){return t.type==="keypress"?xm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),B6=Xr(z6),W6=Dt({},f0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LN=Xr(W6),U6=Dt({},zh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ck}),V6=Xr(U6),G6=Dt({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),H6=Xr(G6),K6=Dt({},f0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),q6=Xr(K6),X6=[9,13,27,32],uk=Xi&&"CompositionEvent"in window,Fd=null;Xi&&"documentMode"in document&&(Fd=document.documentMode);var Y6=Xi&&"TextEvent"in window&&!Fd,eR=Xi&&(!uk||Fd&&8<Fd&&11>=Fd),jN=" ",zN=!1;function tR(t,e){switch(t){case"keyup":return X6.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fc=!1;function Q6(t,e){switch(t){case"compositionend":return nR(e);case"keypress":return e.which!==32?null:(zN=!0,jN);case"textInput":return t=e.data,t===jN&&zN?null:t;default:return null}}function Z6(t,e){if(fc)return t==="compositionend"||!uk&&tR(t,e)?(t=JO(),gm=ak=Ro=null,fc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eR&&e.locale!=="ko"?null:e.data;default:return null}}var J6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!J6[t.type]:e==="textarea"}function rR(t,e,n,r){PO(r),e=_m(e,"onChange"),0<e.length&&(n=new lk("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ld=null,rh=null;function eG(t){pR(t,0)}function p0(t){var e=gc(t);if($O(e))return t}function tG(t,e){if(t==="change")return e}var sR=!1;if(Xi){var pv;if(Xi){var mv="oninput"in document;if(!mv){var WN=document.createElement("div");WN.setAttribute("oninput","return;"),mv=typeof WN.oninput=="function"}pv=mv}else pv=!1;sR=pv&&(!document.documentMode||9<document.documentMode)}function UN(){Ld&&(Ld.detachEvent("onpropertychange",iR),rh=Ld=null)}function iR(t){if(t.propertyName==="value"&&p0(rh)){var e=[];rR(e,rh,t,nk(t)),LO(eG,e)}}function nG(t,e,n){t==="focusin"?(UN(),Ld=e,rh=n,Ld.attachEvent("onpropertychange",iR)):t==="focusout"&&UN()}function rG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return p0(rh)}function sG(t,e){if(t==="click")return p0(e)}function iG(t,e){if(t==="input"||t==="change")return p0(e)}function oG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qs=typeof Object.is=="function"?Object.is:oG;function sh(t,e){if(qs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!yb.call(e,s)||!qs(t[s],e[s]))return!1}return!0}function VN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function GN(t,e){var n=VN(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=VN(n)}}function oR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aR(){for(var t=window,e=Em();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Em(t.document)}return e}function dk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function aG(t){var e=aR(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oR(n.ownerDocument.documentElement,n)){if(r!==null&&dk(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=GN(n,i);var o=GN(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lG=Xi&&"documentMode"in document&&11>=document.documentMode,pc=null,Fb=null,jd=null,Lb=!1;function HN(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Lb||pc==null||pc!==Em(r)||(r=pc,"selectionStart"in r&&dk(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jd&&sh(jd,r)||(jd=r,r=_m(Fb,"onSelect"),0<r.length&&(e=new lk("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=pc)))}function Pp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var mc={animationend:Pp("Animation","AnimationEnd"),animationiteration:Pp("Animation","AnimationIteration"),animationstart:Pp("Animation","AnimationStart"),transitionend:Pp("Transition","TransitionEnd")},gv={},lR={};Xi&&(lR=document.createElement("div").style,"AnimationEvent"in window||(delete mc.animationend.animation,delete mc.animationiteration.animation,delete mc.animationstart.animation),"TransitionEvent"in window||delete mc.transitionend.transition);function m0(t){if(gv[t])return gv[t];if(!mc[t])return t;var e=mc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lR)return gv[t]=e[n];return t}var cR=m0("animationend"),uR=m0("animationiteration"),dR=m0("animationstart"),hR=m0("transitionend"),fR=new Map,KN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ua(t,e){fR.set(t,e),Rl(e,[t])}for(var xv=0;xv<KN.length;xv++){var yv=KN[xv],cG=yv.toLowerCase(),uG=yv[0].toUpperCase()+yv.slice(1);ua(cG,"on"+uG)}ua(cR,"onAnimationEnd");ua(uR,"onAnimationIteration");ua(dR,"onAnimationStart");ua("dblclick","onDoubleClick");ua("focusin","onFocus");ua("focusout","onBlur");ua(hR,"onTransitionEnd");Gc("onMouseEnter",["mouseout","mouseover"]);Gc("onMouseLeave",["mouseout","mouseover"]);Gc("onPointerEnter",["pointerout","pointerover"]);Gc("onPointerLeave",["pointerout","pointerover"]);Rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nd));function qN(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,c6(r,e,void 0,t),t.currentTarget=null}function pR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;qN(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;qN(s,a,c),i=l}}}if(Am)throw t=Rb,Am=!1,Rb=null,t}function bt(t,e){var n=e[Ub];n===void 0&&(n=e[Ub]=new Set);var r=t+"__bubble";n.has(r)||(mR(e,t,2,!1),n.add(r))}function vv(t,e,n){var r=0;e&&(r|=4),mR(n,t,r,e)}var _p="_reactListening"+Math.random().toString(36).slice(2);function ih(t){if(!t[_p]){t[_p]=!0,kO.forEach(function(n){n!=="selectionchange"&&(dG.has(n)||vv(n,!1,t),vv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_p]||(e[_p]=!0,vv("selectionchange",!1,e))}}function mR(t,e,n,r){switch(ZO(e)){case 1:var s=I6;break;case 4:s=N6;break;default:s=ok}n=s.bind(null,e,n,t),s=void 0,!Ob||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function bv(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Wa(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}LO(function(){var c=i,u=nk(n),d=[];e:{var h=fR.get(t);if(h!==void 0){var f=lk,p=t;switch(t){case"keypress":if(xm(n)===0)break e;case"keydown":case"keyup":f=B6;break;case"focusin":p="focus",f=fv;break;case"focusout":p="blur",f=fv;break;case"beforeblur":case"afterblur":f=fv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=MN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=T6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=V6;break;case cR:case uR:case dR:f=O6;break;case hR:f=H6;break;case"scroll":f=$6;break;case"wheel":f=q6;break;case"copy":case"cut":case"paste":f=P6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=LN}var m=(e&4)!==0,x=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,g!==null&&(w=Jd(y,g),w!=null&&m.push(oh(y,w,b)))),x)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Ab&&(p=n.relatedTarget||n.fromElement)&&(Wa(p)||p[Yi]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Wa(p):null,p!==null&&(x=Pl(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=MN,w="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=LN,w="onPointerLeave",g="onPointerEnter",y="pointer"),x=f==null?h:gc(f),b=p==null?h:gc(p),h=new m(w,y+"leave",f,n,u),h.target=x,h.relatedTarget=b,w=null,Wa(u)===c&&(m=new m(g,y+"enter",p,n,u),m.target=b,m.relatedTarget=x,w=m),x=w,f&&p)t:{for(m=f,g=p,y=0,b=m;b;b=Jl(b))y++;for(b=0,w=g;w;w=Jl(w))b++;for(;0<y-b;)m=Jl(m),y--;for(;0<b-y;)g=Jl(g),b--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=Jl(m),g=Jl(g)}m=null}else m=null;f!==null&&XN(d,h,f,m,!1),p!==null&&x!==null&&XN(d,x,p,m,!0)}}e:{if(h=c?gc(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var k=tG;else if(BN(h))if(sR)k=iG;else{k=rG;var C=nG}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=sG);if(k&&(k=k(t,c))){rR(d,k,n,u);break e}C&&C(t,h,c),t==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&Ib(h,"number",h.value)}switch(C=c?gc(c):window,t){case"focusin":(BN(C)||C.contentEditable==="true")&&(pc=C,Fb=c,jd=null);break;case"focusout":jd=Fb=pc=null;break;case"mousedown":Lb=!0;break;case"contextmenu":case"mouseup":case"dragend":Lb=!1,HN(d,n,u);break;case"selectionchange":if(lG)break;case"keydown":case"keyup":HN(d,n,u)}var S;if(uk)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else fc?tR(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(eR&&n.locale!=="ko"&&(fc||I!=="onCompositionStart"?I==="onCompositionEnd"&&fc&&(S=JO()):(Ro=u,ak="value"in Ro?Ro.value:Ro.textContent,fc=!0)),C=_m(c,I),0<C.length&&(I=new FN(I,t,null,n,u),d.push({event:I,listeners:C}),S?I.data=S:(S=nR(n),S!==null&&(I.data=S)))),(S=Y6?Q6(t,n):Z6(t,n))&&(c=_m(c,"onBeforeInput"),0<c.length&&(u=new FN("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=S))}pR(d,e)})}function oh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _m(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Jd(t,n),i!=null&&r.unshift(oh(t,i,s)),i=Jd(t,e),i!=null&&r.push(oh(t,i,s))),t=t.return}return r}function Jl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function XN(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Jd(n,i),l!=null&&o.unshift(oh(n,l,a))):s||(l=Jd(n,i),l!=null&&o.push(oh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var hG=/\r\n?/g,fG=/\u0000|\uFFFD/g;function YN(t){return(typeof t=="string"?t:""+t).replace(hG,`
`).replace(fG,"")}function Mp(t,e,n){if(e=YN(e),YN(t)!==e&&n)throw Error(se(425))}function Mm(){}var jb=null,zb=null;function Bb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wb=typeof setTimeout=="function"?setTimeout:void 0,pG=typeof clearTimeout=="function"?clearTimeout:void 0,QN=typeof Promise=="function"?Promise:void 0,mG=typeof queueMicrotask=="function"?queueMicrotask:typeof QN<"u"?function(t){return QN.resolve(null).then(t).catch(gG)}:Wb;function gG(t){setTimeout(function(){throw t})}function wv(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),nh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);nh(e)}function Bo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ZN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Nu=Math.random().toString(36).slice(2),ui="__reactFiber$"+Nu,ah="__reactProps$"+Nu,Yi="__reactContainer$"+Nu,Ub="__reactEvents$"+Nu,xG="__reactListeners$"+Nu,yG="__reactHandles$"+Nu;function Wa(t){var e=t[ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yi]||n[ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ZN(t);t!==null;){if(n=t[ui])return n;t=ZN(t)}return e}t=n,n=t.parentNode}return null}function Bh(t){return t=t[ui]||t[Yi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function g0(t){return t[ah]||null}var Vb=[],xc=-1;function da(t){return{current:t}}function kt(t){0>xc||(t.current=Vb[xc],Vb[xc]=null,xc--)}function gt(t,e){xc++,Vb[xc]=t.current,t.current=e}var Jo={},Yn=da(Jo),kr=da(!1),ll=Jo;function Hc(t,e){var n=t.type.contextTypes;if(!n)return Jo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Cr(t){return t=t.childContextTypes,t!=null}function Fm(){kt(kr),kt(Yn)}function JN(t,e,n){if(Yn.current!==Jo)throw Error(se(168));gt(Yn,e),gt(kr,n)}function gR(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,n6(t)||"Unknown",s));return Dt({},n,r)}function Lm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jo,ll=Yn.current,gt(Yn,t),gt(kr,kr.current),!0}function e$(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=gR(t,e,ll),r.__reactInternalMemoizedMergedChildContext=t,kt(kr),kt(Yn),gt(Yn,t)):kt(kr),gt(kr,n)}var Pi=null,x0=!1,kv=!1;function xR(t){Pi===null?Pi=[t]:Pi.push(t)}function vG(t){x0=!0,xR(t)}function ha(){if(!kv&&Pi!==null){kv=!0;var t=0,e=rt;try{var n=Pi;for(rt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Pi=null,x0=!1}catch(s){throw Pi!==null&&(Pi=Pi.slice(t+1)),WO(rk,ha),s}finally{rt=e,kv=!1}}return null}var yc=[],vc=0,jm=null,zm=0,is=[],os=0,cl=null,ji=1,zi="";function Oa(t,e){yc[vc++]=zm,yc[vc++]=jm,jm=t,zm=e}function yR(t,e,n){is[os++]=ji,is[os++]=zi,is[os++]=cl,cl=t;var r=ji;t=zi;var s=32-Us(r)-1;r&=~(1<<s),n+=1;var i=32-Us(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ji=1<<32-Us(e)+s|n<<s|r,zi=i+t}else ji=1<<i|n<<s|r,zi=t}function hk(t){t.return!==null&&(Oa(t,1),yR(t,1,0))}function fk(t){for(;t===jm;)jm=yc[--vc],yc[vc]=null,zm=yc[--vc],yc[vc]=null;for(;t===cl;)cl=is[--os],is[os]=null,zi=is[--os],is[os]=null,ji=is[--os],is[os]=null}var zr=null,Lr=null,It=!1,Ms=null;function vR(t,e){var n=cs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function t$(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zr=t,Lr=Bo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zr=t,Lr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=cl!==null?{id:ji,overflow:zi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zr=t,Lr=null,!0):!1;default:return!1}}function Gb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Hb(t){if(It){var e=Lr;if(e){var n=e;if(!t$(t,e)){if(Gb(t))throw Error(se(418));e=Bo(n.nextSibling);var r=zr;e&&t$(t,e)?vR(r,n):(t.flags=t.flags&-4097|2,It=!1,zr=t)}}else{if(Gb(t))throw Error(se(418));t.flags=t.flags&-4097|2,It=!1,zr=t}}}function n$(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zr=t}function Fp(t){if(t!==zr)return!1;if(!It)return n$(t),It=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Bb(t.type,t.memoizedProps)),e&&(e=Lr)){if(Gb(t))throw bR(),Error(se(418));for(;e;)vR(t,e),e=Bo(e.nextSibling)}if(n$(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Lr=Bo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Lr=null}}else Lr=zr?Bo(t.stateNode.nextSibling):null;return!0}function bR(){for(var t=Lr;t;)t=Bo(t.nextSibling)}function Kc(){Lr=zr=null,It=!1}function pk(t){Ms===null?Ms=[t]:Ms.push(t)}var bG=lo.ReactCurrentBatchConfig;function od(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Lp(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function r$(t){var e=t._init;return e(t._payload)}function wR(t){function e(g,y){if(t){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=Go(g,y),g.index=0,g.sibling=null,g}function i(g,y,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,b,w){return y===null||y.tag!==6?(y=Tv(b,g.mode,w),y.return=g,y):(y=s(y,b),y.return=g,y)}function l(g,y,b,w){var k=b.type;return k===hc?u(g,y,b.props.children,w,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===No&&r$(k)===y.type)?(w=s(y,b.props),w.ref=od(g,y,b),w.return=g,w):(w=Sm(b.type,b.key,b.props,null,g.mode,w),w.ref=od(g,y,b),w.return=g,w)}function c(g,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Av(b,g.mode,w),y.return=g,y):(y=s(y,b.children||[]),y.return=g,y)}function u(g,y,b,w,k){return y===null||y.tag!==7?(y=el(b,g.mode,w,k),y.return=g,y):(y=s(y,b),y.return=g,y)}function d(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Tv(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case $p:return b=Sm(y.type,y.key,y.props,null,g.mode,b),b.ref=od(g,null,y),b.return=g,b;case dc:return y=Av(y,g.mode,b),y.return=g,y;case No:var w=y._init;return d(g,w(y._payload),b)}if(Sd(y)||td(y))return y=el(y,g.mode,b,null),y.return=g,y;Lp(g,y)}return null}function h(g,y,b,w){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:a(g,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $p:return b.key===k?l(g,y,b,w):null;case dc:return b.key===k?c(g,y,b,w):null;case No:return k=b._init,h(g,y,k(b._payload),w)}if(Sd(b)||td(b))return k!==null?null:u(g,y,b,w,null);Lp(g,b)}return null}function f(g,y,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(b)||null,a(y,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case $p:return g=g.get(w.key===null?b:w.key)||null,l(y,g,w,k);case dc:return g=g.get(w.key===null?b:w.key)||null,c(y,g,w,k);case No:var C=w._init;return f(g,y,b,C(w._payload),k)}if(Sd(w)||td(w))return g=g.get(b)||null,u(y,g,w,k,null);Lp(y,w)}return null}function p(g,y,b,w){for(var k=null,C=null,S=y,I=y=0,$=null;S!==null&&I<b.length;I++){S.index>I?($=S,S=null):$=S.sibling;var E=h(g,S,b[I],w);if(E===null){S===null&&(S=$);break}t&&S&&E.alternate===null&&e(g,S),y=i(E,y,I),C===null?k=E:C.sibling=E,C=E,S=$}if(I===b.length)return n(g,S),It&&Oa(g,I),k;if(S===null){for(;I<b.length;I++)S=d(g,b[I],w),S!==null&&(y=i(S,y,I),C===null?k=S:C.sibling=S,C=S);return It&&Oa(g,I),k}for(S=r(g,S);I<b.length;I++)$=f(S,g,I,b[I],w),$!==null&&(t&&$.alternate!==null&&S.delete($.key===null?I:$.key),y=i($,y,I),C===null?k=$:C.sibling=$,C=$);return t&&S.forEach(function(A){return e(g,A)}),It&&Oa(g,I),k}function m(g,y,b,w){var k=td(b);if(typeof k!="function")throw Error(se(150));if(b=k.call(b),b==null)throw Error(se(151));for(var C=k=null,S=y,I=y=0,$=null,E=b.next();S!==null&&!E.done;I++,E=b.next()){S.index>I?($=S,S=null):$=S.sibling;var A=h(g,S,E.value,w);if(A===null){S===null&&(S=$);break}t&&S&&A.alternate===null&&e(g,S),y=i(A,y,I),C===null?k=A:C.sibling=A,C=A,S=$}if(E.done)return n(g,S),It&&Oa(g,I),k;if(S===null){for(;!E.done;I++,E=b.next())E=d(g,E.value,w),E!==null&&(y=i(E,y,I),C===null?k=E:C.sibling=E,C=E);return It&&Oa(g,I),k}for(S=r(g,S);!E.done;I++,E=b.next())E=f(S,g,I,E.value,w),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?I:E.key),y=i(E,y,I),C===null?k=E:C.sibling=E,C=E);return t&&S.forEach(function(D){return e(g,D)}),It&&Oa(g,I),k}function x(g,y,b,w){if(typeof b=="object"&&b!==null&&b.type===hc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $p:e:{for(var k=b.key,C=y;C!==null;){if(C.key===k){if(k=b.type,k===hc){if(C.tag===7){n(g,C.sibling),y=s(C,b.props.children),y.return=g,g=y;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===No&&r$(k)===C.type){n(g,C.sibling),y=s(C,b.props),y.ref=od(g,C,b),y.return=g,g=y;break e}n(g,C);break}else e(g,C);C=C.sibling}b.type===hc?(y=el(b.props.children,g.mode,w,b.key),y.return=g,g=y):(w=Sm(b.type,b.key,b.props,null,g.mode,w),w.ref=od(g,y,b),w.return=g,g=w)}return o(g);case dc:e:{for(C=b.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(g,y.sibling),y=s(y,b.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=Av(b,g.mode,w),y.return=g,g=y}return o(g);case No:return C=b._init,x(g,y,C(b._payload),w)}if(Sd(b))return p(g,y,b,w);if(td(b))return m(g,y,b,w);Lp(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(g,y.sibling),y=s(y,b),y.return=g,g=y):(n(g,y),y=Tv(b,g.mode,w),y.return=g,g=y),o(g)):n(g,y)}return x}var qc=wR(!0),kR=wR(!1),Bm=da(null),Wm=null,bc=null,mk=null;function gk(){mk=bc=Wm=null}function xk(t){var e=Bm.current;kt(Bm),t._currentValue=e}function Kb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oc(t,e){Wm=t,mk=bc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yr=!0),t.firstContext=null)}function xs(t){var e=t._currentValue;if(mk!==t)if(t={context:t,memoizedValue:e,next:null},bc===null){if(Wm===null)throw Error(se(308));bc=t,Wm.dependencies={lanes:0,firstContext:t}}else bc=bc.next=t;return e}var Ua=null;function yk(t){Ua===null?Ua=[t]:Ua.push(t)}function CR(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yk(e)):(n.next=s.next,s.next=n),e.interleaved=n,Qi(t,r)}function Qi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $o=!1;function vk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Vi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,He&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Qi(t,n)}return s=r.interleaved,s===null?(e.next=e,yk(r)):(e.next=s.next,s.next=e),r.interleaved=e,Qi(t,n)}function ym(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sk(t,n)}}function s$(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Um(t,e,n,r){var s=t.updateQueue;$o=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Dt({},d,h);break e;case 2:$o=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);dl|=o,t.lanes=o,t.memoizedState=d}}function i$(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var Wh={},pi=da(Wh),lh=da(Wh),ch=da(Wh);function Va(t){if(t===Wh)throw Error(se(174));return t}function bk(t,e){switch(gt(ch,e),gt(lh,t),gt(pi,Wh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$b(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$b(e,t)}kt(pi),gt(pi,e)}function Xc(){kt(pi),kt(lh),kt(ch)}function IR(t){Va(ch.current);var e=Va(pi.current),n=$b(e,t.type);e!==n&&(gt(lh,t),gt(pi,n))}function wk(t){lh.current===t&&(kt(pi),kt(lh))}var Tt=da(0);function Vm(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cv=[];function kk(){for(var t=0;t<Cv.length;t++)Cv[t]._workInProgressVersionPrimary=null;Cv.length=0}var vm=lo.ReactCurrentDispatcher,Sv=lo.ReactCurrentBatchConfig,ul=0,At=null,on=null,gn=null,Gm=!1,zd=!1,uh=0,wG=0;function jn(){throw Error(se(321))}function Ck(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!qs(t[n],e[n]))return!1;return!0}function Sk(t,e,n,r,s,i){if(ul=i,At=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vm.current=t===null||t.memoizedState===null?IG:NG,t=n(r,s),zd){i=0;do{if(zd=!1,uh=0,25<=i)throw Error(se(301));i+=1,gn=on=null,e.updateQueue=null,vm.current=$G,t=n(r,s)}while(zd)}if(vm.current=Hm,e=on!==null&&on.next!==null,ul=0,gn=on=At=null,Gm=!1,e)throw Error(se(300));return t}function Ik(){var t=uh!==0;return uh=0,t}function si(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?At.memoizedState=gn=t:gn=gn.next=t,gn}function ys(){if(on===null){var t=At.alternate;t=t!==null?t.memoizedState:null}else t=on.next;var e=gn===null?At.memoizedState:gn.next;if(e!==null)gn=e,on=t;else{if(t===null)throw Error(se(310));on=t,t={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},gn===null?At.memoizedState=gn=t:gn=gn.next=t}return gn}function dh(t,e){return typeof e=="function"?e(t):e}function Iv(t){var e=ys(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=on,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((ul&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,At.lanes|=u,dl|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,qs(r,e.memoizedState)||(yr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,At.lanes|=i,dl|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nv(t){var e=ys(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);qs(i,e.memoizedState)||(yr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function NR(){}function $R(t,e){var n=At,r=ys(),s=e(),i=!qs(r.memoizedState,s);if(i&&(r.memoizedState=s,yr=!0),r=r.queue,Nk(AR.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||gn!==null&&gn.memoizedState.tag&1){if(n.flags|=2048,hh(9,TR.bind(null,n,r,s,e),void 0,null),yn===null)throw Error(se(349));ul&30||ER(n,e,s)}return s}function ER(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function TR(t,e,n,r){e.value=n,e.getSnapshot=r,DR(e)&&OR(t)}function AR(t,e,n){return n(function(){DR(e)&&OR(t)})}function DR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!qs(t,n)}catch{return!0}}function OR(t){var e=Qi(t,1);e!==null&&Vs(e,t,1,-1)}function o$(t){var e=si();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dh,lastRenderedState:t},e.queue=t,t=t.dispatch=SG.bind(null,At,t),[e.memoizedState,t]}function hh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RR(){return ys().memoizedState}function bm(t,e,n,r){var s=si();At.flags|=t,s.memoizedState=hh(1|e,n,void 0,r===void 0?null:r)}function y0(t,e,n,r){var s=ys();r=r===void 0?null:r;var i=void 0;if(on!==null){var o=on.memoizedState;if(i=o.destroy,r!==null&&Ck(r,o.deps)){s.memoizedState=hh(e,n,i,r);return}}At.flags|=t,s.memoizedState=hh(1|e,n,i,r)}function a$(t,e){return bm(8390656,8,t,e)}function Nk(t,e){return y0(2048,8,t,e)}function PR(t,e){return y0(4,2,t,e)}function _R(t,e){return y0(4,4,t,e)}function MR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FR(t,e,n){return n=n!=null?n.concat([t]):null,y0(4,4,MR.bind(null,e,t),n)}function $k(){}function LR(t,e){var n=ys();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ck(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jR(t,e){var n=ys();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ck(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function zR(t,e,n){return ul&21?(qs(n,e)||(n=GO(),At.lanes|=n,dl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yr=!0),t.memoizedState=n)}function kG(t,e){var n=rt;rt=n!==0&&4>n?n:4,t(!0);var r=Sv.transition;Sv.transition={};try{t(!1),e()}finally{rt=n,Sv.transition=r}}function BR(){return ys().memoizedState}function CG(t,e,n){var r=Vo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},WR(t))UR(e,n);else if(n=CR(t,e,n,r),n!==null){var s=ir();Vs(n,t,r,s),VR(n,e,r)}}function SG(t,e,n){var r=Vo(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(WR(t))UR(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,qs(a,o)){var l=e.interleaved;l===null?(s.next=s,yk(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=CR(t,e,s,r),n!==null&&(s=ir(),Vs(n,t,r,s),VR(n,e,r))}}function WR(t){var e=t.alternate;return t===At||e!==null&&e===At}function UR(t,e){zd=Gm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function VR(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sk(t,n)}}var Hm={readContext:xs,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},IG={readContext:xs,useCallback:function(t,e){return si().memoizedState=[t,e===void 0?null:e],t},useContext:xs,useEffect:a$,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bm(4194308,4,MR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bm(4194308,4,t,e)},useInsertionEffect:function(t,e){return bm(4,2,t,e)},useMemo:function(t,e){var n=si();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=si();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=CG.bind(null,At,t),[r.memoizedState,t]},useRef:function(t){var e=si();return t={current:t},e.memoizedState=t},useState:o$,useDebugValue:$k,useDeferredValue:function(t){return si().memoizedState=t},useTransition:function(){var t=o$(!1),e=t[0];return t=kG.bind(null,t[1]),si().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=At,s=si();if(It){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),yn===null)throw Error(se(349));ul&30||ER(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,a$(AR.bind(null,r,i,t),[t]),r.flags|=2048,hh(9,TR.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=si(),e=yn.identifierPrefix;if(It){var n=zi,r=ji;n=(r&~(1<<32-Us(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=uh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NG={readContext:xs,useCallback:LR,useContext:xs,useEffect:Nk,useImperativeHandle:FR,useInsertionEffect:PR,useLayoutEffect:_R,useMemo:jR,useReducer:Iv,useRef:RR,useState:function(){return Iv(dh)},useDebugValue:$k,useDeferredValue:function(t){var e=ys();return zR(e,on.memoizedState,t)},useTransition:function(){var t=Iv(dh)[0],e=ys().memoizedState;return[t,e]},useMutableSource:NR,useSyncExternalStore:$R,useId:BR,unstable_isNewReconciler:!1},$G={readContext:xs,useCallback:LR,useContext:xs,useEffect:Nk,useImperativeHandle:FR,useInsertionEffect:PR,useLayoutEffect:_R,useMemo:jR,useReducer:Nv,useRef:RR,useState:function(){return Nv(dh)},useDebugValue:$k,useDeferredValue:function(t){var e=ys();return on===null?e.memoizedState=t:zR(e,on.memoizedState,t)},useTransition:function(){var t=Nv(dh)[0],e=ys().memoizedState;return[t,e]},useMutableSource:NR,useSyncExternalStore:$R,useId:BR,unstable_isNewReconciler:!1};function Ps(t,e){if(t&&t.defaultProps){e=Dt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function qb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Dt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var v0={isMounted:function(t){return(t=t._reactInternals)?Pl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ir(),s=Vo(t),i=Vi(r,s);i.payload=e,n!=null&&(i.callback=n),e=Wo(t,i,s),e!==null&&(Vs(e,t,s,r),ym(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ir(),s=Vo(t),i=Vi(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Wo(t,i,s),e!==null&&(Vs(e,t,s,r),ym(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ir(),r=Vo(t),s=Vi(n,r);s.tag=2,e!=null&&(s.callback=e),e=Wo(t,s,r),e!==null&&(Vs(e,t,r,n),ym(e,t,r))}};function l$(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!sh(n,r)||!sh(s,i):!0}function GR(t,e,n){var r=!1,s=Jo,i=e.contextType;return typeof i=="object"&&i!==null?i=xs(i):(s=Cr(e)?ll:Yn.current,r=e.contextTypes,i=(r=r!=null)?Hc(t,s):Jo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=v0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function c$(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&v0.enqueueReplaceState(e,e.state,null)}function Xb(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vk(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=xs(i):(i=Cr(e)?ll:Yn.current,s.context=Hc(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(qb(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&v0.enqueueReplaceState(s,s.state,null),Um(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Yc(t,e){try{var n="",r=e;do n+=t6(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function $v(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Yb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var EG=typeof WeakMap=="function"?WeakMap:Map;function HR(t,e,n){n=Vi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qm||(qm=!0,o1=r),Yb(t,e)},n}function KR(t,e,n){n=Vi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Yb(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Yb(t,e),typeof r!="function"&&(Uo===null?Uo=new Set([this]):Uo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function u$(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new EG;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=WG.bind(null,t,e,n),e.then(t,t))}function d$(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function h$(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Vi(-1,1),e.tag=2,Wo(n,e,1))),n.lanes|=1),t)}var TG=lo.ReactCurrentOwner,yr=!1;function er(t,e,n,r){e.child=t===null?kR(e,null,n,r):qc(e,t.child,n,r)}function f$(t,e,n,r,s){n=n.render;var i=e.ref;return Oc(e,s),r=Sk(t,e,n,r,i,s),n=Ik(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zi(t,e,s)):(It&&n&&hk(e),e.flags|=1,er(t,e,r,s),e.child)}function p$(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!_k(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,qR(t,e,i,r,s)):(t=Sm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:sh,n(o,r)&&t.ref===e.ref)return Zi(t,e,s)}return e.flags|=1,t=Go(i,r),t.ref=e.ref,t.return=e,e.child=t}function qR(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(sh(i,r)&&t.ref===e.ref)if(yr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(yr=!0);else return e.lanes=t.lanes,Zi(t,e,s)}return Qb(t,e,n,r,s)}function XR(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(kc,Or),Or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,gt(kc,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,gt(kc,Or),Or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,gt(kc,Or),Or|=r;return er(t,e,s,n),e.child}function YR(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Qb(t,e,n,r,s){var i=Cr(n)?ll:Yn.current;return i=Hc(e,i),Oc(e,s),n=Sk(t,e,n,r,i,s),r=Ik(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zi(t,e,s)):(It&&r&&hk(e),e.flags|=1,er(t,e,n,s),e.child)}function m$(t,e,n,r,s){if(Cr(n)){var i=!0;Lm(e)}else i=!1;if(Oc(e,s),e.stateNode===null)wm(t,e),GR(e,n,r),Xb(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=xs(c):(c=Cr(n)?ll:Yn.current,c=Hc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&c$(e,o,r,c),$o=!1;var h=e.memoizedState;o.state=h,Um(e,r,o,s),l=e.memoizedState,a!==r||h!==l||kr.current||$o?(typeof u=="function"&&(qb(e,n,u,r),l=e.memoizedState),(a=$o||l$(e,n,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,SR(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ps(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=xs(l):(l=Cr(n)?ll:Yn.current,l=Hc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&c$(e,o,r,l),$o=!1,h=e.memoizedState,o.state=h,Um(e,r,o,s);var p=e.memoizedState;a!==d||h!==p||kr.current||$o?(typeof f=="function"&&(qb(e,n,f,r),p=e.memoizedState),(c=$o||l$(e,n,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Zb(t,e,n,r,i,s)}function Zb(t,e,n,r,s,i){YR(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&e$(e,n,!1),Zi(t,e,i);r=e.stateNode,TG.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=qc(e,t.child,null,i),e.child=qc(e,null,a,i)):er(t,e,a,i),e.memoizedState=r.state,s&&e$(e,n,!0),e.child}function QR(t){var e=t.stateNode;e.pendingContext?JN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&JN(t,e.context,!1),bk(t,e.containerInfo)}function g$(t,e,n,r,s){return Kc(),pk(s),e.flags|=256,er(t,e,n,r),e.child}var Jb={dehydrated:null,treeContext:null,retryLane:0};function e1(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZR(t,e,n){var r=e.pendingProps,s=Tt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),gt(Tt,s&1),t===null)return Hb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=k0(o,r,0,null),t=el(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=e1(n),e.memoizedState=Jb,t):Ek(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return AG(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Go(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Go(a,i):(i=el(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?e1(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Jb,r}return i=t.child,t=i.sibling,r=Go(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ek(t,e){return e=k0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jp(t,e,n,r){return r!==null&&pk(r),qc(e,t.child,null,n),t=Ek(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function AG(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=$v(Error(se(422))),jp(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=k0({mode:"visible",children:r.children},s,0,null),i=el(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&qc(e,t.child,null,o),e.child.memoizedState=e1(o),e.memoizedState=Jb,i);if(!(e.mode&1))return jp(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(se(419)),r=$v(i,r,void 0),jp(t,e,o,r)}if(a=(o&t.childLanes)!==0,yr||a){if(r=yn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Qi(t,s),Vs(r,t,s,-1))}return Pk(),r=$v(Error(se(421))),jp(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=UG.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Lr=Bo(s.nextSibling),zr=e,It=!0,Ms=null,t!==null&&(is[os++]=ji,is[os++]=zi,is[os++]=cl,ji=t.id,zi=t.overflow,cl=e),e=Ek(e,r.children),e.flags|=4096,e)}function x$(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Kb(t.return,e,n)}function Ev(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function JR(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(er(t,e,r.children,n),r=Tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&x$(t,n,e);else if(t.tag===19)x$(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(gt(Tt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Vm(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ev(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Vm(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ev(e,!0,n,null,i);break;case"together":Ev(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),dl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Go(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Go(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function DG(t,e,n){switch(e.tag){case 3:QR(e),Kc();break;case 5:IR(e);break;case 1:Cr(e.type)&&Lm(e);break;case 4:bk(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;gt(Bm,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(gt(Tt,Tt.current&1),e.flags|=128,null):n&e.child.childLanes?ZR(t,e,n):(gt(Tt,Tt.current&1),t=Zi(t,e,n),t!==null?t.sibling:null);gt(Tt,Tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return JR(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),gt(Tt,Tt.current),r)break;return null;case 22:case 23:return e.lanes=0,XR(t,e,n)}return Zi(t,e,n)}var eP,t1,tP,nP;eP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};t1=function(){};tP=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Va(pi.current);var i=null;switch(n){case"input":s=Cb(t,s),r=Cb(t,r),i=[];break;case"select":s=Dt({},s,{value:void 0}),r=Dt({},r,{value:void 0}),i=[];break;case"textarea":s=Nb(t,s),r=Nb(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Mm)}Eb(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qd.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&bt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};nP=function(t,e,n,r){n!==r&&(e.flags|=4)};function ad(t,e){if(!It)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function OG(t,e,n){var r=e.pendingProps;switch(fk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(e),null;case 1:return Cr(e.type)&&Fm(),zn(e),null;case 3:return r=e.stateNode,Xc(),kt(kr),kt(Yn),kk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Fp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ms!==null&&(c1(Ms),Ms=null))),t1(t,e),zn(e),null;case 5:wk(e);var s=Va(ch.current);if(n=e.type,t!==null&&e.stateNode!=null)tP(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return zn(e),null}if(t=Va(pi.current),Fp(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ui]=e,r[ah]=i,t=(e.mode&1)!==0,n){case"dialog":bt("cancel",r),bt("close",r);break;case"iframe":case"object":case"embed":bt("load",r);break;case"video":case"audio":for(s=0;s<Nd.length;s++)bt(Nd[s],r);break;case"source":bt("error",r);break;case"img":case"image":case"link":bt("error",r),bt("load",r);break;case"details":bt("toggle",r);break;case"input":NN(r,i),bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},bt("invalid",r);break;case"textarea":EN(r,i),bt("invalid",r)}Eb(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Mp(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Mp(r.textContent,a,t),s=["children",""+a]):Qd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&bt("scroll",r)}switch(n){case"input":Ep(r),$N(r,i,!0);break;case"textarea":Ep(r),TN(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Mm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ui]=e,t[ah]=r,eP(t,e,!1,!1),e.stateNode=t;e:{switch(o=Tb(n,r),n){case"dialog":bt("cancel",t),bt("close",t),s=r;break;case"iframe":case"object":case"embed":bt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Nd.length;s++)bt(Nd[s],t);s=r;break;case"source":bt("error",t),s=r;break;case"img":case"image":case"link":bt("error",t),bt("load",t),s=r;break;case"details":bt("toggle",t),s=r;break;case"input":NN(t,r),s=Cb(t,r),bt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Dt({},r,{value:void 0}),bt("invalid",t);break;case"textarea":EN(t,r),s=Nb(t,r),bt("invalid",t);break;default:s=r}Eb(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?RO(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&DO(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Zd(t,l):typeof l=="number"&&Zd(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Qd.hasOwnProperty(i)?l!=null&&i==="onScroll"&&bt("scroll",t):l!=null&&Zw(t,i,l,o))}switch(n){case"input":Ep(t),$N(t,r,!1);break;case"textarea":Ep(t),TN(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zo(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ec(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ec(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Mm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zn(e),null;case 6:if(t&&e.stateNode!=null)nP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=Va(ch.current),Va(pi.current),Fp(e)){if(r=e.stateNode,n=e.memoizedProps,r[ui]=e,(i=r.nodeValue!==n)&&(t=zr,t!==null))switch(t.tag){case 3:Mp(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mp(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ui]=e,e.stateNode=r}return zn(e),null;case 13:if(kt(Tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(It&&Lr!==null&&e.mode&1&&!(e.flags&128))bR(),Kc(),e.flags|=98560,i=!1;else if(i=Fp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(se(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(se(317));i[ui]=e}else Kc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zn(e),i=!1}else Ms!==null&&(c1(Ms),Ms=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Tt.current&1?cn===0&&(cn=3):Pk())),e.updateQueue!==null&&(e.flags|=4),zn(e),null);case 4:return Xc(),t1(t,e),t===null&&ih(e.stateNode.containerInfo),zn(e),null;case 10:return xk(e.type._context),zn(e),null;case 17:return Cr(e.type)&&Fm(),zn(e),null;case 19:if(kt(Tt),i=e.memoizedState,i===null)return zn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ad(i,!1);else{if(cn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Vm(t),o!==null){for(e.flags|=128,ad(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return gt(Tt,Tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Bt()>Qc&&(e.flags|=128,r=!0,ad(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vm(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ad(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!It)return zn(e),null}else 2*Bt()-i.renderingStartTime>Qc&&n!==1073741824&&(e.flags|=128,r=!0,ad(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Bt(),e.sibling=null,n=Tt.current,gt(Tt,r?n&1|2:n&1),e):(zn(e),null);case 22:case 23:return Rk(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(zn(e),e.subtreeFlags&6&&(e.flags|=8192)):zn(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function RG(t,e){switch(fk(e),e.tag){case 1:return Cr(e.type)&&Fm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xc(),kt(kr),kt(Yn),kk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wk(e),null;case 13:if(kt(Tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Kc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return kt(Tt),null;case 4:return Xc(),null;case 10:return xk(e.type._context),null;case 22:case 23:return Rk(),null;case 24:return null;default:return null}}var zp=!1,Vn=!1,PG=typeof WeakSet=="function"?WeakSet:Set,pe=null;function wc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Rt(t,e,r)}else n.current=null}function n1(t,e,n){try{n()}catch(r){Rt(t,e,r)}}var y$=!1;function _G(t,e){if(jb=Rm,t=aR(),dk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===s&&(a=o),h===i&&++u===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(zb={focusedElem:t,selectionRange:n},Rm=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,x=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ps(e.type,m),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(w){Rt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return p=y$,y$=!1,p}function Bd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&n1(e,n,i)}s=s.next}while(s!==r)}}function b0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function r1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rP(t){var e=t.alternate;e!==null&&(t.alternate=null,rP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ui],delete e[ah],delete e[Ub],delete e[xG],delete e[yG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sP(t){return t.tag===5||t.tag===3||t.tag===4}function v$(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function s1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Mm));else if(r!==4&&(t=t.child,t!==null))for(s1(t,e,n),t=t.sibling;t!==null;)s1(t,e,n),t=t.sibling}function i1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(i1(t,e,n),t=t.sibling;t!==null;)i1(t,e,n),t=t.sibling}var $n=null,_s=!1;function ko(t,e,n){for(n=n.child;n!==null;)iP(t,e,n),n=n.sibling}function iP(t,e,n){if(fi&&typeof fi.onCommitFiberUnmount=="function")try{fi.onCommitFiberUnmount(h0,n)}catch{}switch(n.tag){case 5:Vn||wc(n,e);case 6:var r=$n,s=_s;$n=null,ko(t,e,n),$n=r,_s=s,$n!==null&&(_s?(t=$n,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$n.removeChild(n.stateNode));break;case 18:$n!==null&&(_s?(t=$n,n=n.stateNode,t.nodeType===8?wv(t.parentNode,n):t.nodeType===1&&wv(t,n),nh(t)):wv($n,n.stateNode));break;case 4:r=$n,s=_s,$n=n.stateNode.containerInfo,_s=!0,ko(t,e,n),$n=r,_s=s;break;case 0:case 11:case 14:case 15:if(!Vn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&n1(n,e,o),s=s.next}while(s!==r)}ko(t,e,n);break;case 1:if(!Vn&&(wc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Rt(n,e,a)}ko(t,e,n);break;case 21:ko(t,e,n);break;case 22:n.mode&1?(Vn=(r=Vn)||n.memoizedState!==null,ko(t,e,n),Vn=r):ko(t,e,n);break;default:ko(t,e,n)}}function b$(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new PG),e.forEach(function(r){var s=VG.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ds(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$n=a.stateNode,_s=!1;break e;case 3:$n=a.stateNode.containerInfo,_s=!0;break e;case 4:$n=a.stateNode.containerInfo,_s=!0;break e}a=a.return}if($n===null)throw Error(se(160));iP(i,o,s),$n=null,_s=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Rt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oP(e,t),e=e.sibling}function oP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ds(e,t),ri(t),r&4){try{Bd(3,t,t.return),b0(3,t)}catch(m){Rt(t,t.return,m)}try{Bd(5,t,t.return)}catch(m){Rt(t,t.return,m)}}break;case 1:Ds(e,t),ri(t),r&512&&n!==null&&wc(n,n.return);break;case 5:if(Ds(e,t),ri(t),r&512&&n!==null&&wc(n,n.return),t.flags&32){var s=t.stateNode;try{Zd(s,"")}catch(m){Rt(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&EO(s,i),Tb(a,o);var c=Tb(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?RO(s,d):u==="dangerouslySetInnerHTML"?DO(s,d):u==="children"?Zd(s,d):Zw(s,u,d,c)}switch(a){case"input":Sb(s,i);break;case"textarea":TO(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ec(s,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Ec(s,!!i.multiple,i.defaultValue,!0):Ec(s,!!i.multiple,i.multiple?[]:"",!1))}s[ah]=i}catch(m){Rt(t,t.return,m)}}break;case 6:if(Ds(e,t),ri(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(m){Rt(t,t.return,m)}}break;case 3:if(Ds(e,t),ri(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{nh(e.containerInfo)}catch(m){Rt(t,t.return,m)}break;case 4:Ds(e,t),ri(t);break;case 13:Ds(e,t),ri(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Dk=Bt())),r&4&&b$(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Vn=(c=Vn)||u,Ds(e,t),Vn=c):Ds(e,t),ri(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(pe=t,u=t.child;u!==null;){for(d=pe=u;pe!==null;){switch(h=pe,f=h.child,h.tag){case 0:case 11:case 14:case 15:Bd(4,h,h.return);break;case 1:wc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Rt(r,n,m)}}break;case 5:wc(h,h.return);break;case 22:if(h.memoizedState!==null){k$(d);continue}}f!==null?(f.return=h,pe=f):k$(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=OO("display",o))}catch(m){Rt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Rt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ds(e,t),ri(t),r&4&&b$(t);break;case 21:break;default:Ds(e,t),ri(t)}}function ri(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(sP(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Zd(s,""),r.flags&=-33);var i=v$(t);i1(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=v$(t);s1(t,a,o);break;default:throw Error(se(161))}}catch(l){Rt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function MG(t,e,n){pe=t,aP(t)}function aP(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var s=pe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||zp;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Vn;a=zp;var c=Vn;if(zp=o,(Vn=l)&&!c)for(pe=s;pe!==null;)o=pe,l=o.child,o.tag===22&&o.memoizedState!==null?C$(s):l!==null?(l.return=o,pe=l):C$(s);for(;i!==null;)pe=i,aP(i),i=i.sibling;pe=s,zp=a,Vn=c}w$(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,pe=i):w$(t)}}function w$(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vn||b0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ps(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&i$(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}i$(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&nh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Vn||e.flags&512&&r1(e)}catch(h){Rt(e,e.return,h)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function k$(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function C$(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{b0(4,e)}catch(l){Rt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Rt(e,s,l)}}var i=e.return;try{r1(e)}catch(l){Rt(e,i,l)}break;case 5:var o=e.return;try{r1(e)}catch(l){Rt(e,o,l)}}}catch(l){Rt(e,e.return,l)}if(e===t){pe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pe=a;break}pe=e.return}}var FG=Math.ceil,Km=lo.ReactCurrentDispatcher,Tk=lo.ReactCurrentOwner,gs=lo.ReactCurrentBatchConfig,He=0,yn=null,Yt=null,An=0,Or=0,kc=da(0),cn=0,fh=null,dl=0,w0=0,Ak=0,Wd=null,gr=null,Dk=0,Qc=1/0,Ri=null,qm=!1,o1=null,Uo=null,Bp=!1,Po=null,Xm=0,Ud=0,a1=null,km=-1,Cm=0;function ir(){return He&6?Bt():km!==-1?km:km=Bt()}function Vo(t){return t.mode&1?He&2&&An!==0?An&-An:bG.transition!==null?(Cm===0&&(Cm=GO()),Cm):(t=rt,t!==0||(t=window.event,t=t===void 0?16:ZO(t.type)),t):1}function Vs(t,e,n,r){if(50<Ud)throw Ud=0,a1=null,Error(se(185));jh(t,n,r),(!(He&2)||t!==yn)&&(t===yn&&(!(He&2)&&(w0|=n),cn===4&&Do(t,An)),Sr(t,r),n===1&&He===0&&!(e.mode&1)&&(Qc=Bt()+500,x0&&ha()))}function Sr(t,e){var n=t.callbackNode;b6(t,e);var r=Om(t,t===yn?An:0);if(r===0)n!==null&&ON(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ON(n),e===1)t.tag===0?vG(S$.bind(null,t)):xR(S$.bind(null,t)),mG(function(){!(He&6)&&ha()}),n=null;else{switch(HO(r)){case 1:n=rk;break;case 4:n=UO;break;case 16:n=Dm;break;case 536870912:n=VO;break;default:n=Dm}n=mP(n,lP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lP(t,e){if(km=-1,Cm=0,He&6)throw Error(se(327));var n=t.callbackNode;if(Rc()&&t.callbackNode!==n)return null;var r=Om(t,t===yn?An:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ym(t,r);else{e=r;var s=He;He|=2;var i=uP();(yn!==t||An!==e)&&(Ri=null,Qc=Bt()+500,Ja(t,e));do try{zG();break}catch(a){cP(t,a)}while(!0);gk(),Km.current=i,He=s,Yt!==null?e=0:(yn=null,An=0,e=cn)}if(e!==0){if(e===2&&(s=Pb(t),s!==0&&(r=s,e=l1(t,s))),e===1)throw n=fh,Ja(t,0),Do(t,r),Sr(t,Bt()),n;if(e===6)Do(t,r);else{if(s=t.current.alternate,!(r&30)&&!LG(s)&&(e=Ym(t,r),e===2&&(i=Pb(t),i!==0&&(r=i,e=l1(t,i))),e===1))throw n=fh,Ja(t,0),Do(t,r),Sr(t,Bt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Ra(t,gr,Ri);break;case 3:if(Do(t,r),(r&130023424)===r&&(e=Dk+500-Bt(),10<e)){if(Om(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ir(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Wb(Ra.bind(null,t,gr,Ri),e);break}Ra(t,gr,Ri);break;case 4:if(Do(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Us(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FG(r/1960))-r,10<r){t.timeoutHandle=Wb(Ra.bind(null,t,gr,Ri),r);break}Ra(t,gr,Ri);break;case 5:Ra(t,gr,Ri);break;default:throw Error(se(329))}}}return Sr(t,Bt()),t.callbackNode===n?lP.bind(null,t):null}function l1(t,e){var n=Wd;return t.current.memoizedState.isDehydrated&&(Ja(t,e).flags|=256),t=Ym(t,e),t!==2&&(e=gr,gr=n,e!==null&&c1(e)),t}function c1(t){gr===null?gr=t:gr.push.apply(gr,t)}function LG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!qs(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Do(t,e){for(e&=~Ak,e&=~w0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Us(e),r=1<<n;t[n]=-1,e&=~r}}function S$(t){if(He&6)throw Error(se(327));Rc();var e=Om(t,0);if(!(e&1))return Sr(t,Bt()),null;var n=Ym(t,e);if(t.tag!==0&&n===2){var r=Pb(t);r!==0&&(e=r,n=l1(t,r))}if(n===1)throw n=fh,Ja(t,0),Do(t,e),Sr(t,Bt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ra(t,gr,Ri),Sr(t,Bt()),null}function Ok(t,e){var n=He;He|=1;try{return t(e)}finally{He=n,He===0&&(Qc=Bt()+500,x0&&ha())}}function hl(t){Po!==null&&Po.tag===0&&!(He&6)&&Rc();var e=He;He|=1;var n=gs.transition,r=rt;try{if(gs.transition=null,rt=1,t)return t()}finally{rt=r,gs.transition=n,He=e,!(He&6)&&ha()}}function Rk(){Or=kc.current,kt(kc)}function Ja(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pG(n)),Yt!==null)for(n=Yt.return;n!==null;){var r=n;switch(fk(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fm();break;case 3:Xc(),kt(kr),kt(Yn),kk();break;case 5:wk(r);break;case 4:Xc();break;case 13:kt(Tt);break;case 19:kt(Tt);break;case 10:xk(r.type._context);break;case 22:case 23:Rk()}n=n.return}if(yn=t,Yt=t=Go(t.current,null),An=Or=e,cn=0,fh=null,Ak=w0=dl=0,gr=Wd=null,Ua!==null){for(e=0;e<Ua.length;e++)if(n=Ua[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ua=null}return t}function cP(t,e){do{var n=Yt;try{if(gk(),vm.current=Hm,Gm){for(var r=At.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Gm=!1}if(ul=0,gn=on=At=null,zd=!1,uh=0,Tk.current=null,n===null||n.return===null){cn=1,fh=e,Yt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=An,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=d$(o);if(f!==null){f.flags&=-257,h$(f,o,a,i,e),f.mode&1&&u$(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){u$(i,c,e),Pk();break e}l=Error(se(426))}}else if(It&&a.mode&1){var x=d$(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),h$(x,o,a,i,e),pk(Yc(l,a));break e}}i=l=Yc(l,a),cn!==4&&(cn=2),Wd===null?Wd=[i]:Wd.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=HR(i,l,e);s$(i,g);break e;case 1:a=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Uo===null||!Uo.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=KR(i,a,e);s$(i,w);break e}}i=i.return}while(i!==null)}hP(n)}catch(k){e=k,Yt===n&&n!==null&&(Yt=n=n.return);continue}break}while(!0)}function uP(){var t=Km.current;return Km.current=Hm,t===null?Hm:t}function Pk(){(cn===0||cn===3||cn===2)&&(cn=4),yn===null||!(dl&268435455)&&!(w0&268435455)||Do(yn,An)}function Ym(t,e){var n=He;He|=2;var r=uP();(yn!==t||An!==e)&&(Ri=null,Ja(t,e));do try{jG();break}catch(s){cP(t,s)}while(!0);if(gk(),He=n,Km.current=r,Yt!==null)throw Error(se(261));return yn=null,An=0,cn}function jG(){for(;Yt!==null;)dP(Yt)}function zG(){for(;Yt!==null&&!d6();)dP(Yt)}function dP(t){var e=pP(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?hP(t):Yt=e,Tk.current=null}function hP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RG(n,e),n!==null){n.flags&=32767,Yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{cn=6,Yt=null;return}}else if(n=OG(n,e,Or),n!==null){Yt=n;return}if(e=e.sibling,e!==null){Yt=e;return}Yt=e=t}while(e!==null);cn===0&&(cn=5)}function Ra(t,e,n){var r=rt,s=gs.transition;try{gs.transition=null,rt=1,BG(t,e,n,r)}finally{gs.transition=s,rt=r}return null}function BG(t,e,n,r){do Rc();while(Po!==null);if(He&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(w6(t,i),t===yn&&(Yt=yn=null,An=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bp||(Bp=!0,mP(Dm,function(){return Rc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gs.transition,gs.transition=null;var o=rt;rt=1;var a=He;He|=4,Tk.current=null,_G(t,n),oP(n,t),aG(zb),Rm=!!jb,zb=jb=null,t.current=n,MG(n),h6(),He=a,rt=o,gs.transition=i}else t.current=n;if(Bp&&(Bp=!1,Po=t,Xm=s),i=t.pendingLanes,i===0&&(Uo=null),m6(n.stateNode),Sr(t,Bt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qm)throw qm=!1,t=o1,o1=null,t;return Xm&1&&t.tag!==0&&Rc(),i=t.pendingLanes,i&1?t===a1?Ud++:(Ud=0,a1=t):Ud=0,ha(),null}function Rc(){if(Po!==null){var t=HO(Xm),e=gs.transition,n=rt;try{if(gs.transition=null,rt=16>t?16:t,Po===null)var r=!1;else{if(t=Po,Po=null,Xm=0,He&6)throw Error(se(331));var s=He;for(He|=4,pe=t.current;pe!==null;){var i=pe,o=i.child;if(pe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pe=c;pe!==null;){var u=pe;switch(u.tag){case 0:case 11:case 15:Bd(8,u,i)}var d=u.child;if(d!==null)d.return=u,pe=d;else for(;pe!==null;){u=pe;var h=u.sibling,f=u.return;if(rP(u),u===c){pe=null;break}if(h!==null){h.return=f,pe=h;break}pe=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}pe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,pe=o;else e:for(;pe!==null;){if(i=pe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Bd(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,pe=g;break e}pe=i.return}}var y=t.current;for(pe=y;pe!==null;){o=pe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pe=b;else e:for(o=y;pe!==null;){if(a=pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:b0(9,a)}}catch(k){Rt(a,a.return,k)}if(a===o){pe=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,pe=w;break e}pe=a.return}}if(He=s,ha(),fi&&typeof fi.onPostCommitFiberRoot=="function")try{fi.onPostCommitFiberRoot(h0,t)}catch{}r=!0}return r}finally{rt=n,gs.transition=e}}return!1}function I$(t,e,n){e=Yc(n,e),e=HR(t,e,1),t=Wo(t,e,1),e=ir(),t!==null&&(jh(t,1,e),Sr(t,e))}function Rt(t,e,n){if(t.tag===3)I$(t,t,n);else for(;e!==null;){if(e.tag===3){I$(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Uo===null||!Uo.has(r))){t=Yc(n,t),t=KR(e,t,1),e=Wo(e,t,1),t=ir(),e!==null&&(jh(e,1,t),Sr(e,t));break}}e=e.return}}function WG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ir(),t.pingedLanes|=t.suspendedLanes&n,yn===t&&(An&n)===n&&(cn===4||cn===3&&(An&130023424)===An&&500>Bt()-Dk?Ja(t,0):Ak|=n),Sr(t,e)}function fP(t,e){e===0&&(t.mode&1?(e=Dp,Dp<<=1,!(Dp&130023424)&&(Dp=4194304)):e=1);var n=ir();t=Qi(t,e),t!==null&&(jh(t,e,n),Sr(t,n))}function UG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fP(t,n)}function VG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),fP(t,n)}var pP;pP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||kr.current)yr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yr=!1,DG(t,e,n);yr=!!(t.flags&131072)}else yr=!1,It&&e.flags&1048576&&yR(e,zm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wm(t,e),t=e.pendingProps;var s=Hc(e,Yn.current);Oc(e,n),s=Sk(null,e,r,t,s,n);var i=Ik();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cr(r)?(i=!0,Lm(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vk(e),s.updater=v0,e.stateNode=s,s._reactInternals=e,Xb(e,r,t,n),e=Zb(null,e,r,!0,i,n)):(e.tag=0,It&&i&&hk(e),er(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=HG(r),t=Ps(r,t),s){case 0:e=Qb(null,e,r,t,n);break e;case 1:e=m$(null,e,r,t,n);break e;case 11:e=f$(null,e,r,t,n);break e;case 14:e=p$(null,e,r,Ps(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ps(r,s),Qb(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ps(r,s),m$(t,e,r,s,n);case 3:e:{if(QR(e),t===null)throw Error(se(387));r=e.pendingProps,i=e.memoizedState,s=i.element,SR(t,e),Um(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Yc(Error(se(423)),e),e=g$(t,e,r,n,s);break e}else if(r!==s){s=Yc(Error(se(424)),e),e=g$(t,e,r,n,s);break e}else for(Lr=Bo(e.stateNode.containerInfo.firstChild),zr=e,It=!0,Ms=null,n=kR(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kc(),r===s){e=Zi(t,e,n);break e}er(t,e,r,n)}e=e.child}return e;case 5:return IR(e),t===null&&Hb(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Bb(r,s)?o=null:i!==null&&Bb(r,i)&&(e.flags|=32),YR(t,e),er(t,e,o,n),e.child;case 6:return t===null&&Hb(e),null;case 13:return ZR(t,e,n);case 4:return bk(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qc(e,null,r,n):er(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ps(r,s),f$(t,e,r,s,n);case 7:return er(t,e,e.pendingProps,n),e.child;case 8:return er(t,e,e.pendingProps.children,n),e.child;case 12:return er(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,gt(Bm,r._currentValue),r._currentValue=o,i!==null)if(qs(i.value,o)){if(i.children===s.children&&!kr.current){e=Zi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Vi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Kb(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(se(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Kb(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}er(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Oc(e,n),s=xs(s),r=r(s),e.flags|=1,er(t,e,r,n),e.child;case 14:return r=e.type,s=Ps(r,e.pendingProps),s=Ps(r.type,s),p$(t,e,r,s,n);case 15:return qR(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ps(r,s),wm(t,e),e.tag=1,Cr(r)?(t=!0,Lm(e)):t=!1,Oc(e,n),GR(e,r,s),Xb(e,r,s,n),Zb(null,e,r,!0,t,n);case 19:return JR(t,e,n);case 22:return XR(t,e,n)}throw Error(se(156,e.tag))};function mP(t,e){return WO(t,e)}function GG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(t,e,n,r){return new GG(t,e,n,r)}function _k(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HG(t){if(typeof t=="function")return _k(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ek)return 11;if(t===tk)return 14}return 2}function Go(t,e){var n=t.alternate;return n===null?(n=cs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sm(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")_k(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case hc:return el(n.children,s,i,e);case Jw:o=8,s|=8;break;case vb:return t=cs(12,n,e,s|2),t.elementType=vb,t.lanes=i,t;case bb:return t=cs(13,n,e,s),t.elementType=bb,t.lanes=i,t;case wb:return t=cs(19,n,e,s),t.elementType=wb,t.lanes=i,t;case IO:return k0(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CO:o=10;break e;case SO:o=9;break e;case ek:o=11;break e;case tk:o=14;break e;case No:o=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=cs(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function el(t,e,n,r){return t=cs(7,t,r,e),t.lanes=n,t}function k0(t,e,n,r){return t=cs(22,t,r,e),t.elementType=IO,t.lanes=n,t.stateNode={isHidden:!1},t}function Tv(t,e,n){return t=cs(6,t,null,e),t.lanes=n,t}function Av(t,e,n){return e=cs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KG(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uv(0),this.expirationTimes=uv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mk(t,e,n,r,s,i,o,a,l){return t=new KG(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vk(i),t}function qG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gP(t){if(!t)return Jo;t=t._reactInternals;e:{if(Pl(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Cr(n))return gR(t,n,e)}return e}function xP(t,e,n,r,s,i,o,a,l){return t=Mk(n,r,!0,t,s,i,o,a,l),t.context=gP(null),n=t.current,r=ir(),s=Vo(n),i=Vi(r,s),i.callback=e??null,Wo(n,i,s),t.current.lanes=s,jh(t,s,r),Sr(t,r),t}function C0(t,e,n,r){var s=e.current,i=ir(),o=Vo(s);return n=gP(n),e.context===null?e.context=n:e.pendingContext=n,e=Vi(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Wo(s,e,o),t!==null&&(Vs(t,s,o,i),ym(t,s,o)),o}function Qm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N$(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Fk(t,e){N$(t,e),(t=t.alternate)&&N$(t,e)}function XG(){return null}var yP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lk(t){this._internalRoot=t}S0.prototype.render=Lk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));C0(t,e,null,null)};S0.prototype.unmount=Lk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hl(function(){C0(null,t,null,null)}),e[Yi]=null}};function S0(t){this._internalRoot=t}S0.prototype.unstable_scheduleHydration=function(t){if(t){var e=XO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ao.length&&e!==0&&e<Ao[n].priority;n++);Ao.splice(n,0,t),n===0&&QO(t)}};function jk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $$(){}function YG(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Qm(o);i.call(c)}}var o=xP(e,r,t,0,null,!1,!1,"",$$);return t._reactRootContainer=o,t[Yi]=o.current,ih(t.nodeType===8?t.parentNode:t),hl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Qm(l);a.call(c)}}var l=Mk(t,0,!1,null,null,!1,!1,"",$$);return t._reactRootContainer=l,t[Yi]=l.current,ih(t.nodeType===8?t.parentNode:t),hl(function(){C0(e,l,n,r)}),l}function N0(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Qm(o);a.call(l)}}C0(e,o,t,s)}else o=YG(n,e,t,s,r);return Qm(o)}KO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Id(e.pendingLanes);n!==0&&(sk(e,n|1),Sr(e,Bt()),!(He&6)&&(Qc=Bt()+500,ha()))}break;case 13:hl(function(){var r=Qi(t,1);if(r!==null){var s=ir();Vs(r,t,1,s)}}),Fk(t,1)}};ik=function(t){if(t.tag===13){var e=Qi(t,134217728);if(e!==null){var n=ir();Vs(e,t,134217728,n)}Fk(t,134217728)}};qO=function(t){if(t.tag===13){var e=Vo(t),n=Qi(t,e);if(n!==null){var r=ir();Vs(n,t,e,r)}Fk(t,e)}};XO=function(){return rt};YO=function(t,e){var n=rt;try{return rt=t,e()}finally{rt=n}};Db=function(t,e,n){switch(e){case"input":if(Sb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=g0(r);if(!s)throw Error(se(90));$O(r),Sb(r,s)}}}break;case"textarea":TO(t,n);break;case"select":e=n.value,e!=null&&Ec(t,!!n.multiple,e,!1)}};MO=Ok;FO=hl;var QG={usingClientEntryPoint:!1,Events:[Bh,gc,g0,PO,_O,Ok]},ld={findFiberByHostInstance:Wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZG={bundleType:ld.bundleType,version:ld.version,rendererPackageName:ld.rendererPackageName,rendererConfig:ld.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zO(t),t===null?null:t.stateNode},findFiberByHostInstance:ld.findFiberByHostInstance||XG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{h0=Wp.inject(ZG),fi=Wp}catch{}}qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QG;qr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jk(e))throw Error(se(200));return qG(t,e,null,n)};qr.createRoot=function(t,e){if(!jk(t))throw Error(se(299));var n=!1,r="",s=yP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Mk(t,1,!1,null,null,n,!1,r,s),t[Yi]=e.current,ih(t.nodeType===8?t.parentNode:t),new Lk(e)};qr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=zO(e),t=t===null?null:t.stateNode,t};qr.flushSync=function(t){return hl(t)};qr.hydrate=function(t,e,n){if(!I0(e))throw Error(se(200));return N0(null,t,e,!0,n)};qr.hydrateRoot=function(t,e,n){if(!jk(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=yP;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=xP(e,null,t,1,n??null,s,!1,i,o),t[Yi]=e.current,ih(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new S0(e)};qr.render=function(t,e,n){if(!I0(e))throw Error(se(200));return N0(null,t,e,!1,n)};qr.unmountComponentAtNode=function(t){if(!I0(t))throw Error(se(40));return t._reactRootContainer?(hl(function(){N0(null,null,t,!1,function(){t._reactRootContainer=null,t[Yi]=null})}),!0):!1};qr.unstable_batchedUpdates=Ok;qr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!I0(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return N0(t,e,n,!1,r)};qr.version="18.3.1-next-f1338f8080-20240426";function vP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vP)}catch(t){console.error(t)}}vP(),vO.exports=qr;var JG=vO.exports,bP,E$=JG;bP=E$.createRoot,E$.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var e5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ee=(t,e)=>{const n=N.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...c},u)=>N.createElement("svg",{ref:u,...e5,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${t5(t)}`,a].join(" "),...c},[...e.map(([d,h])=>N.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=Ee("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=Ee("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=Ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=Ee("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=Ee("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=Ee("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=Ee("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=Ee("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=Ee("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=Ee("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=Ee("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=Ee("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=Ee("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=Ee("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=Ee("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=Ee("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=Ee("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=Ee("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=Ee("Laugh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=Ee("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=Ee("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=Ee("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=Ee("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=Ee("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=Ee("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=Ee("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=Ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=Ee("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=Ee("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=Ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=Ee("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C5=Ee("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=Ee("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=Ee("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T$=Ee("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=Ee("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=Ee("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=Ee("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=Ee("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=Ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=Ee("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=Ee("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A$=Ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=Ee("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=Ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=Ee("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),D5=({onComplete:t})=>{const[e,n]=N.useState(0),[r,s]=N.useState(!1),i=[{icon:Zc,text:"AI-Powered Analysis",color:"text-orange-500",emoji:""},{icon:CP,text:"Mental Health Tracking",color:"text-red-500",emoji:""},{icon:S5,text:"Secure & Private",color:"text-green-500",emoji:""}];return N.useEffect(()=>{setTimeout(()=>s(!0),500);const o=setTimeout(()=>{e<i.length-1?n(e+1):setTimeout(t,1500)},2e3);return()=>clearTimeout(o)},[e,t]),v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-red-500 to-pink-500 flex items-center justify-center relative overflow-hidden",children:[v.jsxs("div",{className:"absolute inset-0",children:[v.jsx("div",{className:"absolute top-20 left-10 w-20 h-20 bg-white bg-opacity-20 rounded-full animate-bounce"}),v.jsx("div",{className:"absolute top-40 right-20 w-16 h-16 bg-yellow-300 bg-opacity-30 rounded-full animate-pulse"}),v.jsx("div",{className:"absolute bottom-40 left-20 w-12 h-12 bg-green-300 bg-opacity-30 rounded-full animate-ping"}),v.jsx("div",{className:"absolute bottom-20 right-10 w-24 h-24 bg-orange-300 bg-opacity-20 rounded-full animate-bounce"}),v.jsx("div",{className:"absolute top-32 left-1/4 animate-spin",children:v.jsx(N5,{size:24,className:"text-yellow-300 opacity-70"})}),v.jsx("div",{className:"absolute bottom-32 right-1/4 animate-spin",style:{animationDelay:"1s"},children:v.jsx(T$,{size:20,className:"text-pink-300 opacity-70"})}),v.jsx("div",{className:"absolute top-1/2 left-16 animate-spin",style:{animationDelay:"2s"},children:v.jsx(A5,{size:28,className:"text-orange-300 opacity-70"})})]}),v.jsxs("div",{className:"text-center z-10",children:[v.jsx("div",{className:`mb-8 transition-all duration-1000 ${r?"scale-100 opacity-100":"scale-50 opacity-0"}`,children:v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"p-8 bg-white bg-opacity-20 rounded-full backdrop-blur-sm border-4 border-white border-opacity-30 shadow-2xl animate-pulse",children:v.jsx(Zc,{size:80,className:"text-white mx-auto"})}),v.jsx("div",{className:"absolute -top-4 -right-4 animate-bounce",children:v.jsx("div",{className:"text-4xl",children:""})}),v.jsx("div",{className:"absolute -bottom-2 -left-2 animate-spin",children:v.jsx(T$,{size:32,className:"text-yellow-300"})})]})}),v.jsxs("div",{className:`transition-all duration-1000 delay-500 ${r?"translate-y-0 opacity-100":"translate-y-8 opacity-0"}`,children:[v.jsxs("h1",{className:"text-6xl font-bold text-white mb-4 tracking-tight",children:["Mindfit",v.jsx("span",{className:"bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:" AI"})]}),v.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("p",{className:"text-2xl text-white text-opacity-90 font-light",children:"Your Mental Health Companion"}),v.jsx("span",{className:"text-2xl",children:""})]})]}),v.jsx("div",{className:"space-y-8 mt-12",children:i.map((o,a)=>{const l=o.icon,c=a<=e;return v.jsxs("div",{className:`flex items-center justify-center space-x-6 transition-all duration-1000 ${c?"opacity-100 translate-x-0 scale-100":"opacity-30 translate-x-8 scale-95"}`,children:[v.jsx("div",{className:`p-4 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm ${c?"animate-bounce":""}`,children:v.jsx(l,{size:32,className:"text-white"})}),v.jsx("div",{className:"text-4xl animate-bounce",style:{animationDelay:`${a*.2}s`},children:o.emoji}),v.jsx("span",{className:"text-white text-xl font-semibold",children:o.text})]},a)})}),v.jsxs("div",{className:"mt-16",children:[v.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[v.jsx("span",{className:"text-2xl animate-spin",children:""}),v.jsx("span",{className:"text-white text-lg",children:"Loading your wellness journey..."}),v.jsx("span",{className:"text-2xl animate-spin",style:{animationDelay:"0.5s"},children:""})]}),v.jsx("div",{className:"w-80 h-3 bg-white bg-opacity-20 rounded-full mx-auto overflow-hidden",children:v.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 rounded-full transition-all duration-2000 ease-out",style:{width:`${(e+1)/i.length*100}%`}})})]})]})]})},Kt={MOOD_ENTRIES:"mindfit_mood_entries",SLEEP_ENTRIES:"mindfit_sleep_entries",TASKS:"mindfit_tasks",ASSESSMENT:"mindfit_assessment",FACE_DIARY:"mindfit_face_diary",USER_PROFILE:"mindfit_user_profile",CURRENT_USER:"mindfit_current_user",ALL_USERS:"mindfit_all_users",AUTH_STATE:"mindfit_auth_state"},Ce={getMoodEntries:()=>{const t=localStorage.getItem(Kt.MOOD_ENTRIES);return t?JSON.parse(t).map(e=>({...e,timestamp:new Date(e.timestamp)})):[]},saveMoodEntry:t=>{const e=Ce.getMoodEntries();e.push(t),localStorage.setItem(Kt.MOOD_ENTRIES,JSON.stringify(e))},getSleepEntries:()=>{const t=localStorage.getItem(Kt.SLEEP_ENTRIES);return t?JSON.parse(t).map(e=>({...e,bedtime:new Date(e.bedtime),wakeTime:new Date(e.wakeTime)})):[]},saveSleepEntry:t=>{const e=Ce.getSleepEntries();e.push(t),localStorage.setItem(Kt.SLEEP_ENTRIES,JSON.stringify(e))},getTasks:()=>{const t=localStorage.getItem(Kt.TASKS);return t?JSON.parse(t).map(e=>({...e,dueDate:new Date(e.dueDate)})):[]},saveTask:t=>{const e=Ce.getTasks(),n=e.findIndex(r=>r.id===t.id);n>=0?e[n]=t:e.push(t),localStorage.setItem(Kt.TASKS,JSON.stringify(e))},getAssessment:()=>{const t=localStorage.getItem(Kt.ASSESSMENT);return t?{...JSON.parse(t),completedAt:new Date(JSON.parse(t).completedAt)}:null},saveAssessment:t=>{localStorage.setItem(Kt.ASSESSMENT,JSON.stringify(t))},getFaceDiaryEntries:()=>{const t=localStorage.getItem(Kt.FACE_DIARY);return t?JSON.parse(t).map(e=>({...e,timestamp:new Date(e.timestamp)})):[]},saveFaceDiaryEntry:t=>{const e=Ce.getFaceDiaryEntries();e.push(t),localStorage.setItem(Kt.FACE_DIARY,JSON.stringify(e))},getUserProfile:()=>{const t=localStorage.getItem(Kt.USER_PROFILE);return t?{...JSON.parse(t),registeredAt:new Date(JSON.parse(t).registeredAt)}:null},saveUserProfile:t=>{localStorage.setItem(Kt.USER_PROFILE,JSON.stringify(t))},getCurrentUser:()=>localStorage.getItem(Kt.CURRENT_USER),setCurrentUser:t=>{localStorage.setItem(Kt.CURRENT_USER,t)},getAllUsers:()=>{const t=localStorage.getItem(Kt.ALL_USERS);return t?JSON.parse(t).map(e=>({...e,registeredAt:new Date(e.registeredAt)})):[]},saveAllUsers:t=>{localStorage.setItem(Kt.ALL_USERS,JSON.stringify(t))},addUser:t=>{const e=Ce.getAllUsers();e.push(t),Ce.saveAllUsers(e)},getUserById:t=>Ce.getAllUsers().find(n=>n.id===t)||null,updateUser:t=>{const e=Ce.getAllUsers(),n=e.findIndex(r=>r.id===t.id);n>=0&&(e[n]=t,Ce.saveAllUsers(e))},getAuthState:()=>{const t=localStorage.getItem(Kt.AUTH_STATE);return t?JSON.parse(t):{isAuthenticated:!1,userType:null}},setAuthState:(t,e)=>{localStorage.setItem(Kt.AUTH_STATE,JSON.stringify({isAuthenticated:t,userType:e}))},clearAuthState:()=>{localStorage.removeItem(Kt.AUTH_STATE),localStorage.removeItem(Kt.CURRENT_USER)}},O5=({onAuthSuccess:t})=>{const[e,n]=N.useState("welcome"),[r,s]=N.useState("patient"),[i,o]=N.useState(!1),[a,l]=N.useState({name:"",email:"",password:"",age:"",doctorId:""}),[c,u]=N.useState({}),d=()=>{const f={};return a.email?/\S+@\S+\.\S+/.test(a.email)||(f.email="Email is invalid"):f.email="Email is required",a.password?a.password.length<6&&(f.password="Password must be at least 6 characters"):f.password="Password is required",e==="signup"&&(a.name||(f.name="Name is required"),r==="patient"&&a.age&&(parseInt(a.age)<13||parseInt(a.age)>120)&&(f.age="Age must be between 13 and 120")),u(f),Object.keys(f).length===0},h=f=>{if(f.preventDefault(),!d())return;const p=Ce.getAllUsers();if(e==="login"){const m=p.find(x=>x.email===a.email&&x.userType===r);m?(Ce.setCurrentUser(m.id),Ce.setAuthState(!0,r),t(r)):u({email:"Invalid credentials"})}else{if(p.find(g=>g.email===a.email)){u({email:"User already exists"});return}const x={id:crypto.randomUUID(),name:a.name,email:a.email,age:a.age?parseInt(a.age):void 0,registeredAt:new Date,userType:r,doctorId:r==="patient"&&a.doctorId?a.doctorId:void 0,patientIds:r==="doctor"?[]:void 0};Ce.addUser(x),Ce.setCurrentUser(x.id),Ce.setAuthState(!0,r),t(r)}};return e==="welcome"?v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:v.jsxs("div",{className:"max-w-md w-full",children:[v.jsxs("div",{className:"text-center mb-12",children:[v.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-3xl w-20 h-20 mx-auto mb-6 flex items-center justify-center shadow-2xl",children:v.jsx(Zc,{size:40,className:"text-white"})}),v.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:["Mindfit ",v.jsx("span",{className:"text-purple-400",children:"AI"})]}),v.jsx("p",{className:"text-gray-300",children:"Choose your account type"})]}),v.jsxs("div",{className:"space-y-4 mb-8",children:[v.jsx("button",{onClick:()=>{s("patient"),n("login")},className:"w-full p-6 bg-gradient-to-r from-blue-600 to-blue-700 rounded-2xl text-white hover:from-blue-700 hover:to-blue-800 transition-all duration-300 transform hover:scale-105 shadow-xl",children:v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-xl",children:v.jsx(fl,{size:32})}),v.jsxs("div",{className:"text-left",children:[v.jsx("h3",{className:"text-xl font-bold",children:"I'm a Patient"}),v.jsx("p",{className:"text-blue-100 text-sm",children:"Track your mental health journey"})]}),v.jsx(u1,{size:24,className:"ml-auto"})]})}),v.jsx("button",{onClick:()=>{s("doctor"),n("login")},className:"w-full p-6 bg-gradient-to-r from-emerald-600 to-emerald-700 rounded-2xl text-white hover:from-emerald-700 hover:to-emerald-800 transition-all duration-300 transform hover:scale-105 shadow-xl",children:v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-xl",children:v.jsx(f1,{size:32})}),v.jsxs("div",{className:"text-left",children:[v.jsx("h3",{className:"text-xl font-bold",children:"I'm a Doctor"}),v.jsx("p",{className:"text-emerald-100 text-sm",children:"Monitor your patients' progress"})]}),v.jsx(u1,{size:24,className:"ml-auto"})]})})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Trusted by healthcare professionals"}),v.jsxs("div",{className:"flex justify-center space-x-6 text-gray-500",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-2xl font-bold text-white",children:"24/7"}),v.jsx("div",{className:"text-xs",children:"Monitoring"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-2xl font-bold text-white",children:"AI"}),v.jsx("div",{className:"text-xs",children:"Analysis"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-2xl font-bold text-white",children:"100%"}),v.jsx("div",{className:"text-xs",children:"Secure"})]})]})]})]})}):v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:v.jsxs("div",{className:"max-w-md w-full",children:[v.jsxs("div",{className:"text-center mb-8",children:[v.jsx("button",{onClick:()=>n("welcome"),className:"mb-6 p-2 text-gray-400 hover:text-white transition-colors",children:" Back"}),v.jsx("div",{className:`p-3 rounded-2xl w-16 h-16 mx-auto mb-4 flex items-center justify-center ${r==="patient"?"bg-blue-600":"bg-emerald-600"}`,children:r==="patient"?v.jsx(fl,{size:32,className:"text-white"}):v.jsx(f1,{size:32,className:"text-white"})}),v.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:e==="login"?"Welcome Back":"Create Account"}),v.jsx("p",{className:"text-gray-300",children:r==="patient"?"Patient Portal":"Doctor Portal"})]}),v.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e==="signup"&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name"}),v.jsx("input",{type:"text",value:a.name,onChange:f=>l(p=>({...p,name:f.target.value})),className:"w-full p-4 bg-white bg-opacity-10 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your full name"}),c.name&&v.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.name})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),v.jsxs("div",{className:"relative",children:[v.jsx(x5,{size:20,className:"absolute left-4 top-4 text-gray-400"}),v.jsx("input",{type:"email",value:a.email,onChange:f=>l(p=>({...p,email:f.target.value})),className:"w-full p-4 pl-12 bg-white bg-opacity-10 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your email"})]}),c.email&&v.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.email})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),v.jsxs("div",{className:"relative",children:[v.jsx(g5,{size:20,className:"absolute left-4 top-4 text-gray-400"}),v.jsx("input",{type:i?"text":"password",value:a.password,onChange:f=>l(p=>({...p,password:f.target.value})),className:"w-full p-4 pl-12 pr-12 bg-white bg-opacity-10 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your password"}),v.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-4 top-4 text-gray-400 hover:text-white",children:i?v.jsx(c5,{size:20}):v.jsx(u5,{size:20})})]}),c.password&&v.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.password})]}),e==="signup"&&r==="patient"&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Age (Optional)"}),v.jsx("input",{type:"number",value:a.age,onChange:f=>l(p=>({...p,age:f.target.value})),className:"w-full p-4 bg-white bg-opacity-10 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your age",min:"13",max:"120"}),c.age&&v.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.age})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Doctor ID (Optional)"}),v.jsx("input",{type:"text",value:a.doctorId,onChange:f=>l(p=>({...p,doctorId:f.target.value})),className:"w-full p-4 bg-white bg-opacity-10 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your doctor's ID"}),v.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Your doctor can monitor your progress with this ID"})]})]}),v.jsx("button",{type:"submit",className:`w-full p-4 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 shadow-xl ${r==="patient"?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800":"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800"}`,children:e==="login"?"Sign In":"Create Account"}),v.jsx("div",{className:"text-center",children:v.jsx("button",{type:"button",onClick:()=>n(e==="login"?"signup":"login"),className:"text-purple-400 hover:text-purple-300 text-sm transition-colors",children:e==="login"?"Don't have an account? Sign up":"Already have an account? Sign in"})})]})]})})};function TP(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=TP(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function ot(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=TP(t))&&(r&&(r+=" "),r+=e);return r}var AP={},DP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==="__proto__"}t.isUnsafeProperty=e})(DP);var OP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=e})(OP);var RP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var r;return typeof n=="string"||typeof n=="symbol"?n:Object.is((r=n==null?void 0:n.valueOf)==null?void 0:r.call(n),-0)?"-0":String(n)}t.toKey=e})(RP);var zk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){const r=[],s=n.length;if(s===0)return r;let i=0,o="",a="",l=!1;for(n.charCodeAt(0)===46&&(r.push(""),i++);i<s;){const c=n[i];a?c==="\\"&&i+1<s?(i++,o+=n[i]):c===a?a="":o+=c:l?c==='"'||c==="'"?a=c:c==="]"?(l=!1,r.push(o),o=""):o+=c:c==="["?(l=!0,o&&(r.push(o),o="")):c==="."?o&&(r.push(o),o=""):o+=c,i++}return o&&r.push(o),r}t.toPath=e})(zk);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=DP,n=OP,r=RP,s=zk;function i(a,l,c){if(a==null)return c;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return c;const u=a[l];return u===void 0?n.isDeepKey(l)?i(a,s.toPath(l),c):c:u}case"number":case"symbol":{typeof l=="number"&&(l=r.toKey(l));const u=a[l];return u===void 0?c:u}default:{if(Array.isArray(l))return o(a,l,c);if(Object.is(l==null?void 0:l.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return c;const u=a[l];return u===void 0?c:u}}}function o(a,l,c){if(l.length===0)return c;let u=a;for(let d=0;d<l.length;d++){if(u==null||e.isUnsafeProperty(l[d]))return c;u=u[l[d]]}return u===void 0?c:u}t.get=i})(AP);var R5=AP.get;const ea=Ei(R5);var PP={exports:{}},pt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bk=Symbol.for("react.transitional.element"),Wk=Symbol.for("react.portal"),$0=Symbol.for("react.fragment"),E0=Symbol.for("react.strict_mode"),T0=Symbol.for("react.profiler"),A0=Symbol.for("react.consumer"),D0=Symbol.for("react.context"),O0=Symbol.for("react.forward_ref"),R0=Symbol.for("react.suspense"),P0=Symbol.for("react.suspense_list"),_0=Symbol.for("react.memo"),M0=Symbol.for("react.lazy"),P5=Symbol.for("react.view_transition"),_5=Symbol.for("react.client.reference");function Ss(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Bk:switch(t=t.type,t){case $0:case T0:case E0:case R0:case P0:case P5:return t;default:switch(t=t&&t.$$typeof,t){case D0:case O0:case M0:case _0:return t;case A0:return t;default:return e}}case Wk:return e}}}pt.ContextConsumer=A0;pt.ContextProvider=D0;pt.Element=Bk;pt.ForwardRef=O0;pt.Fragment=$0;pt.Lazy=M0;pt.Memo=_0;pt.Portal=Wk;pt.Profiler=T0;pt.StrictMode=E0;pt.Suspense=R0;pt.SuspenseList=P0;pt.isContextConsumer=function(t){return Ss(t)===A0};pt.isContextProvider=function(t){return Ss(t)===D0};pt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bk};pt.isForwardRef=function(t){return Ss(t)===O0};pt.isFragment=function(t){return Ss(t)===$0};pt.isLazy=function(t){return Ss(t)===M0};pt.isMemo=function(t){return Ss(t)===_0};pt.isPortal=function(t){return Ss(t)===Wk};pt.isProfiler=function(t){return Ss(t)===T0};pt.isStrictMode=function(t){return Ss(t)===E0};pt.isSuspense=function(t){return Ss(t)===R0};pt.isSuspenseList=function(t){return Ss(t)===P0};pt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===$0||t===T0||t===E0||t===R0||t===P0||typeof t=="object"&&t!==null&&(t.$$typeof===M0||t.$$typeof===_0||t.$$typeof===D0||t.$$typeof===A0||t.$$typeof===O0||t.$$typeof===_5||t.getModuleId!==void 0)};pt.typeOf=Ss;PP.exports=pt;var M5=PP.exports,Tn=t=>t===0?0:t>0?1:-1,Vr=t=>typeof t=="number"&&t!=+t,Ga=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Ne=t=>(typeof t=="number"||t instanceof Number)&&!Vr(t),Jc=t=>Ne(t)||typeof t=="string",F5=0,ta=t=>{var e=++F5;return"".concat(t||"").concat(e)},or=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ne(e)&&typeof e!="string")return r;var i;if(Ga(e)){if(n==null)return r;var o=e.indexOf("%");i=n*parseFloat(e.slice(0,o))/100}else i=+e;return Vr(i)&&(i=r),s&&n!=null&&i>n&&(i=n),i},_P=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,n={},r=0;r<e;r++)if(!n[t[r]])n[t[r]]=!0;else return!0;return!1},Pr=(t,e)=>Ne(t)&&Ne(e)?n=>t+n*(e-t):()=>e;function ec(t,e,n){return Ne(t)&&Ne(e)?t+n*(e-t):e}function MP(t,e,n){if(!(!t||!t.length))return t.find(r=>r&&(typeof e=="function"?e(r):ea(r,e))===n)}var lt=t=>t===null||typeof t>"u",Uh=t=>lt(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),L5=["viewBox","children"],j5=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],D$=["points","pathLength"],Dv={svg:L5,polygon:D$,polyline:D$},Uk=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Vk=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(N.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var r={};return Object.keys(n).forEach(s=>{Uk.includes(s)&&(r[s]=i=>n[s](n,i))}),r},z5=(t,e,n)=>r=>(t(e,n,r),null),F0=(t,e,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var r=null;return Object.keys(t).forEach(s=>{var i=t[s];Uk.includes(s)&&typeof i=="function"&&(r||(r={}),r[s]=z5(i,e,n))}),r},O$=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",R$=null,Ov=null,FP=t=>{if(t===R$&&Array.isArray(Ov))return Ov;var e=[];return N.Children.forEach(t,n=>{lt(n)||(M5.isFragment(n)?e=e.concat(FP(n.props.children)):e.push(n))}),Ov=e,R$=t,e};function Vh(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(s=>O$(s)):r=[O$(e)],FP(t).forEach(s=>{var i=ea(s,"type.displayName")||ea(s,"type.name");r.indexOf(i)!==-1&&n.push(s)}),n}var L0=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,B5=(t,e,n,r)=>{var s,i=(s=r&&(Dv==null?void 0:Dv[r]))!==null&&s!==void 0?s:[];return e.startsWith("data-")||typeof t!="function"&&(r&&i.includes(e)||j5.includes(e))||n&&Uk.includes(e)},je=(t,e,n)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(N.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(i=>{var o;B5((o=r)===null||o===void 0?void 0:o[i],i,e,n)&&(s[i]=r[i])}),s},W5=["children","width","height","viewBox","className","style","title","desc"];function p1(){return p1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},p1.apply(null,arguments)}function U5(t,e){if(t==null)return{};var n,r,s=V5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function V5(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var LP=N.forwardRef((t,e)=>{var{children:n,width:r,height:s,viewBox:i,className:o,style:a,title:l,desc:c}=t,u=U5(t,W5),d=i||{width:r,height:s,x:0,y:0},h=ot("recharts-surface",o);return N.createElement("svg",p1({},je(u,!0,"svg"),{className:h,width:r,height:s,style:a,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:e}),N.createElement("title",null,l),N.createElement("desc",null,c),n)}),G5=["children","className"];function m1(){return m1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m1.apply(null,arguments)}function H5(t,e){if(t==null)return{};var n,r,s=K5(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function K5(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var Ot=N.forwardRef((t,e)=>{var{children:n,className:r}=t,s=H5(t,G5),i=ot("recharts-layer",r);return N.createElement("g",m1({className:i},je(s,!0),{ref:e}),n)}),q5=N.createContext(null);function mt(t){return function(){return t}}const jP=Math.cos,Zm=Math.sin,Js=Math.sqrt,Jm=Math.PI,j0=2*Jm,g1=Math.PI,x1=2*g1,Pa=1e-6,X5=x1-Pa;function zP(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Y5(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return zP;const n=10**e;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class Q5{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?zP:Y5(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,s){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(e,n,r,s,i,o){this._append`C${+e},${+n},${+r},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(e,n,r,s,i){if(e=+e,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,l=r-e,c=s-n,u=o-e,d=a-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>Pa)if(!(Math.abs(d*l-c*u)>Pa)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let f=r-o,p=s-a,m=l*l+c*c,x=f*f+p*p,g=Math.sqrt(m),y=Math.sqrt(h),b=i*Math.tan((g1-Math.acos((m+h-x)/(2*g*y)))/2),w=b/y,k=b/g;Math.abs(w-1)>Pa&&this._append`L${e+w*u},${n+w*d}`,this._append`A${i},${i},0,0,${+(d*f>u*p)},${this._x1=e+k*l},${this._y1=n+k*c}`}}arc(e,n,r,s,i,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(s),l=r*Math.sin(s),c=e+a,u=n+l,d=1^o,h=o?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Pa||Math.abs(this._y1-u)>Pa)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%x1+x1),h>X5?this._append`A${r},${r},0,1,${d},${e-a},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Pa&&this._append`A${r},${r},0,${+(h>=g1)},${d},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function Gk(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Q5(e)}function Hk(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function BP(t){this._context=t}BP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function z0(t){return new BP(t)}function WP(t){return t[0]}function UP(t){return t[1]}function VP(t,e){var n=mt(!0),r=null,s=z0,i=null,o=Gk(a);t=typeof t=="function"?t:t===void 0?WP:mt(t),e=typeof e=="function"?e:e===void 0?UP:mt(e);function a(l){var c,u=(l=Hk(l)).length,d,h=!1,f;for(r==null&&(i=s(f=o())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+t(d,c,l),+e(d,c,l));if(f)return i=null,f+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:mt(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:mt(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:mt(!!l),a):n},a.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),a):s},a.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),a):r},a}function Up(t,e,n){var r=null,s=mt(!0),i=null,o=z0,a=null,l=Gk(c);t=typeof t=="function"?t:t===void 0?WP:mt(+t),e=typeof e=="function"?e:mt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?UP:mt(+n);function c(d){var h,f,p,m=(d=Hk(d)).length,x,g=!1,y,b=new Array(m),w=new Array(m);for(i==null&&(a=o(y=l())),h=0;h<=m;++h){if(!(h<m&&s(x=d[h],h,d))===g)if(g=!g)f=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=h-1;p>=f;--p)a.point(b[p],w[p]);a.lineEnd(),a.areaEnd()}g&&(b[h]=+t(x,h,d),w[h]=+e(x,h,d),a.point(r?+r(x,h,d):b[h],n?+n(x,h,d):w[h]))}if(y)return a=null,y+""||null}function u(){return VP().defined(s).curve(o).context(i)}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:mt(+d),r=null,c):t},c.x0=function(d){return arguments.length?(t=typeof d=="function"?d:mt(+d),c):t},c.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:mt(+d),c):r},c.y=function(d){return arguments.length?(e=typeof d=="function"?d:mt(+d),n=null,c):e},c.y0=function(d){return arguments.length?(e=typeof d=="function"?d:mt(+d),c):e},c.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:mt(+d),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(r).y(e)},c.defined=function(d){return arguments.length?(s=typeof d=="function"?d:mt(!!d),c):s},c.curve=function(d){return arguments.length?(o=d,i!=null&&(a=o(i)),c):o},c.context=function(d){return arguments.length?(d==null?i=a=null:a=o(i=d),c):i},c}class GP{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function Z5(t){return new GP(t,!0)}function J5(t){return new GP(t,!1)}const Kk={draw(t,e){const n=Js(e/Jm);t.moveTo(n,0),t.arc(0,0,n,0,j0)}},eH={draw(t,e){const n=Js(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},HP=Js(1/3),tH=HP*2,nH={draw(t,e){const n=Js(e/tH),r=n*HP;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},rH={draw(t,e){const n=Js(e),r=-n/2;t.rect(r,r,n,n)}},sH=.8908130915292852,KP=Zm(Jm/10)/Zm(7*Jm/10),iH=Zm(j0/10)*KP,oH=-jP(j0/10)*KP,aH={draw(t,e){const n=Js(e*sH),r=iH*n,s=oH*n;t.moveTo(0,-n),t.lineTo(r,s);for(let i=1;i<5;++i){const o=j0*i/5,a=jP(o),l=Zm(o);t.lineTo(l*n,-a*n),t.lineTo(a*r-l*s,l*r+a*s)}t.closePath()}},Rv=Js(3),lH={draw(t,e){const n=-Js(e/(Rv*3));t.moveTo(0,n*2),t.lineTo(-Rv*n,-n),t.lineTo(Rv*n,-n),t.closePath()}},Jr=-.5,es=Js(3)/2,y1=1/Js(12),cH=(y1/2+1)*3,uH={draw(t,e){const n=Js(e/cH),r=n/2,s=n*y1,i=r,o=n*y1+n,a=-i,l=o;t.moveTo(r,s),t.lineTo(i,o),t.lineTo(a,l),t.lineTo(Jr*r-es*s,es*r+Jr*s),t.lineTo(Jr*i-es*o,es*i+Jr*o),t.lineTo(Jr*a-es*l,es*a+Jr*l),t.lineTo(Jr*r+es*s,Jr*s-es*r),t.lineTo(Jr*i+es*o,Jr*o-es*i),t.lineTo(Jr*a+es*l,Jr*l-es*a),t.closePath()}};function dH(t,e){let n=null,r=Gk(s);t=typeof t=="function"?t:mt(t||Kk),e=typeof e=="function"?e:mt(e===void 0?64:+e);function s(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return s.type=function(i){return arguments.length?(t=typeof i=="function"?i:mt(i),s):t},s.size=function(i){return arguments.length?(e=typeof i=="function"?i:mt(+i),s):e},s.context=function(i){return arguments.length?(n=i??null,s):n},s}function eg(){}function tg(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function qP(t){this._context=t}qP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tg(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function hH(t){return new qP(t)}function XP(t){this._context=t}XP.prototype={areaStart:eg,areaEnd:eg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:tg(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function fH(t){return new XP(t)}function YP(t){this._context=t}YP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:tg(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function pH(t){return new YP(t)}function QP(t){this._context=t}QP.prototype={areaStart:eg,areaEnd:eg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function mH(t){return new QP(t)}function P$(t){return t<0?-1:1}function _$(t,e,n){var r=t._x1-t._x0,s=e-t._x1,i=(t._y1-t._y0)/(r||s<0&&-0),o=(n-t._y1)/(s||r<0&&-0),a=(i*s+o*r)/(r+s);return(P$(i)+P$(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(a))||0}function M$(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Pv(t,e,n){var r=t._x0,s=t._y0,i=t._x1,o=t._y1,a=(i-r)/3;t._context.bezierCurveTo(r+a,s+a*e,i-a,o-a*n,i,o)}function ng(t){this._context=t}ng.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Pv(this,this._t0,M$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Pv(this,M$(this,n=_$(this,t,e)),n);break;default:Pv(this,this._t0,n=_$(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function ZP(t){this._context=new JP(t)}(ZP.prototype=Object.create(ng.prototype)).point=function(t,e){ng.prototype.point.call(this,e,t)};function JP(t){this._context=t}JP.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,s,i){this._context.bezierCurveTo(e,t,r,n,i,s)}};function gH(t){return new ng(t)}function xH(t){return new ZP(t)}function e_(t){this._context=t}e_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=F$(t),s=F$(e),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function F$(t){var e,n=t.length-1,r,s=new Array(n),i=new Array(n),o=new Array(n);for(s[0]=0,i[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)s[e]=1,i[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[n-1]=2,i[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=s[e]/i[e-1],i[e]-=r,o[e]-=r*o[e-1];for(s[n-1]=o[n-1]/i[n-1],e=n-2;e>=0;--e)s[e]=(o[e]-s[e+1])/i[e];for(i[n-1]=(t[n]+s[n-1])/2,e=0;e<n-1;++e)i[e]=2*t[e+1]-s[e+1];return[s,i]}function yH(t){return new e_(t)}function B0(t,e){this._context=t,this._t=e}B0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function vH(t){return new B0(t,.5)}function bH(t){return new B0(t,0)}function wH(t){return new B0(t,1)}function eu(t,e){if((o=t.length)>1)for(var n=1,r,s,i=t[e[0]],o,a=i.length;n<o;++n)for(s=i,i=t[e[n]],r=0;r<a;++r)i[r][1]+=i[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function v1(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function kH(t,e){return t[e]}function CH(t){const e=[];return e.key=t,e}function SH(){var t=mt([]),e=v1,n=eu,r=kH;function s(i){var o=Array.from(t.apply(this,arguments),CH),a,l=o.length,c=-1,u;for(const d of i)for(a=0,++c;a<l;++a)(o[a][c]=[0,+r(d,o[a].key,c,i)]).data=d;for(a=0,u=Hk(e(o));a<l;++a)o[u[a]].index=a;return n(o,u),o}return s.keys=function(i){return arguments.length?(t=typeof i=="function"?i:mt(Array.from(i)),s):t},s.value=function(i){return arguments.length?(r=typeof i=="function"?i:mt(+i),s):r},s.order=function(i){return arguments.length?(e=i==null?v1:typeof i=="function"?i:mt(Array.from(i)),s):e},s.offset=function(i){return arguments.length?(n=i??eu,s):n},s}function IH(t,e){if((r=t.length)>0){for(var n,r,s=0,i=t[0].length,o;s<i;++s){for(o=n=0;n<r;++n)o+=t[n][s][1]||0;if(o)for(n=0;n<r;++n)t[n][s][1]/=o}eu(t,e)}}function NH(t,e){if((s=t.length)>0){for(var n=0,r=t[e[0]],s,i=r.length;n<i;++n){for(var o=0,a=0;o<s;++o)a+=t[o][n][1]||0;r[n][1]+=r[n][0]=-a/2}eu(t,e)}}function $H(t,e){if(!(!((o=t.length)>0)||!((i=(s=t[e[0]]).length)>0))){for(var n=0,r=1,s,i,o;r<i;++r){for(var a=0,l=0,c=0;a<o;++a){for(var u=t[e[a]],d=u[r][1]||0,h=u[r-1][1]||0,f=(d-h)/2,p=0;p<a;++p){var m=t[e[p]],x=m[r][1]||0,g=m[r-1][1]||0;f+=x-g}l+=d,c+=f*d}s[r-1][1]+=s[r-1][0]=n,l&&(n-=c/l)}s[r-1][1]+=s[r-1][0]=n,eu(t,e)}}var EH=["type","size","sizeType"];function b1(){return b1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b1.apply(null,arguments)}function L$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function j$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?L$(Object(n),!0).forEach(function(r){TH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function TH(t,e,n){return(e=AH(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AH(t){var e=DH(t,"string");return typeof e=="symbol"?e:e+""}function DH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OH(t,e){if(t==null)return{};var n,r,s=RH(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function RH(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var t_={symbolCircle:Kk,symbolCross:eH,symbolDiamond:nH,symbolSquare:rH,symbolStar:aH,symbolTriangle:lH,symbolWye:uH},PH=Math.PI/180,_H=t=>{var e="symbol".concat(Uh(t));return t_[e]||Kk},MH=(t,e,n)=>{if(e==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var r=18*PH;return 1.25*t*t*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},FH=(t,e)=>{t_["symbol".concat(Uh(t))]=e},n_=t=>{var{type:e="circle",size:n=64,sizeType:r="area"}=t,s=OH(t,EH),i=j$(j$({},s),{},{type:e,size:n,sizeType:r}),o=()=>{var d=_H(e),h=dH().type(d).size(MH(n,r,e));return h()},{className:a,cx:l,cy:c}=i,u=je(i,!0);return l===+l&&c===+c&&n===+n?N.createElement("path",b1({},u,{className:ot("recharts-symbols",a),transform:"translate(".concat(l,", ").concat(c,")"),d:o()})):null};n_.registerSymbol=FH;var qk={},r_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=e})(r_);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=r_;function n(r){return r!=null&&typeof r!="function"&&e.isLength(r.length)}t.isArrayLike=n})(qk);var s_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=e})(s_);var Xk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r){return n===r||Number.isNaN(n)&&Number.isNaN(r)}t.eq=e})(Xk);var i_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Object.getOwnPropertySymbols(n).filter(r=>Object.prototype.propertyIsEnumerable.call(n,r))}t.getSymbols=e})(i_);var o_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=e})(o_);var a_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",n="[object String]",r="[object Number]",s="[object Boolean]",i="[object Arguments]",o="[object Symbol]",a="[object Date]",l="[object Map]",c="[object Set]",u="[object Array]",d="[object Function]",h="[object ArrayBuffer]",f="[object Object]",p="[object Error]",m="[object DataView]",x="[object Uint8Array]",g="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",k="[object Int8Array]",C="[object Int16Array]",S="[object Int32Array]",I="[object BigInt64Array]",$="[object Float32Array]",E="[object Float64Array]";t.argumentsTag=i,t.arrayBufferTag=h,t.arrayTag=u,t.bigInt64ArrayTag=I,t.bigUint64ArrayTag=w,t.booleanTag=s,t.dataViewTag=m,t.dateTag=a,t.errorTag=p,t.float32ArrayTag=$,t.float64ArrayTag=E,t.functionTag=d,t.int16ArrayTag=C,t.int32ArrayTag=S,t.int8ArrayTag=k,t.mapTag=l,t.numberTag=r,t.objectTag=f,t.regexpTag=e,t.setTag=c,t.stringTag=n,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=g})(a_);var l_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function n(r,s=Number.MAX_SAFE_INTEGER){switch(typeof r){case"number":return Number.isInteger(r)&&r>=0&&r<s;case"symbol":return!1;case"string":return e.test(r)}}t.isIndex=n})(l_);var c_={exports:{}},u_={},d_={exports:{}},h_={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tu=N;function LH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var jH=typeof Object.is=="function"?Object.is:LH,zH=tu.useState,BH=tu.useEffect,WH=tu.useLayoutEffect,UH=tu.useDebugValue;function VH(t,e){var n=e(),r=zH({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return WH(function(){s.value=n,s.getSnapshot=e,_v(s)&&i({inst:s})},[t,n,e]),BH(function(){return _v(s)&&i({inst:s}),t(function(){_v(s)&&i({inst:s})})},[t]),UH(n),n}function _v(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!jH(t,n)}catch{return!0}}function GH(t,e){return e()}var HH=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?GH:VH;h_.useSyncExternalStore=tu.useSyncExternalStore!==void 0?tu.useSyncExternalStore:HH;d_.exports=h_;var KH=d_.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W0=N,qH=KH;function XH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var YH=typeof Object.is=="function"?Object.is:XH,QH=qH.useSyncExternalStore,ZH=W0.useRef,JH=W0.useEffect,e8=W0.useMemo,t8=W0.useDebugValue;u_.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=ZH(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=e8(function(){function l(f){if(!c){if(c=!0,u=f,f=r(f),s!==void 0&&o.hasValue){var p=o.value;if(s(p,f))return d=p}return d=f}if(p=d,YH(u,f))return p;var m=r(f);return s!==void 0&&s(p,m)?(u=f,p):(u=f,d=m)}var c=!1,u,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,r,s]);var a=QH(t,i[0],i[1]);return JH(function(){o.hasValue=!0,o.value=a},[a]),t8(a),a};c_.exports=u_;var n8=c_.exports,Yk=N.createContext(null),r8=t=>t,Vt=()=>{var t=N.useContext(Yk);return t?t.store.dispatch:r8},Im=()=>{},s8=()=>Im,i8=(t,e)=>t===e;function Te(t){var e=N.useContext(Yk);return n8.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:s8,e?e.store.getState:Im,e?e.store.getState:Im,e?t:Im,i8)}function o8(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function a8(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function l8(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${n}]`)}}var z$=t=>Array.isArray(t)?t:[t];function c8(t){const e=Array.isArray(t[0])?t[0]:t;return l8(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function u8(t,e){const n=[],{length:r}=t;for(let s=0;s<r;s++)n.push(t[s].apply(null,e));return n}var d8=class{constructor(t){this.value=t}deref(){return this.value}},h8=typeof WeakRef<"u"?WeakRef:d8,f8=0,B$=1;function Vp(){return{s:f8,v:void 0,o:null,p:null}}function f_(t,e={}){let n=Vp();const{resultEqualityCheck:r}=e;let s,i=0;function o(){var d;let a=n;const{length:l}=arguments;for(let h=0,f=l;h<f;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let m=a.o;m===null&&(a.o=m=new WeakMap);const x=m.get(p);x===void 0?(a=Vp(),m.set(p,a)):a=x}else{let m=a.p;m===null&&(a.p=m=new Map);const x=m.get(p);x===void 0?(a=Vp(),m.set(p,a)):a=x}}const c=a;let u;if(a.s===B$)u=a.v;else if(u=t.apply(null,arguments),i++,r){const h=((d=s==null?void 0:s.deref)==null?void 0:d.call(s))??s;h!=null&&r(h,u)&&(u=h,i!==0&&i--),s=typeof u=="object"&&u!==null||typeof u=="function"?new h8(u):u}return c.s=B$,c.v=u,u}return o.clearCache=()=>{n=Vp(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function p8(t,...e){const n=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,r=(...s)=>{let i=0,o=0,a,l={},c=s.pop();typeof c=="object"&&(l=c,c=s.pop()),o8(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...n,...l},{memoize:d,memoizeOptions:h=[],argsMemoize:f=f_,argsMemoizeOptions:p=[],devModeChecks:m={}}=u,x=z$(h),g=z$(p),y=c8(s),b=d(function(){return i++,c.apply(null,arguments)},...x),w=f(function(){o++;const C=u8(y,arguments);return a=b.apply(null,C),a},...g);return Object.assign(w,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:f})};return Object.assign(r,{withTypes:()=>r}),r}var X=p8(f_),m8=Object.assign((t,e=X)=>{a8(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),r=n.map(i=>t[i]);return e(r,(...i)=>i.reduce((o,a,l)=>(o[n[l]]=a,o),{}))},{withTypes:()=>m8}),p_={},m_={},g_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"?1:r===null?2:r===void 0?3:r!==r?4:0}const n=(r,s,i)=>{if(r!==s){const o=e(r),a=e(s);if(o===a&&o===0){if(r<s)return i==="desc"?1:-1;if(r>s)return i==="desc"?-1:1}return i==="desc"?a-o:o-a}return 0};t.compareValues=n})(g_);var x_={},Qk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=e})(Qk);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qk,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function s(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||e.isSymbol(i)?!0:typeof i=="string"&&(r.test(i)||!n.test(i))||o!=null&&Object.hasOwn(o,i)}t.isKey=s})(x_);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=g_,n=x_,r=zk;function s(i,o,a,l){if(i==null)return[];a=l?void 0:a,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(a)||(a=a==null?[]:[a]),a=a.map(f=>String(f));const c=(f,p)=>{let m=f;for(let x=0;x<p.length&&m!=null;++x)m=m[p[x]];return m},u=(f,p)=>p==null||f==null?p:typeof f=="object"&&"key"in f?Object.hasOwn(p,f.key)?p[f.key]:c(p,f.path):typeof f=="function"?f(p):Array.isArray(f)?c(p,f):typeof p=="object"?p[f]:p,d=o.map(f=>(Array.isArray(f)&&f.length===1&&(f=f[0]),f==null||typeof f=="function"||Array.isArray(f)||n.isKey(f)?f:{key:f,path:r.toPath(f)}));return i.map(f=>({original:f,criteria:d.map(p=>u(p,f))})).slice().sort((f,p)=>{for(let m=0;m<d.length;m++){const x=e.compareValues(f.criteria[m],p.criteria[m],a[m]);if(x!==0)return x}return 0}).map(f=>f.original)}t.orderBy=s})(m_);var y_={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r=1){const s=[],i=Math.floor(r),o=(a,l)=>{for(let c=0;c<a.length;c++){const u=a[c];Array.isArray(u)&&l<i?o(u,l+1):s.push(u)}};return o(n,0),s}t.flatten=e})(y_);var Zk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=l_,n=qk,r=s_,s=Xk;function i(o,a,l){return r.isObject(l)&&(typeof a=="number"&&n.isArrayLike(l)&&e.isIndex(a)&&a<l.length||typeof a=="string"&&a in l)?s.eq(l[a],o):!1}t.isIterateeCall=i})(Zk);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=m_,n=y_,r=Zk;function s(i,...o){const a=o.length;return a>1&&r.isIterateeCall(i,o[0],o[1])?o=[]:a>2&&r.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(i,n.flatten(o),["asc"])}t.sortBy=s})(p_);var g8=p_.sortBy;const Jk=Ei(g8);var v_=t=>t.legend.settings,x8=t=>t.legend.size,y8=t=>t.legend.payload;X([y8,v_],(t,e)=>{var{itemSorter:n}=e,r=t.flat(1);return n?Jk(r,n):r});function Nn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var v8=typeof Symbol=="function"&&Symbol.observable||"@@observable",W$=v8,Mv=()=>Math.random().toString(36).substring(7).split("").join("."),b8={INIT:`@@redux/INIT${Mv()}`,REPLACE:`@@redux/REPLACE${Mv()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Mv()}`},rg=b8;function eC(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function b_(t,e,n){if(typeof t!="function")throw new Error(Nn(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Nn(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Nn(1));return n(b_)(t,e)}let r=t,s=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((x,g)=>{o.set(g,x)}))}function u(){if(l)throw new Error(Nn(3));return s}function d(x){if(typeof x!="function")throw new Error(Nn(4));if(l)throw new Error(Nn(5));let g=!0;c();const y=a++;return o.set(y,x),function(){if(g){if(l)throw new Error(Nn(6));g=!1,c(),o.delete(y),i=null}}}function h(x){if(!eC(x))throw new Error(Nn(7));if(typeof x.type>"u")throw new Error(Nn(8));if(typeof x.type!="string")throw new Error(Nn(17));if(l)throw new Error(Nn(9));try{l=!0,s=r(s,x)}finally{l=!1}return(i=o).forEach(y=>{y()}),x}function f(x){if(typeof x!="function")throw new Error(Nn(10));r=x,h({type:rg.REPLACE})}function p(){const x=d;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(Nn(11));function y(){const w=g;w.next&&w.next(u())}return y(),{unsubscribe:x(y)}},[W$](){return this}}}return h({type:rg.INIT}),{dispatch:h,subscribe:d,getState:u,replaceReducer:f,[W$]:p}}function w8(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:rg.INIT})>"u")throw new Error(Nn(12));if(typeof n(void 0,{type:rg.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Nn(13))})}function w_(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{w8(n)}catch(i){s=i}return function(o={},a){if(s)throw s;let l=!1;const c={};for(let u=0;u<r.length;u++){const d=r[u],h=n[d],f=o[d],p=h(f,a);if(typeof p>"u")throw a&&a.type,new Error(Nn(14));c[d]=p,l=l||p!==f}return l=l||r.length!==Object.keys(o).length,l?c:o}}function sg(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function k8(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Nn(15))};const o={getState:s.getState,dispatch:(l,...c)=>i(l,...c)},a=t.map(l=>l(o));return i=sg(...a)(s.dispatch),{...s,dispatch:i}}}function k_(t){return eC(t)&&"type"in t&&typeof t.type=="string"}var C_=Symbol.for("immer-nothing"),U$=Symbol.for("immer-draftable"),Gr=Symbol.for("immer-state");function zs(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var nu=Object.getPrototypeOf;function pl(t){return!!t&&!!t[Gr]}function Ji(t){var e;return t?S_(t)||Array.isArray(t)||!!t[U$]||!!((e=t.constructor)!=null&&e[U$])||V0(t)||G0(t):!1}var C8=Object.prototype.constructor.toString();function S_(t){if(!t||typeof t!="object")return!1;const e=nu(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===C8}function ig(t,e){U0(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function U0(t){const e=t[Gr];return e?e.type_:Array.isArray(t)?1:V0(t)?2:G0(t)?3:0}function w1(t,e){return U0(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function I_(t,e,n){const r=U0(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function S8(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function V0(t){return t instanceof Map}function G0(t){return t instanceof Set}function _a(t){return t.copy_||t.base_}function k1(t,e){if(V0(t))return new Map(t);if(G0(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=S_(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Gr];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(nu(t),r)}else{const r=nu(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function tC(t,e=!1){return H0(t)||pl(t)||!Ji(t)||(U0(t)>1&&(t.set=t.add=t.clear=t.delete=I8),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>tC(r,!0))),t}function I8(){zs(2)}function H0(t){return Object.isFrozen(t)}var N8={};function ml(t){const e=N8[t];return e||zs(0,t),e}var ph;function N_(){return ph}function $8(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function V$(t,e){e&&(ml("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function C1(t){S1(t),t.drafts_.forEach(E8),t.drafts_=null}function S1(t){t===ph&&(ph=t.parent_)}function G$(t){return ph=$8(ph,t)}function E8(t){const e=t[Gr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function H$(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Gr].modified_&&(C1(e),zs(4)),Ji(t)&&(t=og(e,t),e.parent_||ag(e,t)),e.patches_&&ml("Patches").generateReplacementPatches_(n[Gr].base_,t,e.patches_,e.inversePatches_)):t=og(e,n,[]),C1(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==C_?t:void 0}function og(t,e,n){if(H0(e))return e;const r=e[Gr];if(!r)return ig(e,(s,i)=>K$(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return ag(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),ig(i,(a,l)=>K$(t,r,s,a,l,n,o)),ag(t,s,!1),n&&t.patches_&&ml("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function K$(t,e,n,r,s,i,o){if(pl(s)){const a=i&&e&&e.type_!==3&&!w1(e.assigned_,r)?i.concat(r):void 0,l=og(t,s,a);if(I_(n,r,l),pl(l))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(Ji(s)&&!H0(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;og(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&ag(t,s)}}function ag(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&tC(e,n)}function T8(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:N_(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=nC;n&&(s=[r],i=mh);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return r.draft_=a,r.revoke_=o,a}var nC={get(t,e){if(e===Gr)return t;const n=_a(t);if(!w1(n,e))return A8(t,n,e);const r=n[e];return t.finalized_||!Ji(r)?r:r===Fv(t.base_,e)?(Lv(t),t.copy_[e]=N1(r,t)):r},has(t,e){return e in _a(t)},ownKeys(t){return Reflect.ownKeys(_a(t))},set(t,e,n){const r=$_(_a(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=Fv(_a(t),e),i=s==null?void 0:s[Gr];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(S8(n,s)&&(n!==void 0||w1(t.base_,e)))return!0;Lv(t),I1(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Fv(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Lv(t),I1(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=_a(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){zs(11)},getPrototypeOf(t){return nu(t.base_)},setPrototypeOf(){zs(12)}},mh={};ig(nC,(t,e)=>{mh[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});mh.deleteProperty=function(t,e){return mh.set.call(this,t,e,void 0)};mh.set=function(t,e,n){return nC.set.call(this,t[0],e,n,t[0])};function Fv(t,e){const n=t[Gr];return(n?_a(n):t)[e]}function A8(t,e,n){var s;const r=$_(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function $_(t,e){if(!(e in t))return;let n=nu(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=nu(n)}}function I1(t){t.modified_||(t.modified_=!0,t.parent_&&I1(t.parent_))}function Lv(t){t.copy_||(t.copy_=k1(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var D8=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(l=i,...c){return o.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&zs(6),r!==void 0&&typeof r!="function"&&zs(7);let s;if(Ji(e)){const i=G$(this),o=N1(e,void 0);let a=!0;try{s=n(o),a=!1}finally{a?C1(i):S1(i)}return V$(i,r),H$(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===C_&&(s=void 0),this.autoFreeze_&&tC(s,!0),r){const i=[],o=[];ml("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else zs(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,s;return[this.produce(e,n,(o,a)=>{r=o,s=a}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Ji(t)||zs(8),pl(t)&&(t=Gi(t));const e=G$(this),n=N1(t,void 0);return n[Gr].isManual_=!0,S1(e),n}finishDraft(t,e){const n=t&&t[Gr];(!n||!n.isManual_)&&zs(9);const{scope_:r}=n;return V$(r,e),H$(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=ml("Patches").applyPatches_;return pl(t)?r(t,e):this.produce(t,s=>r(s,e))}};function N1(t,e){const n=V0(t)?ml("MapSet").proxyMap_(t,e):G0(t)?ml("MapSet").proxySet_(t,e):T8(t,e);return(e?e.scope_:N_()).drafts_.push(n),n}function Gi(t){return pl(t)||zs(10,t),E_(t)}function E_(t){if(!Ji(t)||H0(t))return t;const e=t[Gr];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=k1(t,e.scope_.immer_.useStrictShallowCopy_)}else n=k1(t,!0);return ig(n,(r,s)=>{I_(n,r,E_(s))}),e&&(e.finalized_=!1),n}var Hr=new D8,T_=Hr.produce;Hr.produceWithPatches.bind(Hr);Hr.setAutoFreeze.bind(Hr);Hr.setUseStrictShallowCopy.bind(Hr);Hr.applyPatches.bind(Hr);Hr.createDraft.bind(Hr);Hr.finishDraft.bind(Hr);function A_(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var O8=A_(),R8=A_,P8=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?sg:sg.apply(null,arguments)};function vs(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Br(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>k_(r)&&r.type===t,n}var D_=class $d extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,$d.prototype)}static get[Symbol.species](){return $d}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new $d(...e[0].concat(this)):new $d(...e.concat(this))}};function q$(t){return Ji(t)?T_(t,()=>{}):t}function Gp(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function _8(t){return typeof t=="boolean"}var M8=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new D_;return n&&(_8(n)?o.push(O8):o.push(R8(n.extraArgument))),o},F8="RTK_autoBatch",X$=t=>e=>{setTimeout(e,t)},L8=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:X$(10):t.type==="callback"?t.queueNotification:X$(t.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},r,{subscribe(u){const d=()=>s&&u(),h=r.subscribe(d);return a.add(u),()=>{h(),a.delete(u)}},dispatch(u){var d;try{return s=!((d=u==null?void 0:u.meta)!=null&&d[F8]),i=!s,i&&(o||(o=!0,l(c))),r.dispatch(u)}finally{s=!0}}})},j8=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new D_(t);return r&&s.push(L8(typeof r=="object"?r:void 0)),s};function z8(t){const e=M8(),{reducer:n=void 0,middleware:r,devTools:s=!0,duplicateMiddlewareCheck:i=!0,preloadedState:o=void 0,enhancers:a=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(eC(n))l=w_(n);else throw new Error(Br(1));let c;typeof r=="function"?c=r(e):c=e();let u=sg;s&&(u=P8({trace:!1,...typeof s=="object"&&s}));const d=k8(...c),h=j8(d);let f=typeof a=="function"?a(h):h();const p=u(...f);return b_(l,o,p)}function O_(t){const e={},n=[];let r;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(Br(28));if(a in e)throw new Error(Br(29));return e[a]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function B8(t){return typeof t=="function"}function W8(t,e){let[n,r,s]=O_(e),i;if(B8(t))i=()=>q$(t());else{const a=q$(t);i=()=>a}function o(a=i(),l){let c=[n[l.type],...r.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[s]),c.reduce((u,d)=>{if(d)if(pl(u)){const f=d(u,l);return f===void 0?u:f}else{if(Ji(u))return T_(u,h=>d(h,l));{const h=d(u,l);if(h===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return u},a)}return o.getInitialState=i,o}var U8="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",V8=(t=21)=>{let e="",n=t;for(;n--;)e+=U8[Math.random()*64|0];return e},G8=Symbol.for("rtk-slice-createasyncthunk");function H8(t,e){return`${t}/${e}`}function K8({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[G8];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Br(11));typeof process<"u";const a=(typeof s.reducers=="function"?s.reducers(X8()):s.reducers)||{},l=Object.keys(a),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(w,k){const C=typeof w=="string"?w:w.type;if(!C)throw new Error(Br(12));if(C in c.sliceCaseReducersByType)throw new Error(Br(13));return c.sliceCaseReducersByType[C]=k,u},addMatcher(w,k){return c.sliceMatchers.push({matcher:w,reducer:k}),u},exposeAction(w,k){return c.actionCreators[w]=k,u},exposeCaseReducer(w,k){return c.sliceCaseReducersByName[w]=k,u}};l.forEach(w=>{const k=a[w],C={reducerName:w,type:H8(i,w),createNotation:typeof s.reducers=="function"};Q8(k)?J8(C,k,u,e):Y8(C,k,u)});function d(){const[w={},k=[],C=void 0]=typeof s.extraReducers=="function"?O_(s.extraReducers):[s.extraReducers],S={...w,...c.sliceCaseReducersByType};return W8(s.initialState,I=>{for(let $ in S)I.addCase($,S[$]);for(let $ of c.sliceMatchers)I.addMatcher($.matcher,$.reducer);for(let $ of k)I.addMatcher($.matcher,$.reducer);C&&I.addDefaultCase(C)})}const h=w=>w,f=new Map,p=new WeakMap;let m;function x(w,k){return m||(m=d()),m(w,k)}function g(){return m||(m=d()),m.getInitialState()}function y(w,k=!1){function C(I){let $=I[w];return typeof $>"u"&&k&&($=Gp(p,C,g)),$}function S(I=h){const $=Gp(f,k,()=>new WeakMap);return Gp($,I,()=>{const E={};for(const[A,D]of Object.entries(s.selectors??{}))E[A]=q8(D,I,()=>Gp(p,I,g),k);return E})}return{reducerPath:w,getSelectors:S,get selectors(){return S(C)},selectSlice:C}}const b={name:i,reducer:x,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...y(o),injectInto(w,{reducerPath:k,...C}={}){const S=k??o;return w.inject({reducerPath:S,reducer:x},C),{...b,...y(S,!0)}}};return b}}function q8(t,e,n,r){function s(i,...o){let a=e(i);return typeof a>"u"&&r&&(a=n()),t(a,...o)}return s.unwrapped=t,s}var Is=K8();function X8(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function Y8({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!Z8(r))throw new Error(Br(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?vs(t,o):vs(t))}function Q8(t){return t._reducerDefinitionType==="asyncThunk"}function Z8(t){return t._reducerDefinitionType==="reducerWithPrepare"}function J8({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Br(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=n,d=s(t,i,u);r.exposeAction(e,d),o&&r.addCase(d.fulfilled,o),a&&r.addCase(d.pending,a),l&&r.addCase(d.rejected,l),c&&r.addMatcher(d.settled,c),r.exposeCaseReducer(e,{fulfilled:o||Hp,pending:a||Hp,rejected:l||Hp,settled:c||Hp})}function Hp(){}var eK="task",R_="listener",P_="completed",rC="cancelled",tK=`task-${rC}`,nK=`task-${P_}`,$1=`${R_}-${rC}`,rK=`${R_}-${P_}`,K0=class{constructor(t){ed(this,"name","TaskAbortError");ed(this,"message");this.code=t,this.message=`${eK} ${rC} (reason: ${t})`}},sC=(t,e)=>{if(typeof t!="function")throw new TypeError(Br(32))},lg=()=>{},__=(t,e=lg)=>(t.catch(e),t),M_=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),tl=(t,e)=>{const n=t.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},nl=t=>{if(t.aborted){const{reason:e}=t;throw new K0(e)}};function F_(t,e){let n=lg;return new Promise((r,s)=>{const i=()=>s(new K0(t.reason));if(t.aborted){i();return}n=M_(t,i),e.finally(()=>n()).then(r,s)}).finally(()=>{n=lg})}var sK=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof K0?"cancelled":"rejected",error:n}}finally{e==null||e()}},cg=t=>e=>__(F_(t,e).then(n=>(nl(t),n))),L_=t=>{const e=cg(t);return n=>e(new Promise(r=>setTimeout(r,n)))},{assign:Pc}=Object,Y$={},q0="listenerMiddleware",iK=(t,e)=>{const n=r=>M_(t,()=>tl(r,t.reason));return(r,s)=>{sC(r);const i=new AbortController;n(i);const o=sK(async()=>{nl(t),nl(i.signal);const a=await r({pause:cg(i.signal),delay:L_(i.signal),signal:i.signal});return nl(i.signal),a},()=>tl(i,nK));return s!=null&&s.autoJoin&&e.push(o.catch(lg)),{result:cg(t)(o),cancel(){tl(i,tK)}}}},oK=(t,e)=>{const n=async(r,s)=>{nl(e);let i=()=>{};const a=[new Promise((l,c)=>{let u=t({predicate:r,effect:(d,h)=>{h.unsubscribe(),l([d,h.getState(),h.getOriginalState()])}});i=()=>{u(),c()}})];s!=null&&a.push(new Promise(l=>setTimeout(l,s,null)));try{const l=await F_(e,Promise.race(a));return nl(e),l}finally{i()}};return(r,s)=>__(n(r,s))},j_=t=>{let{type:e,actionCreator:n,matcher:r,predicate:s,effect:i}=t;if(e)s=vs(e).match;else if(n)e=n.type,s=n.match;else if(r)s=r;else if(!s)throw new Error(Br(21));return sC(i),{predicate:s,type:e,effect:i}},z_=Pc(t=>{const{type:e,predicate:n,effect:r}=j_(t);return{id:V8(),effect:r,type:e,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Br(22))}}},{withTypes:()=>z_}),Q$=(t,e)=>{const{type:n,effect:r,predicate:s}=j_(e);return Array.from(t.values()).find(i=>(typeof n=="string"?i.type===n:i.predicate===s)&&i.effect===r)},E1=t=>{t.pending.forEach(e=>{tl(e,$1)})},aK=t=>()=>{t.forEach(E1),t.clear()},Z$=(t,e,n)=>{try{t(e,n)}catch(r){setTimeout(()=>{throw r},0)}},B_=Pc(vs(`${q0}/add`),{withTypes:()=>B_}),lK=vs(`${q0}/removeAll`),W_=Pc(vs(`${q0}/remove`),{withTypes:()=>W_}),cK=(...t)=>{console.error(`${q0}/error`,...t)},Gh=(t={})=>{const e=new Map,{extra:n,onError:r=cK}=t;sC(r);const s=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),d=>{u.unsubscribe(),d!=null&&d.cancelActive&&E1(u)}),i=u=>{const d=Q$(e,u)??z_(u);return s(d)};Pc(i,{withTypes:()=>i});const o=u=>{const d=Q$(e,u);return d&&(d.unsubscribe(),u.cancelActive&&E1(d)),!!d};Pc(o,{withTypes:()=>o});const a=async(u,d,h,f)=>{const p=new AbortController,m=oK(i,p.signal),x=[];try{u.pending.add(p),await Promise.resolve(u.effect(d,Pc({},h,{getOriginalState:f,condition:(g,y)=>m(g,y).then(Boolean),take:m,delay:L_(p.signal),pause:cg(p.signal),extra:n,signal:p.signal,fork:iK(p.signal,x),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((g,y,b)=>{g!==p&&(tl(g,$1),b.delete(g))})},cancel:()=>{tl(p,$1),u.pending.delete(p)},throwIfCancelled:()=>{nl(p.signal)}})))}catch(g){g instanceof K0||Z$(r,g,{raisedBy:"effect"})}finally{await Promise.all(x),tl(p,rK),u.pending.delete(p)}},l=aK(e);return{middleware:u=>d=>h=>{if(!k_(h))return d(h);if(B_.match(h))return i(h.payload);if(lK.match(h)){l();return}if(W_.match(h))return o(h.payload);let f=u.getState();const p=()=>{if(f===Y$)throw new Error(Br(23));return f};let m;try{if(m=d(h),e.size>0){const x=u.getState(),g=Array.from(e.values());for(const y of g){let b=!1;try{b=y.predicate(h,x,f)}catch(w){b=!1,Z$(r,w,{raisedBy:"predicate"})}b&&a(y,h,u,p)}}}finally{f=Y$}return m},startListening:i,stopListening:o,clearListeners:l}};function Br(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var uK={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},U_=Is({name:"chartLayout",initialState:uK,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:dK,setLayout:hK,setChartSize:fK,setScale:pK}=U_.actions,mK=U_.reducer;function J$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function eE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?J$(Object(n),!0).forEach(function(r){gK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function gK(t,e,n){return(e=xK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xK(t){var e=yK(t,"string");return typeof e=="symbol"?e:e+""}function yK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ug=Math.PI/180,vK=t=>t*180/Math.PI,qn=(t,e,n,r)=>({x:t+Math.cos(-ug*r)*n,y:e+Math.sin(-ug*r)*n}),V_=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},bK=(t,e)=>{var{x:n,y:r}=t,{x:s,y:i}=e;return Math.sqrt((n-s)**2+(r-i)**2)},wK=(t,e)=>{var{x:n,y:r}=t,{cx:s,cy:i}=e,o=bK({x:n,y:r},{x:s,y:i});if(o<=0)return{radius:o,angle:0};var a=(n-s)/o,l=Math.acos(a);return r>i&&(l=2*Math.PI-l),{radius:o,angle:vK(l),angleInRadian:l}},kK=t=>{var{startAngle:e,endAngle:n}=t,r=Math.floor(e/360),s=Math.floor(n/360),i=Math.min(r,s);return{startAngle:e-i*360,endAngle:n-i*360}},CK=(t,e)=>{var{startAngle:n,endAngle:r}=e,s=Math.floor(n/360),i=Math.floor(r/360),o=Math.min(s,i);return t+o*360},SK=(t,e)=>{var{x:n,y:r}=t,{radius:s,angle:i}=wK({x:n,y:r},e),{innerRadius:o,outerRadius:a}=e;if(s<o||s>a||s===0)return null;var{startAngle:l,endAngle:c}=kK(e),u=i,d;if(l<=c){for(;u>c;)u-=360;for(;u<l;)u+=360;d=u>=l&&u<=c}else{for(;u>l;)u-=360;for(;u<c;)u+=360;d=u>=c&&u<=l}return d?eE(eE({},e),{},{radius:s,angle:CK(u,e)}):null};function tE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function as(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tE(Object(n),!0).forEach(function(r){IK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function IK(t,e,n){return(e=NK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NK(t){var e=$K(t,"string");return typeof e=="symbol"?e:e+""}function $K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dt(t,e,n){return lt(t)||lt(e)?n:Jc(e)?ea(t,e,n):typeof e=="function"?e(t):n}var EK=(t,e,n,r,s)=>{var i,o=-1,a=(i=e==null?void 0:e.length)!==null&&i!==void 0?i:0;if(a<=1||t==null)return 0;if(r==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var l=0;l<a;l++){var c=l>0?n[l-1].coordinate:n[a-1].coordinate,u=n[l].coordinate,d=l>=a-1?n[0].coordinate:n[l+1].coordinate,h=void 0;if(Tn(u-c)!==Tn(d-u)){var f=[];if(Tn(d-u)===Tn(s[1]-s[0])){h=d;var p=u+s[1]-s[0];f[0]=Math.min(p,(p+c)/2),f[1]=Math.max(p,(p+c)/2)}else{h=c;var m=d+s[1]-s[0];f[0]=Math.min(u,(m+u)/2),f[1]=Math.max(u,(m+u)/2)}var x=[Math.min(u,(h+u)/2),Math.max(u,(h+u)/2)];if(t>x[0]&&t<=x[1]||t>=f[0]&&t<=f[1]){({index:o}=n[l]);break}}else{var g=Math.min(c,d),y=Math.max(c,d);if(t>(g+u)/2&&t<=(y+u)/2){({index:o}=n[l]);break}}}else if(e){for(var b=0;b<a;b++)if(b===0&&t<=(e[b].coordinate+e[b+1].coordinate)/2||b>0&&b<a-1&&t>(e[b].coordinate+e[b-1].coordinate)/2&&t<=(e[b].coordinate+e[b+1].coordinate)/2||b===a-1&&t>(e[b].coordinate+e[b-1].coordinate)/2){({index:o}=e[b]);break}}return o},TK=(t,e,n)=>{if(e&&n){var{width:r,height:s}=n,{align:i,verticalAlign:o,layout:a}=e;if((a==="vertical"||a==="horizontal"&&o==="middle")&&i!=="center"&&Ne(t[i]))return as(as({},t),{},{[i]:t[i]+(r||0)});if((a==="horizontal"||a==="vertical"&&i==="center")&&o!=="middle"&&Ne(t[o]))return as(as({},t),{},{[o]:t[o]+(s||0)})}return t},Ti=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",nE=1e-4,AK=t=>{var e=t.domain();if(!(!e||e.length<=2)){var n=e.length,r=t.range(),s=Math.min(r[0],r[1])-nE,i=Math.max(r[0],r[1])+nE,o=t(e[0]),a=t(e[n-1]);(o<s||o>i||a<s||a>i)&&t.domain([e[0],e[n-1]])}},DK=(t,e)=>{if(!e||e.length!==2||!Ne(e[0])||!Ne(e[1]))return t;var n=Math.min(e[0],e[1]),r=Math.max(e[0],e[1]),s=[t[0],t[1]];return(!Ne(t[0])||t[0]<n)&&(s[0]=n),(!Ne(t[1])||t[1]>r)&&(s[1]=r),s[0]>r&&(s[0]=r),s[1]<n&&(s[1]=n),s},OK=t=>{var e=t.length;if(!(e<=0))for(var n=0,r=t[0].length;n<r;++n)for(var s=0,i=0,o=0;o<e;++o){var a=Vr(t[o][n][1])?t[o][n][0]:t[o][n][1];a>=0?(t[o][n][0]=s,t[o][n][1]=s+a,s=t[o][n][1]):(t[o][n][0]=i,t[o][n][1]=i+a,i=t[o][n][1])}},RK=t=>{var e=t.length;if(!(e<=0))for(var n=0,r=t[0].length;n<r;++n)for(var s=0,i=0;i<e;++i){var o=Vr(t[i][n][1])?t[i][n][0]:t[i][n][1];o>=0?(t[i][n][0]=s,t[i][n][1]=s+o,s=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},PK={sign:OK,expand:IH,none:eu,silhouette:NH,wiggle:$H,positive:RK},_K=(t,e,n)=>{var r=PK[n],s=SH().keys(e).value((i,o)=>+dt(i,o,0)).order(v1).offset(r);return s(t)};function iC(t){return t==null?void 0:String(t)}function dg(t){var{axis:e,ticks:n,bandSize:r,entry:s,index:i,dataKey:o}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!lt(s[e.dataKey])){var a=MP(n,"value",s[e.dataKey]);if(a)return a.coordinate+r/2}return n[i]?n[i].coordinate+r/2:null}var l=dt(s,lt(o)?e.dataKey:o);return lt(l)?null:e.scale(l)}var rE=t=>{var{axis:e,ticks:n,offset:r,bandSize:s,entry:i,index:o}=t;if(e.type==="category")return n[o]?n[o].coordinate+r:null;var a=dt(i,e.dataKey,e.scale.domain()[o]);return lt(a)?null:e.scale(a)-s/2+r},MK=t=>{var{numericAxis:e}=t,n=e.scale.domain();if(e.type==="number"){var r=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return r<=0&&s>=0?0:s<0?s:r}return n[0]},FK=t=>{var e=t.flat(2).filter(Ne);return[Math.min(...e),Math.max(...e)]},LK=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],jK=(t,e,n)=>{if(t!=null)return LK(Object.keys(t).reduce((r,s)=>{var i=t[s],{stackedData:o}=i,a=o.reduce((l,c)=>{var u=FK(c.slice(e,n+1));return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);return[Math.min(a[0],r[0]),Math.max(a[1],r[1])]},[1/0,-1/0]))},sE=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iE=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ru=(t,e,n)=>{if(t&&t.scale&&t.scale.bandwidth){var r=t.scale.bandwidth();if(!n||r>0)return r}if(t&&e&&e.length>=2){for(var s=Jk(e,u=>u.coordinate),i=1/0,o=1,a=s.length;o<a;o++){var l=s[o],c=s[o-1];i=Math.min((l.coordinate||0)-(c.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function oE(t){var{tooltipEntrySettings:e,dataKey:n,payload:r,value:s,name:i}=t;return as(as({},e),{},{dataKey:n,payload:r,value:s,name:i})}function fa(t,e){if(t)return String(t);if(typeof e=="string")return e}function zK(t,e,n,r,s){if(n==="horizontal"||n==="vertical"){var i=t>=s.left&&t<=s.left+s.width&&e>=s.top&&e<=s.top+s.height;return i?{x:t,y:e}:null}return r?SK({x:t,y:e},r):null}var BK=(t,e,n,r)=>{var s=e.find(c=>c&&c.index===n);if(s){if(t==="horizontal")return{x:s.coordinate,y:r.y};if(t==="vertical")return{x:r.x,y:s.coordinate};if(t==="centric"){var i=s.coordinate,{radius:o}=r;return as(as(as({},r),qn(r.cx,r.cy,o,i)),{},{angle:i,radius:o})}var a=s.coordinate,{angle:l}=r;return as(as(as({},r),qn(r.cx,r.cy,a,l)),{},{angle:l,radius:a})}return{x:0,y:0}},WK=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,co=t=>t.layout.width,uo=t=>t.layout.height,UK=t=>t.layout.scale,G_=t=>t.layout.margin,oC=X(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),aC=X(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),H_="data-recharts-item-index",K_="data-recharts-item-data-key",X0=60;function aE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Co(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aE(Object(n),!0).forEach(function(r){VK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function VK(t,e,n){return(e=GK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=HK(t,"string");return typeof e=="symbol"?e:e+""}function HK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KK=t=>t.brush.height,bn=X([co,uo,G_,KK,oC,aC,v_,x8],(t,e,n,r,s,i,o,a)=>{var l=i.reduce((p,m)=>{var{orientation:x}=m;if(!m.mirror&&!m.hide){var g=typeof m.width=="number"?m.width:X0;return Co(Co({},p),{},{[x]:p[x]+g})}return p},{left:n.left||0,right:n.right||0}),c=s.reduce((p,m)=>{var{orientation:x}=m;return!m.mirror&&!m.hide?Co(Co({},p),{},{[x]:ea(p,"".concat(x))+m.height}):p},{top:n.top||0,bottom:n.bottom||0}),u=Co(Co({},c),l),d=u.bottom;u.bottom+=r,u=TK(u,o,a);var h=t-u.left-u.right,f=e-u.top-u.bottom;return Co(Co({brushBottom:d},u),{},{width:Math.max(h,0),height:Math.max(f,0)})}),qK=X(bn,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),q_=X(co,uo,(t,e)=>({x:0,y:0,width:t,height:e})),XK=N.createContext(null),hr=()=>N.useContext(XK)!=null,Y0=t=>t.brush,Q0=X([Y0,bn,G_],(t,e,n)=>({height:t.height,x:Ne(t.x)?t.x:e.left,y:Ne(t.y)?t.y:e.top+e.height+e.brushBottom-((n==null?void 0:n.bottom)||0),width:Ne(t.width)?t.width:e.width})),X_=()=>{var t,e=hr(),n=Te(qK),r=Te(Q0),s=(t=Te(Y0))===null||t===void 0?void 0:t.padding;return!e||!r||!s?n:{width:r.width-s.left-s.right,height:r.height-s.top-s.bottom,x:s.left,y:s.top}},YK=()=>Te(co),QK=()=>Te(uo),Ge=t=>t.layout.layoutType,Z0=()=>Te(Ge),ZK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Y_=Is({name:"legend",initialState:ZK,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var n=Gi(t).payload.indexOf(e.payload);n>-1&&t.payload.splice(n,1)}}}),{setLegendSize:sOe,setLegendSettings:iOe,addLegendPayload:Q_,removeLegendPayload:Z_}=Y_.actions,JK=Y_.reducer,e7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),_l={isSsr:e7()},t7=()=>Te(t=>t.rootProps.accessibilityLayer);function On(t){return Number.isFinite(t)}function su(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function T1(){return T1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},T1.apply(null,arguments)}function lE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function cE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lE(Object(n),!0).forEach(function(r){n7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function n7(t,e,n){return(e=r7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r7(t){var e=s7(t,"string");return typeof e=="symbol"?e:e+""}function s7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uE={curveBasisClosed:fH,curveBasisOpen:pH,curveBasis:hH,curveBumpX:Z5,curveBumpY:J5,curveLinearClosed:mH,curveLinear:z0,curveMonotoneX:gH,curveMonotoneY:xH,curveNatural:yH,curveStep:vH,curveStepAfter:wH,curveStepBefore:bH},Kp=t=>On(t.x)&&On(t.y),cd=t=>t.x,ud=t=>t.y,i7=(t,e)=>{if(typeof t=="function")return t;var n="curve".concat(Uh(t));return(n==="curveMonotone"||n==="curveBump")&&e?uE["".concat(n).concat(e==="vertical"?"Y":"X")]:uE[n]||z0},o7=t=>{var{type:e="linear",points:n=[],baseLine:r,layout:s,connectNulls:i=!1}=t,o=i7(e,s),a=i?n.filter(Kp):n,l;if(Array.isArray(r)){var c=i?r.filter(d=>Kp(d)):r,u=a.map((d,h)=>cE(cE({},d),{},{base:c[h]}));return s==="vertical"?l=Up().y(ud).x1(cd).x0(d=>d.base.x):l=Up().x(cd).y1(ud).y0(d=>d.base.y),l.defined(Kp).curve(o),l(u)}return s==="vertical"&&Ne(r)?l=Up().y(ud).x1(cd).x0(r):Ne(r)?l=Up().x(cd).y1(ud).y0(r):l=VP().x(cd).y(ud),l.defined(Kp).curve(o),l(a)},Gd=t=>{var{className:e,points:n,path:r,pathRef:s}=t;if((!n||!n.length)&&!r)return null;var i=n&&n.length?o7(t):r;return N.createElement("path",T1({},je(t,!1),Vk(t),{className:ot("recharts-curve",e),d:i===null?void 0:i,ref:s}))};function dE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function a7(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dE(Object(n),!0).forEach(function(r){l7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function l7(t,e,n){return(e=c7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c7(t){var e=u7(t,"string");return typeof e=="symbol"?e:e+""}function u7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ei(t,e){var n=a7({},t),r=e,s=Object.keys(e),i=s.reduce((o,a)=>(o[a]===void 0&&r[a]!==void 0&&(o[a]=r[a]),o),n);return i}var J_={},eM={},tM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){if(!n||typeof n!="object")return!1;const r=Object.getPrototypeOf(n);return r===null||r===Object.prototype||Object.getPrototypeOf(r)===null?Object.prototype.toString.call(n)==="[object Object]":!1}t.isPlainObject=e})(tM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tM,n=i_,r=o_,s=a_,i=Xk;function o(c,u,d){return a(c,u,void 0,void 0,void 0,void 0,d)}function a(c,u,d,h,f,p,m){const x=m(c,u,d,h,f,p);if(x!==void 0)return x;if(typeof c==typeof u)switch(typeof c){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return c===u;case"number":return c===u||Object.is(c,u);case"function":return c===u;case"object":return l(c,u,p,m)}return l(c,u,p,m)}function l(c,u,d,h){if(Object.is(c,u))return!0;let f=r.getTag(c),p=r.getTag(u);if(f===s.argumentsTag&&(f=s.objectTag),p===s.argumentsTag&&(p=s.objectTag),f!==p)return!1;switch(f){case s.stringTag:return c.toString()===u.toString();case s.numberTag:{const g=c.valueOf(),y=u.valueOf();return i.eq(g,y)}case s.booleanTag:case s.dateTag:case s.symbolTag:return Object.is(c.valueOf(),u.valueOf());case s.regexpTag:return c.source===u.source&&c.flags===u.flags;case s.functionTag:return c===u}d=d??new Map;const m=d.get(c),x=d.get(u);if(m!=null&&x!=null)return m===u;d.set(c,u),d.set(u,c);try{switch(f){case s.mapTag:{if(c.size!==u.size)return!1;for(const[g,y]of c.entries())if(!u.has(g)||!a(y,u.get(g),g,c,u,d,h))return!1;return!0}case s.setTag:{if(c.size!==u.size)return!1;const g=Array.from(c.values()),y=Array.from(u.values());for(let b=0;b<g.length;b++){const w=g[b],k=y.findIndex(C=>a(w,C,void 0,c,u,d,h));if(k===-1)return!1;y.splice(k,1)}return!0}case s.arrayTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:case s.bigUint64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.bigInt64ArrayTag:case s.float32ArrayTag:case s.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(c)!==Buffer.isBuffer(u)||c.length!==u.length)return!1;for(let g=0;g<c.length;g++)if(!a(c[g],u[g],g,c,u,d,h))return!1;return!0}case s.arrayBufferTag:return c.byteLength!==u.byteLength?!1:l(new Uint8Array(c),new Uint8Array(u),d,h);case s.dataViewTag:return c.byteLength!==u.byteLength||c.byteOffset!==u.byteOffset?!1:l(new Uint8Array(c),new Uint8Array(u),d,h);case s.errorTag:return c.name===u.name&&c.message===u.message;case s.objectTag:{if(!(l(c.constructor,u.constructor,d,h)||e.isPlainObject(c)&&e.isPlainObject(u)))return!1;const y=[...Object.keys(c),...n.getSymbols(c)],b=[...Object.keys(u),...n.getSymbols(u)];if(y.length!==b.length)return!1;for(let w=0;w<y.length;w++){const k=y[w],C=c[k];if(!Object.hasOwn(u,k))return!1;const S=u[k];if(!a(C,S,k,c,u,d,h))return!1}return!0}default:return!1}}finally{d.delete(c),d.delete(u)}}t.isEqualWith=o})(eM);var nM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(nM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM,n=nM;function r(s,i){return e.isEqualWith(s,i,n.noop)}t.isEqual=r})(J_);var d7=J_.isEqual;const h7=Ei(d7);function f7(t){var e={},n=()=>null,r=!1,s=null,i=o=>{if(!r){if(Array.isArray(o)){if(!o.length)return;var a=o,[l,...c]=a;if(typeof l=="number"){s=t.setTimeout(i.bind(null,c),l);return}i(l),s=t.setTimeout(i.bind(null,c));return}typeof o=="object"&&(e=o,n(e)),typeof o=="function"&&o()}};return{stop:()=>{r=!0},start:o=>{r=!1,s&&(s(),s=null),i(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>t}}var hg=1e-4,rM=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],sM=(t,e)=>t.map((n,r)=>n*e**r).reduce((n,r)=>n+r),hE=(t,e)=>n=>{var r=rM(t,e);return sM(r,n)},p7=(t,e)=>n=>{var r=rM(t,e),s=[...r.map((i,o)=>i*o).slice(1),0];return sM(s,n)},fE=function(){for(var e,n,r,s,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];if(o.length===1)switch(o[0]){case"linear":[e,r,n,s]=[0,0,1,1];break;case"ease":[e,r,n,s]=[.25,.1,.25,1];break;case"ease-in":[e,r,n,s]=[.42,0,1,1];break;case"ease-out":[e,r,n,s]=[.42,0,.58,1];break;case"ease-in-out":[e,r,n,s]=[0,0,.58,1];break;default:{var l=o[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,r,n,s]=l[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else o.length===4&&([e,r,n,s]=o);var c=hE(e,n),u=hE(r,s),d=p7(e,n),h=p=>p>1?1:p<0?0:p,f=p=>{for(var m=p>1?1:p,x=m,g=0;g<8;++g){var y=c(x)-m,b=d(x);if(Math.abs(y-m)<hg||b<hg)return u(x);x=h(x-y/b)}return u(x)};return f.isStepper=!1,f},m7=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:r=8,dt:s=17}=e,i=(o,a,l)=>{var c=-(o-a)*n,u=l*r,d=l+(c-u)*s/1e3,h=l*s/1e3+o;return Math.abs(h-a)<hg&&Math.abs(d)<hg?[a,0]:[h,d]};return i.isStepper=!0,i.dt=s,i},g7=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return fE(t);case"spring":return m7();default:if(t.split("(")[0]==="cubic-bezier")return fE(t)}return typeof t=="function"?t:null};function pE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function mE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pE(Object(n),!0).forEach(function(r){x7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function x7(t,e,n){return(e=y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var b7=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),w7=(t,e,n)=>t.map(r=>"".concat(b7(r)," ").concat(e,"ms ").concat(n)).join(","),k7=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((n,r)=>n.filter(s=>r.includes(s))),gh=(t,e)=>Object.keys(e).reduce((n,r)=>mE(mE({},n),{},{[r]:t(r,e[r])}),{});function gE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function En(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gE(Object(n),!0).forEach(function(r){C7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function C7(t,e,n){return(e=S7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S7(t){var e=I7(t,"string");return typeof e=="symbol"?e:e+""}function I7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fg=(t,e,n)=>t+(e-t)*n,A1=t=>{var{from:e,to:n}=t;return e!==n},iM=(t,e,n)=>{var r=gh((s,i)=>{if(A1(i)){var[o,a]=t(i.from,i.to,i.velocity);return En(En({},i),{},{from:o,velocity:a})}return i},e);return n<1?gh((s,i)=>A1(i)?En(En({},i),{},{velocity:fg(i.velocity,r[s].velocity,n),from:fg(i.from,r[s].from,n)}):i,e):iM(t,r,n-1)};function N7(t,e,n,r,s,i){var o,a=r.reduce((h,f)=>En(En({},h),{},{[f]:{from:t[f],velocity:0,to:e[f]}}),{}),l=()=>gh((h,f)=>f.from,a),c=()=>!Object.values(a).filter(A1).length,u=null,d=h=>{o||(o=h);var f=h-o,p=f/n.dt;a=iM(n,a,p),s(En(En(En({},t),e),l())),o=h,c()||(u=i.setTimeout(d))};return()=>(u=i.setTimeout(d),()=>{u()})}function $7(t,e,n,r,s,i,o){var a=null,l=s.reduce((d,h)=>En(En({},d),{},{[h]:[t[h],e[h]]}),{}),c,u=d=>{c||(c=d);var h=(d-c)/r,f=gh((m,x)=>fg(...x,n(h)),l);if(i(En(En(En({},t),e),f)),h<1)a=o.setTimeout(u);else{var p=gh((m,x)=>fg(...x,n(1)),l);i(En(En(En({},t),e),p))}};return()=>(a=o.setTimeout(u),()=>{a()})}const E7=(t,e,n,r,s,i)=>{var o=k7(t,e);return n.isStepper===!0?N7(t,e,n,o,s,i):$7(t,e,n,r,o,s,i)};class T7{setTimeout(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=performance.now(),s=null,i=o=>{o-r>=n?e(o):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(i))};return s=requestAnimationFrame(i),()=>{cancelAnimationFrame(s)}}}var A7=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function D1(){return D1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D1.apply(null,arguments)}function D7(t,e){if(t==null)return{};var n,r,s=O7(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function O7(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function xE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function So(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xE(Object(n),!0).forEach(function(r){Ha(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ha(t,e,n){return(e=R7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R7(t){var e=P7(t,"string");return typeof e=="symbol"?e:e+""}function P7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _7(){return f7(new T7)}class lC extends N.PureComponent{constructor(e,n){super(e,n),Ha(this,"mounted",!1),Ha(this,"manager",null),Ha(this,"stopJSAnimation",null),Ha(this,"unSubscribe",null);var{isActive:r,attributeName:s,from:i,to:o,children:a,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!r||l<=0){this.state={style:{}},typeof a=="function"&&(this.state={style:o});return}if(i){if(typeof a=="function"){this.state={style:i};return}this.state={style:s?{[s]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:n}=this.props;this.mounted=!0,!(!e||!n)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:n,canBegin:r,attributeName:s,shouldReAnimate:i,to:o,from:a}=this.props,{style:l}=this.state;if(r){if(!n){var c={style:s?{[s]:o}:o};this.state&&l&&(s&&l[s]!==o||!s&&l!==o)&&this.setState(c);return}if(!(h7(e.to,o)&&e.canBegin&&e.isActive)){var u=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var d=u||i?a:e.to;if(this.state&&l){var h={style:s?{[s]:d}:d};(s&&l[s]!==d||!s&&l!==d)&&this.setState(h)}this.runAnimation(So(So({},this.props),{},{from:d,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:n,to:r,duration:s,easing:i,begin:o,onAnimationEnd:a,onAnimationStart:l}=e,c=E7(n,r,g7(i),s,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=c()};this.manager.start([l,o,u,s,a])}runAnimation(e){var{begin:n,duration:r,attributeName:s,to:i,easing:o,onAnimationStart:a,onAnimationEnd:l,children:c}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof o=="function"||typeof c=="function"||o==="spring"){this.runJSAnimation(e);return}var u=s?{[s]:i}:i,d=w7(Object.keys(u),r,o);this.manager.start([a,n,So(So({},u),{},{transition:d}),r,l])}render(){var e=this.props,{children:n,begin:r,duration:s,attributeName:i,easing:o,isActive:a,from:l,to:c,canBegin:u,onAnimationEnd:d,shouldReAnimate:h,onAnimationReStart:f,animationManager:p}=e,m=D7(e,A7),x=N.Children.count(n),g=this.state.style;if(typeof n=="function")return n(g);if(!a||x===0||s<=0)return n;var y=b=>{var{style:w={},className:k}=b.props,C=N.cloneElement(b,So(So({},m),{},{style:So(So({},w),g),className:k}));return C};return x===1?y(N.Children.only(n)):N.createElement("div",null,N.Children.map(n,b=>y(b)))}}Ha(lC,"displayName","Animate");Ha(lC,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var M7=N.createContext(null);function eo(t){var e,n,r=N.useContext(M7);return N.createElement(lC,D1({},t,{animationManager:(e=(n=t.animationManager)!==null&&n!==void 0?n:r)!==null&&e!==void 0?e:_7()}))}function pg(){return pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pg.apply(null,arguments)}var yE=(t,e,n,r,s)=>{var i=Math.min(Math.abs(n)/2,Math.abs(r)/2),o=r>=0?1:-1,a=n>=0?1:-1,l=r>=0&&n>=0||r<0&&n<0?1:0,c;if(i>0&&s instanceof Array){for(var u=[0,0,0,0],d=0,h=4;d<h;d++)u[d]=s[d]>i?i:s[d];c="M".concat(t,",").concat(e+o*u[0]),u[0]>0&&(c+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(t+a*u[0],",").concat(e)),c+="L ".concat(t+n-a*u[1],",").concat(e),u[1]>0&&(c+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,`,
        `).concat(t+n,",").concat(e+o*u[1])),c+="L ".concat(t+n,",").concat(e+r-o*u[2]),u[2]>0&&(c+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,`,
        `).concat(t+n-a*u[2],",").concat(e+r)),c+="L ".concat(t+a*u[3],",").concat(e+r),u[3]>0&&(c+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+r-o*u[3])),c+="Z"}else if(i>0&&s===+s&&s>0){var f=Math.min(i,s);c="M ".concat(t,",").concat(e+o*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(l,",").concat(t+a*f,",").concat(e,`
            L `).concat(t+n-a*f,",").concat(e,`
            A `).concat(f,",").concat(f,",0,0,").concat(l,",").concat(t+n,",").concat(e+o*f,`
            L `).concat(t+n,",").concat(e+r-o*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(l,",").concat(t+n-a*f,",").concat(e+r,`
            L `).concat(t+a*f,",").concat(e+r,`
            A `).concat(f,",").concat(f,",0,0,").concat(l,",").concat(t,",").concat(e+r-o*f," Z")}else c="M ".concat(t,",").concat(e," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return c},F7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},L7=t=>{var e=ei(t,F7),n=N.useRef(null),[r,s]=N.useState(-1);N.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var g=n.current.getTotalLength();g&&s(g)}catch{}},[]);var{x:i,y:o,width:a,height:l,radius:c,className:u}=e,{animationEasing:d,animationDuration:h,animationBegin:f,isAnimationActive:p,isUpdateAnimationActive:m}=e;if(i!==+i||o!==+o||a!==+a||l!==+l||a===0||l===0)return null;var x=ot("recharts-rectangle",u);return m?N.createElement(eo,{canBegin:r>0,from:{width:a,height:l,x:i,y:o},to:{width:a,height:l,x:i,y:o},duration:h,animationEasing:d,isActive:m},g=>{var{width:y,height:b,x:w,y:k}=g;return N.createElement(eo,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:h,isActive:p,easing:d},N.createElement("path",pg({},je(e,!0),{className:x,d:yE(w,k,y,b,c),ref:n})))}):N.createElement("path",pg({},je(e,!0),{className:x,d:yE(i,o,a,l,c)}))};function O1(){return O1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O1.apply(null,arguments)}var j7=(t,e)=>{var n=Tn(e-t),r=Math.min(Math.abs(e-t),359.999);return n*r},qp=t=>{var{cx:e,cy:n,radius:r,angle:s,sign:i,isExternal:o,cornerRadius:a,cornerIsExternal:l}=t,c=a*(o?1:-1)+r,u=Math.asin(a/c)/ug,d=l?s:s+i*u,h=qn(e,n,c,d),f=qn(e,n,r,d),p=l?s-i*u:s,m=qn(e,n,c*Math.cos(u*ug),p);return{center:h,circleTangency:f,lineTangency:m,theta:u}},oM=t=>{var{cx:e,cy:n,innerRadius:r,outerRadius:s,startAngle:i,endAngle:o}=t,a=j7(i,o),l=i+a,c=qn(e,n,s,i),u=qn(e,n,s,l),d="M ".concat(c.x,",").concat(c.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(a)>180),",").concat(+(i>l),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var h=qn(e,n,r,i),f=qn(e,n,r,l);d+="L ".concat(f.x,",").concat(f.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(a)>180),",").concat(+(i<=l),`,
            `).concat(h.x,",").concat(h.y," Z")}else d+="L ".concat(e,",").concat(n," Z");return d},z7=t=>{var{cx:e,cy:n,innerRadius:r,outerRadius:s,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:a,startAngle:l,endAngle:c}=t,u=Tn(c-l),{circleTangency:d,lineTangency:h,theta:f}=qp({cx:e,cy:n,radius:s,angle:l,sign:u,cornerRadius:i,cornerIsExternal:a}),{circleTangency:p,lineTangency:m,theta:x}=qp({cx:e,cy:n,radius:s,angle:c,sign:-u,cornerRadius:i,cornerIsExternal:a}),g=a?Math.abs(l-c):Math.abs(l-c)-f-x;if(g<0)return o?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):oM({cx:e,cy:n,innerRadius:r,outerRadius:s,startAngle:l,endAngle:c});var y="M ".concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(d.x,",").concat(d.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(g>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,`
  `);if(r>0){var{circleTangency:b,lineTangency:w,theta:k}=qp({cx:e,cy:n,radius:r,angle:l,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:a}),{circleTangency:C,lineTangency:S,theta:I}=qp({cx:e,cy:n,radius:r,angle:c,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:a}),$=a?Math.abs(l-c):Math.abs(l-c)-k-I;if($<0&&i===0)return"".concat(y,"L").concat(e,",").concat(n,"Z");y+="L".concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(r,",").concat(r,",0,").concat(+($>180),",").concat(+(u>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,"Z")}else y+="L".concat(e,",").concat(n,"Z");return y},B7={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},W7=t=>{var e=ei(t,B7),{cx:n,cy:r,innerRadius:s,outerRadius:i,cornerRadius:o,forceCornerRadius:a,cornerIsExternal:l,startAngle:c,endAngle:u,className:d}=e;if(i<s||c===u)return null;var h=ot("recharts-sector",d),f=i-s,p=or(o,f,0,!0),m;return p>0&&Math.abs(c-u)<360?m=z7({cx:n,cy:r,innerRadius:s,outerRadius:i,cornerRadius:Math.min(p,f/2),forceCornerRadius:a,cornerIsExternal:l,startAngle:c,endAngle:u}):m=oM({cx:n,cy:r,innerRadius:s,outerRadius:i,startAngle:c,endAngle:u}),N.createElement("path",O1({},je(e,!0),{className:h,d:m}))},aM={},lM={},cM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qk;function n(r){return e.isSymbol(r)?NaN:Number(r)}t.toNumber=n})(cM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=cM;function n(r){return r?(r=e.toNumber(r),r===1/0||r===-1/0?(r<0?-1:1)*Number.MAX_VALUE:r===r?r:0):r===0?r:0}t.toFinite=n})(lM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zk,n=lM;function r(s,i,o){o&&typeof o!="number"&&e.isIterateeCall(s,i,o)&&(i=o=void 0),s=n.toFinite(s),i===void 0?(i=s,s=0):i=n.toFinite(i),o=o===void 0?s<i?1:-1:n.toFinite(o);const a=Math.max(Math.ceil((i-s)/(o||1)),0),l=new Array(a);for(let c=0;c<a;c++)l[c]=s,s+=o;return l}t.range=r})(aM);var U7=aM.range;const uM=Ei(U7);function Ho(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function V7(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cC(t){let e,n,r;t.length!==2?(e=Ho,n=(a,l)=>Ho(t(a),l),r=(a,l)=>t(a)-l):(e=t===Ho||t===V7?t:G7,n=t,r=t);function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<0?c=d+1:u=d}while(c<u)}return c}function i(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function o(a,l,c=0,u=a.length){const d=s(a,l,c,u-1);return d>c&&r(a[d-1],l)>-r(a[d],l)?d-1:d}return{left:s,center:o,right:i}}function G7(){return 0}function dM(t){return t===null?NaN:+t}function*H7(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const K7=cC(Ho),Hh=K7.right;cC(dM).center;class vE extends Map{constructor(e,n=Y7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,s]of e)this.set(r,s)}get(e){return super.get(bE(this,e))}has(e){return super.has(bE(this,e))}set(e,n){return super.set(q7(this,e),n)}delete(e){return super.delete(X7(this,e))}}function bE({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function q7({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function X7({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Y7(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Q7(t=Ho){if(t===Ho)return hM;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function hM(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Z7=Math.sqrt(50),J7=Math.sqrt(10),eq=Math.sqrt(2);function mg(t,e,n){const r=(e-t)/Math.max(0,n),s=Math.floor(Math.log10(r)),i=r/Math.pow(10,s),o=i>=Z7?10:i>=J7?5:i>=eq?2:1;let a,l,c;return s<0?(c=Math.pow(10,-s)/o,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,s)*o,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=n&&n<2?mg(t,e,n*2):[a,l,c]}function R1(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[s,i,o]=r?mg(e,t,n):mg(t,e,n);if(!(i>=s))return[];const a=i-s+1,l=new Array(a);if(r)if(o<0)for(let c=0;c<a;++c)l[c]=(i-c)/-o;else for(let c=0;c<a;++c)l[c]=(i-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(s+c)/-o;else for(let c=0;c<a;++c)l[c]=(s+c)*o;return l}function P1(t,e,n){return e=+e,t=+t,n=+n,mg(t,e,n)[2]}function _1(t,e,n){e=+e,t=+t,n=+n;const r=e<t,s=r?P1(e,t,n):P1(t,e,n);return(r?-1:1)*(s<0?1/-s:s)}function wE(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function kE(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function fM(t,e,n=0,r=1/0,s){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(s=s===void 0?hM:Q7(s);r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),f=Math.max(n,Math.floor(e-c*d/l+h)),p=Math.min(r,Math.floor(e+(l-c)*d/l+h));fM(t,e,f,p,s)}const i=t[e];let o=n,a=r;for(dd(t,n,e),s(t[r],i)>0&&dd(t,n,r);o<a;){for(dd(t,o,a),++o,--a;s(t[o],i)<0;)++o;for(;s(t[a],i)>0;)--a}s(t[n],i)===0?dd(t,n,a):(++a,dd(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function dd(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function tq(t,e,n){if(t=Float64Array.from(H7(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return kE(t);if(e>=1)return wE(t);var r,s=(r-1)*e,i=Math.floor(s),o=wE(fM(t,i).subarray(0,i+1)),a=kE(t.subarray(i+1));return o+(a-o)*(s-i)}}function nq(t,e,n=dM){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,s=(r-1)*e,i=Math.floor(s),o=+n(t[i],i,t),a=+n(t[i+1],i+1,t);return o+(a-o)*(s-i)}}function rq(t,e,n){t=+t,e=+e,n=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((e-t)/n))|0,i=new Array(s);++r<s;)i[r]=t+r*n;return i}function Ns(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ho(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const M1=Symbol("implicit");function uC(){var t=new vE,e=[],n=[],r=M1;function s(i){let o=t.get(i);if(o===void 0){if(r!==M1)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return s.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new vE;for(const o of i)t.has(o)||t.set(o,e.push(o)-1);return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return uC(e,n).unknown(r)},Ns.apply(s,arguments),s}function dC(){var t=uC().unknown(void 0),e=t.domain,n=t.range,r=0,s=1,i,o,a=!1,l=0,c=0,u=.5;delete t.unknown;function d(){var h=e().length,f=s<r,p=f?s:r,m=f?r:s;i=(m-p)/Math.max(1,h-l+c*2),a&&(i=Math.floor(i)),p+=(m-p-i*(h-l))*u,o=i*(1-l),a&&(p=Math.round(p),o=Math.round(o));var x=rq(h).map(function(g){return p+i*g});return n(f?x.reverse():x)}return t.domain=function(h){return arguments.length?(e(h),d()):e()},t.range=function(h){return arguments.length?([r,s]=h,r=+r,s=+s,d()):[r,s]},t.rangeRound=function(h){return[r,s]=h,r=+r,s=+s,a=!0,d()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(h){return arguments.length?(a=!!h,d()):a},t.padding=function(h){return arguments.length?(l=Math.min(1,c=+h),d()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},t.paddingOuter=function(h){return arguments.length?(c=+h,d()):c},t.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),d()):u},t.copy=function(){return dC(e(),[r,s]).round(a).paddingInner(l).paddingOuter(c).align(u)},Ns.apply(d(),arguments)}function pM(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return pM(e())},t}function sq(){return pM(dC.apply(null,arguments).paddingInner(1))}function hC(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function mM(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Kh(){}var xh=.7,gg=1/xh,_c="\\s*([+-]?\\d+)\\s*",yh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",iq=/^#([0-9a-f]{3,8})$/,oq=new RegExp(`^rgb\\(${_c},${_c},${_c}\\)$`),aq=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),lq=new RegExp(`^rgba\\(${_c},${_c},${_c},${yh}\\)$`),cq=new RegExp(`^rgba\\(${mi},${mi},${mi},${yh}\\)$`),uq=new RegExp(`^hsl\\(${yh},${mi},${mi}\\)$`),dq=new RegExp(`^hsla\\(${yh},${mi},${mi},${yh}\\)$`),CE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hC(Kh,vh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:SE,formatHex:SE,formatHex8:hq,formatHsl:fq,formatRgb:IE,toString:IE});function SE(){return this.rgb().formatHex()}function hq(){return this.rgb().formatHex8()}function fq(){return gM(this).formatHsl()}function IE(){return this.rgb().formatRgb()}function vh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=iq.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?NE(e):n===3?new vr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Xp(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Xp(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=oq.exec(t))?new vr(e[1],e[2],e[3],1):(e=aq.exec(t))?new vr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=lq.exec(t))?Xp(e[1],e[2],e[3],e[4]):(e=cq.exec(t))?Xp(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=uq.exec(t))?TE(e[1],e[2]/100,e[3]/100,1):(e=dq.exec(t))?TE(e[1],e[2]/100,e[3]/100,e[4]):CE.hasOwnProperty(t)?NE(CE[t]):t==="transparent"?new vr(NaN,NaN,NaN,0):null}function NE(t){return new vr(t>>16&255,t>>8&255,t&255,1)}function Xp(t,e,n,r){return r<=0&&(t=e=n=NaN),new vr(t,e,n,r)}function pq(t){return t instanceof Kh||(t=vh(t)),t?(t=t.rgb(),new vr(t.r,t.g,t.b,t.opacity)):new vr}function F1(t,e,n,r){return arguments.length===1?pq(t):new vr(t,e,n,r??1)}function vr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}hC(vr,F1,mM(Kh,{brighter(t){return t=t==null?gg:Math.pow(gg,t),new vr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xh:Math.pow(xh,t),new vr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vr(rl(this.r),rl(this.g),rl(this.b),xg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$E,formatHex:$E,formatHex8:mq,formatRgb:EE,toString:EE}));function $E(){return`#${Ka(this.r)}${Ka(this.g)}${Ka(this.b)}`}function mq(){return`#${Ka(this.r)}${Ka(this.g)}${Ka(this.b)}${Ka((isNaN(this.opacity)?1:this.opacity)*255)}`}function EE(){const t=xg(this.opacity);return`${t===1?"rgb(":"rgba("}${rl(this.r)}, ${rl(this.g)}, ${rl(this.b)}${t===1?")":`, ${t})`}`}function xg(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function rl(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ka(t){return t=rl(t),(t<16?"0":"")+t.toString(16)}function TE(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Bs(t,e,n,r)}function gM(t){if(t instanceof Bs)return new Bs(t.h,t.s,t.l,t.opacity);if(t instanceof Kh||(t=vh(t)),!t)return new Bs;if(t instanceof Bs)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,a=i-s,l=(i+s)/2;return a?(e===i?o=(n-r)/a+(n<r)*6:n===i?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?i+s:2-i-s,o*=60):a=l>0&&l<1?0:o,new Bs(o,a,l,t.opacity)}function gq(t,e,n,r){return arguments.length===1?gM(t):new Bs(t,e,n,r??1)}function Bs(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}hC(Bs,gq,mM(Kh,{brighter(t){return t=t==null?gg:Math.pow(gg,t),new Bs(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xh:Math.pow(xh,t),new Bs(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new vr(jv(t>=240?t-240:t+120,s,r),jv(t,s,r),jv(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new Bs(AE(this.h),Yp(this.s),Yp(this.l),xg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=xg(this.opacity);return`${t===1?"hsl(":"hsla("}${AE(this.h)}, ${Yp(this.s)*100}%, ${Yp(this.l)*100}%${t===1?")":`, ${t})`}`}}));function AE(t){return t=(t||0)%360,t<0?t+360:t}function Yp(t){return Math.max(0,Math.min(1,t||0))}function jv(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const fC=t=>()=>t;function xq(t,e){return function(n){return t+n*e}}function yq(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function vq(t){return(t=+t)==1?xM:function(e,n){return n-e?yq(e,n,t):fC(isNaN(e)?n:e)}}function xM(t,e){var n=e-t;return n?xq(t,n):fC(isNaN(t)?e:t)}const DE=function t(e){var n=vq(e);function r(s,i){var o=n((s=F1(s)).r,(i=F1(i)).r),a=n(s.g,i.g),l=n(s.b,i.b),c=xM(s.opacity,i.opacity);return function(u){return s.r=o(u),s.g=a(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=t,r}(1);function bq(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=t[s]*(1-i)+e[s]*i;return r}}function wq(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kq(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,s=new Array(r),i=new Array(n),o;for(o=0;o<r;++o)s[o]=$u(t[o],e[o]);for(;o<n;++o)i[o]=e[o];return function(a){for(o=0;o<r;++o)i[o]=s[o](a);return i}}function Cq(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function yg(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Sq(t,e){var n={},r={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?n[s]=$u(t[s],e[s]):r[s]=e[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var L1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zv=new RegExp(L1.source,"g");function Iq(t){return function(){return t}}function Nq(t){return function(e){return t(e)+""}}function $q(t,e){var n=L1.lastIndex=zv.lastIndex=0,r,s,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=L1.exec(t))&&(s=zv.exec(e));)(i=s.index)>n&&(i=e.slice(n,i),a[o]?a[o]+=i:a[++o]=i),(r=r[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:yg(r,s)})),n=zv.lastIndex;return n<e.length&&(i=e.slice(n),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?Nq(l[0].x):Iq(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}function $u(t,e){var n=typeof e,r;return e==null||n==="boolean"?fC(e):(n==="number"?yg:n==="string"?(r=vh(e))?(e=r,DE):$q:e instanceof vh?DE:e instanceof Date?Cq:wq(e)?bq:Array.isArray(e)?kq:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Sq:yg)(t,e)}function pC(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Eq(t,e){e===void 0&&(e=t,t=$u);for(var n=0,r=e.length-1,s=e[0],i=new Array(r<0?0:r);n<r;)i[n]=t(s,s=e[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return i[a](o-a)}}function Tq(t){return function(){return t}}function vg(t){return+t}var OE=[0,1];function sr(t){return t}function j1(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Tq(isNaN(e)?NaN:.5)}function Aq(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Dq(t,e,n){var r=t[0],s=t[1],i=e[0],o=e[1];return s<r?(r=j1(s,r),i=n(o,i)):(r=j1(r,s),i=n(i,o)),function(a){return i(r(a))}}function Oq(t,e,n){var r=Math.min(t.length,e.length)-1,s=new Array(r),i=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)s[o]=j1(t[o],t[o+1]),i[o]=n(e[o],e[o+1]);return function(a){var l=Hh(t,a,1,r)-1;return i[l](s[l](a))}}function qh(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function J0(){var t=OE,e=OE,n=$u,r,s,i,o=sr,a,l,c;function u(){var h=Math.min(t.length,e.length);return o!==sr&&(o=Aq(t[0],t[h-1])),a=h>2?Oq:Dq,l=c=null,d}function d(h){return h==null||isNaN(h=+h)?i:(l||(l=a(t.map(r),e,n)))(r(o(h)))}return d.invert=function(h){return o(s((c||(c=a(e,t.map(r),yg)))(h)))},d.domain=function(h){return arguments.length?(t=Array.from(h,vg),u()):t.slice()},d.range=function(h){return arguments.length?(e=Array.from(h),u()):e.slice()},d.rangeRound=function(h){return e=Array.from(h),n=pC,u()},d.clamp=function(h){return arguments.length?(o=h?!0:sr,u()):o!==sr},d.interpolate=function(h){return arguments.length?(n=h,u()):n},d.unknown=function(h){return arguments.length?(i=h,d):i},function(h,f){return r=h,s=f,u()}}function mC(){return J0()(sr,sr)}function Rq(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function bg(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function iu(t){return t=bg(Math.abs(t)),t?t[1]:NaN}function Pq(t,e){return function(n,r){for(var s=n.length,i=[],o=0,a=t[0],l=0;s>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(n.substring(s-=a,s+a)),!((l+=a+1)>r));)a=t[o=(o+1)%t.length];return i.reverse().join(e)}}function _q(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Mq=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bh(t){if(!(e=Mq.exec(t)))throw new Error("invalid format: "+t);var e;return new gC({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}bh.prototype=gC.prototype;function gC(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}gC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Fq(t){e:for(var e=t.length,n=1,r=-1,s;n<e;++n)switch(t[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(s+1):t}var yM;function Lq(t,e){var n=bg(t,e);if(!n)return t+"";var r=n[0],s=n[1],i=s-(yM=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+bg(t,Math.max(0,e+i-1))[0]}function RE(t,e){var n=bg(t,e);if(!n)return t+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const PE={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Rq,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>RE(t*100,e),r:RE,s:Lq,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _E(t){return t}var ME=Array.prototype.map,FE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function jq(t){var e=t.grouping===void 0||t.thousands===void 0?_E:Pq(ME.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?_E:_q(ME.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(d){d=bh(d);var h=d.fill,f=d.align,p=d.sign,m=d.symbol,x=d.zero,g=d.width,y=d.comma,b=d.precision,w=d.trim,k=d.type;k==="n"?(y=!0,k="g"):PE[k]||(b===void 0&&(b=12),w=!0,k="g"),(x||h==="0"&&f==="=")&&(x=!0,h="0",f="=");var C=m==="$"?n:m==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",S=m==="$"?r:/[%p]/.test(k)?o:"",I=PE[k],$=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(A){var D=C,P=S,O,F,U;if(k==="c")P=I(A)+P,A="";else{A=+A;var V=A<0||1/A<0;if(A=isNaN(A)?l:I(Math.abs(A),b),w&&(A=Fq(A)),V&&+A==0&&p!=="+"&&(V=!1),D=(V?p==="("?p:a:p==="-"||p==="("?"":p)+D,P=(k==="s"?FE[8+yM/3]:"")+P+(V&&p==="("?")":""),$){for(O=-1,F=A.length;++O<F;)if(U=A.charCodeAt(O),48>U||U>57){P=(U===46?s+A.slice(O+1):A.slice(O))+P,A=A.slice(0,O);break}}}y&&!x&&(A=e(A,1/0));var _=D.length+A.length+P.length,z=_<g?new Array(g-_+1).join(h):"";switch(y&&x&&(A=e(z+A,z.length?g-P.length:1/0),z=""),f){case"<":A=D+A+P+z;break;case"=":A=D+z+A+P;break;case"^":A=z.slice(0,_=z.length>>1)+D+A+P+z.slice(_);break;default:A=z+D+A+P;break}return i(A)}return E.toString=function(){return d+""},E}function u(d,h){var f=c((d=bh(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(iu(h)/3)))*3,m=Math.pow(10,-p),x=FE[8+p/3];return function(g){return f(m*g)+x}}return{format:c,formatPrefix:u}}var Qp,xC,vM;zq({thousands:",",grouping:[3],currency:["$",""]});function zq(t){return Qp=jq(t),xC=Qp.format,vM=Qp.formatPrefix,Qp}function Bq(t){return Math.max(0,-iu(Math.abs(t)))}function Wq(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(iu(e)/3)))*3-iu(Math.abs(t)))}function Uq(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,iu(e)-iu(t))+1}function bM(t,e,n,r){var s=_1(t,e,n),i;switch(r=bh(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(i=Wq(s,o))&&(r.precision=i),vM(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=Uq(s,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=Bq(s))&&(r.precision=i-(r.type==="%")*2);break}}return xC(r)}function pa(t){var e=t.domain;return t.ticks=function(n){var r=e();return R1(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var s=e();return bM(s[0],s[s.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),s=0,i=r.length-1,o=r[s],a=r[i],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=s,s=i,i=c);u-- >0;){if(c=P1(o,a,n),c===l)return r[s]=o,r[i]=a,e(r);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return t},t}function wM(){var t=mC();return t.copy=function(){return qh(t,wM())},Ns.apply(t,arguments),pa(t)}function kM(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,vg),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return kM(t).unknown(e)},t=arguments.length?Array.from(t,vg):[0,1],pa(n)}function CM(t,e){t=t.slice();var n=0,r=t.length-1,s=t[n],i=t[r],o;return i<s&&(o=n,n=r,r=o,o=s,s=i,i=o),t[n]=e.floor(s),t[r]=e.ceil(i),t}function LE(t){return Math.log(t)}function jE(t){return Math.exp(t)}function Vq(t){return-Math.log(-t)}function Gq(t){return-Math.exp(-t)}function Hq(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Kq(t){return t===10?Hq:t===Math.E?Math.exp:e=>Math.pow(t,e)}function qq(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function zE(t){return(e,n)=>-t(-e,n)}function yC(t){const e=t(LE,jE),n=e.domain;let r=10,s,i;function o(){return s=qq(r),i=Kq(r),n()[0]<0?(s=zE(s),i=zE(i),t(Vq,Gq)):t(LE,jE),e}return e.base=function(a){return arguments.length?(r=+a,o()):r},e.domain=function(a){return arguments.length?(n(a),o()):n()},e.ticks=a=>{const l=n();let c=l[0],u=l[l.length-1];const d=u<c;d&&([c,u]=[u,c]);let h=s(c),f=s(u),p,m;const x=a==null?10:+a;let g=[];if(!(r%1)&&f-h<x){if(h=Math.floor(h),f=Math.ceil(f),c>0){for(;h<=f;++h)for(p=1;p<r;++p)if(m=h<0?p/i(-h):p*i(h),!(m<c)){if(m>u)break;g.push(m)}}else for(;h<=f;++h)for(p=r-1;p>=1;--p)if(m=h>0?p/i(-h):p*i(h),!(m<c)){if(m>u)break;g.push(m)}g.length*2<x&&(g=R1(c,u,x))}else g=R1(h,f,Math.min(f-h,x)).map(i);return d?g.reverse():g},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=bh(l)).precision==null&&(l.trim=!0),l=xC(l)),a===1/0)return l;const c=Math.max(1,r*a/e.ticks().length);return u=>{let d=u/i(Math.round(s(u)));return d*r<r-.5&&(d*=r),d<=c?l(u):""}},e.nice=()=>n(CM(n(),{floor:a=>i(Math.floor(s(a))),ceil:a=>i(Math.ceil(s(a)))})),e}function SM(){const t=yC(J0()).domain([1,10]);return t.copy=()=>qh(t,SM()).base(t.base()),Ns.apply(t,arguments),t}function BE(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function WE(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function vC(t){var e=1,n=t(BE(e),WE(e));return n.constant=function(r){return arguments.length?t(BE(e=+r),WE(e)):e},pa(n)}function IM(){var t=vC(J0());return t.copy=function(){return qh(t,IM()).constant(t.constant())},Ns.apply(t,arguments)}function UE(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Xq(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Yq(t){return t<0?-t*t:t*t}function bC(t){var e=t(sr,sr),n=1;function r(){return n===1?t(sr,sr):n===.5?t(Xq,Yq):t(UE(n),UE(1/n))}return e.exponent=function(s){return arguments.length?(n=+s,r()):n},pa(e)}function wC(){var t=bC(J0());return t.copy=function(){return qh(t,wC()).exponent(t.exponent())},Ns.apply(t,arguments),t}function Qq(){return wC.apply(null,arguments).exponent(.5)}function VE(t){return Math.sign(t)*t*t}function Zq(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function NM(){var t=mC(),e=[0,1],n=!1,r;function s(i){var o=Zq(t(i));return isNaN(o)?r:n?Math.round(o):o}return s.invert=function(i){return t.invert(VE(i))},s.domain=function(i){return arguments.length?(t.domain(i),s):t.domain()},s.range=function(i){return arguments.length?(t.range((e=Array.from(i,vg)).map(VE)),s):e.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(t.clamp(i),s):t.clamp()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return NM(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},Ns.apply(s,arguments),pa(s)}function $M(){var t=[],e=[],n=[],r;function s(){var o=0,a=Math.max(1,e.length);for(n=new Array(a-1);++o<a;)n[o-1]=nq(t,o/a);return i}function i(o){return o==null||isNaN(o=+o)?r:e[Hh(n,o)]}return i.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},i.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let a of o)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Ho),s()},i.range=function(o){return arguments.length?(e=Array.from(o),s()):e.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return $M().domain(t).range(e).unknown(r)},Ns.apply(i,arguments)}function EM(){var t=0,e=1,n=1,r=[.5],s=[0,1],i;function o(l){return l!=null&&l<=l?s[Hh(r,l,0,n)]:i}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return o}return o.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,a()):[t,e]},o.range=function(l){return arguments.length?(n=(s=Array.from(l)).length-1,a()):s.slice()},o.invertExtent=function(l){var c=s.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,r[0]]:c>=n?[r[n-1],e]:[r[c-1],r[c]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return r.slice()},o.copy=function(){return EM().domain([t,e]).range(s).unknown(i)},Ns.apply(pa(o),arguments)}function TM(){var t=[.5],e=[0,1],n,r=1;function s(i){return i!=null&&i<=i?e[Hh(t,i,0,r)]:n}return s.domain=function(i){return arguments.length?(t=Array.from(i),r=Math.min(t.length,e.length-1),s):t.slice()},s.range=function(i){return arguments.length?(e=Array.from(i),r=Math.min(t.length,e.length-1),s):e.slice()},s.invertExtent=function(i){var o=e.indexOf(i);return[t[o-1],t[o]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return TM().domain(t).range(e).unknown(n)},Ns.apply(s,arguments)}const Bv=new Date,Wv=new Date;function hn(t,e,n,r){function s(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(t(i=new Date(+i)),i),s.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),s.round=i=>{const o=s(i),a=s.ceil(i);return i-o<a-i?o:a},s.offset=(i,o)=>(e(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,a)=>{const l=[];if(i=s.ceil(i),a=a==null?1:Math.floor(a),!(i<o)||!(a>0))return l;let c;do l.push(c=new Date(+i)),e(i,a),t(i);while(c<i&&i<o);return l},s.filter=i=>hn(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!i(o););else for(;--a>=0;)for(;e(o,1),!i(o););}),n&&(s.count=(i,o)=>(Bv.setTime(+i),Wv.setTime(+o),t(Bv),t(Wv),Math.floor(n(Bv,Wv))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(r?o=>r(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const wg=hn(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);wg.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?hn(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):wg);wg.range;const Bi=1e3,us=Bi*60,Wi=us*60,to=Wi*24,kC=to*7,GE=to*30,Uv=to*365,qa=hn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Bi)},(t,e)=>(e-t)/Bi,t=>t.getUTCSeconds());qa.range;const CC=hn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Bi)},(t,e)=>{t.setTime(+t+e*us)},(t,e)=>(e-t)/us,t=>t.getMinutes());CC.range;const SC=hn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*us)},(t,e)=>(e-t)/us,t=>t.getUTCMinutes());SC.range;const IC=hn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Bi-t.getMinutes()*us)},(t,e)=>{t.setTime(+t+e*Wi)},(t,e)=>(e-t)/Wi,t=>t.getHours());IC.range;const NC=hn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Wi)},(t,e)=>(e-t)/Wi,t=>t.getUTCHours());NC.range;const Xh=hn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*us)/to,t=>t.getDate()-1);Xh.range;const ex=hn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/to,t=>t.getUTCDate()-1);ex.range;const AM=hn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/to,t=>Math.floor(t/to));AM.range;function Ml(t){return hn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*us)/kC)}const tx=Ml(0),kg=Ml(1),Jq=Ml(2),eX=Ml(3),ou=Ml(4),tX=Ml(5),nX=Ml(6);tx.range;kg.range;Jq.range;eX.range;ou.range;tX.range;nX.range;function Fl(t){return hn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/kC)}const nx=Fl(0),Cg=Fl(1),rX=Fl(2),sX=Fl(3),au=Fl(4),iX=Fl(5),oX=Fl(6);nx.range;Cg.range;rX.range;sX.range;au.range;iX.range;oX.range;const $C=hn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());$C.range;const EC=hn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());EC.range;const no=hn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());no.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:hn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});no.range;const ro=hn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ro.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:hn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});ro.range;function DM(t,e,n,r,s,i){const o=[[qa,1,Bi],[qa,5,5*Bi],[qa,15,15*Bi],[qa,30,30*Bi],[i,1,us],[i,5,5*us],[i,15,15*us],[i,30,30*us],[s,1,Wi],[s,3,3*Wi],[s,6,6*Wi],[s,12,12*Wi],[r,1,to],[r,2,2*to],[n,1,kC],[e,1,GE],[e,3,3*GE],[t,1,Uv]];function a(c,u,d){const h=u<c;h&&([c,u]=[u,c]);const f=d&&typeof d.range=="function"?d:l(c,u,d),p=f?f.range(c,+u+1):[];return h?p.reverse():p}function l(c,u,d){const h=Math.abs(u-c)/d,f=cC(([,,x])=>x).right(o,h);if(f===o.length)return t.every(_1(c/Uv,u/Uv,d));if(f===0)return wg.every(Math.max(_1(c,u,d),1));const[p,m]=o[h/o[f-1][2]<o[f][2]/h?f-1:f];return p.every(m)}return[a,l]}const[aX,lX]=DM(ro,EC,nx,AM,NC,SC),[cX,uX]=DM(no,$C,tx,Xh,IC,CC);function Vv(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Gv(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function hd(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function dX(t){var e=t.dateTime,n=t.date,r=t.time,s=t.periods,i=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,c=fd(s),u=pd(s),d=fd(i),h=pd(i),f=fd(o),p=pd(o),m=fd(a),x=pd(a),g=fd(l),y=pd(l),b={a:V,A:_,b:z,B:K,c:null,d:QE,e:QE,f:PX,g:VX,G:HX,H:DX,I:OX,j:RX,L:OM,m:_X,M:MX,p:Z,q,Q:eT,s:tT,S:FX,u:LX,U:jX,V:zX,w:BX,W:WX,x:null,X:null,y:UX,Y:GX,Z:KX,"%":JE},w={a:te,A:ie,b:oe,B:le,c:null,d:ZE,e:ZE,f:QX,g:a9,G:c9,H:qX,I:XX,j:YX,L:PM,m:ZX,M:JX,p:ge,q:ke,Q:eT,s:tT,S:e9,u:t9,U:n9,V:r9,w:s9,W:i9,x:null,X:null,y:o9,Y:l9,Z:u9,"%":JE},k={a:E,A,b:D,B:P,c:O,d:XE,e:XE,f:$X,g:qE,G:KE,H:YE,I:YE,j:CX,L:NX,m:kX,M:SX,p:$,q:wX,Q:TX,s:AX,S:IX,u:gX,U:xX,V:yX,w:mX,W:vX,x:F,X:U,y:qE,Y:KE,Z:bX,"%":EX};b.x=C(n,b),b.X=C(r,b),b.c=C(e,b),w.x=C(n,w),w.X=C(r,w),w.c=C(e,w);function C(ee,ue){return function(de){var J=[],Oe=-1,Ie=0,Pe=ee.length,De,Ke,it;for(de instanceof Date||(de=new Date(+de));++Oe<Pe;)ee.charCodeAt(Oe)===37&&(J.push(ee.slice(Ie,Oe)),(Ke=HE[De=ee.charAt(++Oe)])!=null?De=ee.charAt(++Oe):Ke=De==="e"?" ":"0",(it=ue[De])&&(De=it(de,Ke)),J.push(De),Ie=Oe+1);return J.push(ee.slice(Ie,Oe)),J.join("")}}function S(ee,ue){return function(de){var J=hd(1900,void 0,1),Oe=I(J,ee,de+="",0),Ie,Pe;if(Oe!=de.length)return null;if("Q"in J)return new Date(J.Q);if("s"in J)return new Date(J.s*1e3+("L"in J?J.L:0));if(ue&&!("Z"in J)&&(J.Z=0),"p"in J&&(J.H=J.H%12+J.p*12),J.m===void 0&&(J.m="q"in J?J.q:0),"V"in J){if(J.V<1||J.V>53)return null;"w"in J||(J.w=1),"Z"in J?(Ie=Gv(hd(J.y,0,1)),Pe=Ie.getUTCDay(),Ie=Pe>4||Pe===0?Cg.ceil(Ie):Cg(Ie),Ie=ex.offset(Ie,(J.V-1)*7),J.y=Ie.getUTCFullYear(),J.m=Ie.getUTCMonth(),J.d=Ie.getUTCDate()+(J.w+6)%7):(Ie=Vv(hd(J.y,0,1)),Pe=Ie.getDay(),Ie=Pe>4||Pe===0?kg.ceil(Ie):kg(Ie),Ie=Xh.offset(Ie,(J.V-1)*7),J.y=Ie.getFullYear(),J.m=Ie.getMonth(),J.d=Ie.getDate()+(J.w+6)%7)}else("W"in J||"U"in J)&&("w"in J||(J.w="u"in J?J.u%7:"W"in J?1:0),Pe="Z"in J?Gv(hd(J.y,0,1)).getUTCDay():Vv(hd(J.y,0,1)).getDay(),J.m=0,J.d="W"in J?(J.w+6)%7+J.W*7-(Pe+5)%7:J.w+J.U*7-(Pe+6)%7);return"Z"in J?(J.H+=J.Z/100|0,J.M+=J.Z%100,Gv(J)):Vv(J)}}function I(ee,ue,de,J){for(var Oe=0,Ie=ue.length,Pe=de.length,De,Ke;Oe<Ie;){if(J>=Pe)return-1;if(De=ue.charCodeAt(Oe++),De===37){if(De=ue.charAt(Oe++),Ke=k[De in HE?ue.charAt(Oe++):De],!Ke||(J=Ke(ee,de,J))<0)return-1}else if(De!=de.charCodeAt(J++))return-1}return J}function $(ee,ue,de){var J=c.exec(ue.slice(de));return J?(ee.p=u.get(J[0].toLowerCase()),de+J[0].length):-1}function E(ee,ue,de){var J=f.exec(ue.slice(de));return J?(ee.w=p.get(J[0].toLowerCase()),de+J[0].length):-1}function A(ee,ue,de){var J=d.exec(ue.slice(de));return J?(ee.w=h.get(J[0].toLowerCase()),de+J[0].length):-1}function D(ee,ue,de){var J=g.exec(ue.slice(de));return J?(ee.m=y.get(J[0].toLowerCase()),de+J[0].length):-1}function P(ee,ue,de){var J=m.exec(ue.slice(de));return J?(ee.m=x.get(J[0].toLowerCase()),de+J[0].length):-1}function O(ee,ue,de){return I(ee,e,ue,de)}function F(ee,ue,de){return I(ee,n,ue,de)}function U(ee,ue,de){return I(ee,r,ue,de)}function V(ee){return o[ee.getDay()]}function _(ee){return i[ee.getDay()]}function z(ee){return l[ee.getMonth()]}function K(ee){return a[ee.getMonth()]}function Z(ee){return s[+(ee.getHours()>=12)]}function q(ee){return 1+~~(ee.getMonth()/3)}function te(ee){return o[ee.getUTCDay()]}function ie(ee){return i[ee.getUTCDay()]}function oe(ee){return l[ee.getUTCMonth()]}function le(ee){return a[ee.getUTCMonth()]}function ge(ee){return s[+(ee.getUTCHours()>=12)]}function ke(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var ue=C(ee+="",b);return ue.toString=function(){return ee},ue},parse:function(ee){var ue=S(ee+="",!1);return ue.toString=function(){return ee},ue},utcFormat:function(ee){var ue=C(ee+="",w);return ue.toString=function(){return ee},ue},utcParse:function(ee){var ue=S(ee+="",!0);return ue.toString=function(){return ee},ue}}}var HE={"-":"",_:" ",0:"0"},wn=/^\s*\d+/,hX=/^%/,fX=/[\\^$*+?|[\]().{}]/g;function Ye(t,e,n){var r=t<0?"-":"",s=(r?-t:t)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(e)+s:s)}function pX(t){return t.replace(fX,"\\$&")}function fd(t){return new RegExp("^(?:"+t.map(pX).join("|")+")","i")}function pd(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function mX(t,e,n){var r=wn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function gX(t,e,n){var r=wn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function xX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function yX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function vX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function KE(t,e,n){var r=wn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function qE(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function bX(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wX(t,e,n){var r=wn.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function kX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function XE(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function CX(t,e,n){var r=wn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function YE(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function SX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function IX(t,e,n){var r=wn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function NX(t,e,n){var r=wn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function $X(t,e,n){var r=wn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function EX(t,e,n){var r=hX.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function TX(t,e,n){var r=wn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function AX(t,e,n){var r=wn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function QE(t,e){return Ye(t.getDate(),e,2)}function DX(t,e){return Ye(t.getHours(),e,2)}function OX(t,e){return Ye(t.getHours()%12||12,e,2)}function RX(t,e){return Ye(1+Xh.count(no(t),t),e,3)}function OM(t,e){return Ye(t.getMilliseconds(),e,3)}function PX(t,e){return OM(t,e)+"000"}function _X(t,e){return Ye(t.getMonth()+1,e,2)}function MX(t,e){return Ye(t.getMinutes(),e,2)}function FX(t,e){return Ye(t.getSeconds(),e,2)}function LX(t){var e=t.getDay();return e===0?7:e}function jX(t,e){return Ye(tx.count(no(t)-1,t),e,2)}function RM(t){var e=t.getDay();return e>=4||e===0?ou(t):ou.ceil(t)}function zX(t,e){return t=RM(t),Ye(ou.count(no(t),t)+(no(t).getDay()===4),e,2)}function BX(t){return t.getDay()}function WX(t,e){return Ye(kg.count(no(t)-1,t),e,2)}function UX(t,e){return Ye(t.getFullYear()%100,e,2)}function VX(t,e){return t=RM(t),Ye(t.getFullYear()%100,e,2)}function GX(t,e){return Ye(t.getFullYear()%1e4,e,4)}function HX(t,e){var n=t.getDay();return t=n>=4||n===0?ou(t):ou.ceil(t),Ye(t.getFullYear()%1e4,e,4)}function KX(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ye(e/60|0,"0",2)+Ye(e%60,"0",2)}function ZE(t,e){return Ye(t.getUTCDate(),e,2)}function qX(t,e){return Ye(t.getUTCHours(),e,2)}function XX(t,e){return Ye(t.getUTCHours()%12||12,e,2)}function YX(t,e){return Ye(1+ex.count(ro(t),t),e,3)}function PM(t,e){return Ye(t.getUTCMilliseconds(),e,3)}function QX(t,e){return PM(t,e)+"000"}function ZX(t,e){return Ye(t.getUTCMonth()+1,e,2)}function JX(t,e){return Ye(t.getUTCMinutes(),e,2)}function e9(t,e){return Ye(t.getUTCSeconds(),e,2)}function t9(t){var e=t.getUTCDay();return e===0?7:e}function n9(t,e){return Ye(nx.count(ro(t)-1,t),e,2)}function _M(t){var e=t.getUTCDay();return e>=4||e===0?au(t):au.ceil(t)}function r9(t,e){return t=_M(t),Ye(au.count(ro(t),t)+(ro(t).getUTCDay()===4),e,2)}function s9(t){return t.getUTCDay()}function i9(t,e){return Ye(Cg.count(ro(t)-1,t),e,2)}function o9(t,e){return Ye(t.getUTCFullYear()%100,e,2)}function a9(t,e){return t=_M(t),Ye(t.getUTCFullYear()%100,e,2)}function l9(t,e){return Ye(t.getUTCFullYear()%1e4,e,4)}function c9(t,e){var n=t.getUTCDay();return t=n>=4||n===0?au(t):au.ceil(t),Ye(t.getUTCFullYear()%1e4,e,4)}function u9(){return"+0000"}function JE(){return"%"}function eT(t){return+t}function tT(t){return Math.floor(+t/1e3)}var tc,MM,FM;d9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function d9(t){return tc=dX(t),MM=tc.format,tc.parse,FM=tc.utcFormat,tc.utcParse,tc}function h9(t){return new Date(t)}function f9(t){return t instanceof Date?+t:+new Date(+t)}function TC(t,e,n,r,s,i,o,a,l,c){var u=mC(),d=u.invert,h=u.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),x=c("%I %p"),g=c("%a %d"),y=c("%b %d"),b=c("%B"),w=c("%Y");function k(C){return(l(C)<C?f:a(C)<C?p:o(C)<C?m:i(C)<C?x:r(C)<C?s(C)<C?g:y:n(C)<C?b:w)(C)}return u.invert=function(C){return new Date(d(C))},u.domain=function(C){return arguments.length?h(Array.from(C,f9)):h().map(h9)},u.ticks=function(C){var S=h();return t(S[0],S[S.length-1],C??10)},u.tickFormat=function(C,S){return S==null?k:c(S)},u.nice=function(C){var S=h();return(!C||typeof C.range!="function")&&(C=e(S[0],S[S.length-1],C??10)),C?h(CM(S,C)):u},u.copy=function(){return qh(u,TC(t,e,n,r,s,i,o,a,l,c))},u}function p9(){return Ns.apply(TC(cX,uX,no,$C,tx,Xh,IC,CC,qa,MM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function m9(){return Ns.apply(TC(aX,lX,ro,EC,nx,ex,NC,SC,qa,FM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function rx(){var t=0,e=1,n,r,s,i,o=sr,a=!1,l;function c(d){return d==null||isNaN(d=+d)?l:o(s===0?.5:(d=(i(d)-n)*s,a?Math.max(0,Math.min(1,d)):d))}c.domain=function(d){return arguments.length?([t,e]=d,n=i(t=+t),r=i(e=+e),s=n===r?0:1/(r-n),c):[t,e]},c.clamp=function(d){return arguments.length?(a=!!d,c):a},c.interpolator=function(d){return arguments.length?(o=d,c):o};function u(d){return function(h){var f,p;return arguments.length?([f,p]=h,o=d(f,p),c):[o(0),o(1)]}}return c.range=u($u),c.rangeRound=u(pC),c.unknown=function(d){return arguments.length?(l=d,c):l},function(d){return i=d,n=d(t),r=d(e),s=n===r?0:1/(r-n),c}}function ma(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function LM(){var t=pa(rx()(sr));return t.copy=function(){return ma(t,LM())},ho.apply(t,arguments)}function jM(){var t=yC(rx()).domain([1,10]);return t.copy=function(){return ma(t,jM()).base(t.base())},ho.apply(t,arguments)}function zM(){var t=vC(rx());return t.copy=function(){return ma(t,zM()).constant(t.constant())},ho.apply(t,arguments)}function AC(){var t=bC(rx());return t.copy=function(){return ma(t,AC()).exponent(t.exponent())},ho.apply(t,arguments)}function g9(){return AC.apply(null,arguments).exponent(.5)}function BM(){var t=[],e=sr;function n(r){if(r!=null&&!isNaN(r=+r))return e((Hh(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let s of r)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(Ho),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,s)=>e(s/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(s,i)=>tq(t,i/r))},n.copy=function(){return BM(e).domain(t)},ho.apply(n,arguments)}function sx(){var t=0,e=.5,n=1,r=1,s,i,o,a,l,c=sr,u,d=!1,h;function f(m){return isNaN(m=+m)?h:(m=.5+((m=+u(m))-i)*(r*m<r*i?a:l),c(d?Math.max(0,Math.min(1,m)):m))}f.domain=function(m){return arguments.length?([t,e,n]=m,s=u(t=+t),i=u(e=+e),o=u(n=+n),a=s===i?0:.5/(i-s),l=i===o?0:.5/(o-i),r=i<s?-1:1,f):[t,e,n]},f.clamp=function(m){return arguments.length?(d=!!m,f):d},f.interpolator=function(m){return arguments.length?(c=m,f):c};function p(m){return function(x){var g,y,b;return arguments.length?([g,y,b]=x,c=Eq(m,[g,y,b]),f):[c(0),c(.5),c(1)]}}return f.range=p($u),f.rangeRound=p(pC),f.unknown=function(m){return arguments.length?(h=m,f):h},function(m){return u=m,s=m(t),i=m(e),o=m(n),a=s===i?0:.5/(i-s),l=i===o?0:.5/(o-i),r=i<s?-1:1,f}}function WM(){var t=pa(sx()(sr));return t.copy=function(){return ma(t,WM())},ho.apply(t,arguments)}function UM(){var t=yC(sx()).domain([.1,1,10]);return t.copy=function(){return ma(t,UM()).base(t.base())},ho.apply(t,arguments)}function VM(){var t=vC(sx());return t.copy=function(){return ma(t,VM()).constant(t.constant())},ho.apply(t,arguments)}function DC(){var t=bC(sx());return t.copy=function(){return ma(t,DC()).exponent(t.exponent())},ho.apply(t,arguments)}function x9(){return DC.apply(null,arguments).exponent(.5)}const Ed=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:dC,scaleDiverging:WM,scaleDivergingLog:UM,scaleDivergingPow:DC,scaleDivergingSqrt:x9,scaleDivergingSymlog:VM,scaleIdentity:kM,scaleImplicit:M1,scaleLinear:wM,scaleLog:SM,scaleOrdinal:uC,scalePoint:sq,scalePow:wC,scaleQuantile:$M,scaleQuantize:EM,scaleRadial:NM,scaleSequential:LM,scaleSequentialLog:jM,scaleSequentialPow:AC,scaleSequentialQuantile:BM,scaleSequentialSqrt:g9,scaleSequentialSymlog:zM,scaleSqrt:Qq,scaleSymlog:IM,scaleThreshold:TM,scaleTime:p9,scaleUtc:m9,tickFormat:bM},Symbol.toStringTag,{value:"Module"}));var Ll=t=>t.chartData,OC=X([Ll],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),ix=(t,e,n,r)=>r?OC(t):Ll(t);function lu(t){if(Array.isArray(t)&&t.length===2){var[e,n]=t;if(On(e)&&On(n))return!0}return!1}function nT(t,e,n){return n?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function y9(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,r]=t,s,i;if(On(n))s=n;else if(typeof n=="function")return;if(On(r))i=r;else if(typeof r=="function")return;var o=[s,i];if(lu(o))return o}}function v9(t,e,n){if(!(!n&&e==null)){if(typeof t=="function"&&e!=null)try{var r=t(e,n);if(lu(r))return nT(r,e,n)}catch{}if(Array.isArray(t)&&t.length===2){var[s,i]=t,o,a;if(s==="auto")e!=null&&(o=Math.min(...e));else if(Ne(s))o=s;else if(typeof s=="function")try{e!=null&&(o=s(e==null?void 0:e[0]))}catch{}else if(typeof s=="string"&&sE.test(s)){var l=sE.exec(s);if(l==null||e==null)o=void 0;else{var c=+l[1];o=e[0]-c}}else o=e==null?void 0:e[0];if(i==="auto")e!=null&&(a=Math.max(...e));else if(Ne(i))a=i;else if(typeof i=="function")try{e!=null&&(a=i(e==null?void 0:e[1]))}catch{}else if(typeof i=="string"&&iE.test(i)){var u=iE.exec(i);if(u==null||e==null)a=void 0;else{var d=+u[1];a=e[1]+d}}else a=e==null?void 0:e[1];var h=[o,a];if(lu(h))return e==null?h:nT(h,e,n)}}}var Eu=1e9,b9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},PC,Nt=!0,bs="[DecimalError] ",sl=bs+"Invalid argument: ",RC=bs+"Exponent out of range: ",Tu=Math.floor,Ma=Math.pow,w9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Mr,mn=1e7,wt=7,GM=9007199254740991,Sg=Tu(GM/wt),me={};me.absoluteValue=me.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};me.comparedTo=me.cmp=function(t){var e,n,r,s,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(r=i.d.length,s=t.d.length,e=0,n=r<s?r:s;e<n;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return r===s?0:r>s^i.s<0?1:-1};me.decimalPlaces=me.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*wt;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};me.dividedBy=me.div=function(t){return Hi(this,new this.constructor(t))};me.dividedToIntegerBy=me.idiv=function(t){var e=this,n=e.constructor;return ht(Hi(e,new n(t),0,1),n.precision)};me.equals=me.eq=function(t){return!this.cmp(t)};me.exponent=function(){return Jt(this)};me.greaterThan=me.gt=function(t){return this.cmp(t)>0};me.greaterThanOrEqualTo=me.gte=function(t){return this.cmp(t)>=0};me.isInteger=me.isint=function(){return this.e>this.d.length-2};me.isNegative=me.isneg=function(){return this.s<0};me.isPositive=me.ispos=function(){return this.s>0};me.isZero=function(){return this.s===0};me.lessThan=me.lt=function(t){return this.cmp(t)<0};me.lessThanOrEqualTo=me.lte=function(t){return this.cmp(t)<1};me.logarithm=me.log=function(t){var e,n=this,r=n.constructor,s=r.precision,i=s+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(Mr))throw Error(bs+"NaN");if(n.s<1)throw Error(bs+(n.s?"NaN":"-Infinity"));return n.eq(Mr)?new r(0):(Nt=!1,e=Hi(wh(n,i),wh(t,i),i),Nt=!0,ht(e,s))};me.minus=me.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?qM(e,t):HM(e,(t.s=-t.s,t))};me.modulo=me.mod=function(t){var e,n=this,r=n.constructor,s=r.precision;if(t=new r(t),!t.s)throw Error(bs+"NaN");return n.s?(Nt=!1,e=Hi(n,t,0,1).times(t),Nt=!0,n.minus(e)):ht(new r(n),s)};me.naturalExponential=me.exp=function(){return KM(this)};me.naturalLogarithm=me.ln=function(){return wh(this)};me.negated=me.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};me.plus=me.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?HM(e,t):qM(e,(t.s=-t.s,t))};me.precision=me.sd=function(t){var e,n,r,s=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(sl+t);if(e=Jt(s)+1,r=s.d.length-1,n=r*wt+1,r=s.d[r],r){for(;r%10==0;r/=10)n--;for(r=s.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};me.squareRoot=me.sqrt=function(){var t,e,n,r,s,i,o,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(bs+"NaN")}for(t=Jt(a),Nt=!1,s=Math.sqrt(+a),s==0||s==1/0?(e=di(a.d),(e.length+t)%2==0&&(e+="0"),s=Math.sqrt(e),t=Tu((t+1)/2)-(t<0||t%2),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(s.toString()),n=l.precision,s=o=n+3;;)if(i=r,r=i.plus(Hi(a,i,o+2)).times(.5),di(i.d).slice(0,o)===(e=di(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),s==o&&e=="4999"){if(ht(i,n+1,0),i.times(i).eq(a)){r=i;break}}else if(e!="9999")break;o+=4}return Nt=!0,ht(r,n)};me.times=me.mul=function(t){var e,n,r,s,i,o,a,l,c,u=this,d=u.constructor,h=u.d,f=(t=new d(t)).d;if(!u.s||!t.s)return new d(0);for(t.s*=u.s,n=u.e+t.e,l=h.length,c=f.length,l<c&&(i=h,h=f,f=i,o=l,l=c,c=o),i=[],o=l+c,r=o;r--;)i.push(0);for(r=c;--r>=0;){for(e=0,s=l+r;s>r;)a=i[s]+f[r]*h[s-r-1]+e,i[s--]=a%mn|0,e=a/mn|0;i[s]=(i[s]+e)%mn|0}for(;!i[--o];)i.pop();return e?++n:i.shift(),t.d=i,t.e=n,Nt?ht(t,d.precision):t};me.toDecimalPlaces=me.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(wi(t,0,Eu),e===void 0?e=r.rounding:wi(e,0,8),ht(n,t+Jt(n)+1,e))};me.toExponential=function(t,e){var n,r=this,s=r.constructor;return t===void 0?n=gl(r,!0):(wi(t,0,Eu),e===void 0?e=s.rounding:wi(e,0,8),r=ht(new s(r),t+1,e),n=gl(r,!0,t+1)),n};me.toFixed=function(t,e){var n,r,s=this,i=s.constructor;return t===void 0?gl(s):(wi(t,0,Eu),e===void 0?e=i.rounding:wi(e,0,8),r=ht(new i(s),t+Jt(s)+1,e),n=gl(r.abs(),!1,t+Jt(r)+1),s.isneg()&&!s.isZero()?"-"+n:n)};me.toInteger=me.toint=function(){var t=this,e=t.constructor;return ht(new e(t),Jt(t)+1,e.rounding)};me.toNumber=function(){return+this};me.toPower=me.pow=function(t){var e,n,r,s,i,o,a=this,l=a.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(Mr);if(a=new l(a),!a.s){if(t.s<1)throw Error(bs+"Infinity");return a}if(a.eq(Mr))return a;if(r=l.precision,t.eq(Mr))return ht(a,r);if(e=t.e,n=t.d.length-1,o=e>=n,i=a.s,o){if((n=u<0?-u:u)<=GM){for(s=new l(Mr),e=Math.ceil(r/wt+4),Nt=!1;n%2&&(s=s.times(a),sT(s.d,e)),n=Tu(n/2),n!==0;)a=a.times(a),sT(a.d,e);return Nt=!0,t.s<0?new l(Mr).div(s):ht(s,r)}}else if(i<0)throw Error(bs+"NaN");return i=i<0&&t.d[Math.max(e,n)]&1?-1:1,a.s=1,Nt=!1,s=t.times(wh(a,r+c)),Nt=!0,s=KM(s),s.s=i,s};me.toPrecision=function(t,e){var n,r,s=this,i=s.constructor;return t===void 0?(n=Jt(s),r=gl(s,n<=i.toExpNeg||n>=i.toExpPos)):(wi(t,1,Eu),e===void 0?e=i.rounding:wi(e,0,8),s=ht(new i(s),t,e),n=Jt(s),r=gl(s,t<=n||n<=i.toExpNeg,t)),r};me.toSignificantDigits=me.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(wi(t,1,Eu),e===void 0?e=r.rounding:wi(e,0,8)),ht(new r(n),t,e)};me.toString=me.valueOf=me.val=me.toJSON=me[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Jt(t),n=t.constructor;return gl(t,e<=n.toExpNeg||e>=n.toExpPos)};function HM(t,e){var n,r,s,i,o,a,l,c,u=t.constructor,d=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Nt?ht(e,d):e;if(l=t.d,c=e.d,o=t.e,s=e.e,l=l.slice(),i=o-s,i){for(i<0?(r=l,i=-i,a=c.length):(r=c,s=o,a=l.length),o=Math.ceil(d/wt),a=o>a?o+1:a+1,i>a&&(i=a,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(a=l.length,i=c.length,a-i<0&&(i=a,r=c,c=l,l=r),n=0;i;)n=(l[--i]=l[i]+c[i]+n)/mn|0,l[i]%=mn;for(n&&(l.unshift(n),++s),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=s,Nt?ht(e,d):e}function wi(t,e,n){if(t!==~~t||t<e||t>n)throw Error(sl+t)}function di(t){var e,n,r,s=t.length-1,i="",o=t[0];if(s>0){for(i+=o,e=1;e<s;e++)r=t[e]+"",n=wt-r.length,n&&(i+=Eo(n)),i+=r;o=t[e],r=o+"",n=wt-r.length,n&&(i+=Eo(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Hi=function(){function t(r,s){var i,o=0,a=r.length;for(r=r.slice();a--;)i=r[a]*s+o,r[a]=i%mn|0,o=i/mn|0;return o&&r.unshift(o),r}function e(r,s,i,o){var a,l;if(i!=o)l=i>o?1:-1;else for(a=l=0;a<i;a++)if(r[a]!=s[a]){l=r[a]>s[a]?1:-1;break}return l}function n(r,s,i){for(var o=0;i--;)r[i]-=o,o=r[i]<s[i]?1:0,r[i]=o*mn+r[i]-s[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,s,i,o){var a,l,c,u,d,h,f,p,m,x,g,y,b,w,k,C,S,I,$=r.constructor,E=r.s==s.s?1:-1,A=r.d,D=s.d;if(!r.s)return new $(r);if(!s.s)throw Error(bs+"Division by zero");for(l=r.e-s.e,S=D.length,k=A.length,f=new $(E),p=f.d=[],c=0;D[c]==(A[c]||0);)++c;if(D[c]>(A[c]||0)&&--l,i==null?y=i=$.precision:o?y=i+(Jt(r)-Jt(s))+1:y=i,y<0)return new $(0);if(y=y/wt+2|0,c=0,S==1)for(u=0,D=D[0],y++;(c<k||u)&&y--;c++)b=u*mn+(A[c]||0),p[c]=b/D|0,u=b%D|0;else{for(u=mn/(D[0]+1)|0,u>1&&(D=t(D,u),A=t(A,u),S=D.length,k=A.length),w=S,m=A.slice(0,S),x=m.length;x<S;)m[x++]=0;I=D.slice(),I.unshift(0),C=D[0],D[1]>=mn/2&&++C;do u=0,a=e(D,m,S,x),a<0?(g=m[0],S!=x&&(g=g*mn+(m[1]||0)),u=g/C|0,u>1?(u>=mn&&(u=mn-1),d=t(D,u),h=d.length,x=m.length,a=e(d,m,h,x),a==1&&(u--,n(d,S<h?I:D,h))):(u==0&&(a=u=1),d=D.slice()),h=d.length,h<x&&d.unshift(0),n(m,d,x),a==-1&&(x=m.length,a=e(D,m,S,x),a<1&&(u++,n(m,S<x?I:D,x))),x=m.length):a===0&&(u++,m=[0]),p[c++]=u,a&&m[0]?m[x++]=A[w]||0:(m=[A[w]],x=1);while((w++<k||m[0]!==void 0)&&y--)}return p[0]||p.shift(),f.e=l,ht(f,o?i+Jt(f)+1:i)}}();function KM(t,e){var n,r,s,i,o,a,l=0,c=0,u=t.constructor,d=u.precision;if(Jt(t)>16)throw Error(RC+Jt(t));if(!t.s)return new u(Mr);for(e==null?(Nt=!1,a=d):a=e,o=new u(.03125);t.abs().gte(.1);)t=t.times(o),c+=5;for(r=Math.log(Ma(2,c))/Math.LN10*2+5|0,a+=r,n=s=i=new u(Mr),u.precision=a;;){if(s=ht(s.times(t),a),n=n.times(++l),o=i.plus(Hi(s,n,a)),di(o.d).slice(0,a)===di(i.d).slice(0,a)){for(;c--;)i=ht(i.times(i),a);return u.precision=d,e==null?(Nt=!0,ht(i,d)):i}i=o}}function Jt(t){for(var e=t.e*wt,n=t.d[0];n>=10;n/=10)e++;return e}function Hv(t,e,n){if(e>t.LN10.sd())throw Nt=!0,n&&(t.precision=n),Error(bs+"LN10 precision limit exceeded");return ht(new t(t.LN10),e)}function Eo(t){for(var e="";t--;)e+="0";return e}function wh(t,e){var n,r,s,i,o,a,l,c,u,d=1,h=10,f=t,p=f.d,m=f.constructor,x=m.precision;if(f.s<1)throw Error(bs+(f.s?"NaN":"-Infinity"));if(f.eq(Mr))return new m(0);if(e==null?(Nt=!1,c=x):c=e,f.eq(10))return e==null&&(Nt=!0),Hv(m,c);if(c+=h,m.precision=c,n=di(p),r=n.charAt(0),i=Jt(f),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)f=f.times(t),n=di(f.d),r=n.charAt(0),d++;i=Jt(f),r>1?(f=new m("0."+n),i++):f=new m(r+"."+n.slice(1))}else return l=Hv(m,c+2,x).times(i+""),f=wh(new m(r+"."+n.slice(1)),c-h).plus(l),m.precision=x,e==null?(Nt=!0,ht(f,x)):f;for(a=o=f=Hi(f.minus(Mr),f.plus(Mr),c),u=ht(f.times(f),c),s=3;;){if(o=ht(o.times(u),c),l=a.plus(Hi(o,new m(s),c)),di(l.d).slice(0,c)===di(a.d).slice(0,c))return a=a.times(2),i!==0&&(a=a.plus(Hv(m,c+2,x).times(i+""))),a=Hi(a,new m(d),c),m.precision=x,e==null?(Nt=!0,ht(a,x)):a;a=l,s+=2}}function rT(t,e){var n,r,s;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(r,s),e){if(s-=r,n=n-r-1,t.e=Tu(n/wt),t.d=[],r=(n+1)%wt,n<0&&(r+=wt),r<s){for(r&&t.d.push(+e.slice(0,r)),s-=wt;r<s;)t.d.push(+e.slice(r,r+=wt));e=e.slice(r),r=wt-e.length}else r-=s;for(;r--;)e+="0";if(t.d.push(+e),Nt&&(t.e>Sg||t.e<-Sg))throw Error(RC+n)}else t.s=0,t.e=0,t.d=[0];return t}function ht(t,e,n){var r,s,i,o,a,l,c,u,d=t.d;for(o=1,i=d[0];i>=10;i/=10)o++;if(r=e-o,r<0)r+=wt,s=e,c=d[u=0];else{if(u=Math.ceil((r+1)/wt),i=d.length,u>=i)return t;for(c=i=d[u],o=1;i>=10;i/=10)o++;r%=wt,s=r-wt+o}if(n!==void 0&&(i=Ma(10,o-s-1),a=c/i%10|0,l=e<0||d[u+1]!==void 0||c%i,l=n<4?(a||l)&&(n==0||n==(t.s<0?3:2)):a>5||a==5&&(n==4||l||n==6&&(r>0?s>0?c/Ma(10,o-s):0:d[u-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return l?(i=Jt(t),d.length=1,e=e-i-1,d[0]=Ma(10,(wt-e%wt)%wt),t.e=Tu(-e/wt)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=u,i=1,u--):(d.length=u+1,i=Ma(10,wt-r),d[u]=s>0?(c/Ma(10,o-s)%Ma(10,s)|0)*i:0),l)for(;;)if(u==0){(d[0]+=i)==mn&&(d[0]=1,++t.e);break}else{if(d[u]+=i,d[u]!=mn)break;d[u--]=0,i=1}for(r=d.length;d[--r]===0;)d.pop();if(Nt&&(t.e>Sg||t.e<-Sg))throw Error(RC+Jt(t));return t}function qM(t,e){var n,r,s,i,o,a,l,c,u,d,h=t.constructor,f=h.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new h(t),Nt?ht(e,f):e;if(l=t.d,d=e.d,r=e.e,c=t.e,l=l.slice(),o=c-r,o){for(u=o<0,u?(n=l,o=-o,a=d.length):(n=d,r=c,a=l.length),s=Math.max(Math.ceil(f/wt),a)+2,o>s&&(o=s,n.length=1),n.reverse(),s=o;s--;)n.push(0);n.reverse()}else{for(s=l.length,a=d.length,u=s<a,u&&(a=s),s=0;s<a;s++)if(l[s]!=d[s]){u=l[s]<d[s];break}o=0}for(u&&(n=l,l=d,d=n,e.s=-e.s),a=l.length,s=d.length-a;s>0;--s)l[a++]=0;for(s=d.length;s>o;){if(l[--s]<d[s]){for(i=s;i&&l[--i]===0;)l[i]=mn-1;--l[i],l[s]+=mn}l[s]-=d[s]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,Nt?ht(e,f):e):new h(0)}function gl(t,e,n){var r,s=Jt(t),i=di(t.d),o=i.length;return e?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+Eo(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+Eo(-s-1)+i,n&&(r=n-o)>0&&(i+=Eo(r))):s>=o?(i+=Eo(s+1-o),n&&(r=n-s-1)>0&&(i=i+"."+Eo(r))):((r=s+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(s+1===o&&(i+="."),i+=Eo(r))),t.s<0?"-"+i:i}function sT(t,e){if(t.length>e)return t.length=e,!0}function XM(t){var e,n,r;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(sl+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return rT(o,i.toString())}else if(typeof i!="string")throw Error(sl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,w9.test(i))rT(o,i);else throw Error(sl+i)}if(s.prototype=me,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=XM,s.config=s.set=k9,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return s.config(t),s}function k9(t){if(!t||typeof t!="object")throw Error(bs+"Object expected");var e,n,r,s=["precision",1,Eu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((r=t[n=s[e]])!==void 0)if(Tu(r)===r&&r>=s[e+1]&&r<=s[e+2])this[n]=r;else throw Error(sl+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(sl+n+": "+r);return this}var PC=XM(b9);Mr=new PC(1);const nt=PC;var C9=t=>t,YM={"@@functional/placeholder":!0},QM=t=>t===YM,iT=t=>function e(){return arguments.length===0||arguments.length===1&&QM(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},ZM=(t,e)=>t===1?e:iT(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var i=r.filter(o=>o!==YM).length;return i>=t?e(...r):ZM(t-i,iT(function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var c=r.map(u=>QM(u)?a.shift():u);return e(...c,...a)}))}),ox=t=>ZM(t.length,t),z1=(t,e)=>{for(var n=[],r=t;r<e;++r)n[r-t]=r;return n},S9=ox((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(n=>e[n]).map(t)),I9=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return C9;var s=n.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce((a,l)=>l(a),i(...arguments))}},B1=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),JM=t=>{var e=null,n=null;return function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return e&&s.every((o,a)=>{var l;return o===((l=e)===null||l===void 0?void 0:l[a])})||(e=s,n=t(...s)),n}};function eF(t){var e;return t===0?e=1:e=Math.floor(new nt(t).abs().log(10).toNumber())+1,e}function tF(t,e,n){for(var r=new nt(t),s=0,i=[];r.lt(e)&&s<1e5;)i.push(r.toNumber()),r=r.add(n),s++;return i}ox((t,e,n)=>{var r=+t,s=+e;return r+n*(s-r)});ox((t,e,n)=>{var r=e-+t;return r=r||1/0,(n-t)/r});ox((t,e,n)=>{var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});var nF=t=>{var[e,n]=t,[r,s]=[e,n];return e>n&&([r,s]=[n,e]),[r,s]},rF=(t,e,n)=>{if(t.lte(0))return new nt(0);var r=eF(t.toNumber()),s=new nt(10).pow(r),i=t.div(s),o=r!==1?.05:.1,a=new nt(Math.ceil(i.div(o).toNumber())).add(n).mul(o),l=a.mul(s);return e?new nt(l.toNumber()):new nt(Math.ceil(l.toNumber()))},N9=(t,e,n)=>{var r=new nt(1),s=new nt(t);if(!s.isint()&&n){var i=Math.abs(t);i<1?(r=new nt(10).pow(eF(t)-1),s=new nt(Math.floor(s.div(r).toNumber())).mul(r)):i>1&&(s=new nt(Math.floor(t)))}else t===0?s=new nt(Math.floor((e-1)/2)):n||(s=new nt(Math.floor(t)));var o=Math.floor((e-1)/2),a=I9(S9(l=>s.add(new nt(l-o).mul(r)).toNumber()),z1);return a(0,e)},sF=function(e,n,r,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-e)/(r-1)))return{step:new nt(0),tickMin:new nt(0),tickMax:new nt(0)};var o=rF(new nt(n).sub(e).div(r-1),s,i),a;e<=0&&n>=0?a=new nt(0):(a=new nt(e).add(n).div(2),a=a.sub(new nt(a).mod(o)));var l=Math.ceil(a.sub(e).div(o).toNumber()),c=Math.ceil(new nt(n).sub(a).div(o).toNumber()),u=l+c+1;return u>r?sF(e,n,r,s,i+1):(u<r&&(c=n>0?c+(r-u):c,l=n>0?l:l+(r-u)),{step:o,tickMin:a.sub(new nt(l).mul(o)),tickMax:a.add(new nt(c).mul(o))})};function $9(t){var[e,n]=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(r,2),[o,a]=nF([e,n]);if(o===-1/0||a===1/0){var l=a===1/0?[o,...z1(0,r-1).map(()=>1/0)]:[...z1(0,r-1).map(()=>-1/0),a];return e>n?B1(l):l}if(o===a)return N9(o,r,s);var{step:c,tickMin:u,tickMax:d}=sF(o,a,i,s,0),h=tF(u,d.add(new nt(.1).mul(c)),c);return e>n?B1(h):h}function E9(t,e){var[n,r]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=nF([n,r]);if(i===-1/0||o===1/0)return[n,r];if(i===o)return[i];var a=Math.max(e,2),l=rF(new nt(o).sub(i).div(a-1),s,0),c=[...tF(new nt(i),new nt(o),l),o];return s===!1&&(c=c.map(u=>Math.round(u))),n>r?B1(c):c}var T9=JM($9),A9=JM(E9),iF=t=>t.rootProps.maxBarSize,D9=t=>t.rootProps.barGap,oF=t=>t.rootProps.barCategoryGap,O9=t=>t.rootProps.barSize,Yh=t=>t.rootProps.stackOffset,_C=t=>t.options.chartName,aF=t=>t.rootProps.syncId,R9=t=>t.rootProps.syncMethod,lF=t=>t.options.eventEmitter,Mi={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},Rr={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},ax=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},P9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Mi.angleAxisId,includeHidden:!1,name:void 0,reversed:Mi.reversed,scale:Mi.scale,tick:Mi.tick,tickCount:void 0,ticks:void 0,type:Mi.type,unit:void 0},_9={allowDataOverflow:Rr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Rr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Rr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Rr.scale,tick:Rr.tick,tickCount:Rr.tickCount,ticks:void 0,type:Rr.type,unit:void 0},M9={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Mi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mi.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mi.scale,tick:Mi.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},F9={allowDataOverflow:Rr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Rr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Rr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Rr.scale,tick:Rr.tick,tickCount:Rr.tickCount,ticks:void 0,type:"category",unit:void 0},MC=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?M9:P9,FC=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?F9:_9,lx=t=>t.polarOptions,LC=X([co,uo,bn],V_),cF=X([lx,LC],(t,e)=>{if(t!=null)return or(t.innerRadius,e,0)}),uF=X([lx,LC],(t,e)=>{if(t!=null)return or(t.outerRadius,e,e*.8)}),L9=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:n}=t;return[e,n]},dF=X([lx],L9);X([MC,dF],ax);var hF=X([LC,cF,uF],(t,e,n)=>{if(!(t==null||e==null||n==null))return[e,n]});X([FC,hF],ax);var j9=X([Ge,lx,cF,uF,co,uo],(t,e,n,r,s,i)=>{if(!(t!=="centric"&&t!=="radial"||e==null||n==null||r==null)){var{cx:o,cy:a,startAngle:l,endAngle:c}=e;return{cx:or(o,s,s/2),cy:or(a,i,i/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:c,clockWise:!1}}}),Gt=(t,e)=>e,Qh=(t,e,n)=>n;function oT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ig(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oT(Object(n),!0).forEach(function(r){z9(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function z9(t,e,n){return(e=B9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B9(t){var e=W9(t,"string");return typeof e=="symbol"?e:e+""}function W9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var W1=[0,"auto"],Ar={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},fo=(t,e)=>{var n=t.cartesianAxis.xAxis[e];return n??Ar},Dr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:W1,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:X0},ga=(t,e)=>{var n=t.cartesianAxis.yAxis[e];return n??Dr},U9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},jC=(t,e)=>{var n=t.cartesianAxis.zAxis[e];return n??U9},Ht=(t,e,n)=>{switch(e){case"xAxis":return fo(t,n);case"yAxis":return ga(t,n);case"zAxis":return jC(t,n);case"angleAxis":return MC(t,n);case"radiusAxis":return FC(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},V9=(t,e,n)=>{switch(e){case"xAxis":return fo(t,n);case"yAxis":return ga(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},Zh=(t,e,n)=>{switch(e){case"xAxis":return fo(t,n);case"yAxis":return ga(t,n);case"angleAxis":return MC(t,n);case"radiusAxis":return FC(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},fF=t=>t.graphicalItems.countOfBars>0;function zC(t,e){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===e;case"yAxis":return"yAxisId"in n&&n.yAxisId===e;case"zAxis":return"zAxisId"in n&&n.zAxisId===e;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===e;default:return!1}}}var Jh=t=>t.graphicalItems.cartesianItems,G9=X([Gt,Qh],zC),BC=(t,e,n)=>t.filter(n).filter(r=>(e==null?void 0:e.includeHidden)===!0?!0:!r.hide),ef=X([Jh,Ht,G9],BC),pF=t=>t.filter(e=>e.stackId===void 0),H9=X([ef],pF),WC=t=>t.map(e=>e.data).filter(Boolean).flat(1),K9=X([ef],WC),UC=(t,e)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:s}=e;return t.length>0?t:n.slice(r,s+1)},cx=X([K9,ix],UC),VC=(t,e,n)=>(e==null?void 0:e.dataKey)!=null?t.map(r=>({value:dt(r,e.dataKey)})):n.length>0?n.map(r=>r.dataKey).flatMap(r=>t.map(s=>({value:dt(s,r)}))):t.map(r=>({value:r})),ux=X([cx,Ht,ef],VC);function mF(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function jl(t){return t.filter(e=>Jc(e)||e instanceof Date).map(Number).filter(e=>Vr(e)===!1)}function q9(t,e,n){return!n||typeof e!="number"||Vr(e)?[]:n.length?jl(n.flatMap(r=>{var s=dt(t,r.dataKey),i,o;if(Array.isArray(s)?[i,o]=s:i=o=s,!(!On(i)||!On(o)))return[e-i,e+o]})):[]}var gF=(t,e,n)=>{var r={},s=e.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),r);return Object.fromEntries(Object.entries(s).map(i=>{var[o,a]=i,l=a.map(c=>c.dataKey);return[o,{stackedData:_K(t,l,n),graphicalItems:a}]}))},kh=X([cx,ef,Yh],gF),xF=(t,e,n)=>{var{dataStartIndex:r,dataEndIndex:s}=e;if(n!=="zAxis"){var i=jK(t,r,s);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},X9=X([kh,Ll,Gt],xF),yF=(t,e,n,r)=>n.length>0?t.flatMap(s=>n.flatMap(i=>{var o,a,l=(o=i.errorBars)===null||o===void 0?void 0:o.filter(u=>mF(r,u)),c=dt(s,(a=e.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:c,errorDomain:q9(s,c,l)}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(s=>({value:dt(s,e.dataKey),errorDomain:[]})):t.map(s=>({value:s,errorDomain:[]})),Y9=X(cx,Ht,H9,Gt,yF);function Q9(t){var{value:e}=t;if(Jc(e)||e instanceof Date)return e}var Z9=t=>{var e=t.flatMap(r=>[r.value,r.errorDomain]).flat(1),n=jl(e);if(n.length!==0)return[Math.min(...n),Math.max(...n)]},J9=(t,e,n)=>{var r=t.map(Q9).filter(s=>s!=null);return n&&(e.dataKey==null||e.allowDuplicatedCategory&&_P(r))?uM(0,t.length):e.allowDuplicatedCategory?r:Array.from(new Set(r))},GC=t=>{var e;if(t==null||!("domain"in t))return W1;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var n=jl(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:W1},HC=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var s=n.filter(Boolean);if(s.length!==0){var i=s.flat(),o=Math.min(...i),a=Math.max(...i);return[o,a]}},vF=t=>t.referenceElements.dots,Au=(t,e,n)=>t.filter(r=>r.ifOverflow==="extendDomain").filter(r=>e==="xAxis"?r.xAxisId===n:r.yAxisId===n),eY=X([vF,Gt,Qh],Au),bF=t=>t.referenceElements.areas,tY=X([bF,Gt,Qh],Au),wF=t=>t.referenceElements.lines,nY=X([wF,Gt,Qh],Au),kF=(t,e)=>{var n=jl(t.map(r=>e==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},rY=X(eY,Gt,kF),CF=(t,e)=>{var n=jl(t.flatMap(r=>[e==="xAxis"?r.x1:r.y1,e==="xAxis"?r.x2:r.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},sY=X([tY,Gt],CF),SF=(t,e)=>{var n=jl(t.map(r=>e==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},iY=X(nY,Gt,SF),oY=X(rY,iY,sY,(t,e,n)=>HC(t,n,e)),IF=X([Ht],GC),KC=(t,e,n,r,s)=>{var i=y9(e,t.allowDataOverflow);return i??v9(e,HC(n,s,Z9(r)),t.allowDataOverflow)},aY=X([Ht,IF,X9,Y9,oY],KC),lY=[0,1],qC=(t,e,n,r,s,i,o)=>{if(!(t==null||n==null||n.length===0)){var{dataKey:a,type:l}=t,c=Ti(e,i);return c&&a==null?uM(0,n.length):l==="category"?J9(r,t,c):s==="expand"?lY:o}},XC=X([Ht,Ge,cx,ux,Yh,Gt,aY],qC),NF=(t,e,n,r,s)=>{if(t!=null){var{scale:i,type:o}=t;if(i==="auto")return e==="radial"&&s==="radiusAxis"?"band":e==="radial"&&s==="angleAxis"?"linear":o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var a="scale".concat(Uh(i));return a in Ed?a:"point"}}},Du=X([Ht,Ge,fF,_C,Gt],NF);function cY(t){if(t!=null){if(t in Ed)return Ed[t]();var e="scale".concat(Uh(t));if(e in Ed)return Ed[e]()}}function YC(t,e,n,r){if(!(n==null||r==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(r);var s=cY(e);if(s!=null){var i=s.domain(n).range(r);return AK(i),i}}}var QC=(t,e,n)=>{var r=GC(e);if(!(n!=="auto"&&n!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(r)&&(r[0]==="auto"||r[1]==="auto")&&lu(t))return T9(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&lu(t))return A9(t,e.tickCount,e.allowDecimals)}},ZC=X([XC,Zh,Du],QC),JC=(t,e,n,r)=>{if(r!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&lu(e)&&Array.isArray(n)&&n.length>0){var s=e[0],i=n[0],o=e[1],a=n[n.length-1];return[Math.min(s,i),Math.max(o,a)]}return e},uY=X([Ht,XC,ZC,Gt],JC),dY=X(ux,Ht,(t,e)=>{if(!(!e||e.type!=="number")){var n=1/0,r=Array.from(jl(t.map(a=>a.value))).sort((a,l)=>a-l);if(r.length<2)return 1/0;var s=r[r.length-1]-r[0];if(s===0)return 1/0;for(var i=0;i<r.length-1;i++){var o=r[i+1]-r[i];n=Math.min(n,o)}return n/s}}),$F=X(dY,Ge,oF,bn,(t,e,n,r)=>r,(t,e,n,r,s)=>{if(!On(t))return 0;var i=e==="vertical"?r.height:r.width;if(s==="gap")return t*i/2;if(s==="no-gap"){var o=or(n,t*i),a=t*i/2;return a-o-(a-o)/i*o}return 0}),hY=(t,e)=>{var n=fo(t,e);return n==null||typeof n.padding!="string"?0:$F(t,"xAxis",e,n.padding)},fY=(t,e)=>{var n=ga(t,e);return n==null||typeof n.padding!="string"?0:$F(t,"yAxis",e,n.padding)},pY=X(fo,hY,(t,e)=>{var n,r;if(t==null)return{left:0,right:0};var{padding:s}=t;return typeof s=="string"?{left:e,right:e}:{left:((n=s.left)!==null&&n!==void 0?n:0)+e,right:((r=s.right)!==null&&r!==void 0?r:0)+e}}),mY=X(ga,fY,(t,e)=>{var n,r;if(t==null)return{top:0,bottom:0};var{padding:s}=t;return typeof s=="string"?{top:e,bottom:e}:{top:((n=s.top)!==null&&n!==void 0?n:0)+e,bottom:((r=s.bottom)!==null&&r!==void 0?r:0)+e}}),gY=X([bn,pY,Q0,Y0,(t,e,n)=>n],(t,e,n,r,s)=>{var{padding:i}=r;return s?[i.left,n.width-i.right]:[t.left+e.left,t.left+t.width-e.right]}),xY=X([bn,Ge,mY,Q0,Y0,(t,e,n)=>n],(t,e,n,r,s,i)=>{var{padding:o}=s;return i?[r.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),tf=(t,e,n,r)=>{var s;switch(e){case"xAxis":return gY(t,n,r);case"yAxis":return xY(t,n,r);case"zAxis":return(s=jC(t,n))===null||s===void 0?void 0:s.range;case"angleAxis":return dF(t);case"radiusAxis":return hF(t,n);default:return}},EF=X([Ht,tf],ax),Ou=X([Ht,Du,uY,EF],YC);X(ef,Gt,(t,e)=>t.flatMap(n=>{var r;return(r=n.errorBars)!==null&&r!==void 0?r:[]}).filter(n=>mF(e,n)));function TF(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var dx=(t,e)=>e,hx=(t,e,n)=>n,yY=X(oC,dx,hx,(t,e,n)=>t.filter(r=>r.orientation===e).filter(r=>r.mirror===n).sort(TF)),vY=X(aC,dx,hx,(t,e,n)=>t.filter(r=>r.orientation===e).filter(r=>r.mirror===n).sort(TF)),AF=(t,e)=>({width:t.width,height:e.height}),bY=(t,e)=>{var n=typeof e.width=="number"?e.width:X0;return{width:n,height:t.height}},DF=X(bn,fo,AF),wY=(t,e,n)=>{switch(e){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},kY=(t,e,n)=>{switch(e){case"left":return t.left;case"right":return n-t.right;default:return 0}},CY=X(uo,bn,yY,dx,hx,(t,e,n,r,s)=>{var i={},o;return n.forEach(a=>{var l=AF(e,a);o==null&&(o=wY(e,r,t));var c=r==="top"&&!s||r==="bottom"&&s;i[a.id]=o-Number(c)*l.height,o+=(c?-1:1)*l.height}),i}),SY=X(co,bn,vY,dx,hx,(t,e,n,r,s)=>{var i={},o;return n.forEach(a=>{var l=bY(e,a);o==null&&(o=kY(e,r,t));var c=r==="left"&&!s||r==="right"&&s;i[a.id]=o-Number(c)*l.width,o+=(c?-1:1)*l.width}),i}),IY=(t,e)=>{var n=bn(t),r=fo(t,e);if(r!=null){var s=CY(t,r.orientation,r.mirror),i=s[e];return i==null?{x:n.left,y:0}:{x:n.left,y:i}}},NY=(t,e)=>{var n=bn(t),r=ga(t,e);if(r!=null){var s=SY(t,r.orientation,r.mirror),i=s[e];return i==null?{x:0,y:n.top}:{x:i,y:n.top}}},OF=X(bn,ga,(t,e)=>{var n=typeof e.width=="number"?e.width:X0;return{width:n,height:t.height}}),aT=(t,e,n)=>{switch(e){case"xAxis":return DF(t,n).width;case"yAxis":return OF(t,n).height;default:return}},RF=(t,e,n,r)=>{if(n!=null){var{allowDuplicatedCategory:s,type:i,dataKey:o}=n,a=Ti(t,r),l=e.map(c=>c.value);if(o&&a&&i==="category"&&s&&_P(l))return l}},eS=X([Ge,ux,Ht,Gt],RF),PF=(t,e,n,r)=>{if(!(n==null||n.dataKey==null)){var{type:s,scale:i}=n,o=Ti(t,r);if(o&&(s==="number"||i!=="auto"))return e.map(a=>a.value)}},tS=X([Ge,ux,Zh,Gt],PF);X([Ge,V9,Du,Ou,eS,tS,tf,ZC,Gt],(t,e,n,r,s,i,o,a,l)=>{if(e==null)return null;var c=Ti(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:i,duplicateDomain:s,isCategorical:c,niceTicks:a,range:o,realScaleType:n,scale:r}});var $Y=(t,e,n,r,s,i,o,a,l)=>{if(!(e==null||r==null)){var c=Ti(t,l),{type:u,ticks:d,tickCount:h}=e,f=n==="scaleBand"&&typeof r.bandwidth=="function"?r.bandwidth()/2:2,p=u==="category"&&r.bandwidth?r.bandwidth()/f:0;p=l==="angleAxis"&&i!=null&&i.length>=2?Tn(i[0]-i[1])*2*p:p;var m=d||s;if(m){var x=m.map((g,y)=>{var b=o?o.indexOf(g):g;return{index:y,coordinate:r(b)+p,value:g,offset:p}});return x.filter(g=>!Vr(g.coordinate))}return c&&a?a.map((g,y)=>({coordinate:r(g)+p,value:g,index:y,offset:p})):r.ticks?r.ticks(h).map(g=>({coordinate:r(g)+p,value:g,offset:p})):r.domain().map((g,y)=>({coordinate:r(g)+p,value:o?o[g]:g,index:y,offset:p}))}},_F=X([Ge,Zh,Du,Ou,ZC,tf,eS,tS,Gt],$Y),EY=(t,e,n,r,s,i,o)=>{if(!(e==null||n==null||r==null||r[0]===r[1])){var a=Ti(t,o),{tickCount:l}=e,c=0;return c=o==="angleAxis"&&(r==null?void 0:r.length)>=2?Tn(r[0]-r[1])*2*c:c,a&&i?i.map((u,d)=>({coordinate:n(u)+c,value:u,index:d,offset:c})):n.ticks?n.ticks(l).map(u=>({coordinate:n(u)+c,value:u,offset:c})):n.domain().map((u,d)=>({coordinate:n(u)+c,value:s?s[u]:u,index:d,offset:c}))}},ki=X([Ge,Zh,Ou,tf,eS,tS,Gt],EY),ws=X(Ht,Ou,(t,e)=>{if(!(t==null||e==null))return Ig(Ig({},t),{},{scale:e})}),TY=X([Ht,Du,XC,EF],YC);X((t,e,n)=>jC(t,n),TY,(t,e)=>{if(!(t==null||e==null))return Ig(Ig({},t),{},{scale:e})});var AY=X([Ge,oC,aC],(t,e,n)=>{switch(t){case"horizontal":return e.some(r=>r.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(r=>r.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),MF=t=>t.options.defaultTooltipEventType,FF=t=>t.options.validateTooltipEventTypes;function LF(t,e,n){if(t==null)return e;var r=t?"axis":"item";return n==null?e:n.includes(r)?r:e}function jF(t,e){var n=MF(t),r=FF(t);return LF(e,n,r)}var zF=(t,e)=>{var n,r=Number(e);if(!(Vr(r)||e==null))return r>=0?t==null||(n=t[r])===null||n===void 0?void 0:n.value:void 0},DY=t=>t.tooltip.settings,Oo={active:!1,index:null,dataKey:void 0,coordinate:void 0},OY={itemInteraction:{click:Oo,hover:Oo},axisInteraction:{click:Oo,hover:Oo},keyboardInteraction:Oo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},BF=Is({name:"tooltip",initialState:OY,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var n=Gi(t).tooltipItemPayloads.indexOf(e.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:RY,removeTooltipEntrySettings:PY,setTooltipSettingsState:oOe,setActiveMouseOverItemIndex:WF,mouseLeaveItem:_Y,mouseLeaveChart:UF,setActiveClickItemIndex:MY,setMouseOverAxisIndex:VF,setMouseClickAxisIndex:FY,setSyncInteraction:lT,setKeyboardInteraction:U1}=BF.actions,LY=BF.reducer;function cT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Zp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cT(Object(n),!0).forEach(function(r){jY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jY(t,e,n){return(e=zY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zY(t){var e=BY(t,"string");return typeof e=="symbol"?e:e+""}function BY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WY(t,e,n){return e==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function UY(t){return t.index!=null}var GF=(t,e,n,r)=>{if(e==null)return Oo;var s=WY(t,e,n);if(s==null)return Oo;if(s.active)return s;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var i=t.settings.active===!0;if(UY(s)){if(i)return Zp(Zp({},s),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Zp(Zp({},Oo),{},{coordinate:s.coordinate})},nS=(t,e)=>{var n=t==null?void 0:t.index;if(n==null)return null;var r=Number(n);if(!On(r))return n;var s=0,i=1/0;return e.length>0&&(i=e.length-1),String(Math.max(s,Math.min(r,i)))},HF=(t,e,n,r,s,i,o,a)=>{if(!(i==null||a==null)){var l=o[0],c=l==null?void 0:a(l.positions,i);if(c!=null)return c;var u=s==null?void 0:s[Number(i)];if(u)switch(n){case"horizontal":return{x:u.coordinate,y:(r.top+e)/2};default:return{x:(r.left+t)/2,y:u.coordinate}}}},KF=(t,e,n,r)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var s;return n==="hover"?s=t.itemInteraction.hover.dataKey:s=t.itemInteraction.click.dataKey,s==null&&r!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===s})},nf=t=>t.options.tooltipPayloadSearcher,rf=t=>t.tooltip;function uT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function dT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uT(Object(n),!0).forEach(function(r){VY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function VY(t,e,n){return(e=GY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GY(t){var e=HY(t,"string");return typeof e=="symbol"?e:e+""}function HY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KY(t,e,n){return Array.isArray(t)&&t&&e+n!==0?t.slice(e,n+1):t}function qY(t,e){return t??e}var qF=(t,e,n,r,s,i,o)=>{if(!(e==null||i==null)){var{chartData:a,computedData:l,dataStartIndex:c,dataEndIndex:u}=n,d=[];return t.reduce((h,f)=>{var p,{dataDefinedOnItem:m,settings:x}=f,g=qY(m,a),y=KY(g,c,u),b=(p=x==null?void 0:x.dataKey)!==null&&p!==void 0?p:r==null?void 0:r.dataKey,w=x==null?void 0:x.nameKey,k;if(r!=null&&r.dataKey&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?k=MP(y,r.dataKey,s):k=i(y,e,l,w),Array.isArray(k))k.forEach(S=>{var I=dT(dT({},x),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});h.push(oE({tooltipEntrySettings:I,dataKey:S.dataKey,payload:S.payload,value:dt(S.payload,S.dataKey),name:S.name}))});else{var C;h.push(oE({tooltipEntrySettings:x,dataKey:b,payload:k,value:dt(k,b),name:(C=dt(k,w))!==null&&C!==void 0?C:x==null?void 0:x.name}))}return h},d)}},kn=t=>{var e=Ge(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Ru=t=>t.tooltip.settings.axisId,Zn=t=>{var e=kn(t),n=Ru(t);return Zh(t,e,n)},rS=X([Zn,Ge,fF,_C,kn],NF),XY=X([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),YY=X([kn,Ru],zC),fx=X([XY,Zn,YY],BC),QY=X([fx],WC),zl=X([QY,Ll],UC),sS=X([zl,Zn,fx],VC),ZY=X([Zn],GC),JY=X([zl,fx,Yh],gF),eQ=X([JY,Ll,kn],xF),tQ=X([fx],pF),nQ=X([zl,Zn,tQ,kn],yF),rQ=X([vF,kn,Ru],Au),sQ=X([rQ,kn],kF),iQ=X([bF,kn,Ru],Au),oQ=X([iQ,kn],CF),aQ=X([wF,kn,Ru],Au),lQ=X([aQ,kn],SF),cQ=X([sQ,lQ,oQ],HC),uQ=X([Zn,ZY,eQ,nQ,cQ],KC),XF=X([Zn,Ge,zl,sS,Yh,kn,uQ],qC),dQ=X([XF,Zn,rS],QC),hQ=X([Zn,XF,dQ,kn],JC),YF=t=>{var e=kn(t),n=Ru(t),r=!1;return tf(t,e,n,r)},QF=X([Zn,YF],ax),fQ=X([Zn,rS,hQ,QF],YC),pQ=X([Ge,sS,Zn,kn],RF),mQ=X([Ge,sS,Zn,kn],PF),gQ=(t,e,n,r,s,i,o,a)=>{if(e){var{type:l}=e,c=Ti(t,a);if(r){var u=n==="scaleBand"&&r.bandwidth?r.bandwidth()/2:2,d=l==="category"&&r.bandwidth?r.bandwidth()/u:0;return d=a==="angleAxis"&&s!=null&&(s==null?void 0:s.length)>=2?Tn(s[0]-s[1])*2*d:d,c&&o?o.map((h,f)=>({coordinate:r(h)+d,value:h,index:f,offset:d})):r.domain().map((h,f)=>({coordinate:r(h)+d,value:i?i[h]:h,index:f,offset:d}))}}},xa=X([Ge,Zn,rS,fQ,YF,pQ,mQ,kn],gQ),iS=X([MF,FF,DY],(t,e,n)=>LF(n.shared,t,e)),ZF=t=>t.tooltip.settings.trigger,oS=t=>t.tooltip.settings.defaultIndex,px=X([rf,iS,ZF,oS],GF),na=X([px,zl],nS),JF=X([xa,na],zF),e3=X([px],t=>{if(t)return t.dataKey}),t3=X([rf,iS,ZF,oS],KF),xQ=X([co,uo,Ge,bn,xa,oS,t3,nf],HF),yQ=X([px,xQ],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),vQ=X([px],t=>t.active),bQ=X([t3,na,Ll,Zn,JF,nf,iS],qF),wQ=X([bQ],t=>{if(t!=null){var e=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(e))}}),kQ=()=>Te(_C),aS=(t,e)=>e,n3=(t,e,n)=>n,lS=(t,e,n,r)=>r,CQ=X(xa,t=>Jk(t,e=>e.coordinate)),cS=X([rf,aS,n3,lS],GF),r3=X([cS,zl],nS),s3=X([rf,aS,n3,lS],KF),Ng=X([co,uo,Ge,bn,xa,lS,s3,nf],HF);X([cS,Ng],(t,e)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:e});var SQ=X(xa,r3,zF);X([s3,r3,Ll,Zn,SQ,nf,aS],qF);X([cS],t=>({isActive:t.active,activeIndex:t.index}));var IQ=(t,e,n,r,s,i,o,a)=>{if(!(!t||!e||!r||!s||!i)){var l=zK(t.chartX,t.chartY,e,n,a);if(l){var c=WK(l,e),u=EK(c,o,i,r,s),d=BK(e,i,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},NQ=N.createContext(null),i3={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,d||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,p){var m=n?n+c:c;if(!this._events[m])return!1;var x=this._events[m],g=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),g){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,d),!0;case 4:return x.fn.call(x.context,u,d,h),!0;case 5:return x.fn.call(x.context,u,d,h,f),!0;case 6:return x.fn.call(x.context,u,d,h,f,p),!0}for(b=1,y=new Array(g-1);b<g;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,k;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(c,x[b].fn,void 0,!0),g){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,u);break;case 3:x[b].fn.call(x[b].context,u,d);break;case 4:x[b].fn.call(x[b].context,u,d,h);break;default:if(!y)for(k=1,y=new Array(g-1);k<g;k++)y[k-1]=arguments[k];x[b].fn.apply(x[b].context,y)}}return!0},a.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var m=0,x=[],g=p.length;m<g;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&x.push(p[m]);x.length?this._events[f]=x.length===1?x[0]:x:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(i3);var $Q=i3.exports;const EQ=Ei($Q);var $g=new EQ,hT="recharts.syncEvent.tooltip",fT="recharts.syncEvent.brush";function mx(t,e){if(e){var n=Number.parseInt(e,10);if(!Vr(n))return t==null?void 0:t[n]}}var TQ={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},o3=Is({name:"options",initialState:TQ,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),AQ=o3.reducer,{createEventEmitter:DQ}=o3.actions,OQ={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},a3=Is({name:"chartData",initialState:OQ,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:n,endIndex:r}=e.payload;n!=null&&(t.dataStartIndex=n),r!=null&&(t.dataEndIndex=r)}}}),{setChartData:pT,setDataStartEndIndexes:RQ,setComputedData:aOe}=a3.actions,PQ=a3.reducer,l3=()=>{};function _Q(){var t=Te(aF),e=Te(lF),n=Vt(),r=Te(R9),s=Te(xa),i=Z0(),o=X_(),a=Te(l=>l.rootProps.className);N.useEffect(()=>{if(t==null)return l3;var l=(c,u,d)=>{if(e!==d&&t===c){if(r==="index"){n(u);return}if(s!=null){var h;if(typeof r=="function"){var f={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},p=r(s,f);h=s[p]}else r==="value"&&(h=s.find(C=>String(C.value)===u.payload.label));var{coordinate:m}=u.payload;if(h==null||u.payload.active===!1||m==null||o==null){n(lT({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x,y:g}=m,y=Math.min(x,o.x+o.width),b=Math.min(g,o.y+o.height),w={x:i==="horizontal"?h.coordinate:y,y:i==="horizontal"?b:h.coordinate},k=lT({active:u.payload.active,coordinate:w,dataKey:u.payload.dataKey,index:String(h.index),label:u.payload.label});n(k)}}};return $g.on(hT,l),()=>{$g.off(hT,l)}},[a,n,e,t,r,s,i,o])}function MQ(){var t=Te(aF),e=Te(lF),n=Vt();N.useEffect(()=>{if(t==null)return l3;var r=(s,i,o)=>{e!==o&&t===s&&n(RQ(i))};return $g.on(fT,r),()=>{$g.off(fT,r)}},[n,e,t])}function FQ(){var t=Vt();N.useEffect(()=>{t(DQ())},[t]),_Q(),MQ()}var c3={},u3={},d3={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r,{signal:s,edges:i}={}){let o,a=null;const l=i!=null&&i.includes("leading"),c=i==null||i.includes("trailing"),u=()=>{a!==null&&(n.apply(o,a),o=void 0,a=null)},d=()=>{c&&u(),m()};let h=null;const f=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,d()},r)},p=()=>{h!==null&&(clearTimeout(h),h=null)},m=()=>{p(),o=void 0,a=null},x=()=>{u()},g=function(...y){if(s!=null&&s.aborted)return;o=this,a=y;const b=h==null;f(),l&&b&&u()};return g.schedule=f,g.cancel=m,g.flush=x,s==null||s.addEventListener("abort",m,{once:!0}),g}t.debounce=e})(d3);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=d3;function n(r,s=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:a=!0,maxWait:l}=i,c=Array(2);o&&(c[0]="leading"),a&&(c[1]="trailing");let u,d=null;const h=e.debounce(function(...m){u=r.apply(this,m),d=null},s,{edges:c}),f=function(...m){return l!=null&&(d===null&&(d=Date.now()),Date.now()-d>=l)?(u=r.apply(this,m),d=Date.now(),h.cancel(),h.schedule(),u):(h.apply(this,m),u)},p=()=>(h.flush(),u);return f.cancel=h.cancel,f.flush=p,f}t.debounce=n})(u3);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=u3;function n(r,s=0,i={}){const{leading:o=!0,trailing:a=!0}=i;return e.debounce(r,s,{leading:o,maxWait:s,trailing:a})}t.throttle=n})(c3);var LQ=c3.throttle;const jQ=Ei(LQ);var Kv=function(e,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i]};function mT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function qv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mT(Object(n),!0).forEach(function(r){zQ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function zQ(t,e,n){return(e=BQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cc=N.forwardRef((t,e)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:s="100%",height:i="100%",minWidth:o=0,minHeight:a,maxHeight:l,children:c,debounce:u=0,id:d,className:h,onResize:f,style:p={}}=t,m=N.useRef(null),x=N.useRef();x.current=f,N.useImperativeHandle(e,()=>m.current);var[g,y]=N.useState({containerWidth:r.width,containerHeight:r.height}),b=N.useCallback((k,C)=>{y(S=>{var I=Math.round(k),$=Math.round(C);return S.containerWidth===I&&S.containerHeight===$?S:{containerWidth:I,containerHeight:$}})},[]);N.useEffect(()=>{var k=$=>{var E,{width:A,height:D}=$[0].contentRect;b(A,D),(E=x.current)===null||E===void 0||E.call(x,A,D)};u>0&&(k=jQ(k,u,{trailing:!0,leading:!1}));var C=new ResizeObserver(k),{width:S,height:I}=m.current.getBoundingClientRect();return b(S,I),C.observe(m.current),()=>{C.disconnect()}},[b,u]);var w=N.useMemo(()=>{var{containerWidth:k,containerHeight:C}=g;if(k<0||C<0)return null;Kv(Ga(s)||Ga(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,i),Kv(!n||n>0,"The aspect(%s) must be greater than zero.",n);var S=Ga(s)?k:s,I=Ga(i)?C:i;return n&&n>0&&(S?I=S/n:I&&(S=I*n),l&&I>l&&(I=l)),Kv(S>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,I,s,i,o,a,n),N.Children.map(c,$=>N.cloneElement($,{width:S,height:I,style:qv({width:S,height:I},$.props.style)}))},[n,c,i,l,a,o,g,s]);return N.createElement("div",{id:d?"".concat(d):void 0,className:ot("recharts-responsive-container",h),style:qv(qv({},p),{},{width:s,height:i,minWidth:o,minHeight:a,maxHeight:l}),ref:m},N.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),Pu=t=>null;Pu.displayName="Cell";function gT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function V1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gT(Object(n),!0).forEach(function(r){UQ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function UQ(t,e,n){return(e=VQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nc={widthCache:{},cacheCount:0},HQ=2e3,KQ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},xT="recharts_measurement_span";function qQ(t){var e=V1({},t);return Object.keys(e).forEach(n=>{e[n]||delete e[n]}),e}var Hd=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||_l.isSsr)return{width:0,height:0};var r=qQ(n),s=JSON.stringify({text:e,copyStyle:r});if(nc.widthCache[s])return nc.widthCache[s];try{var i=document.getElementById(xT);i||(i=document.createElement("span"),i.setAttribute("id",xT),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=V1(V1({},KQ),r);Object.assign(i.style,o),i.textContent="".concat(e);var a=i.getBoundingClientRect(),l={width:a.width,height:a.height};return nc.widthCache[s]=l,++nc.cacheCount>HQ&&(nc.cacheCount=0,nc.widthCache={}),l}catch{return{width:0,height:0}}},yT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XQ=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,YQ=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,h3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QQ=Object.keys(h3),Sc="NaN";function ZQ(t,e){return t*h3[e]}class mr{static parse(e){var n,[,r,s]=(n=YQ.exec(e))!==null&&n!==void 0?n:[];return new mr(parseFloat(r),s??"")}constructor(e,n){this.num=e,this.unit=n,this.num=e,this.unit=n,Vr(e)&&(this.unit=""),n!==""&&!XQ.test(n)&&(this.num=NaN,this.unit=""),QQ.includes(n)&&(this.num=ZQ(e,n),this.unit="px")}add(e){return this.unit!==e.unit?new mr(NaN,""):new mr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new mr(NaN,""):new mr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new mr(NaN,""):new mr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new mr(NaN,""):new mr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vr(this.num)}}function f3(t){if(t.includes(Sc))return Sc;for(var e=t;e.includes("*")||e.includes("/");){var n,[,r,s,i]=(n=yT.exec(e))!==null&&n!==void 0?n:[],o=mr.parse(r??""),a=mr.parse(i??""),l=s==="*"?o.multiply(a):o.divide(a);if(l.isNaN())return Sc;e=e.replace(yT,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var c,[,u,d,h]=(c=vT.exec(e))!==null&&c!==void 0?c:[],f=mr.parse(u??""),p=mr.parse(h??""),m=d==="+"?f.add(p):f.subtract(p);if(m.isNaN())return Sc;e=e.replace(vT,m.toString())}return e}var bT=/\(([^()]*)\)/;function JQ(t){for(var e=t,n;(n=bT.exec(e))!=null;){var[,r]=n;e=e.replace(bT,f3(r))}return e}function eZ(t){var e=t.replace(/\s+/g,"");return e=JQ(e),e=f3(e),e}function tZ(t){try{return eZ(t)}catch{return Sc}}function Xv(t){var e=tZ(t.slice(5,-1));return e===Sc?"":e}var nZ=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],rZ=["dx","dy","angle","className","breakAll"];function G1(){return G1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},G1.apply(null,arguments)}function wT(t,e){if(t==null)return{};var n,r,s=sZ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function sZ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var p3=/[ \f\n\r\t\v\u2028\u2029]+/,m3=t=>{var{children:e,breakAll:n,style:r}=t;try{var s=[];lt(e)||(n?s=e.toString().split(""):s=e.toString().split(p3));var i=s.map(a=>({word:a,width:Hd(a,r).width})),o=n?0:Hd("",r).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},iZ=(t,e,n,r,s)=>{var{maxLines:i,children:o,style:a,breakAll:l}=t,c=Ne(i),u=o,d=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return A.reduce((D,P)=>{var{word:O,width:F}=P,U=D[D.length-1];if(U&&(r==null||s||U.width+F+n<Number(r)))U.words.push(O),U.width+=F+n;else{var V={words:[O],width:F};D.push(V)}return D},[])},h=d(e),f=E=>E.reduce((A,D)=>A.width>D.width?A:D);if(!c||s)return h;var p=h.length>i||f(h).width>Number(r);if(!p)return h;for(var m="",x=E=>{var A=u.slice(0,E),D=m3({breakAll:l,style:a,children:A+m}).wordsWithComputedWidth,P=d(D),O=P.length>i||f(P).width>Number(r);return[O,P]},g=0,y=u.length-1,b=0,w;g<=y&&b<=u.length-1;){var k=Math.floor((g+y)/2),C=k-1,[S,I]=x(C),[$]=x(k);if(!S&&!$&&(g=k+1),S&&$&&(y=k-1),!S&&$){w=I;break}b++}return w||h},kT=t=>{var e=lt(t)?[]:t.toString().split(p3);return[{words:e}]},oZ=t=>{var{width:e,scaleToFit:n,children:r,style:s,breakAll:i,maxLines:o}=t;if((e||n)&&!_l.isSsr){var a,l,c=m3({breakAll:i,children:r,style:s});if(c){var{wordsWithComputedWidth:u,spaceWidth:d}=c;a=u,l=d}else return kT(r);return iZ({breakAll:i,children:r,maxLines:o,style:s},a,l,e,n)}return kT(r)},CT="#808080",gx=N.forwardRef((t,e)=>{var{x:n=0,y:r=0,lineHeight:s="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:a="start",verticalAnchor:l="end",fill:c=CT}=t,u=wT(t,nZ),d=N.useMemo(()=>oZ({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:h,dy:f,angle:p,className:m,breakAll:x}=u,g=wT(u,rZ);if(!Jc(n)||!Jc(r))return null;var y=n+(Ne(h)?h:0),b=r+(Ne(f)?f:0),w;switch(l){case"start":w=Xv("calc(".concat(i,")"));break;case"middle":w=Xv("calc(".concat((d.length-1)/2," * -").concat(s," + (").concat(i," / 2))"));break;default:w=Xv("calc(".concat(d.length-1," * -").concat(s,")"));break}var k=[];if(o){var C=d[0].width,{width:S}=u;k.push("scale(".concat(Ne(S)?S/C:1,")"))}return p&&k.push("rotate(".concat(p,", ").concat(y,", ").concat(b,")")),k.length&&(g.transform=k.join(" ")),N.createElement("text",G1({},je(g,!0),{ref:e,x:y,y:b,className:ot("recharts-text",m),textAnchor:a,fill:c.includes("url")?CT:c}),d.map((I,$)=>{var E=I.words.join(x?"":" ");return N.createElement("tspan",{x:y,dy:$===0?w:s,key:"".concat(E,"-").concat($)},E)}))});gx.displayName="Text";var aZ=["offset"],lZ=["labelRef"];function ST(t,e){if(t==null)return{};var n,r,s=cZ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function cZ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function IT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function qt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IT(Object(n),!0).forEach(function(r){uZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uZ(t,e,n){return(e=dZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dZ(t){var e=hZ(t,"string");return typeof e=="symbol"?e:e+""}function hZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fi(){return Fi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fi.apply(null,arguments)}var fZ=t=>{var{value:e,formatter:n}=t,r=lt(t.children)?e:t.children;return typeof n=="function"?n(r):r},uS=t=>t!=null&&typeof t=="function",pZ=(t,e)=>{var n=Tn(e-t),r=Math.min(Math.abs(e-t),360);return n*r},mZ=(t,e,n)=>{var{position:r,viewBox:s,offset:i,className:o}=t,{cx:a,cy:l,innerRadius:c,outerRadius:u,startAngle:d,endAngle:h,clockWise:f}=s,p=(c+u)/2,m=pZ(d,h),x=m>=0?1:-1,g,y;r==="insideStart"?(g=d+x*i,y=f):r==="insideEnd"?(g=h-x*i,y=!f):r==="end"&&(g=h+x*i,y=f),y=m<=0?y:!y;var b=qn(a,l,p,g),w=qn(a,l,p,g+(y?1:-1)*359),k="M".concat(b.x,",").concat(b.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),C=lt(t.id)?ta("recharts-radial-line-"):t.id;return N.createElement("text",Fi({},n,{dominantBaseline:"central",className:ot("recharts-radial-bar-label",o)}),N.createElement("defs",null,N.createElement("path",{id:C,d:k})),N.createElement("textPath",{xlinkHref:"#".concat(C)},e))},gZ=t=>{var{viewBox:e,offset:n,position:r}=t,{cx:s,cy:i,innerRadius:o,outerRadius:a,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:h}=qn(s,i,a+n,u);return{x:d,y:h,textAnchor:d>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:i,textAnchor:"middle",verticalAnchor:"end"};var f=(o+a)/2,{x:p,y:m}=qn(s,i,f,u);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}},xZ=(t,e)=>{var{parentViewBox:n,offset:r,position:s}=t,{x:i,y:o,width:a,height:l}=e,c=l>=0?1:-1,u=c*r,d=c>0?"end":"start",h=c>0?"start":"end",f=a>=0?1:-1,p=f*r,m=f>0?"end":"start",x=f>0?"start":"end";if(s==="top"){var g={x:i+a/2,y:o-c*r,textAnchor:"middle",verticalAnchor:d};return qt(qt({},g),n?{height:Math.max(o-n.y,0),width:a}:{})}if(s==="bottom"){var y={x:i+a/2,y:o+l+u,textAnchor:"middle",verticalAnchor:h};return qt(qt({},y),n?{height:Math.max(n.y+n.height-(o+l),0),width:a}:{})}if(s==="left"){var b={x:i-p,y:o+l/2,textAnchor:m,verticalAnchor:"middle"};return qt(qt({},b),n?{width:Math.max(b.x-n.x,0),height:l}:{})}if(s==="right"){var w={x:i+a+p,y:o+l/2,textAnchor:x,verticalAnchor:"middle"};return qt(qt({},w),n?{width:Math.max(n.x+n.width-w.x,0),height:l}:{})}var k=n?{width:a,height:l}:{};return s==="insideLeft"?qt({x:i+p,y:o+l/2,textAnchor:x,verticalAnchor:"middle"},k):s==="insideRight"?qt({x:i+a-p,y:o+l/2,textAnchor:m,verticalAnchor:"middle"},k):s==="insideTop"?qt({x:i+a/2,y:o+u,textAnchor:"middle",verticalAnchor:h},k):s==="insideBottom"?qt({x:i+a/2,y:o+l-u,textAnchor:"middle",verticalAnchor:d},k):s==="insideTopLeft"?qt({x:i+p,y:o+u,textAnchor:x,verticalAnchor:h},k):s==="insideTopRight"?qt({x:i+a-p,y:o+u,textAnchor:m,verticalAnchor:h},k):s==="insideBottomLeft"?qt({x:i+p,y:o+l-u,textAnchor:x,verticalAnchor:d},k):s==="insideBottomRight"?qt({x:i+a-p,y:o+l-u,textAnchor:m,verticalAnchor:d},k):s&&typeof s=="object"&&(Ne(s.x)||Ga(s.x))&&(Ne(s.y)||Ga(s.y))?qt({x:i+or(s.x,a),y:o+or(s.y,l),textAnchor:"end",verticalAnchor:"end"},k):qt({x:i+a/2,y:o+l/2,textAnchor:"middle",verticalAnchor:"middle"},k)},yZ=t=>"cx"in t&&Ne(t.cx);function _r(t){var{offset:e=5}=t,n=ST(t,aZ),r=qt({offset:e},n),{viewBox:s,position:i,value:o,children:a,content:l,className:c="",textBreakAll:u,labelRef:d}=r,h=X_(),f=s||h;if(!f||lt(o)&&lt(a)&&!N.isValidElement(l)&&typeof l!="function")return null;if(N.isValidElement(l)){var p=ST(r,lZ);return N.cloneElement(l,p)}var m;if(typeof l=="function"){if(m=N.createElement(l,r),N.isValidElement(m))return m}else m=fZ(r);var x=yZ(f),g=je(r,!0);if(x&&(i==="insideStart"||i==="insideEnd"||i==="end"))return mZ(r,m,g);var y=x?gZ(r):xZ(r,f);return N.createElement(gx,Fi({ref:d,className:ot("recharts-label",c)},g,y,{breakAll:u}),m)}_r.displayName="Label";var g3=t=>{var{cx:e,cy:n,angle:r,startAngle:s,endAngle:i,r:o,radius:a,innerRadius:l,outerRadius:c,x:u,y:d,top:h,left:f,width:p,height:m,clockWise:x,labelViewBox:g}=t;if(g)return g;if(Ne(p)&&Ne(m)){if(Ne(u)&&Ne(d))return{x:u,y:d,width:p,height:m};if(Ne(h)&&Ne(f))return{x:h,y:f,width:p,height:m}}if(Ne(u)&&Ne(d))return{x:u,y:d,width:0,height:0};if(Ne(e)&&Ne(n))return{cx:e,cy:n,startAngle:s||r||0,endAngle:i||r||0,innerRadius:l||0,outerRadius:c||a||o||0,clockWise:x};if(t.viewBox)return t.viewBox},vZ=(t,e,n)=>{if(!t)return null;var r={viewBox:e,labelRef:n};return t===!0?N.createElement(_r,Fi({key:"label-implicit"},r)):Jc(t)?N.createElement(_r,Fi({key:"label-implicit",value:t},r)):N.isValidElement(t)?t.type===_r?N.cloneElement(t,qt({key:"label-implicit"},r)):N.createElement(_r,Fi({key:"label-implicit",content:t},r)):uS(t)?N.createElement(_r,Fi({key:"label-implicit",content:t},r)):t&&typeof t=="object"?N.createElement(_r,Fi({},t,{key:"label-implicit"},r)):null},bZ=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:s,labelRef:i}=e,o=g3(e),a=Vh(s,_r).map((c,u)=>N.cloneElement(c,{viewBox:n||o,key:"label-".concat(u)}));if(!r)return a;var l=vZ(e.label,n||o,i);return[l,...a]};_r.parseViewBox=g3;_r.renderCallByParent=bZ;var x3={},y3={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n[n.length-1]}t.last=e})(y3);var v3={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=e})(v3);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=y3,n=v3,r=qk;function s(i){if(r.isArrayLike(i))return e.last(n.toArray(i))}t.last=s})(x3);var wZ=x3.last;const kZ=Ei(wZ);var CZ=["valueAccessor"],SZ=["data","dataKey","clockWise","id","textBreakAll"];function Eg(){return Eg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Eg.apply(null,arguments)}function NT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function $T(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NT(Object(n),!0).forEach(function(r){IZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function IZ(t,e,n){return(e=NZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NZ(t){var e=$Z(t,"string");return typeof e=="symbol"?e:e+""}function $Z(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ET(t,e){if(t==null)return{};var n,r,s=EZ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function EZ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var TZ=t=>Array.isArray(t.value)?kZ(t.value):t.value;function Ki(t){var{valueAccessor:e=TZ}=t,n=ET(t,CZ),{data:r,dataKey:s,clockWise:i,id:o,textBreakAll:a}=n,l=ET(n,SZ);return!r||!r.length?null:N.createElement(Ot,{className:"recharts-label-list"},r.map((c,u)=>{var d=lt(s)?e(c,u):dt(c&&c.payload,s),h=lt(o)?{}:{id:"".concat(o,"-").concat(u)};return N.createElement(_r,Eg({},je(c,!0),l,h,{parentViewBox:c.parentViewBox,value:d,textBreakAll:a,viewBox:_r.parseViewBox(lt(i)?c:$T($T({},c),{},{clockWise:i})),key:"label-".concat(u),index:u}))}))}Ki.displayName="LabelList";function AZ(t,e){return t?t===!0?N.createElement(Ki,{key:"labelList-implicit",data:e}):N.isValidElement(t)||uS(t)?N.createElement(Ki,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?N.createElement(Ki,Eg({data:e},t,{key:"labelList-implicit"})):null:null}function DZ(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:r}=t,s=Vh(r,Ki).map((o,a)=>N.cloneElement(o,{data:e,key:"labelList-".concat(a)}));if(!n)return s;var i=AZ(t.label,e);return[i,...s]}Ki.renderCallByParent=DZ;function H1(){return H1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H1.apply(null,arguments)}var dS=t=>{var{cx:e,cy:n,r,className:s}=t,i=ot("recharts-dot",s);return e===+e&&n===+n&&r===+r?N.createElement("circle",H1({},je(t,!1),Vk(t),{className:i,cx:e,cy:n,r})):null},b3=t=>t.graphicalItems.polarItems,OZ=X([Gt,Qh],zC),hS=X([b3,Ht,OZ],BC),RZ=X([hS],WC),fS=X([RZ,OC],UC),PZ=X([fS,Ht,hS],VC),_Z=X([fS,Ht,hS],(t,e,n)=>n.length>0?t.flatMap(r=>n.flatMap(s=>{var i,o=dt(r,(i=e.dataKey)!==null&&i!==void 0?i:s.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(r=>({value:dt(r,e.dataKey),errorDomain:[]})):t.map(r=>({value:r,errorDomain:[]}))),TT=()=>{},MZ=X([Ht,IF,TT,_Z,TT],KC),w3=X([Ht,Ge,fS,PZ,Yh,Gt,MZ],qC),FZ=X([w3,Ht,Du],QC);X([Ht,w3,FZ,Gt],JC);var LZ={radiusAxis:{},angleAxis:{}},jZ=Is({name:"polarAxis",initialState:LZ,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),zZ=jZ.reducer;function AT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function DT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AT(Object(n),!0).forEach(function(r){BZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function BZ(t,e,n){return(e=WZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WZ(t){var e=UZ(t,"string");return typeof e=="symbol"?e:e+""}function UZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pS=(t,e)=>e,VZ=[],mS=(t,e,n)=>(n==null?void 0:n.length)===0?VZ:n,k3=X([OC,pS,mS],(t,e,n)=>{var{chartData:r}=t,s;if((e==null?void 0:e.data)!=null&&e.data.length>0?s=e.data:s=r,(!s||!s.length)&&n!=null&&(s=n.map(i=>DT(DT({},e.presentationProps),i.props))),s!=null)return s}),GZ=X([k3,pS,mS],(t,e,n)=>{if(t!=null)return t.map((r,s)=>{var i,o=dt(r,e.nameKey,e.name),a;return n!=null&&(i=n[s])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?a=n[s].props.fill:typeof r=="object"&&r!=null&&"fill"in r?a=r.fill:a=e.fill,{value:fa(o,e.dataKey),color:a,payload:r,type:e.legendType}})}),HZ=X([b3,pS],(t,e)=>{if(t.some(n=>n.type==="pie"&&e.dataKey===n.dataKey&&e.data===n.data))return e}),KZ=X([k3,HZ,mS,bn],(t,e,n,r)=>{if(!(e==null||t==null))return MJ({offset:r,pieSettings:e,displayedData:t,cells:n})}),qZ={countOfBars:0,cartesianItems:[],polarItems:[]},C3=Is({name:"graphicalItems",initialState:qZ,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:n,next:r}=e.payload,s=Gi(t).cartesianItems.indexOf(n);s>-1&&(t.cartesianItems[s]=r)},removeCartesianGraphicalItem(t,e){var n=Gi(t).cartesianItems.indexOf(e.payload);n>-1&&t.cartesianItems.splice(n,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var n=Gi(t).polarItems.indexOf(e.payload);n>-1&&t.polarItems.splice(n,1)}}}),{addBar:XZ,removeBar:YZ,addCartesianGraphicalItem:QZ,replaceCartesianGraphicalItem:ZZ,removeCartesianGraphicalItem:JZ,addPolarGraphicalItem:eJ,removePolarGraphicalItem:tJ}=C3.actions,nJ=C3.reducer;function OT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function RT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OT(Object(n),!0).forEach(function(r){rJ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function rJ(t,e,n){return(e=sJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sJ(t){var e=iJ(t,"string");return typeof e=="symbol"?e:e+""}function iJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oJ(t){var e=Vt(),n=N.useRef(null);return N.useEffect(()=>{var r=RT(RT({},t),{},{stackId:iC(t.stackId)});n.current===null?e(QZ(r)):n.current!==r&&e(ZZ({prev:n.current,next:r})),n.current=r},[e,t]),N.useEffect(()=>()=>{n.current&&(e(JZ(n.current)),n.current=null)},[e]),null}function aJ(t){var e=Vt();return N.useEffect(()=>(e(eJ(t)),()=>{e(tJ(t))}),[e,t]),null}var S3={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var s;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const i=n[Symbol.toStringTag];return i==null||!((s=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&s.writable)?!1:n.toString()===`[object ${i}]`}let r=n;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(n)===r}t.isPlainObject=e})(S3);var lJ=S3.isPlainObject;const cJ=Ei(lJ);function Tg(){return Tg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Tg.apply(null,arguments)}var PT=(t,e,n,r,s)=>{var i=n-r,o;return o="M ".concat(t,",").concat(e),o+="L ".concat(t+n,",").concat(e),o+="L ".concat(t+n-i/2,",").concat(e+s),o+="L ".concat(t+n-i/2-r,",").concat(e+s),o+="L ".concat(t,",").concat(e," Z"),o},uJ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dJ=t=>{var e=ei(t,uJ),n=N.useRef(),[r,s]=N.useState(-1);N.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var x=n.current.getTotalLength();x&&s(x)}catch{}},[]);var{x:i,y:o,upperWidth:a,lowerWidth:l,height:c,className:u}=e,{animationEasing:d,animationDuration:h,animationBegin:f,isUpdateAnimationActive:p}=e;if(i!==+i||o!==+o||a!==+a||l!==+l||c!==+c||a===0&&l===0||c===0)return null;var m=ot("recharts-trapezoid",u);return p?N.createElement(eo,{canBegin:r>0,from:{upperWidth:0,lowerWidth:0,height:c,x:i,y:o},to:{upperWidth:a,lowerWidth:l,height:c,x:i,y:o},duration:h,animationEasing:d,isActive:p},x=>{var{upperWidth:g,lowerWidth:y,height:b,x:w,y:k}=x;return N.createElement(eo,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:h,easing:d},N.createElement("path",Tg({},je(e,!0),{className:m,d:PT(w,k,g,y,b),ref:n})))}):N.createElement("g",null,N.createElement("path",Tg({},je(e,!0),{className:m,d:PT(i,o,a,l,c)})))},hJ=["option","shapeType","propTransformer","activeClassName","isActive"];function fJ(t,e){if(t==null)return{};var n,r,s=pJ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function pJ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function _T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ag(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_T(Object(n),!0).forEach(function(r){mJ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_T(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function mJ(t,e,n){return(e=gJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gJ(t){var e=xJ(t,"string");return typeof e=="symbol"?e:e+""}function xJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yJ(t,e){return Ag(Ag({},e),t)}function vJ(t,e){return t==="symbols"}function MT(t){var{shapeType:e,elementProps:n}=t;switch(e){case"rectangle":return N.createElement(L7,n);case"trapezoid":return N.createElement(dJ,n);case"sector":return N.createElement(W7,n);case"symbols":if(vJ(e))return N.createElement(n_,n);break;default:return null}}function bJ(t){return N.isValidElement(t)?t.props:t}function I3(t){var{option:e,shapeType:n,propTransformer:r=yJ,activeClassName:s="recharts-active-shape",isActive:i}=t,o=fJ(t,hJ),a;if(N.isValidElement(e))a=N.cloneElement(e,Ag(Ag({},o),bJ(e)));else if(typeof e=="function")a=e(o);else if(cJ(e)&&typeof e!="boolean"){var l=r(e,o);a=N.createElement(MT,{shapeType:n,elementProps:l})}else{var c=o;a=N.createElement(MT,{shapeType:n,elementProps:c})}return i?N.createElement(Ot,{className:s},a):a}var gS=(t,e)=>{var n=Vt();return(r,s)=>i=>{t==null||t(r,s,i),n(WF({activeIndex:String(s),activeDataKey:e,activeCoordinate:r.tooltipPosition}))}},xS=t=>{var e=Vt();return(n,r)=>s=>{t==null||t(n,r,s),e(_Y())}},yS=(t,e)=>{var n=Vt();return(r,s)=>i=>{t==null||t(r,s,i),n(MY({activeIndex:String(s),activeDataKey:e,activeCoordinate:r.tooltipPosition}))}};function xx(t){var{fn:e,args:n}=t,r=Vt(),s=hr();return N.useEffect(()=>{if(!s){var i=e(n);return r(RY(i)),()=>{r(PY(i))}}},[e,n,r,s]),null}var N3=()=>{};function vS(t){var{legendPayload:e}=t,n=Vt(),r=hr();return N.useEffect(()=>r?N3:(n(Q_(e)),()=>{n(Z_(e))}),[n,r,e]),null}function wJ(t){var{legendPayload:e}=t,n=Vt(),r=Te(Ge);return N.useEffect(()=>r!=="centric"&&r!=="radial"?N3:(n(Q_(e)),()=>{n(Z_(e))}),[n,r,e]),null}function yx(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=N.useRef(ta(e)),r=N.useRef(t);return r.current!==t&&(n.current=ta(e),r.current=t),n.current}var kJ=["onMouseEnter","onClick","onMouseLeave"];function CJ(t,e){if(t==null)return{};var n,r,s=SJ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function SJ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function FT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FT(Object(n),!0).forEach(function(r){vx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function vx(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:e+""}function NJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xl(){return xl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xl.apply(null,arguments)}function $J(t){var e=N.useMemo(()=>je(t,!1),[t]),n=N.useMemo(()=>Vh(t.children,Pu),[t.children]),r=N.useMemo(()=>({name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,minAngle:t.minAngle,paddingAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,legendType:t.legendType,fill:t.fill,presentationProps:e}),[t.cornerRadius,t.cx,t.cy,t.data,t.dataKey,t.endAngle,t.innerRadius,t.minAngle,t.name,t.nameKey,t.outerRadius,t.paddingAngle,t.startAngle,t.tooltipType,t.legendType,t.fill,e]),s=Te(i=>GZ(i,r,n));return N.createElement(wJ,{legendPayload:s})}function EJ(t){var{dataKey:e,nameKey:n,sectors:r,stroke:s,strokeWidth:i,fill:o,name:a,hide:l,tooltipType:c}=t;return{dataDefinedOnItem:r==null?void 0:r.map(u=>u.tooltipPayload),positions:r==null?void 0:r.map(u=>u.tooltipPosition),settings:{stroke:s,strokeWidth:i,fill:o,dataKey:e,nameKey:n,name:fa(a,e),hide:l,type:c,color:o,unit:""}}}var TJ=(t,e)=>t>e?"start":t<e?"end":"middle",AJ=(t,e,n)=>typeof e=="function"?e(t):or(e,n,n*.8),DJ=(t,e,n)=>{var{top:r,left:s,width:i,height:o}=e,a=V_(i,o),l=s+or(t.cx,i,i/2),c=r+or(t.cy,o,o/2),u=or(t.innerRadius,a,0),d=AJ(n,t.outerRadius,a),h=t.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:h}},OJ=(t,e)=>{var n=Tn(e-t),r=Math.min(Math.abs(e-t),360);return n*r},RJ=(t,e)=>{if(N.isValidElement(t))return N.cloneElement(t,e);if(typeof t=="function")return t(e);var n=ot("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return N.createElement(Gd,xl({},e,{type:"linear",className:n}))},PJ=(t,e,n)=>{if(N.isValidElement(t))return N.cloneElement(t,e);var r=n;if(typeof t=="function"&&(r=t(e),N.isValidElement(r)))return r;var s=ot("recharts-pie-label-text",typeof t!="boolean"&&typeof t!="function"?t.className:"");return N.createElement(gx,xl({},e,{alignmentBaseline:"middle",className:s}),r)};function _J(t){var{sectors:e,props:n,showLabels:r}=t,{label:s,labelLine:i,dataKey:o}=n;if(!r||!s||!e)return null;var a=je(n,!1),l=je(s,!1),c=je(i,!1),u=typeof s=="object"&&"offsetRadius"in s&&s.offsetRadius||20,d=e.map((h,f)=>{var p=(h.startAngle+h.endAngle)/2,m=qn(h.cx,h.cy,h.outerRadius+u,p),x=Pt(Pt(Pt(Pt({},a),h),{},{stroke:"none"},l),{},{index:f,textAnchor:TJ(m.x,h.cx)},m),g=Pt(Pt(Pt(Pt({},a),h),{},{fill:"none",stroke:h.fill},c),{},{index:f,points:[qn(h.cx,h.cy,h.outerRadius,p),m],key:"line"});return N.createElement(Ot,{key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(f)},i&&RJ(i,g),PJ(s,x,dt(h,o)))});return N.createElement(Ot,{className:"recharts-pie-labels"},d)}function $3(t){var{sectors:e,activeShape:n,inactiveShape:r,allOtherPieProps:s,showLabels:i}=t,o=Te(na),{onMouseEnter:a,onClick:l,onMouseLeave:c}=s,u=CJ(s,kJ),d=gS(a,s.dataKey),h=xS(c),f=yS(l,s.dataKey);return e==null?null:N.createElement(N.Fragment,null,e.map((p,m)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&e.length!==1)return null;var x=n&&String(m)===o,g=o?r:null,y=x?n:g,b=Pt(Pt({},p),{},{stroke:p.stroke,tabIndex:-1,[H_]:m,[K_]:s.dataKey});return N.createElement(Ot,xl({tabIndex:-1,className:"recharts-pie-sector"},F0(u,p,m),{onMouseEnter:d(p,m),onMouseLeave:h(p,m),onClick:f(p,m),key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(m)}),N.createElement(I3,xl({option:y,isActive:x,shapeType:"sector"},b)))}),N.createElement(_J,{sectors:e,props:s,showLabels:i}))}function MJ(t){var e,{pieSettings:n,displayedData:r,cells:s,offset:i}=t,{cornerRadius:o,startAngle:a,endAngle:l,dataKey:c,nameKey:u,tooltipType:d}=n,h=Math.abs(n.minAngle),f=OJ(a,l),p=Math.abs(f),m=r.length<=1?0:(e=n.paddingAngle)!==null&&e!==void 0?e:0,x=r.filter(C=>dt(C,c,0)!==0).length,g=(p>=360?x:x-1)*m,y=p-x*h-g,b=r.reduce((C,S)=>{var I=dt(S,c,0);return C+(Ne(I)?I:0)},0),w;if(b>0){var k;w=r.map((C,S)=>{var I=dt(C,c,0),$=dt(C,u,S),E=DJ(n,i,C),A=(Ne(I)?I:0)/b,D,P=Pt(Pt({},C),s&&s[S]&&s[S].props);S?D=k.endAngle+Tn(f)*m*(I!==0?1:0):D=a;var O=D+Tn(f)*((I!==0?h:0)+A*y),F=(D+O)/2,U=(E.innerRadius+E.outerRadius)/2,V=[{name:$,value:I,payload:P,dataKey:c,type:d}],_=qn(E.cx,E.cy,U,F);return k=Pt(Pt(Pt(Pt({},n.presentationProps),{},{percent:A,cornerRadius:o,name:$,tooltipPayload:V,midAngle:F,middleRadius:U,tooltipPosition:_},P),E),{},{value:dt(C,c),startAngle:D,endAngle:O,payload:P,paddingAngle:Tn(f)*m}),k})}return w}function FJ(t){var{props:e,previousSectorsRef:n}=t,{sectors:r,isAnimationActive:s,animationBegin:i,animationDuration:o,animationEasing:a,activeShape:l,inactiveShape:c,onAnimationStart:u,onAnimationEnd:d}=e,h=yx(e,"recharts-pie-"),f=n.current,[p,m]=N.useState(!0),x=N.useCallback(()=>{typeof d=="function"&&d(),m(!1)},[d]),g=N.useCallback(()=>{typeof u=="function"&&u(),m(!0)},[u]);return N.createElement(eo,{begin:i,duration:o,isActive:s,easing:a,from:{t:0},to:{t:1},onAnimationStart:g,onAnimationEnd:x,key:h},y=>{var{t:b}=y,w=[],k=r&&r[0],C=k.startAngle;return r.forEach((S,I)=>{var $=f&&f[I],E=I>0?ea(S,"paddingAngle",0):0;if($){var A=Pr($.endAngle-$.startAngle,S.endAngle-S.startAngle),D=Pt(Pt({},S),{},{startAngle:C+E,endAngle:C+A(b)+E});w.push(D),C=D.endAngle}else{var{endAngle:P,startAngle:O}=S,F=Pr(0,P-O),U=F(b),V=Pt(Pt({},S),{},{startAngle:C+E,endAngle:C+U+E});w.push(V),C=V.endAngle}}),n.current=w,N.createElement(Ot,null,N.createElement($3,{sectors:w,activeShape:l,inactiveShape:c,allOtherPieProps:e,showLabels:!p}))})}function LJ(t){var{sectors:e,isAnimationActive:n,activeShape:r,inactiveShape:s}=t,i=N.useRef(null),o=i.current;return n&&e&&e.length&&(!o||o!==e)?N.createElement(FJ,{props:t,previousSectorsRef:i}):N.createElement($3,{sectors:e,activeShape:r,inactiveShape:s,allOtherPieProps:t,showLabels:!0})}function jJ(t){var{hide:e,className:n,rootTabIndex:r}=t,s=ot("recharts-pie",n);return e?null:N.createElement(Ot,{tabIndex:r,className:s},N.createElement(LJ,t))}var E3={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!_l.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function zJ(t){var e=ei(t,E3),n=N.useMemo(()=>Vh(t.children,Pu),[t.children]),r=je(e,!1),s=N.useMemo(()=>({name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,minAngle:e.minAngle,paddingAngle:e.paddingAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,legendType:e.legendType,fill:e.fill,presentationProps:r}),[e.cornerRadius,e.cx,e.cy,e.data,e.dataKey,e.endAngle,e.innerRadius,e.minAngle,e.name,e.nameKey,e.outerRadius,e.paddingAngle,e.startAngle,e.tooltipType,e.legendType,e.fill,r]),i=Te(o=>KZ(o,s,n));return N.createElement(N.Fragment,null,N.createElement(xx,{fn:EJ,args:Pt(Pt({},e),{},{sectors:i})}),N.createElement(jJ,xl({},e,{sectors:i})))}class bx extends N.PureComponent{constructor(){super(...arguments),vx(this,"id",ta("recharts-pie-"))}render(){return N.createElement(N.Fragment,null,N.createElement(aJ,{data:this.props.data,dataKey:this.props.dataKey,hide:this.props.hide,angleAxisId:0,radiusAxisId:0,stackId:void 0,barSize:void 0,type:"pie"}),N.createElement($J,this.props),N.createElement(zJ,this.props),this.props.children)}}vx(bx,"displayName","Pie");vx(bx,"defaultProps",E3);var BJ=X([bn],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),WJ=X([BJ,co,uo],(t,e,n)=>{if(!(!t||e==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),UJ=t=>{var e=hr();return Te(n=>ws(n,"xAxis",t,e))},VJ=t=>{var e=hr();return Te(n=>ws(n,"yAxis",t,e))},wx=()=>Te(WJ),GJ=()=>Te(wQ);function LT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function jT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LT(Object(n),!0).forEach(function(r){HJ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function HJ(t,e,n){return(e=KJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KJ(t){var e=qJ(t,"string");return typeof e=="symbol"?e:e+""}function qJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var XJ=t=>{var{point:e,childIndex:n,mainColor:r,activeDot:s,dataKey:i}=t;if(s===!1||e.x==null||e.y==null)return null;var o=jT(jT({index:n,dataKey:i,cx:e.x,cy:e.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},je(s,!1)),Vk(s)),a;return N.isValidElement(s)?a=N.cloneElement(s,o):typeof s=="function"?a=s(o):a=N.createElement(dS,o),N.createElement(Ot,{className:"recharts-active-dot"},a)};function K1(t){var{points:e,mainColor:n,activeDot:r,itemDataKey:s}=t,i=Te(na),o=GJ();if(e==null||o==null)return null;var a=e.find(l=>o.includes(l.payload));return lt(a)?null:XJ({point:a,childIndex:Number(i),mainColor:n,dataKey:s,activeDot:r})}var YJ=()=>{var t=Vt();return N.useEffect(()=>(t(XZ()),()=>{t(YZ())})),null},QJ=["children"];function ZJ(t,e){if(t==null)return{};var n,r,s=JJ(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function JJ(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var zT=()=>{},T3=N.createContext({addErrorBar:zT,removeErrorBar:zT}),eee={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},A3=N.createContext(eee);function D3(t){var{children:e}=t,n=ZJ(t,QJ);return N.createElement(A3.Provider,{value:n},e)}var tee=()=>N.useContext(A3),bS=t=>{var{children:e,xAxisId:n,yAxisId:r,zAxisId:s,dataKey:i,data:o,stackId:a,hide:l,type:c,barSize:u}=t,[d,h]=N.useState([]),f=N.useCallback(x=>{h(g=>[...g,x])},[h]),p=N.useCallback(x=>{h(g=>g.filter(y=>y!==x))},[h]),m=hr();return N.createElement(T3.Provider,{value:{addErrorBar:f,removeErrorBar:p}},N.createElement(oJ,{type:c,data:o,xAxisId:n,yAxisId:r,zAxisId:s,dataKey:i,errorBars:d,stackId:a,hide:l,barSize:u,isPanorama:m}),e)};function nee(t){var{addErrorBar:e,removeErrorBar:n}=N.useContext(T3);return N.useEffect(()=>(e(t),()=>{n(t)}),[e,n,t]),null}var ree=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function O3(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ch(){return Ch=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ch.apply(null,arguments)}function oee(t,e){if(t==null)return{};var n,r,s=aee(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function aee(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function lee(t){var{direction:e,width:n,dataKey:r,isAnimationActive:s,animationBegin:i,animationDuration:o,animationEasing:a}=t,l=oee(t,ree),c=je(l,!1),{data:u,dataPointFormatter:d,xAxisId:h,yAxisId:f,errorBarOffset:p}=tee(),m=UJ(h),x=VJ(f);if((m==null?void 0:m.scale)==null||(x==null?void 0:x.scale)==null||u==null||e==="x"&&m.type!=="number")return null;var g=u.map(y=>{var{x:b,y:w,value:k,errorVal:C}=d(y,r,e);if(!C)return null;var S=[],I,$;if(Array.isArray(C)?[I,$]=C:I=$=C,e==="x"){var{scale:E}=m,A=w+p,D=A+n,P=A-n,O=E(k-I),F=E(k+$);S.push({x1:F,y1:D,x2:F,y2:P}),S.push({x1:O,y1:A,x2:F,y2:A}),S.push({x1:O,y1:D,x2:O,y2:P})}else if(e==="y"){var{scale:U}=x,V=b+p,_=V-n,z=V+n,K=U(k-I),Z=U(k+$);S.push({x1:_,y1:Z,x2:z,y2:Z}),S.push({x1:V,y1:K,x2:V,y2:Z}),S.push({x1:_,y1:K,x2:z,y2:K})}var q="".concat(b+p,"px ").concat(w+p,"px");return N.createElement(Ot,Ch({className:"recharts-errorBar",key:"bar-".concat(S.map(te=>"".concat(te.x1,"-").concat(te.x2,"-").concat(te.y1,"-").concat(te.y2)))},c),S.map(te=>{var ie=s?{transformOrigin:"".concat(te.x1-5,"px")}:void 0;return N.createElement(eo,{from:{transform:"scaleY(0)",transformOrigin:q},to:{transform:"scaleY(1)",transformOrigin:q},begin:i,easing:a,isActive:s,duration:o,key:"line-".concat(te.x1,"-").concat(te.x2,"-").concat(te.y1,"-").concat(te.y2),style:{transformOrigin:q}},N.createElement("line",Ch({},te,{style:ie})))}))});return N.createElement(Ot,{className:"recharts-errorBars"},g)}var R3=N.createContext(void 0);function cee(t){var e=N.useContext(R3);return t??e??"x"}function P3(t){var{direction:e,children:n}=t;return N.createElement(R3.Provider,{value:e},n)}var _3={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function uee(t){var e=cee(t.direction),{width:n,isAnimationActive:r,animationBegin:s,animationDuration:i,animationEasing:o}=ei(t,_3);return N.createElement(N.Fragment,null,N.createElement(nee,{dataKey:t.dataKey,direction:e}),N.createElement(lee,Ch({},t,{direction:e,width:n,isAnimationActive:r,animationBegin:s,animationDuration:i,animationEasing:o})))}class M3 extends N.Component{render(){return N.createElement(uee,this.props)}}O3(M3,"defaultProps",_3);O3(M3,"displayName","ErrorBar");var dee="Invariant failed";function hee(t,e){throw new Error(dee)}var fee=["x","y"];function q1(){return q1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},q1.apply(null,arguments)}function BT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function md(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BT(Object(n),!0).forEach(function(r){pee(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function pee(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=gee(t,"string");return typeof e=="symbol"?e:e+""}function gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xee(t,e){if(t==null)return{};var n,r,s=yee(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function yee(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function vee(t,e){var{x:n,y:r}=t,s=xee(t,fee),i="".concat(n),o=parseInt(i,10),a="".concat(r),l=parseInt(a,10),c="".concat(e.height||s.height),u=parseInt(c,10),d="".concat(e.width||s.width),h=parseInt(d,10);return md(md(md(md(md({},e),s),o?{x:o}:{}),l?{y:l}:{}),{},{height:u,width:h,name:e.name,radius:e.radius})}function F3(t){return N.createElement(I3,q1({shapeType:"rectangle",propTransformer:vee,activeClassName:"recharts-active-bar"},t))}var bee=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,s)=>{if(Ne(e))return e;var i=Ne(r)||lt(r);return i?e(r,s):(i||hee(),n)}};function kx(t,e){var n,r,s=Te(c=>fo(c,t)),i=Te(c=>ga(c,e)),o=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Ar.allowDataOverflow,a=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:Dr.allowDataOverflow,l=o||a;return{needClip:l,needClipX:o,needClipY:a}}function wS(t){var{xAxisId:e,yAxisId:n,clipPathId:r}=t,s=wx(),{needClipX:i,needClipY:o,needClip:a}=kx(e,n);if(!a)return null;var{x:l,y:c,width:u,height:d}=s;return N.createElement("clipPath",{id:"clipPath-".concat(r)},N.createElement("rect",{x:i?l:l-u/2,y:o?c:c-d/2,width:i?u:u*2,height:o?d:d*2}))}var wee=["onMouseEnter","onMouseLeave","onClick"],kee=["value","background","tooltipPosition"],Cee=["onMouseEnter","onClick","onMouseLeave"];function Sh(){return Sh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sh.apply(null,arguments)}function WT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Gn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WT(Object(n),!0).forEach(function(r){Cx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Cx(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1(t,e){if(t==null)return{};var n,r,s=Nee(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Nee(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var $ee=t=>{var{dataKey:e,name:n,fill:r,legendType:s,hide:i}=t;return[{inactive:i,dataKey:e,type:s,color:r,value:fa(n,e),payload:t}]};function Eee(t){var{dataKey:e,stroke:n,strokeWidth:r,fill:s,name:i,hide:o,unit:a}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:s,dataKey:e,nameKey:void 0,name:fa(i,e),hide:o,type:t.tooltipType,color:t.fill,unit:a}}}function Tee(t){var e=Te(na),{data:n,dataKey:r,background:s,allOtherBarProps:i}=t,{onMouseEnter:o,onMouseLeave:a,onClick:l}=i,c=X1(i,wee),u=gS(o,r),d=xS(a),h=yS(l,r);if(!s||n==null)return null;var f=je(s,!1);return N.createElement(N.Fragment,null,n.map((p,m)=>{var{value:x,background:g,tooltipPosition:y}=p,b=X1(p,kee);if(!g)return null;var w=u(p,m),k=d(p,m),C=h(p,m),S=Gn(Gn(Gn(Gn(Gn({option:s,isActive:String(m)===e},b),{},{fill:"#eee"},g),f),F0(c,p,m)),{},{onMouseEnter:w,onMouseLeave:k,onClick:C,dataKey:r,index:m,className:"recharts-bar-background-rectangle"});return N.createElement(F3,Sh({key:"background-bar-".concat(m)},S))}))}function L3(t){var{data:e,props:n,showLabels:r}=t,s=je(n,!1),{shape:i,dataKey:o,activeBar:a}=n,l=Te(na),c=Te(e3),{onMouseEnter:u,onClick:d,onMouseLeave:h}=n,f=X1(n,Cee),p=gS(u,o),m=xS(h),x=yS(d,o);return e?N.createElement(N.Fragment,null,e.map((g,y)=>{var b=a&&String(y)===l&&(c==null||o===c),w=b?a:i,k=Gn(Gn(Gn({},s),g),{},{isActive:b,option:w,index:y,dataKey:o});return N.createElement(Ot,Sh({className:"recharts-bar-rectangle"},F0(f,g,y),{onMouseEnter:p(g,y),onMouseLeave:m(g,y),onClick:x(g,y),key:"rectangle-".concat(g==null?void 0:g.x,"-").concat(g==null?void 0:g.y,"-").concat(g==null?void 0:g.value,"-").concat(y)}),N.createElement(F3,k))}),r&&Ki.renderCallByParent(n,e)):null}function Aee(t){var{props:e,previousRectanglesRef:n}=t,{data:r,layout:s,isAnimationActive:i,animationBegin:o,animationDuration:a,animationEasing:l,onAnimationEnd:c,onAnimationStart:u}=e,d=n.current,h=yx(e,"recharts-bar-"),[f,p]=N.useState(!1),m=N.useCallback(()=>{typeof c=="function"&&c(),p(!1)},[c]),x=N.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return N.createElement(eo,{begin:o,duration:a,isActive:i,easing:l,from:{t:0},to:{t:1},onAnimationEnd:m,onAnimationStart:x,key:h},g=>{var{t:y}=g,b=y===1?r:r.map((w,k)=>{var C=d&&d[k];if(C){var S=Pr(C.x,w.x),I=Pr(C.y,w.y),$=Pr(C.width,w.width),E=Pr(C.height,w.height);return Gn(Gn({},w),{},{x:S(y),y:I(y),width:$(y),height:E(y)})}if(s==="horizontal"){var A=Pr(0,w.height),D=A(y);return Gn(Gn({},w),{},{y:w.y+w.height-D,height:D})}var P=Pr(0,w.width),O=P(y);return Gn(Gn({},w),{},{width:O})});return y>0&&(n.current=b),N.createElement(Ot,null,N.createElement(L3,{props:e,data:b,showLabels:!f}))})}function Dee(t){var{data:e,isAnimationActive:n}=t,r=N.useRef(null);return n&&e&&e.length&&(r.current==null||r.current!==e)?N.createElement(Aee,{previousRectanglesRef:r,props:t}):N.createElement(L3,{props:t,data:e,showLabels:!0})}var j3=0,Oee=(t,e)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:dt(t,e)}};class Ree extends N.PureComponent{constructor(){super(...arguments),Cx(this,"id",ta("recharts-bar-"))}render(){var{hide:e,data:n,dataKey:r,className:s,xAxisId:i,yAxisId:o,needClip:a,background:l,id:c,layout:u}=this.props;if(e)return null;var d=ot("recharts-bar",s),h=lt(c)?this.id:c;return N.createElement(Ot,{className:d},a&&N.createElement("defs",null,N.createElement(wS,{clipPathId:h,xAxisId:i,yAxisId:o})),N.createElement(Ot,{className:"recharts-bar-rectangles",clipPath:a?"url(#clipPath-".concat(h,")"):null},N.createElement(Tee,{data:n,dataKey:r,background:l,allOtherBarProps:this.props}),N.createElement(Dee,this.props)),N.createElement(P3,{direction:u==="horizontal"?"y":"x"},this.props.children))}}var z3={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!_l.isSsr,legendType:"rect",minPointSize:j3,xAxisId:0,yAxisId:0};function Pee(t){var{xAxisId:e,yAxisId:n,hide:r,legendType:s,minPointSize:i,activeBar:o,animationBegin:a,animationDuration:l,animationEasing:c,isAnimationActive:u}=ei(t,z3),{needClip:d}=kx(e,n),h=Z0(),f=hr(),p=N.useMemo(()=>({barSize:t.barSize,data:void 0,dataKey:t.dataKey,maxBarSize:t.maxBarSize,minPointSize:i,stackId:iC(t.stackId)}),[t.barSize,t.dataKey,t.maxBarSize,i,t.stackId]),m=Vh(t.children,Pu),x=Te(b=>lte(b,e,n,f,p,m));if(h!=="vertical"&&h!=="horizontal")return null;var g,y=x==null?void 0:x[0];return y==null||y.height==null||y.width==null?g=0:g=h==="vertical"?y.height/2:y.width/2,N.createElement(D3,{xAxisId:e,yAxisId:n,data:x,dataPointFormatter:Oee,errorBarOffset:g},N.createElement(Ree,Sh({},t,{layout:h,needClip:d,data:x,xAxisId:e,yAxisId:n,hide:r,legendType:s,minPointSize:i,activeBar:o,animationBegin:a,animationDuration:l,animationEasing:c,isAnimationActive:u})))}function _ee(t){var{layout:e,barSettings:{dataKey:n,minPointSize:r},pos:s,bandSize:i,xAxis:o,yAxis:a,xAxisTicks:l,yAxisTicks:c,stackedData:u,displayedData:d,offset:h,cells:f}=t,p=e==="horizontal"?a:o,m=u?p.scale.domain():null,x=MK({numericAxis:p});return d.map((g,y)=>{var b,w,k,C,S,I;u?b=DK(u[y],m):(b=dt(g,n),Array.isArray(b)||(b=[x,b]));var $=bee(r,j3)(b[1],y);if(e==="horizontal"){var E,[A,D]=[a.scale(b[0]),a.scale(b[1])];w=rE({axis:o,ticks:l,bandSize:i,offset:s.offset,entry:g,index:y}),k=(E=D??A)!==null&&E!==void 0?E:void 0,C=s.size;var P=A-D;if(S=Vr(P)?0:P,I={x:w,y:h.top,width:C,height:h.height},Math.abs($)>0&&Math.abs(S)<Math.abs($)){var O=Tn(S||$)*(Math.abs($)-Math.abs(S));k-=O,S+=O}}else{var[F,U]=[o.scale(b[0]),o.scale(b[1])];if(w=F,k=rE({axis:a,ticks:c,bandSize:i,offset:s.offset,entry:g,index:y}),C=U-F,S=s.size,I={x:h.left,y:k,width:h.width,height:S},Math.abs($)>0&&Math.abs(C)<Math.abs($)){var V=Tn(C||$)*(Math.abs($)-Math.abs(C));C+=V}}var _=Gn(Gn({},g),{},{x:w,y:k,width:C,height:S,value:u?b:b[1],payload:g,background:I,tooltipPosition:{x:w+C/2,y:k+S/2}},f&&f[y]&&f[y].props);return _})}class kS extends N.PureComponent{render(){return N.createElement(bS,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},N.createElement(YJ,null),N.createElement(vS,{legendPayload:$ee(this.props)}),N.createElement(xx,{fn:Eee,args:this.props}),N.createElement(Pee,this.props))}}Cx(kS,"displayName","Bar");Cx(kS,"defaultProps",z3);function UT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Jp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UT(Object(n),!0).forEach(function(r){Mee(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Mee(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=Lee(t,"string");return typeof e=="symbol"?e:e+""}function Lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jee=(t,e)=>e,zee=(t,e,n)=>n,Bee=(t,e,n,r)=>r,CS=(t,e,n,r,s)=>s,Wee=(t,e,n,r,s)=>s.maxBarSize,Uee=(t,e,n,r,s,i)=>i,VT=(t,e,n)=>{var r=n??t;if(!lt(r))return or(r,e,0)},Vee=X([Ge,Jh,jee,zee,Bee],(t,e,n,r,s)=>e.filter(i=>t==="horizontal"?i.xAxisId===n:i.yAxisId===r).filter(i=>i.isPanorama===s).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Gee=(t,e,n,r)=>{var s=Ge(t);return s==="horizontal"?kh(t,"yAxis",n,r):kh(t,"xAxis",e,r)},Hee=(t,e,n)=>{var r=Ge(t);return r==="horizontal"?aT(t,"xAxis",e):aT(t,"yAxis",n)};function Kee(t){return t.stackId!=null&&t.dataKey!=null}var qee=(t,e,n)=>{var r={},s=t.filter(Kee),i=t.filter(c=>c.stackId==null),o=s.reduce((c,u)=>(c[u.stackId]||(c[u.stackId]=[]),c[u.stackId].push(u),c),r),a=Object.entries(o).map(c=>{var[u,d]=c,h=d.map(p=>p.dataKey),f=VT(e,n,d[0].barSize);return{stackId:u,dataKeys:h,barSize:f}}),l=i.map(c=>{var u=[c.dataKey].filter(h=>h!=null),d=VT(e,n,c.barSize);return{stackId:void 0,dataKeys:u,barSize:d}});return[...a,...l]},Xee=X([Vee,O9,Hee],qee),Yee=(t,e,n,r,s)=>{var i,o,a=Ge(t),l=iF(t),{maxBarSize:c}=s,u=lt(c)?l:c,d,h;return a==="horizontal"?(d=ws(t,"xAxis",e,r),h=ki(t,"xAxis",e,r)):(d=ws(t,"yAxis",n,r),h=ki(t,"yAxis",n,r)),(i=(o=ru(d,h,!0))!==null&&o!==void 0?o:u)!==null&&i!==void 0?i:0},B3=(t,e,n,r)=>{var s=Ge(t),i,o;return s==="horizontal"?(i=ws(t,"xAxis",e,r),o=ki(t,"xAxis",e,r)):(i=ws(t,"yAxis",n,r),o=ki(t,"yAxis",n,r)),ru(i,o)};function Qee(t,e,n,r,s){var i=r.length;if(!(i<1)){var o=or(t,n,0,!0),a,l=[];if(On(r[0].barSize)){var c=!1,u=n/i,d=r.reduce((g,y)=>g+(y.barSize||0),0);d+=(i-1)*o,d>=n&&(d-=(i-1)*o,o=0),d>=n&&u>0&&(c=!0,u*=.9,d=i*u);var h=(n-d)/2>>0,f={offset:h-o,size:0};a=r.reduce((g,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:f.offset+f.size+o,size:c?u:(b=y.barSize)!==null&&b!==void 0?b:0}},k=[...g,w];return f=k[k.length-1].position,k},l)}else{var p=or(e,n,0,!0);n-2*p-(i-1)*o<=0&&(o=0);var m=(n-2*p-(i-1)*o)/i;m>1&&(m>>=0);var x=On(s)?Math.min(m,s):m;a=r.reduce((g,y,b)=>[...g,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:p+(m+o)*b+(m-x)/2,size:x}}],l)}return a}}var Zee=(t,e,n,r,s,i,o)=>{var a=lt(o)?e:o,l=Qee(n,r,s!==i?s:i,t,a);return s!==i&&l!=null&&(l=l.map(c=>Jp(Jp({},c),{},{position:Jp(Jp({},c.position),{},{offset:c.position.offset-s/2})}))),l},Jee=X([Xee,iF,D9,oF,Yee,B3,Wee],Zee),ete=(t,e,n,r)=>ws(t,"xAxis",e,r),tte=(t,e,n,r)=>ws(t,"yAxis",n,r),nte=(t,e,n,r)=>ki(t,"xAxis",e,r),rte=(t,e,n,r)=>ki(t,"yAxis",n,r),ste=X([Jee,CS],(t,e)=>{if(t!=null){var n=t.find(r=>r.stackId===e.stackId&&r.dataKeys.includes(e.dataKey));if(n!=null)return n.position}}),ite=(t,e)=>{if(!(!t||(e==null?void 0:e.dataKey)==null)){var{stackId:n}=e;if(n!=null){var r=t[n];if(r){var{stackedData:s}=r;if(s){var i=s.find(o=>o.key===e.dataKey);return i}}}}},ote=X([Jh,CS],(t,e)=>{if(t.some(n=>n.type==="bar"&&e.dataKey===n.dataKey&&e.stackId===n.stackId&&e.stackId===n.stackId))return e}),ate=X([Gee,CS],ite),lte=X([bn,ete,tte,nte,rte,ste,Ge,ix,B3,ate,ote,Uee],(t,e,n,r,s,i,o,a,l,c,u,d)=>{var{chartData:h,dataStartIndex:f,dataEndIndex:p}=a;if(!(u==null||i==null||o!=="horizontal"&&o!=="vertical"||e==null||n==null||r==null||s==null||l==null)){var{data:m}=u,x;if(m!=null&&m.length>0?x=m:x=h==null?void 0:h.slice(f,p+1),x!=null)return _ee({layout:o,barSettings:u,pos:i,bandSize:l,xAxis:e,yAxis:n,xAxisTicks:r,yAxisTicks:s,stackedData:c,displayedData:x,offset:t,cells:d})}}),W3=t=>{var{chartData:e}=t,n=Vt(),r=hr();return N.useEffect(()=>r?()=>{}:(n(pT(e)),()=>{n(pT(void 0))}),[e,n,r]),null},GT={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},cte=Is({name:"brush",initialState:GT,reducers:{setBrushSettings(t,e){return e.payload==null?GT:e.payload}}}),ute=cte.reducer;function dte(t,e,n){return(e=hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hte(t){var e=fte(t,"string");return typeof e=="symbol"?e:e+""}function fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SS{static create(e){return new SS(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:n,position:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(r)switch(r){case"start":return this.scale(e);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}default:return this.scale(e)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var n=this.range(),r=n[0],s=n[n.length-1];return r<=s?e>=r&&e<=s:e>=s&&e<=r}}dte(SS,"EPS",1e-4);function pte(t){return(t%180+180)%180}var mte=function(e){var{width:n,height:r}=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=pte(s),o=i*Math.PI/180,a=Math.atan(r/n),l=o>a&&o<Math.PI-a?r/Math.sin(o):n/Math.cos(o);return Math.abs(l)},gte={dots:[],areas:[],lines:[]},xte=Is({name:"referenceElements",initialState:gte,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var n=Gi(t).dots.findIndex(r=>r===e.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var n=Gi(t).areas.findIndex(r=>r===e.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var n=Gi(t).lines.findIndex(r=>r===e.payload);n!==-1&&t.lines.splice(n,1)}}}),yte=xte.reducer,vte=N.createContext(void 0),bte=t=>{var{children:e}=t,[n]=N.useState("".concat(ta("recharts"),"-clip")),r=wx();if(r==null)return null;var{x:s,y:i,width:o,height:a}=r;return N.createElement(vte.Provider,{value:n},N.createElement("defs",null,N.createElement("clipPath",{id:n},N.createElement("rect",{x:s,y:i,height:a,width:o}))),e)};function Yv(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function U3(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],s=0;s<t.length;s+=e)r.push(t[s]);return r}function wte(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return mte(r,n)}function kte(t,e,n){var r=n==="width",{x:s,y:i,width:o,height:a}=t;return e===1?{start:r?s:i,end:r?s+o:i+a}:{start:r?s+o:i+a,end:r?s:i}}function Dg(t,e,n,r,s){if(t*e<t*r||t*e>t*s)return!1;var i=n();return t*(e-t*i/2-r)>=0&&t*(e+t*i/2-s)<=0}function Cte(t,e){return U3(t,e+1)}function Ste(t,e,n,r,s){for(var i=(r||[]).slice(),{start:o,end:a}=e,l=0,c=1,u=o,d=function(){var p=r==null?void 0:r[l];if(p===void 0)return{v:U3(r,c)};var m=l,x,g=()=>(x===void 0&&(x=n(p,m)),x),y=p.coordinate,b=l===0||Dg(t,y,g,u,a);b||(l=0,u=o,c+=1),b&&(u=y+t*(g()/2+s),l+=c)},h;c<=i.length;)if(h=d(),h)return h.v;return[]}function HT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Bn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HT(Object(n),!0).forEach(function(r){Ite(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ite(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ete(t,e,n,r,s){for(var i=(r||[]).slice(),o=i.length,{start:a}=e,{end:l}=e,c=function(h){var f=i[h],p,m=()=>(p===void 0&&(p=n(f,h)),p);if(h===o-1){var x=t*(f.coordinate+t*m()/2-l);i[h]=f=Bn(Bn({},f),{},{tickCoord:x>0?f.coordinate-x*t:f.coordinate})}else i[h]=f=Bn(Bn({},f),{},{tickCoord:f.coordinate});var g=Dg(t,f.tickCoord,m,a,l);g&&(l=f.tickCoord-t*(m()/2+s),i[h]=Bn(Bn({},f),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return i}function Tte(t,e,n,r,s,i){var o=(r||[]).slice(),a=o.length,{start:l,end:c}=e;if(i){var u=r[a-1],d=n(u,a-1),h=t*(u.coordinate+t*d/2-c);o[a-1]=u=Bn(Bn({},u),{},{tickCoord:h>0?u.coordinate-h*t:u.coordinate});var f=Dg(t,u.tickCoord,()=>d,l,c);f&&(c=u.tickCoord-t*(d/2+s),o[a-1]=Bn(Bn({},u),{},{isShow:!0}))}for(var p=i?a-1:a,m=function(y){var b=o[y],w,k=()=>(w===void 0&&(w=n(b,y)),w);if(y===0){var C=t*(b.coordinate-t*k()/2-l);o[y]=b=Bn(Bn({},b),{},{tickCoord:C<0?b.coordinate-C*t:b.coordinate})}else o[y]=b=Bn(Bn({},b),{},{tickCoord:b.coordinate});var S=Dg(t,b.tickCoord,k,l,c);S&&(l=b.tickCoord+t*(k()/2+s),o[y]=Bn(Bn({},b),{},{isShow:!0}))},x=0;x<p;x++)m(x);return o}function Ate(t,e,n){var{tick:r,ticks:s,viewBox:i,minTickGap:o,orientation:a,interval:l,tickFormatter:c,unit:u,angle:d}=t;if(!s||!s.length||!r)return[];if(Ne(l)||_l.isSsr){var h;return(h=Cte(s,Ne(l)?l:0))!==null&&h!==void 0?h:[]}var f=[],p=a==="top"||a==="bottom"?"width":"height",m=u&&p==="width"?Hd(u,{fontSize:e,letterSpacing:n}):{width:0,height:0},x=(b,w)=>{var k=typeof c=="function"?c(b.value,w):b.value;return p==="width"?wte(Hd(k,{fontSize:e,letterSpacing:n}),m,d):Hd(k,{fontSize:e,letterSpacing:n})[p]},g=s.length>=2?Tn(s[1].coordinate-s[0].coordinate):1,y=kte(i,g,p);return l==="equidistantPreserveStart"?Ste(g,y,x,s,o):(l==="preserveStart"||l==="preserveStartEnd"?f=Tte(g,y,x,s,o,l==="preserveStartEnd"):f=Ete(g,y,x,s,o),f.filter(b=>b.isShow))}var Dte=["viewBox"],Ote=["viewBox"];function Ic(){return Ic=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ic.apply(null,arguments)}function KT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function sn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KT(Object(n),!0).forEach(function(r){IS(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qT(t,e){if(t==null)return{};var n,r,s=Rte(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Rte(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function IS(t,e,n){return(e=Pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pte(t){var e=_te(t,"string");return typeof e=="symbol"?e:e+""}function _te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _u extends N.Component{constructor(e){super(e),this.tickRefs=N.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,n){var{viewBox:r}=e,s=qT(e,Dte),i=this.props,{viewBox:o}=i,a=qT(i,Ote);return!Yv(r,o)||!Yv(s,a)||!Yv(n,this.state)}getTickLineCoord(e){var{x:n,y:r,width:s,height:i,orientation:o,tickSize:a,mirror:l,tickMargin:c}=this.props,u,d,h,f,p,m,x=l?-1:1,g=e.tickSize||a,y=Ne(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":u=d=e.coordinate,f=r+ +!l*i,h=f-x*g,m=h-x*c,p=y;break;case"left":h=f=e.coordinate,d=n+ +!l*s,u=d-x*g,p=u-x*c,m=y;break;case"right":h=f=e.coordinate,d=n+ +l*s,u=d+x*g,p=u+x*c,m=y;break;default:u=d=e.coordinate,f=r+ +l*i,h=f+x*g,m=h+x*c,p=y;break}return{line:{x1:u,y1:h,x2:d,y2:f},tick:{x:p,y:m}}}getTickTextAnchor(){var{orientation:e,mirror:n}=this.props,r;switch(e){case"left":r=n?"start":"end";break;case"right":r=n?"end":"start";break;default:r="middle";break}return r}getTickVerticalAnchor(){var{orientation:e,mirror:n}=this.props;switch(e){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}renderAxisLine(){var{x:e,y:n,width:r,height:s,orientation:i,mirror:o,axisLine:a}=this.props,l=sn(sn(sn({},je(this.props,!1)),je(a,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var c=+(i==="top"&&!o||i==="bottom"&&o);l=sn(sn({},l),{},{x1:e,y1:n+c*s,x2:e+r,y2:n+c*s})}else{var u=+(i==="left"&&!o||i==="right"&&o);l=sn(sn({},l),{},{x1:e+u*r,y1:n,x2:e+u*r,y2:n+s})}return N.createElement("line",Ic({},l,{className:ot("recharts-cartesian-axis-line",ea(a,"className"))}))}static renderTickItem(e,n,r){var s,i=ot(n.className,"recharts-cartesian-axis-tick-value");if(N.isValidElement(e))s=N.cloneElement(e,sn(sn({},n),{},{className:i}));else if(typeof e=="function")s=e(sn(sn({},n),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=ot(o,e.className)),s=N.createElement(gx,Ic({},n,{className:o}),r)}return s}renderTicks(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:s,stroke:i,tick:o,tickFormatter:a,unit:l}=this.props,c=Ate(sn(sn({},this.props),{},{ticks:r}),e,n),u=this.getTickTextAnchor(),d=this.getTickVerticalAnchor(),h=je(this.props,!1),f=je(o,!1),p=sn(sn({},h),{},{fill:"none"},je(s,!1)),m=c.map((x,g)=>{var{line:y,tick:b}=this.getTickLineCoord(x),w=sn(sn(sn(sn({textAnchor:u,verticalAnchor:d},h),{},{stroke:"none",fill:i},f),b),{},{index:g,payload:x,visibleTicksCount:c.length,tickFormatter:a});return N.createElement(Ot,Ic({className:"recharts-cartesian-axis-tick",key:"tick-".concat(x.value,"-").concat(x.coordinate,"-").concat(x.tickCoord)},F0(this.props,x,g)),s&&N.createElement("line",Ic({},p,y,{className:ot("recharts-cartesian-axis-tick-line",ea(s,"className"))})),o&&_u.renderTickItem(o,w,"".concat(typeof a=="function"?a(x.value,g):x.value).concat(l||"")))});return m.length>0?N.createElement("g",{className:"recharts-cartesian-axis-ticks"},m):null}render(){var{axisLine:e,width:n,height:r,className:s,hide:i}=this.props;if(i)return null;var{ticks:o}=this.props;return n!=null&&n<=0||r!=null&&r<=0?null:N.createElement(Ot,{className:ot("recharts-cartesian-axis",s),ref:a=>{if(a){var l=a.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var u=window.getComputedStyle(c).fontSize,d=window.getComputedStyle(c).letterSpacing;(u!==this.state.fontSize||d!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,o),_r.renderCallByParent(this.props))}}IS(_u,"displayName","CartesianAxis");IS(_u,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var V3=(t,e,n,r)=>ws(t,"xAxis",e,r),G3=(t,e,n,r)=>ki(t,"xAxis",e,r),H3=(t,e,n,r)=>ws(t,"yAxis",n,r),K3=(t,e,n,r)=>ki(t,"yAxis",n,r),Mte=X([Ge,V3,H3,G3,K3],(t,e,n,r,s)=>Ti(t,"xAxis")?ru(e,r,!1):ru(n,s,!1)),Fte=(t,e,n,r,s)=>s,Lte=X([Jh,Fte],(t,e)=>{if(t.some(n=>n.type==="line"&&e.dataKey===n.dataKey&&e.data===n.data))return e}),jte=X([Ge,V3,H3,G3,K3,Lte,Mte,ix],(t,e,n,r,s,i,o,a)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:u}=a;if(!(i==null||e==null||n==null||r==null||s==null||r.length===0||s.length===0||o==null)){var{dataKey:d,data:h}=i,f;if(h!=null&&h.length>0?f=h:f=l==null?void 0:l.slice(c,u+1),f!=null)return sne({layout:t,xAxis:e,yAxis:n,xAxisTicks:r,yAxisTicks:s,dataKey:d,bandSize:o,displayedData:f})}}),zte=["type","layout","connectNulls","needClip"],Bte=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function q3(t,e){if(t==null)return{};var n,r,s=Wte(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Wte(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function XT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Fs(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XT(Object(n),!0).forEach(function(r){Sx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Sx(t,e,n){return(e=Ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ute(t){var e=Vte(t,"string");return typeof e=="symbol"?e:e+""}function Vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cu(){return cu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cu.apply(null,arguments)}var Gte=t=>{var{dataKey:e,name:n,stroke:r,legendType:s,hide:i}=t;return[{inactive:i,dataKey:e,type:s,color:r,value:fa(n,e),payload:t}]};function Hte(t){var{dataKey:e,data:n,stroke:r,strokeWidth:s,fill:i,name:o,hide:a,unit:l}=t;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:e,nameKey:void 0,name:fa(o,e),hide:a,type:t.tooltipType,color:t.stroke,unit:l}}}var X3=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function Kte(t,e){for(var n=t.length%2!==0?[...t,0]:t,r=[],s=0;s<e;++s)r=[...r,...n];return r}var qte=(t,e,n)=>{var r=n.reduce((d,h)=>d+h);if(!r)return X3(e,t);for(var s=Math.floor(t/r),i=t%r,o=e-t,a=[],l=0,c=0;l<n.length;c+=n[l],++l)if(c+n[l]>i){a=[...n.slice(0,l),i-c];break}var u=a.length%2===0?[0,o]:[o];return[...Kte(n,s),...a,...u].map(d=>"".concat(d,"px")).join(", ")};function Xte(t,e){var n;if(N.isValidElement(t))n=N.cloneElement(t,e);else if(typeof t=="function")n=t(e);else{var r=ot("recharts-line-dot",typeof t!="boolean"?t.className:"");n=N.createElement(dS,cu({},e,{className:r}))}return n}function Yte(t,e){return t==null?!1:e?!0:t.length===1}function Qte(t){var{clipPathId:e,points:n,props:r}=t,{dot:s,dataKey:i,needClip:o}=r;if(!Yte(n,s))return null;var a=L0(s),l=je(r,!1),c=je(s,!0),u=n.map((h,f)=>{var p=Fs(Fs(Fs({key:"dot-".concat(f),r:3},l),c),{},{index:f,cx:h.x,cy:h.y,dataKey:i,value:h.value,payload:h.payload,points:n});return Xte(s,p)}),d={clipPath:o?"url(#clipPath-".concat(a?"":"dots-").concat(e,")"):null};return N.createElement(Ot,cu({className:"recharts-line-dots",key:"dots"},d),u)}function Y1(t){var{clipPathId:e,pathRef:n,points:r,strokeDasharray:s,props:i,showLabels:o}=t,{type:a,layout:l,connectNulls:c,needClip:u}=i,d=q3(i,zte),h=Fs(Fs({},je(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):null,points:r,type:a,layout:l,connectNulls:c,strokeDasharray:s??i.strokeDasharray});return N.createElement(N.Fragment,null,(r==null?void 0:r.length)>1&&N.createElement(Gd,cu({},h,{pathRef:n})),N.createElement(Qte,{points:r,clipPathId:e,props:i}),o&&Ki.renderCallByParent(i,r))}function Zte(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function Jte(t){var{clipPathId:e,props:n,pathRef:r,previousPointsRef:s,longestAnimatedLengthRef:i}=t,{points:o,strokeDasharray:a,isAnimationActive:l,animationBegin:c,animationDuration:u,animationEasing:d,animateNewValues:h,width:f,height:p,onAnimationEnd:m,onAnimationStart:x}=n,g=s.current,y=yx(n,"recharts-line-"),[b,w]=N.useState(!1),k=N.useCallback(()=>{typeof m=="function"&&m(),w(!1)},[m]),C=N.useCallback(()=>{typeof x=="function"&&x(),w(!0)},[x]),S=Zte(r.current),I=i.current;return N.createElement(eo,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},onAnimationEnd:k,onAnimationStart:C,key:y},$=>{var{t:E}=$,A=Pr(I,S+I),D=Math.min(A(E),S),P;if(a){var O="".concat(a).split(/[,\s]+/gim).map(V=>parseFloat(V));P=qte(D,S,O)}else P=X3(S,D);if(g){var F=g.length/o.length,U=E===1?o:o.map((V,_)=>{var z=Math.floor(_*F);if(g[z]){var K=g[z],Z=Pr(K.x,V.x),q=Pr(K.y,V.y);return Fs(Fs({},V),{},{x:Z(E),y:q(E)})}if(h){var te=Pr(f*2,V.x),ie=Pr(p/2,V.y);return Fs(Fs({},V),{},{x:te(E),y:ie(E)})}return Fs(Fs({},V),{},{x:V.x,y:V.y})});return s.current=U,N.createElement(Y1,{props:n,points:U,clipPathId:e,pathRef:r,showLabels:!b,strokeDasharray:P})}return E>0&&S>0&&(s.current=o,i.current=D),N.createElement(Y1,{props:n,points:o,clipPathId:e,pathRef:r,showLabels:!b,strokeDasharray:P})})}function ene(t){var{clipPathId:e,props:n}=t,{points:r,isAnimationActive:s}=n,i=N.useRef(null),o=N.useRef(0),a=N.useRef(null),l=i.current;return s&&r&&r.length&&l!==r?N.createElement(Jte,{props:n,clipPathId:e,previousPointsRef:i,longestAnimatedLengthRef:o,pathRef:a}):N.createElement(Y1,{props:n,points:r,clipPathId:e,pathRef:a,showLabels:!0})}var tne=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:dt(t.payload,e)});class nne extends N.Component{constructor(){super(...arguments),Sx(this,"id",ta("recharts-line-"))}render(){var e,{hide:n,dot:r,points:s,className:i,xAxisId:o,yAxisId:a,top:l,left:c,width:u,height:d,id:h,needClip:f,layout:p}=this.props;if(n)return null;var m=ot("recharts-line",i),x=lt(h)?this.id:h,{r:g=3,strokeWidth:y=2}=(e=je(r,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},b=L0(r),w=g*2+y;return N.createElement(N.Fragment,null,N.createElement(Ot,{className:m},f&&N.createElement("defs",null,N.createElement(wS,{clipPathId:x,xAxisId:o,yAxisId:a}),!b&&N.createElement("clipPath",{id:"clipPath-dots-".concat(x)},N.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),N.createElement(ene,{props:this.props,clipPathId:x}),N.createElement(P3,{direction:p==="horizontal"?"y":"x"},N.createElement(D3,{xAxisId:o,yAxisId:a,data:s,dataPointFormatter:tne,errorBarOffset:0},this.props.children))),N.createElement(K1,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var Y3={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!_l.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function rne(t){var e=ei(t,Y3),{activeDot:n,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,connectNulls:a,dot:l,hide:c,isAnimationActive:u,label:d,legendType:h,xAxisId:f,yAxisId:p}=e,m=q3(e,Bte),{needClip:x}=kx(f,p),{height:g,width:y,x:b,y:w}=wx(),k=Z0(),C=hr(),S=N.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),I=Te($=>jte($,f,p,C,S));return k!=="horizontal"&&k!=="vertical"?null:N.createElement(nne,cu({},m,{connectNulls:a,dot:l,activeDot:n,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,isAnimationActive:u,hide:c,label:d,legendType:h,xAxisId:f,yAxisId:p,points:I,layout:k,height:g,width:y,left:b,top:w,needClip:x}))}function sne(t){var{layout:e,xAxis:n,yAxis:r,xAxisTicks:s,yAxisTicks:i,dataKey:o,bandSize:a,displayedData:l}=t;return l.map((c,u)=>{var d=dt(c,o);return e==="horizontal"?{x:dg({axis:n,ticks:s,bandSize:a,entry:c,index:u}),y:lt(d)?null:r.scale(d),value:d,payload:c}:{x:lt(d)?null:n.scale(d),y:dg({axis:r,ticks:i,bandSize:a,entry:c,index:u}),value:d,payload:c}})}class Mc extends N.PureComponent{render(){return N.createElement(bS,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},N.createElement(vS,{legendPayload:Gte(this.props)}),N.createElement(xx,{fn:Hte,args:this.props}),N.createElement(rne,this.props))}}Sx(Mc,"displayName","Line");Sx(Mc,"defaultProps",Y3);var Q3=(t,e,n,r)=>ws(t,"xAxis",e,r),Z3=(t,e,n,r)=>ki(t,"xAxis",e,r),J3=(t,e,n,r)=>ws(t,"yAxis",n,r),eL=(t,e,n,r)=>ki(t,"yAxis",n,r),ine=X([Ge,Q3,J3,Z3,eL],(t,e,n,r,s)=>Ti(t,"xAxis")?ru(e,r,!1):ru(n,s,!1)),one=(t,e,n,r,s)=>{var i,o=Ge(t),a=Ti(o,"xAxis"),l;if(a?l=kh(t,"yAxis",n,r):l=kh(t,"xAxis",e,r),l!=null){var{dataKey:c,stackId:u}=s;if(u!=null){var d=(i=l[u])===null||i===void 0?void 0:i.stackedData;return d==null?void 0:d.find(h=>h.key===c)}}},ane=(t,e,n,r,s)=>s,lne=X([Jh,ane],(t,e)=>{if(t.some(n=>n.type==="area"&&e.dataKey===n.dataKey&&iC(e.stackId)===n.stackId&&e.data===n.data))return e}),cne=X([Ge,Q3,J3,Z3,eL,one,ix,ine,lne],(t,e,n,r,s,i,o,a,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(l==null||t!=="horizontal"&&t!=="vertical"||e==null||n==null||r==null||s==null||r.length===0||s.length===0||a==null)){var{data:h}=l,f;if(h&&h.length>0?f=h:f=c==null?void 0:c.slice(u,d+1),f!=null){var p=void 0;return Ene({layout:t,xAxis:e,yAxis:n,xAxisTicks:r,yAxisTicks:s,dataStartIndex:u,areaSettings:l,stackedData:i,displayedData:f,chartBaseValue:p,bandSize:a})}}}),une=["layout","type","stroke","connectNulls","isRange"],dne=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function tL(t,e){if(t==null)return{};var n,r,s=hne(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function hne(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function YT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Xa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YT(Object(n),!0).forEach(function(r){Ix(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ix(t,e,n){return(e=fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ko(){return Ko=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ko.apply(null,arguments)}function Og(t,e){return t&&t!=="none"?t:e}var mne=t=>{var{dataKey:e,name:n,stroke:r,fill:s,legendType:i,hide:o}=t;return[{inactive:o,dataKey:e,type:i,color:Og(r,s),value:fa(n,e),payload:t}]};function gne(t){var{dataKey:e,data:n,stroke:r,strokeWidth:s,fill:i,name:o,hide:a,unit:l}=t;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:e,nameKey:void 0,name:fa(o,e),hide:a,type:t.tooltipType,color:Og(r,i),unit:l}}}var xne=(t,e)=>{var n;if(N.isValidElement(t))n=N.cloneElement(t,e);else if(typeof t=="function")n=t(e);else{var r=ot("recharts-area-dot",typeof t!="boolean"?t.className:"");n=N.createElement(dS,Ko({},e,{className:r}))}return n};function yne(t,e){return t==null?!1:e?!0:t.length===1}function vne(t){var{clipPathId:e,points:n,props:r}=t,{needClip:s,dot:i,dataKey:o}=r;if(!yne(n,i))return null;var a=L0(i),l=je(r,!1),c=je(i,!0),u=n.map((h,f)=>{var p=Xa(Xa(Xa({key:"dot-".concat(f),r:3},l),c),{},{index:f,cx:h.x,cy:h.y,dataKey:o,value:h.value,payload:h.payload,points:n});return xne(i,p)}),d={clipPath:s?"url(#clipPath-".concat(a?"":"dots-").concat(e,")"):void 0};return N.createElement(Ot,Ko({className:"recharts-area-dots"},d),u)}function Q1(t){var{points:e,baseLine:n,needClip:r,clipPathId:s,props:i,showLabels:o}=t,{layout:a,type:l,stroke:c,connectNulls:u,isRange:d}=i,h=tL(i,une);return N.createElement(N.Fragment,null,(e==null?void 0:e.length)>1&&N.createElement(Ot,{clipPath:r?"url(#clipPath-".concat(s,")"):void 0},N.createElement(Gd,Ko({},je(h,!0),{points:e,connectNulls:u,type:l,baseLine:n,layout:a,stroke:"none",className:"recharts-area-area"})),c!=="none"&&N.createElement(Gd,Ko({},je(i,!1),{className:"recharts-area-curve",layout:a,type:l,connectNulls:u,fill:"none",points:e})),c!=="none"&&d&&N.createElement(Gd,Ko({},je(i,!1),{className:"recharts-area-curve",layout:a,type:l,connectNulls:u,fill:"none",points:n}))),N.createElement(vne,{points:e,props:i,clipPathId:s}),o&&Ki.renderCallByParent(i,e))}function bne(t){var{alpha:e,baseLine:n,points:r,strokeWidth:s}=t,i=r[0].y,o=r[r.length-1].y;if(!On(i)||!On(o))return null;var a=e*Math.abs(i-o),l=Math.max(...r.map(c=>c.x||0));return Ne(n)?l=Math.max(n,l):n&&Array.isArray(n)&&n.length&&(l=Math.max(...n.map(c=>c.x||0),l)),Ne(l)?N.createElement("rect",{x:0,y:i<o?i:i-a,width:l+(s?parseInt("".concat(s),10):1),height:Math.floor(a)}):null}function wne(t){var{alpha:e,baseLine:n,points:r,strokeWidth:s}=t,i=r[0].x,o=r[r.length-1].x;if(!On(i)||!On(o))return null;var a=e*Math.abs(i-o),l=Math.max(...r.map(c=>c.y||0));return Ne(n)?l=Math.max(n,l):n&&Array.isArray(n)&&n.length&&(l=Math.max(...n.map(c=>c.y||0),l)),Ne(l)?N.createElement("rect",{x:i<o?i:i-a,y:0,width:a,height:Math.floor(l+(s?parseInt("".concat(s),10):1))}):null}function kne(t){var{alpha:e,layout:n,points:r,baseLine:s,strokeWidth:i}=t;return n==="vertical"?N.createElement(bne,{alpha:e,points:r,baseLine:s,strokeWidth:i}):N.createElement(wne,{alpha:e,points:r,baseLine:s,strokeWidth:i})}function Cne(t){var{needClip:e,clipPathId:n,props:r,previousPointsRef:s,previousBaselineRef:i}=t,{points:o,baseLine:a,isAnimationActive:l,animationBegin:c,animationDuration:u,animationEasing:d,onAnimationStart:h,onAnimationEnd:f}=r,p=yx(r,"recharts-area-"),[m,x]=N.useState(!0),g=N.useCallback(()=>{typeof f=="function"&&f(),x(!1)},[f]),y=N.useCallback(()=>{typeof h=="function"&&h(),x(!0)},[h]),b=s.current,w=i.current;return N.createElement(eo,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},onAnimationEnd:g,onAnimationStart:y,key:p},k=>{var{t:C}=k;if(b){var S=b.length/o.length,I=C===1?o:o.map((E,A)=>{var D=Math.floor(A*S);if(b[D]){var P=b[D];return Xa(Xa({},E),{},{x:ec(P.x,E.x,C),y:ec(P.y,E.y,C)})}return E}),$;return Ne(a)?$=ec(w,a,C):lt(a)||Vr(a)?$=ec(w,0,C):$=a.map((E,A)=>{var D=Math.floor(A*S);if(Array.isArray(w)&&w[D]){var P=w[D];return Xa(Xa({},E),{},{x:ec(P.x,E.x,C),y:ec(P.y,E.y,C)})}return E}),C>0&&(s.current=I,i.current=$),N.createElement(Q1,{points:I,baseLine:$,needClip:e,clipPathId:n,props:r,showLabels:!m})}return C>0&&(s.current=o,i.current=a),N.createElement(Ot,null,N.createElement("defs",null,N.createElement("clipPath",{id:"animationClipPath-".concat(n)},N.createElement(kne,{alpha:C,points:o,baseLine:a,layout:r.layout,strokeWidth:r.strokeWidth}))),N.createElement(Ot,{clipPath:"url(#animationClipPath-".concat(n,")")},N.createElement(Q1,{points:o,baseLine:a,needClip:e,clipPathId:n,props:r,showLabels:!0})))})}function Sne(t){var{needClip:e,clipPathId:n,props:r}=t,{points:s,baseLine:i,isAnimationActive:o}=r,a=N.useRef(null),l=N.useRef(),c=a.current,u=l.current;return o&&s&&s.length&&(c!==s||u!==i)?N.createElement(Cne,{needClip:e,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:l}):N.createElement(Q1,{points:s,baseLine:i,needClip:e,clipPathId:n,props:r,showLabels:!0})}class Ine extends N.PureComponent{constructor(){super(...arguments),Ix(this,"id",ta("recharts-area-"))}render(){var e,{hide:n,dot:r,points:s,className:i,top:o,left:a,needClip:l,xAxisId:c,yAxisId:u,width:d,height:h,id:f,baseLine:p}=this.props;if(n)return null;var m=ot("recharts-area",i),x=lt(f)?this.id:f,{r:g=3,strokeWidth:y=2}=(e=je(r,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},b=L0(r),w=g*2+y;return N.createElement(N.Fragment,null,N.createElement(Ot,{className:m},l&&N.createElement("defs",null,N.createElement(wS,{clipPathId:x,xAxisId:c,yAxisId:u}),!b&&N.createElement("clipPath",{id:"clipPath-dots-".concat(x)},N.createElement("rect",{x:a-w/2,y:o-w/2,width:d+w,height:h+w}))),N.createElement(Sne,{needClip:l,clipPathId:x,props:this.props})),N.createElement(K1,{points:s,mainColor:Og(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(p)&&N.createElement(K1,{points:p,mainColor:Og(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var nL={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!_l.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function Nne(t){var e,n=ei(t,nL),{activeDot:r,animationBegin:s,animationDuration:i,animationEasing:o,connectNulls:a,dot:l,fill:c,fillOpacity:u,hide:d,isAnimationActive:h,legendType:f,stroke:p,xAxisId:m,yAxisId:x}=n,g=tL(n,dne),y=Z0(),b=kQ(),{needClip:w}=kx(m,x),k=hr(),C=N.useMemo(()=>({baseValue:t.baseValue,stackId:t.stackId,connectNulls:a,data:t.data,dataKey:t.dataKey}),[t.baseValue,t.stackId,a,t.data,t.dataKey]),{points:S,isRange:I,baseLine:$}=(e=Te(O=>cne(O,m,x,k,C)))!==null&&e!==void 0?e:{},{height:E,width:A,x:D,y:P}=wx();return y!=="horizontal"&&y!=="vertical"||b!=="AreaChart"&&b!=="ComposedChart"?null:N.createElement(Ine,Ko({},g,{activeDot:r,animationBegin:s,animationDuration:i,animationEasing:o,baseLine:$,connectNulls:a,dot:l,fill:c,fillOpacity:u,height:E,hide:d,layout:y,isAnimationActive:h,isRange:I,legendType:f,needClip:w,points:S,stroke:p,width:A,left:D,top:P,xAxisId:m,yAxisId:x}))}var $ne=(t,e,n,r,s)=>{var i=n??e;if(Ne(i))return i;var o=t==="horizontal"?s:r,a=o.scale.domain();if(o.type==="number"){var l=Math.max(a[0],a[1]),c=Math.min(a[0],a[1]);return i==="dataMin"?c:i==="dataMax"||l<0?l:Math.max(Math.min(a[0],a[1]),0)}return i==="dataMin"?a[0]:i==="dataMax"?a[1]:a[0]};function Ene(t){var{areaSettings:{connectNulls:e,baseValue:n,dataKey:r},stackedData:s,layout:i,chartBaseValue:o,xAxis:a,yAxis:l,displayedData:c,dataStartIndex:u,xAxisTicks:d,yAxisTicks:h,bandSize:f}=t,p=s&&s.length,m=$ne(i,o,n,a,l),x=i==="horizontal",g=!1,y=c.map((w,k)=>{var C;p?C=s[u+k]:(C=dt(w,r),Array.isArray(C)?g=!0:C=[m,C]);var S=C[1]==null||p&&!e&&dt(w,r)==null;return x?{x:dg({axis:a,ticks:d,bandSize:f,entry:w,index:k}),y:S?null:l.scale(C[1]),value:C,payload:w}:{x:S?null:a.scale(C[1]),y:dg({axis:l,ticks:h,bandSize:f,entry:w,index:k}),value:C,payload:w}}),b;return p||g?b=y.map(w=>{var k=Array.isArray(w.value)?w.value[0]:null;return x?{x:w.x,y:k!=null&&w.y!=null?l.scale(k):null}:{x:k!=null?a.scale(k):null,y:w.y}}):b=x?l.scale(m):a.scale(m),{points:y,baseLine:b,isRange:g}}class Kd extends N.PureComponent{render(){return N.createElement(bS,{type:"area",data:this.props.data,dataKey:this.props.dataKey,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,stackId:this.props.stackId,hide:this.props.hide,barSize:void 0},N.createElement(vS,{legendPayload:mne(this.props)}),N.createElement(xx,{fn:gne,args:this.props}),N.createElement(Nne,this.props))}}Ix(Kd,"displayName","Area");Ix(Kd,"defaultProps",nL);function QT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function ZT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QT(Object(n),!0).forEach(function(r){Tne(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QT(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Tne(t,e,n){return(e=Ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ane(t){var e=Dne(t,"string");return typeof e=="symbol"?e:e+""}function Dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var One={xAxis:{},yAxis:{},zAxis:{}},rL=Is({name:"cartesianAxis",initialState:One,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:n,width:r}=e.payload;t.yAxis[n]&&(t.yAxis[n]=ZT(ZT({},t.yAxis[n]),{},{width:r}))}}}),{addXAxis:Rne,removeXAxis:Pne,addYAxis:_ne,removeYAxis:Mne,addZAxis:lOe,removeZAxis:cOe,updateYAxisWidth:Fne}=rL.actions,Lne=rL.reducer,jne=["children"],zne=["dangerouslySetInnerHTML","ticks"];function sL(t,e,n){return(e=Bne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bne(t){var e=Wne(t,"string");return typeof e=="symbol"?e:e+""}function Wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z1(){return Z1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z1.apply(null,arguments)}function iL(t,e){if(t==null)return{};var n,r,s=Une(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Une(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Vne(t){var e=Vt(),n=N.useMemo(()=>{var i=iL(t,jne);return i},[t]),r=Te(i=>fo(i,n.id)),s=n===r;return N.useEffect(()=>(e(Rne(n)),()=>{e(Pne(n))}),[n,e]),s?t.children:null}var Gne=t=>{var{xAxisId:e,className:n}=t,r=Te(q_),s=hr(),i="xAxis",o=Te(d=>Ou(d,i,e,s)),a=Te(d=>_F(d,i,e,s)),l=Te(d=>DF(d,e)),c=Te(d=>IY(d,e));if(l==null||c==null)return null;var u=iL(t,zne);return N.createElement(_u,Z1({},u,{scale:o,x:c.x,y:c.y,width:l.width,height:l.height,className:ot("recharts-".concat(i," ").concat(i),n),viewBox:r,ticks:a}))},Hne=t=>{var e,n,r,s,i;return N.createElement(Vne,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(n=t.includeHidden)!==null&&n!==void 0?n:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(r=t.angle)!==null&&r!==void 0?r:0,minTickGap:(s=t.minTickGap)!==null&&s!==void 0?s:5,tick:(i=t.tick)!==null&&i!==void 0?i:!0,tickFormatter:t.tickFormatter},N.createElement(Gne,t))};class Fc extends N.Component{render(){return N.createElement(Hne,this.props)}}sL(Fc,"displayName","XAxis");sL(Fc,"defaultProps",{allowDataOverflow:Ar.allowDataOverflow,allowDecimals:Ar.allowDecimals,allowDuplicatedCategory:Ar.allowDuplicatedCategory,height:Ar.height,hide:!1,mirror:Ar.mirror,orientation:Ar.orientation,padding:Ar.padding,reversed:Ar.reversed,scale:Ar.scale,tickCount:Ar.tickCount,type:Ar.type,xAxisId:0});var Kne=t=>{var{ticks:e,label:n,labelGapWithTick:r=5,tickSize:s=0,tickMargin:i=0}=t,o=0;if(e){e.forEach(u=>{if(u){var d=u.getBoundingClientRect();d.width>o&&(o=d.width)}});var a=n?n.getBoundingClientRect().width:0,l=s+i,c=o+l+a+(n?r:0);return Math.round(c)}return 0},qne=["dangerouslySetInnerHTML","ticks"];function oL(t,e,n){return(e=Xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:e+""}function Yne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J1(){return J1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J1.apply(null,arguments)}function Qne(t,e){if(t==null)return{};var n,r,s=Zne(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Zne(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Jne(t){var e=Vt();return N.useEffect(()=>(e(_ne(t)),()=>{e(Mne(t))}),[t,e]),null}var ere=t=>{var e,{yAxisId:n,className:r,width:s,label:i}=t,o=N.useRef(null),a=N.useRef(null),l=Te(q_),c=hr(),u=Vt(),d="yAxis",h=Te(g=>Ou(g,d,n,c)),f=Te(g=>OF(g,n)),p=Te(g=>NY(g,n)),m=Te(g=>_F(g,d,n,c));if(N.useLayoutEffect(()=>{var g;if(!(s!=="auto"||!f||uS(i)||N.isValidElement(i))){var y=o.current,b=y==null||(g=y.tickRefs)===null||g===void 0?void 0:g.current,{tickSize:w,tickMargin:k}=y.props,C=Kne({ticks:b,label:a.current,labelGapWithTick:5,tickSize:w,tickMargin:k});Math.round(f.width)!==Math.round(C)&&u(Fne({id:n,width:C}))}},[o,o==null||(e=o.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,f==null?void 0:f.width,f,u,i,n,s]),f==null||p==null)return null;var x=Qne(t,qne);return N.createElement(_u,J1({},x,{ref:o,labelRef:a,scale:h,x:p.x,y:p.y,width:f.width,height:f.height,className:ot("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:m}))},tre=t=>{var e,n,r,s,i;return N.createElement(N.Fragment,null,N.createElement(Jne,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(n=t.includeHidden)!==null&&n!==void 0?n:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(r=t.angle)!==null&&r!==void 0?r:0,minTickGap:(s=t.minTickGap)!==null&&s!==void 0?s:5,tick:(i=t.tick)!==null&&i!==void 0?i:!0,tickFormatter:t.tickFormatter}),N.createElement(ere,t))},nre={allowDataOverflow:Dr.allowDataOverflow,allowDecimals:Dr.allowDecimals,allowDuplicatedCategory:Dr.allowDuplicatedCategory,hide:!1,mirror:Dr.mirror,orientation:Dr.orientation,padding:Dr.padding,reversed:Dr.reversed,scale:Dr.scale,tickCount:Dr.tickCount,type:Dr.type,width:Dr.width,yAxisId:0};class Lc extends N.Component{render(){return N.createElement(tre,this.props)}}oL(Lc,"displayName","YAxis");oL(Lc,"defaultProps",nre);var rre={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sf=N;function sre(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ire=typeof Object.is=="function"?Object.is:sre,ore=sf.useSyncExternalStore,are=sf.useRef,lre=sf.useEffect,cre=sf.useMemo,ure=sf.useDebugValue;rre.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=are(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=cre(function(){function l(f){if(!c){if(c=!0,u=f,f=r(f),s!==void 0&&o.hasValue){var p=o.value;if(s(p,f))return d=p}return d=f}if(p=d,ire(u,f))return p;var m=r(f);return s!==void 0&&s(p,m)?(u=f,p):(u=f,d=m)}var c=!1,u,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,r,s]);var a=ore(t,i[0],i[1]);return lre(function(){o.hasValue=!0,o.value=a},[a]),ure(a),a};function dre(t){t()}function hre(){let t=null,e=null;return{clear(){t=null,e=null},notify(){dre(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var JT={notify(){},get:()=>[]};function fre(t,e){let n,r=JT,s=0,i=!1;function o(m){u();const x=r.subscribe(m);let g=!1;return()=>{g||(g=!0,x(),d())}}function a(){r.notify()}function l(){p.onStateChange&&p.onStateChange()}function c(){return i}function u(){s++,n||(n=t.subscribe(l),r=hre())}function d(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=JT)}function h(){i||(i=!0,u())}function f(){i&&(i=!1,d())}const p={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:h,tryUnsubscribe:f,getListeners:()=>r};return p}var pre=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mre=pre(),gre=()=>typeof navigator<"u"&&navigator.product==="ReactNative",xre=gre(),yre=()=>mre||xre?N.useLayoutEffect:N.useEffect,vre=yre(),Qv=Symbol.for("react-redux-context"),Zv=typeof globalThis<"u"?globalThis:{};function bre(){if(!N.createContext)return{};const t=Zv[Qv]??(Zv[Qv]=new Map);let e=t.get(N.createContext);return e||(e=N.createContext(null),t.set(N.createContext,e)),e}var wre=bre();function kre(t){const{children:e,context:n,serverState:r,store:s}=t,i=N.useMemo(()=>{const l=fre(s);return{store:s,subscription:l,getServerState:r?()=>r:void 0}},[s,r]),o=N.useMemo(()=>s.getState(),[s]);vre(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=n||wre;return N.createElement(a.Provider,{value:i},e)}var Cre=kre,Sre=(t,e)=>e,NS=X([Sre,Ge,j9,kn,QF,xa,CQ,bn],IQ),$S=t=>{var e=t.currentTarget.getBoundingClientRect(),n=e.width/t.currentTarget.offsetWidth,r=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/n),chartY:Math.round((t.clientY-e.top)/r)}},aL=vs("mouseClick"),lL=Gh();lL.startListening({actionCreator:aL,effect:(t,e)=>{var n=t.payload,r=NS(e.getState(),$S(n));(r==null?void 0:r.activeIndex)!=null&&e.dispatch(FY({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var ew=vs("mouseMove"),cL=Gh();cL.startListening({actionCreator:ew,effect:(t,e)=>{var n=t.payload,r=e.getState(),s=jF(r,r.tooltip.settings.shared),i=NS(r,$S(n));s==="axis"&&((i==null?void 0:i.activeIndex)!=null?e.dispatch(VF({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):e.dispatch(UF()))}});function Ire(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var eA={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},uL=Is({name:"rootProps",initialState:eA,reducers:{updateOptions:(t,e)=>{var n;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(n=e.payload.barGap)!==null&&n!==void 0?n:eA.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),Nre=uL.reducer,{updateOptions:$re}=uL.actions,dL=Is({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:Ere}=dL.actions,Tre=dL.reducer,hL=vs("keyDown"),fL=vs("focus"),ES=Gh();ES.startListening({actionCreator:hL,effect:(t,e)=>{var n=e.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:s}=n.tooltip,i=t.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(nS(s,zl(n))),a=xa(n);if(i==="Enter"){var l=Ng(n,"axis","hover",String(s.index));e.dispatch(U1({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:l}));return}var c=AY(n),u=c==="left-to-right"?1:-1,d=i==="ArrowRight"?1:-1,h=o+d*u;if(!(a==null||h>=a.length||h<0)){var f=Ng(n,"axis","hover",String(h));e.dispatch(U1({active:!0,activeIndex:h.toString(),activeDataKey:void 0,activeCoordinate:f}))}}}}});ES.startListening({actionCreator:fL,effect:(t,e)=>{var n=e.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:s}=n.tooltip;if(!s.active&&s.index==null){var i="0",o=Ng(n,"axis","hover",String(i));e.dispatch(U1({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var rs=vs("externalEvent"),pL=Gh();pL.startListening({actionCreator:rs,effect:(t,e)=>{if(t.payload.handler!=null){var n=e.getState(),r={activeCoordinate:yQ(n),activeDataKey:e3(n),activeIndex:na(n),activeLabel:JF(n),activeTooltipIndex:na(n),isTooltipActive:vQ(n)};t.payload.handler(r,t.payload.reactEvent)}}});var Are=X([rf],t=>t.tooltipItemPayloads),Dre=X([Are,nf,(t,e,n)=>e,(t,e,n)=>n],(t,e,n,r)=>{var s=t.find(a=>a.settings.dataKey===r);if(s!=null){var{positions:i}=s;if(i!=null){var o=e(i,n);return o}}}),mL=vs("touchMove"),gL=Gh();gL.startListening({actionCreator:mL,effect:(t,e)=>{var n=t.payload,r=e.getState(),s=jF(r,r.tooltip.settings.shared);if(s==="axis"){var i=NS(r,$S({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&e.dispatch(VF({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(s==="item"){var o,a=n.touches[0],l=document.elementFromPoint(a.clientX,a.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(H_),u=(o=l.getAttribute(K_))!==null&&o!==void 0?o:void 0,d=Dre(e.getState(),c,u);e.dispatch(WF({activeDataKey:u,activeIndex:c,activeCoordinate:d}))}}});var Ore=w_({brush:ute,cartesianAxis:Lne,chartData:PQ,graphicalItems:nJ,layout:mK,legend:JK,options:AQ,polarAxis:zZ,polarOptions:Tre,referenceElements:yte,rootProps:Nre,tooltip:LY}),Rre=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return z8({reducer:Ore,preloadedState:e,middleware:r=>r({serializableCheck:!1}).concat([lL.middleware,cL.middleware,ES.middleware,pL.middleware,gL.middleware]),devTools:{serialize:{replacer:Ire},name:"recharts-".concat(n)}})};function xL(t){var{preloadedState:e,children:n,reduxStoreName:r}=t,s=hr(),i=N.useRef(null);if(s)return n;i.current==null&&(i.current=Rre(e,r));var o=Yk;return N.createElement(Cre,{context:o,store:i.current},n)}function yL(t){var{layout:e,width:n,height:r,margin:s}=t,i=Vt(),o=hr();return N.useEffect(()=>{o||(i(hK(e)),i(fK({width:n,height:r})),i(dK(s)))},[i,o,e,n,r,s]),null}function vL(t){var e=Vt();return N.useEffect(()=>{e($re(t))},[e,t]),null}var Pre=["children"];function _re(t,e){if(t==null)return{};var n,r,s=Mre(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Mre(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Rg(){return Rg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rg.apply(null,arguments)}var Fre={width:"100%",height:"100%"},Lre=N.forwardRef((t,e)=>{var n=YK(),r=QK(),s=t7();if(!su(n)||!su(r))return null;var{children:i,otherAttributes:o,title:a,desc:l}=t,c,u;return typeof o.tabIndex=="number"?c=o.tabIndex:c=s?0:void 0,typeof o.role=="string"?u=o.role:u=s?"application":void 0,N.createElement(LP,Rg({},o,{title:a,desc:l,role:u,tabIndex:c,width:n,height:r,style:Fre,ref:e}),i)}),jre=t=>{var{children:e}=t,n=Te(Q0);if(!n)return null;var{width:r,height:s,y:i,x:o}=n;return N.createElement(LP,{width:r,height:s,x:o,y:i},e)},tA=N.forwardRef((t,e)=>{var{children:n}=t,r=_re(t,Pre),s=hr();return s?N.createElement(jre,null,n):N.createElement(Lre,Rg({ref:e},r),n)});function zre(){var t=Vt(),[e,n]=N.useState(null),r=Te(UK);return N.useEffect(()=>{if(e!=null){var s=e.getBoundingClientRect(),i=s.width/e.offsetWidth;On(i)&&i!==r&&t(pK(i))}},[e,t,r]),n}function nA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Bre(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nA(Object(n),!0).forEach(function(r){Wre(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Wre(t,e,n){return(e=Ure(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ure(t){var e=Vre(t,"string");return typeof e=="symbol"?e:e+""}function Vre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gre=N.forwardRef((t,e)=>{var{children:n,className:r,height:s,onClick:i,onContextMenu:o,onDoubleClick:a,onMouseDown:l,onMouseEnter:c,onMouseLeave:u,onMouseMove:d,onMouseUp:h,onTouchEnd:f,onTouchMove:p,onTouchStart:m,style:x,width:g}=t,y=Vt(),[b,w]=N.useState(null),[k,C]=N.useState(null);FQ();var S=zre(),I=N.useCallback(q=>{S(q),typeof e=="function"&&e(q),w(q),C(q)},[S,e,w,C]),$=N.useCallback(q=>{y(aL(q)),y(rs({handler:i,reactEvent:q}))},[y,i]),E=N.useCallback(q=>{y(ew(q)),y(rs({handler:c,reactEvent:q}))},[y,c]),A=N.useCallback(q=>{y(UF()),y(rs({handler:u,reactEvent:q}))},[y,u]),D=N.useCallback(q=>{y(ew(q)),y(rs({handler:d,reactEvent:q}))},[y,d]),P=N.useCallback(()=>{y(fL())},[y]),O=N.useCallback(q=>{y(hL(q.key))},[y]),F=N.useCallback(q=>{y(rs({handler:o,reactEvent:q}))},[y,o]),U=N.useCallback(q=>{y(rs({handler:a,reactEvent:q}))},[y,a]),V=N.useCallback(q=>{y(rs({handler:l,reactEvent:q}))},[y,l]),_=N.useCallback(q=>{y(rs({handler:h,reactEvent:q}))},[y,h]),z=N.useCallback(q=>{y(rs({handler:m,reactEvent:q}))},[y,m]),K=N.useCallback(q=>{y(mL(q)),y(rs({handler:p,reactEvent:q}))},[y,p]),Z=N.useCallback(q=>{y(rs({handler:f,reactEvent:q}))},[y,f]);return N.createElement(NQ.Provider,{value:b},N.createElement(q5.Provider,{value:k},N.createElement("div",{className:ot("recharts-wrapper",r),style:Bre({position:"relative",cursor:"default",width:g,height:s},x),onClick:$,onContextMenu:F,onDoubleClick:U,onFocus:P,onKeyDown:O,onMouseDown:V,onMouseEnter:E,onMouseLeave:A,onMouseMove:D,onMouseUp:_,onTouchEnd:Z,onTouchMove:K,onTouchStart:z,ref:I},n)))}),Hre=["children","className","width","height","style","compact","title","desc"];function Kre(t,e){if(t==null)return{};var n,r,s=qre(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function qre(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var bL=N.forwardRef((t,e)=>{var{children:n,className:r,width:s,height:i,style:o,compact:a,title:l,desc:c}=t,u=Kre(t,Hre),d=je(u,!1);return a?N.createElement(tA,{otherAttributes:d,title:l,desc:c},n):N.createElement(Gre,{className:r,style:o,width:s,height:i,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},N.createElement(tA,{otherAttributes:d,title:l,desc:c,ref:e},N.createElement(bte,null,n)))}),Xre=["width","height"];function tw(){return tw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tw.apply(null,arguments)}function Yre(t,e){if(t==null)return{};var n,r,s=Qre(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Qre(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var Zre={top:5,right:5,bottom:5,left:5},Jre={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Zre,reverseStackOrder:!1,syncMethod:"index"},TS=N.forwardRef(function(e,n){var r,s=ei(e.categoricalChartProps,Jre),{width:i,height:o}=s,a=Yre(s,Xre);if(!su(i)||!su(o))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,categoricalChartProps:h}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return N.createElement(xL,{preloadedState:{options:f},reduxStoreName:(r=h.id)!==null&&r!==void 0?r:l},N.createElement(W3,{chartData:h.data}),N.createElement(yL,{width:i,height:o,layout:s.layout,margin:s.margin}),N.createElement(vL,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),N.createElement(bL,tw({},a,{width:i,height:o,ref:n})))}),ese=["axis"],wL=N.forwardRef((t,e)=>N.createElement(TS,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ese,tooltipPayloadSearcher:mx,categoricalChartProps:t,ref:e})),tse=["axis","item"],nse=N.forwardRef((t,e)=>N.createElement(TS,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:tse,tooltipPayloadSearcher:mx,categoricalChartProps:t,ref:e}));function rse(t){var e=Vt();return N.useEffect(()=>{e(Ere(t))},[e,t]),null}var sse=["width","height","layout"];function nw(){return nw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nw.apply(null,arguments)}function ise(t,e){if(t==null)return{};var n,r,s=ose(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function ose(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var ase={top:5,right:5,bottom:5,left:5},lse={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:ase,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},cse=N.forwardRef(function(e,n){var r,s=ei(e.categoricalChartProps,lse),{width:i,height:o,layout:a}=s,l=ise(s,sse);if(!su(i)||!su(o))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h}=e,f={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return N.createElement(xL,{preloadedState:{options:f},reduxStoreName:(r=s.id)!==null&&r!==void 0?r:c},N.createElement(W3,{chartData:s.data}),N.createElement(yL,{width:i,height:o,layout:a,margin:s.margin}),N.createElement(vL,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),N.createElement(rse,{cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius}),N.createElement(bL,nw({width:i,height:o},l,{ref:n})))}),use=["item"],dse={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},kL=N.forwardRef((t,e)=>{var n=ei(t,dse);return N.createElement(cse,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:use,tooltipPayloadSearcher:mx,categoricalChartProps:n,ref:e})}),hse=["axis"],fse=N.forwardRef((t,e)=>N.createElement(TS,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:hse,tooltipPayloadSearcher:mx,categoricalChartProps:t,ref:e}));const CL=6048e5,pse=864e5,rA=Symbol.for("constructDateFrom");function Xs(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&rA in t?t[rA](e):t instanceof Date?new t.constructor(e):new Date(e)}function dn(t,e){return Xs(e||t,t)}function SL(t,e,n){const r=dn(t,n==null?void 0:n.in);return isNaN(e)?Xs(t,NaN):(e&&r.setDate(r.getDate()+e),r)}let mse={};function of(){return mse}function uu(t,e){var a,l,c,u;const n=of(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=dn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Pg(t,e){return uu(t,{...e,weekStartsOn:1})}function IL(t,e){const n=dn(t,e==null?void 0:e.in),r=n.getFullYear(),s=Xs(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=Pg(s),o=Xs(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const a=Pg(o);return n.getTime()>=i.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function sA(t){const e=dn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function NL(t,...e){const n=Xs.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function _g(t,e){const n=dn(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function gse(t,e,n){const[r,s]=NL(n==null?void 0:n.in,t,e),i=_g(r),o=_g(s),a=+i-sA(i),l=+o-sA(o);return Math.round((a-l)/pse)}function xse(t,e){const n=IL(t,e),r=Xs(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Pg(r)}function $L(t){return Xs(t,Date.now())}function EL(t,e,n){const[r,s]=NL(n==null?void 0:n.in,t,e);return+_g(r)==+_g(s)}function yse(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function vse(t){return!(!yse(t)&&typeof t!="number"||isNaN(+dn(t)))}function bse(t,e){const n=dn(t,e==null?void 0:e.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function wse(t,e){const n=dn(t,e==null?void 0:e.in);return n.setDate(1),n.setHours(0,0,0,0),n}function kse(t,e){const n=dn(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Cse(t,e){var a,l;const n=of(),r=n.weekStartsOn??((l=(a=n.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,s=dn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const Sse={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ise=(t,e,n)=>{let r;const s=Sse[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Jv(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Nse={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$se={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ese={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Tse={date:Jv({formats:Nse,defaultWidth:"full"}),time:Jv({formats:$se,defaultWidth:"full"}),dateTime:Jv({formats:Ese,defaultWidth:"full"})},Ase={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Dse=(t,e,n,r)=>Ase[t];function gd(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const Ose={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Rse={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Pse={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_se={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Mse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Fse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Lse=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},jse={ordinalNumber:Lse,era:gd({values:Ose,defaultWidth:"wide"}),quarter:gd({values:Rse,defaultWidth:"wide",argumentCallback:t=>t-1}),month:gd({values:Pse,defaultWidth:"wide"}),day:gd({values:_se,defaultWidth:"wide"}),dayPeriod:gd({values:Mse,defaultWidth:"wide",formattingValues:Fse,defaultFormattingWidth:"wide"})};function xd(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?Bse(a,d=>d.test(o)):zse(a,d=>d.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function zse(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function Bse(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function Wse(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const Use=/^(\d+)(th|st|nd|rd)?/i,Vse=/\d+/i,Gse={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Hse={any:[/^b/i,/^(a|c)/i]},Kse={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qse={any:[/1/i,/2/i,/3/i,/4/i]},Xse={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Yse={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Qse={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Zse={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Jse={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},eie={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},tie={ordinalNumber:Wse({matchPattern:Use,parsePattern:Vse,valueCallback:t=>parseInt(t,10)}),era:xd({matchPatterns:Gse,defaultMatchWidth:"wide",parsePatterns:Hse,defaultParseWidth:"any"}),quarter:xd({matchPatterns:Kse,defaultMatchWidth:"wide",parsePatterns:qse,defaultParseWidth:"any",valueCallback:t=>t+1}),month:xd({matchPatterns:Xse,defaultMatchWidth:"wide",parsePatterns:Yse,defaultParseWidth:"any"}),day:xd({matchPatterns:Qse,defaultMatchWidth:"wide",parsePatterns:Zse,defaultParseWidth:"any"}),dayPeriod:xd({matchPatterns:Jse,defaultMatchWidth:"any",parsePatterns:eie,defaultParseWidth:"any"})},nie={code:"en-US",formatDistance:Ise,formatLong:Tse,formatRelative:Dse,localize:jse,match:tie,options:{weekStartsOn:0,firstWeekContainsDate:1}};function rie(t,e){const n=dn(t,e==null?void 0:e.in);return gse(n,kse(n))+1}function sie(t,e){const n=dn(t,e==null?void 0:e.in),r=+Pg(n)-+xse(n);return Math.round(r/CL)+1}function TL(t,e){var u,d,h,f;const n=dn(t,e==null?void 0:e.in),r=n.getFullYear(),s=of(),i=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((f=(h=s.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=Xs((e==null?void 0:e.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=uu(o,e),l=Xs((e==null?void 0:e.in)||t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=uu(l,e);return+n>=+a?r+1:+n>=+c?r:r-1}function iie(t,e){var a,l,c,u;const n=of(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=TL(t,e),i=Xs((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),uu(i,e)}function oie(t,e){const n=dn(t,e==null?void 0:e.in),r=+uu(n,e)-+iie(n,e);return Math.round(r/CL)+1}function tt(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Io={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return tt(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):tt(n+1,2)},d(t,e){return tt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return tt(t.getHours()%12||12,e.length)},H(t,e){return tt(t.getHours(),e.length)},m(t,e){return tt(t.getMinutes(),e.length)},s(t,e){return tt(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return tt(s,e.length)}},rc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},iA={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Io.y(t,e)},Y:function(t,e,n,r){const s=TL(t,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return tt(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):tt(i,e.length)},R:function(t,e){const n=IL(t);return tt(n,e.length)},u:function(t,e){const n=t.getFullYear();return tt(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return tt(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return tt(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return Io.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return tt(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=oie(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):tt(s,e.length)},I:function(t,e,n){const r=sie(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):tt(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Io.d(t,e)},D:function(t,e,n){const r=rie(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):tt(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return tt(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return tt(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return tt(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=rc.noon:r===0?s=rc.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=rc.evening:r>=12?s=rc.afternoon:r>=4?s=rc.morning:s=rc.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Io.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Io.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):tt(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):tt(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Io.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Io.s(t,e)},S:function(t,e){return Io.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return aA(r);case"XXXX":case"XX":return Fa(r);case"XXXXX":case"XXX":default:return Fa(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return aA(r);case"xxxx":case"xx":return Fa(r);case"xxxxx":case"xxx":default:return Fa(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+oA(r,":");case"OOOO":default:return"GMT"+Fa(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+oA(r,":");case"zzzz":default:return"GMT"+Fa(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return tt(r,e.length)},T:function(t,e,n){return tt(+t,e.length)}};function oA(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+tt(i,2)}function aA(t,e){return t%60===0?(t>0?"-":"+")+tt(Math.abs(t)/60,2):Fa(t,e)}function Fa(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=tt(Math.trunc(r/60),2),i=tt(r%60,2);return n+s+e+i}const lA=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},AL=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},aie=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return lA(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",lA(r,e)).replace("{{time}}",AL(s,e))},lie={p:AL,P:aie},cie=/^D+$/,uie=/^Y+$/,die=["D","DD","YY","YYYY"];function hie(t){return cie.test(t)}function fie(t){return uie.test(t)}function pie(t,e,n){const r=mie(t,e,n);if(console.warn(r),die.includes(t))throw new RangeError(r)}function mie(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const gie=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,xie=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yie=/^'([^]*?)'?$/,vie=/''/g,bie=/[a-zA-Z]/;function Ze(t,e,n){var u,d,h,f;const r=of(),s=r.locale??nie,i=r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=r.weekStartsOn??((f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,a=dn(t,n==null?void 0:n.in);if(!vse(a))throw new RangeError("Invalid time value");let l=e.match(xie).map(p=>{const m=p[0];if(m==="p"||m==="P"){const x=lie[m];return x(p,s.formatLong)}return p}).join("").match(gie).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:wie(p)};if(iA[m])return{isToken:!0,value:p};if(m.match(bie))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(p=>{if(!p.isToken)return p.value;const m=p.value;(fie(m)||hie(m))&&pie(m,e,String(t));const x=iA[m[0]];return x(a,m,s.localize,c)}).join("")}function wie(t){const e=t.match(yie);return e?e[1].replace(vie,"'"):t}function kie(t){return+dn(t)<Date.now()}function rw(t,e){return EL(Xs(t,t),$L(t))}function Cie(t,e){return EL(t,SL($L(t),1),e)}function sw(t,e,n){const r=+dn(t,n==null?void 0:n.in),[s,i]=[+dn(e.start,n==null?void 0:n.in),+dn(e.end,n==null?void 0:n.in)].sort((o,a)=>o-a);return r>=s&&r<=i}function iw(t,e,n){return SL(t,-e,n)}const Sie=({onLogout:t})=>{const[e,n]=N.useState(null),[r,s]=N.useState("");N.useState("overview");const i=Ce.getUserProfile(),a=Ce.getAllUsers().filter(f=>f.userType==="patient"&&(f.doctorId===(i==null?void 0:i.id)||r===""||f.name.toLowerCase().includes(r.toLowerCase())||f.id.toLowerCase().includes(r.toLowerCase()))),l=f=>{const p=Ce.getCurrentUser();Ce.setCurrentUser(f);const m=Ce.getMoodEntries(),x=Ce.getSleepEntries(),g=Ce.getFaceDiaryEntries(),y=Ce.getAssessment(),b=Ce.getTasks();return p&&Ce.setCurrentUser(p),{moodEntries:m,sleepEntries:x,faceDiaryEntries:g,assessment:y,tasks:b}},c=()=>{const f=a.length,p=a.filter(x=>{const{assessment:g}=l(x.id);return(g==null?void 0:g.riskLevel)==="high"}).length,m=a.filter(x=>{const{moodEntries:g,faceDiaryEntries:y}=l(x.id);return[...g,...y].filter(w=>sw(w.timestamp,{start:iw(new Date,7),end:new Date})).length>0}).length;return{totalPatients:f,highRiskPatients:p,recentActivity:m}},u=f=>{var C;const{moodEntries:p,sleepEntries:m,faceDiaryEntries:x,assessment:g}=l(f.id),y=p.slice(-1)[0],b=m.slice(-1)[0],w=x.slice(-1)[0],k=S=>{switch(S){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return v.jsxs("div",{onClick:()=>n(f.id),className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 cursor-pointer border border-gray-100 hover:border-blue-200",children:[v.jsxs("div",{className:"flex items-start justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl",children:v.jsx(fl,{size:24,className:"text-white"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-bold text-gray-800",children:f.name}),v.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",f.id.slice(0,8)]}),v.jsxs("p",{className:"text-xs text-gray-500",children:["Joined ",Ze(f.registeredAt,"MMM yyyy")]})]})]}),g&&v.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-medium border ${k(g.riskLevel)}`,children:[(C=g.riskLevel)==null?void 0:C.toUpperCase()," RISK"]})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[v.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-xl",children:[v.jsx(CP,{size:20,className:"text-blue-600 mx-auto mb-1"}),v.jsx("div",{className:"text-sm font-medium text-gray-800",children:p.length}),v.jsx("div",{className:"text-xs text-gray-600",children:"Mood Entries"})]}),v.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-xl",children:[v.jsx(SP,{size:20,className:"text-purple-600 mx-auto mb-1"}),v.jsx("div",{className:"text-sm font-medium text-gray-800",children:b?`${b.score}/100`:"N/A"}),v.jsx("div",{className:"text-xs text-gray-600",children:"Sleep Score"})]}),v.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-xl",children:[v.jsx(Zc,{size:20,className:"text-green-600 mx-auto mb-1"}),v.jsx("div",{className:"text-sm font-medium text-gray-800",children:w?w.analysis.overallScore:"N/A"}),v.jsx("div",{className:"text-xs text-gray-600",children:"Wellbeing"})]})]}),y&&v.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-xl",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-sm text-gray-600",children:"Latest Mood:"}),v.jsx("span",{className:"text-sm font-medium capitalize text-gray-800",children:y.mood})]})})]},f.id)},d=()=>{var k;if(!e)return null;const f=a.find(C=>C.id===e);if(!f)return null;const{moodEntries:p,sleepEntries:m,faceDiaryEntries:x,assessment:g,tasks:y}=l(e),b=Array.from({length:7},(C,S)=>{var $,E;const I=iw(new Date,S);return{date:Ze(I,"MMM dd"),mood:p.filter(A=>Ze(A.timestamp,"MMM dd")===Ze(I,"MMM dd")).length,sleep:(($=m.find(A=>Ze(A.bedtime,"MMM dd")===Ze(I,"MMM dd")))==null?void 0:$.score)||0,wellbeing:((E=x.find(A=>Ze(A.timestamp,"MMM dd")===Ze(I,"MMM dd")))==null?void 0:E.analysis.overallScore)||0}}).reverse(),w=[{name:"Sad",value:p.filter(C=>C.mood==="sad").length,color:"#EF4444"},{name:"Normal",value:p.filter(C=>C.mood==="normal").length,color:"#F59E0B"},{name:"Happy",value:p.filter(C=>C.mood==="happy").length,color:"#10B981"},{name:"Excited",value:p.filter(C=>C.mood==="excited").length,color:"#8B5CF6"}].filter(C=>C.value>0);return v.jsxs("div",{className:"space-y-6",children:[v.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-xl",children:v.jsx(fl,{size:32})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-bold",children:f.name}),v.jsxs("p",{className:"text-blue-100",children:["Patient ID: ",f.id.slice(0,8)]}),v.jsxs("p",{className:"text-blue-100 text-sm",children:[f.age&&`Age: ${f.age}  `,"Member since ",Ze(f.registeredAt,"MMM yyyy")]})]})]}),v.jsx("button",{onClick:()=>n(null),className:"p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors",children:""})]})}),g&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[v.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Initial Assessment"}),v.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("div",{className:`text-4xl font-bold mb-2 ${g.riskLevel==="high"?"text-red-600":g.riskLevel==="medium"?"text-yellow-600":"text-green-600"}`,children:[g.score,"/100"]}),v.jsxs("div",{className:`text-sm font-medium ${g.riskLevel==="high"?"text-red-600":g.riskLevel==="medium"?"text-yellow-600":"text-green-600"}`,children:[(k=g.riskLevel)==null?void 0:k.toUpperCase()," RISK"]})]}),v.jsxs("div",{className:"text-sm text-gray-600",children:[v.jsxs("p",{children:[v.jsx("strong",{children:"Completed:"})," ",Ze(g.completedAt,"MMM d, yyyy")]}),v.jsxs("p",{children:[v.jsx("strong",{children:"Questions:"})," 25 answered"]}),v.jsxs("p",{className:"mt-2",children:[g.riskLevel==="high"&&v.jsx("span",{className:"text-red-600",children:" Requires immediate attention"}),g.riskLevel==="medium"&&v.jsx("span",{className:"text-yellow-600",children:" Monitor closely"}),g.riskLevel==="low"&&v.jsx("span",{className:"text-green-600",children:" Low risk profile"})]})]})]})]}),v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[v.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"7-Day Trends"}),v.jsx("div",{className:"h-64",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsxs(wL,{data:b,children:[v.jsx(Fc,{dataKey:"date",fontSize:12}),v.jsx(Lc,{fontSize:12}),v.jsx(Mc,{type:"monotone",dataKey:"mood",stroke:"#3B82F6",strokeWidth:2,name:"Mood Entries"}),v.jsx(Mc,{type:"monotone",dataKey:"sleep",stroke:"#10B981",strokeWidth:2,name:"Sleep Score"}),v.jsx(Mc,{type:"monotone",dataKey:"wellbeing",stroke:"#8B5CF6",strokeWidth:2,name:"Wellbeing"})]})})}),v.jsxs("div",{className:"flex justify-center space-x-6 mt-4",children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:"Mood Entries"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-green-600 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:"Sleep Score"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-purple-600 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:"Wellbeing"})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[v.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Recent Mood Entries"}),v.jsx("div",{className:"space-y-3",children:p.slice(-5).reverse().map(C=>v.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[v.jsxs("div",{children:[v.jsx("span",{className:"font-medium capitalize",children:C.mood}),v.jsx("p",{className:"text-sm text-gray-600",children:Ze(C.timestamp,"MMM d, h:mm a")}),C.note&&v.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C.note})]}),v.jsx("div",{className:`w-3 h-3 rounded-full ${C.mood==="excited"?"bg-purple-500":C.mood==="happy"?"bg-green-500":C.mood==="normal"?"bg-yellow-500":"bg-red-500"}`})]},C.id))})]}),v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[v.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Face Diary Reports"}),v.jsx("div",{className:"space-y-3",children:x.slice(-5).reverse().map(C=>v.jsx("div",{className:"p-3 bg-gray-50 rounded-xl",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("span",{className:"font-medium",children:C.analysis.dominantEmotion}),v.jsx("p",{className:"text-sm text-gray-600",children:Ze(C.timestamp,"MMM d, h:mm a")}),C.analysis.depressionIndicators.length>0&&v.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[C.analysis.depressionIndicators.length," depression indicators"]})]}),v.jsx("div",{className:`text-lg font-bold ${C.analysis.overallScore>=70?"text-green-600":C.analysis.overallScore>=40?"text-yellow-600":"text-red-600"}`,children:C.analysis.overallScore})]})},C.id))})]})]}),w.length>0&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[v.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Mood Distribution"}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsx("div",{className:"h-48",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsx(kL,{children:v.jsx(bx,{data:w,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,dataKey:"value",children:w.map((C,S)=>v.jsx(Pu,{fill:C.color},`cell-${S}`))})})})}),v.jsx("div",{className:"space-y-2",children:w.map((C,S)=>v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C.color}}),v.jsx("span",{className:"text-sm text-gray-600",children:C.name})]}),v.jsxs("span",{className:"text-sm font-medium",children:[C.value," entries"]})]},S))})]})]})]})},h=c();return v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[v.jsx("div",{className:"bg-white shadow-sm border-b",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"p-2 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-xl",children:v.jsx(Zc,{size:24,className:"text-white"})}),v.jsxs("div",{children:[v.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Doctor Dashboard"}),v.jsxs("p",{className:"text-gray-600",children:["Welcome, Dr. ",i==null?void 0:i.name]})]})]}),v.jsxs("button",{onClick:t,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[v.jsx(d1,{size:20}),v.jsx("span",{children:"Logout"})]})]})})}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e?d():v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[v.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-2xl p-6 text-white",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-blue-100 text-sm",children:"Total Patients"}),v.jsx("p",{className:"text-3xl font-bold",children:h.totalPatients})]}),v.jsx(A$,{size:32,className:"text-blue-200"})]})}),v.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-700 rounded-2xl p-6 text-white",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-red-100 text-sm",children:"High Risk Patients"}),v.jsx("p",{className:"text-3xl font-bold",children:h.highRiskPatients})]}),v.jsx(r5,{size:32,className:"text-red-200"})]})}),v.jsx("div",{className:"bg-gradient-to-r from-green-600 to-green-700 rounded-2xl p-6 text-white",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-green-100 text-sm",children:"Active This Week"}),v.jsx("p",{className:"text-3xl font-bold",children:h.recentActivity})]}),v.jsx(EP,{size:32,className:"text-green-200"})]})})]}),v.jsx("div",{className:"mb-6",children:v.jsxs("div",{className:"relative max-w-md",children:[v.jsx(w5,{size:20,className:"absolute left-4 top-3 text-gray-400"}),v.jsx("input",{type:"text",placeholder:"Search patients by name or ID...",value:r,onChange:f=>s(f.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"})]})}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(u)}),a.length===0&&v.jsxs("div",{className:"text-center py-12",children:[v.jsx(A$,{size:48,className:"text-gray-300 mx-auto mb-4"}),v.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No patients found"}),v.jsx("p",{className:"text-gray-500",children:r?"Try adjusting your search terms":"Patients will appear here when they add your doctor ID"})]})]})})]})},Iie=({activeTab:t,onTabChange:e})=>{const n=[{id:"home",label:"Home",icon:f5,emoji:""},{id:"chat",label:"AI Chat",icon:h1,emoji:""},{id:"planner",label:"Planner",icon:wP,emoji:""},{id:"face-diary",label:"Face Diary",icon:a5,emoji:""},{id:"profile",label:"Profile",icon:fl,emoji:""}];return v.jsx("nav",{className:"bg-white shadow-2xl border-t-2 border-orange-200",children:v.jsx("div",{className:"max-w-md mx-auto",children:v.jsx("div",{className:"flex justify-around py-2",children:n.map(r=>{const s=r.icon,i=t===r.id;return v.jsxs("button",{onClick:()=>e(r.id),className:`flex flex-col items-center p-3 rounded-2xl transition-all duration-300 transform ${i?"text-orange-600 bg-gradient-to-t from-orange-50 to-red-50 scale-110 shadow-lg":"text-gray-600 hover:text-orange-600 hover:bg-orange-50 hover:scale-105"}`,children:[v.jsxs("div",{className:"relative",children:[v.jsx(s,{size:24}),i&&v.jsx("div",{className:"absolute -top-1 -right-1 text-sm",children:r.emoji})]}),v.jsx("span",{className:"text-xs mt-1 font-medium",children:r.label}),i&&v.jsx("div",{className:"w-1 h-1 bg-orange-500 rounded-full mt-1"})]},r.id)})})})})},Nie=({title:t,subtitle:e})=>v.jsx("header",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white p-4",children:v.jsx("div",{className:"max-w-md mx-auto",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:v.jsx(Zc,{size:24})}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("h1",{className:"text-xl font-bold",children:"Mindfit AI"}),v.jsx("span",{className:"text-2xl",children:""})]}),e&&v.jsx("p",{className:"text-orange-100 text-sm",children:e})]})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("button",{className:"p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors",children:v.jsx(i5,{size:20})}),v.jsx("button",{className:"p-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors",children:v.jsx(C5,{size:20})})]})]})})});/*! Capacitor: https://capacitorjs.com/ - MIT License */var du;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(du||(du={}));class jc extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const $ie=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Eie=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:$ie(t),i=()=>s()!=="web",o=d=>{const h=c.get(d);return!!(h!=null&&h.platforms.has(s())||a(d))},a=d=>{var h;return(h=n.PluginHeaders)===null||h===void 0?void 0:h.find(f=>f.name===d)},l=d=>t.console.error(d),c=new Map,u=(d,h={})=>{const f=c.get(d);if(f)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),f.proxy;const p=s(),m=a(d);let x;const g=async()=>(!x&&p in h?x=typeof h[p]=="function"?x=await h[p]():x=h[p]:e!==null&&!x&&"web"in h&&(x=typeof h.web=="function"?x=await h.web():x=h.web),x),y=(I,$)=>{var E,A;if(m){const D=m==null?void 0:m.methods.find(P=>$===P.name);if(D)return D.rtype==="promise"?P=>n.nativePromise(d,$.toString(),P):(P,O)=>n.nativeCallback(d,$.toString(),P,O);if(I)return(E=I[$])===null||E===void 0?void 0:E.bind(I)}else{if(I)return(A=I[$])===null||A===void 0?void 0:A.bind(I);throw new jc(`"${d}" plugin is not implemented on ${p}`,du.Unimplemented)}},b=I=>{let $;const E=(...A)=>{const D=g().then(P=>{const O=y(P,I);if(O){const F=O(...A);return $=F==null?void 0:F.remove,F}else throw new jc(`"${d}.${I}()" is not implemented on ${p}`,du.Unimplemented)});return I==="addListener"&&(D.remove=async()=>$()),D};return E.toString=()=>`${I.toString()}() { [capacitor code] }`,Object.defineProperty(E,"name",{value:I,writable:!1,configurable:!1}),E},w=b("addListener"),k=b("removeListener"),C=(I,$)=>{const E=w({eventName:I},$),A=async()=>{const P=await E;k({eventName:I,callbackId:P},$)},D=new Promise(P=>E.then(()=>P({remove:A})));return D.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await A()},D},S=new Proxy({},{get(I,$){switch($){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return m?C:w;case"removeListener":return k;default:return b($)}}});return r[d]=S,c.set(d,{name:d,proxy:S,platforms:new Set([...Object.keys(h),...m?[p]:[]])}),S};return n.convertFileSrc||(n.convertFileSrc=d=>d),n.getPlatform=s,n.handleError=l,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=u,n.Exception=jc,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Tie=t=>t.Capacitor=Eie(t),ra=Tie(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Yr=ra.registerPlugin;class AS{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new ra.Exception(e,du.Unimplemented)}unavailable(e="not available"){return new ra.Exception(e,du.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const cA=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),uA=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Aie extends AS{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=uA(s).trim(),i=uA(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=cA(e.key),r=cA(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Yr("CapacitorCookies",{web:()=>new Aie});const Die=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),Oie=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},Rie=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let a,l;return Array.isArray(o)?(l="",o.forEach(c=>{a=e?encodeURIComponent(c):c,l+=`${i}=${a}&`}),l.slice(0,-1)):(a=e?encodeURIComponent(o):o,l=`${i}=${a}`),`${r}&${l}`},"").substr(1):null,Pie=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=Oie(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,a]of Object.entries(t.data||{}))i.set(o,a);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(t.data))i.append(a,t.data[a]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class _ie extends AS{async request(e){const n=Pie(e,e.webFetchExtra),r=Rie(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?e:{};o.includes("application/json")&&(a="json");let l,c;switch(a){case"arraybuffer":case"blob":c=await i.blob(),l=await Die(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const u={};return i.headers.forEach((d,h)=>{u[h]=d}),{data:l,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Yr("CapacitorHttp",{web:()=>new _ie});const Mie="modulepreload",Fie=function(t){return"/"+t},dA={},ya=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=Fie(l),l in dA)return;dA[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Mie,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},hA=Yr("App",{web:()=>ya(()=>import("./web-oyIkipjn.js"),[]).then(t=>new t.AppWeb)});var Nc;(function(t){t.Prompt="PROMPT",t.Camera="CAMERA",t.Photos="PHOTOS"})(Nc||(Nc={}));var qd;(function(t){t.Rear="REAR",t.Front="FRONT"})(qd||(qd={}));var fA;(function(t){t.Uri="uri",t.Base64="base64",t.DataUrl="dataUrl"})(fA||(fA={}));class Lie extends AS{async getPhoto(e){return new Promise(async(n,r)=>{if(e.webUseInput||e.source===Nc.Photos)this.fileInputExperience(e,n,r);else if(e.source===Nc.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",async i=>{i.detail===0?this.fileInputExperience(e,n,r):this.cameraExperience(e,n,r)})}else this.cameraExperience(e,n,r)})}async pickImages(e){return new Promise(async(n,r)=>{this.multipleFileInputExperience(n,r)})}async cameraExperience(e,n,r){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===qd.Front?"user":"environment",document.body.appendChild(s);try{await s.componentOnReady(),s.addEventListener("onPhoto",async i=>{const o=i.detail;o===null?r(new jc("User cancelled photos app")):o instanceof Error?r(o):n(await this._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)}),s.present()}catch{this.fileInputExperience(e,n,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,n,r)}fileInputExperience(e,n,r){let s=document.querySelector("#_capacitor-camera-input");const i=()=>{var o;(o=s.parentNode)===null||o===void 0||o.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",o=>{const a=s.files[0];let l="jpeg";if(a.type==="image/png"?l="png":a.type==="image/gif"&&(l="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const c=new FileReader;c.addEventListener("load",()=>{if(e.resultType==="dataUrl")n({dataUrl:c.result,format:l});else if(e.resultType==="base64"){const u=c.result.split(",")[1];n({base64String:u,format:l})}i()}),c.readAsDataURL(a)}else n({webPath:URL.createObjectURL(a),format:l}),i()}),s.addEventListener("cancel",o=>{r(new jc("User cancelled photos app")),i()})),s.accept="image/*",s.capture=!0,e.source===Nc.Photos||e.source===Nc.Prompt?s.removeAttribute("capture"):e.direction===qd.Front?s.capture="user":e.direction===qd.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,n){let r=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var i;(i=r.parentNode)===null||i===void 0||i.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",i=>{const o=[];for(let a=0;a<r.files.length;a++){const l=r.files[a];let c="jpeg";l.type==="image/png"?c="png":l.type==="image/gif"&&(c="gif"),o.push({webPath:URL.createObjectURL(l),format:c})}e({photos:o}),s()}),r.addEventListener("cancel",i=>{n(new jc("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,n){return new Promise((r,s)=>{const i=new FileReader,o=e.type.split("/")[1];n.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:o,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{const a=i.result;n.resultType==="dataUrl"?r({dataUrl:a,format:o,saved:!1}):r({base64String:a.split(",")[1],format:o,saved:!1})},i.onerror=a=>{s(a)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}Yr("Camera",{web:()=>new Lie});const DL=Yr("Device",{web:()=>ya(()=>import("./web-CJ3NxOrp.js"),[]).then(t=>new t.DeviceWeb)});function jie(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return new Proxy({},{get(r,s){return(i,o,a)=>{const l=t.Capacitor.Plugins[n];if(l===void 0){a(new Error(`Capacitor plugin ${n} not found`));return}if(typeof l[s]!="function"){a(new Error(`Method ${s} not found in Capacitor plugin ${n}`));return}(async()=>{try{const c=await l[s](i);o(c)}catch(c){a(c)}})()}}})}})}function zie(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return t.cordova.plugins[n]}})}function Bie(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?jie(window):window.cordova!==void 0&&zie(window))}var pA;(function(t){t.Documents="DOCUMENTS",t.Data="DATA",t.Library="LIBRARY",t.Cache="CACHE",t.External="EXTERNAL",t.ExternalStorage="EXTERNAL_STORAGE",t.ExternalCache="EXTERNAL_CACHE",t.LibraryNoCloud="LIBRARY_NO_CLOUD",t.Temporary="TEMPORARY"})(pA||(pA={}));var mA;(function(t){t.UTF8="utf8",t.ASCII="ascii",t.UTF16="utf16"})(mA||(mA={}));Yr("Filesystem",{web:()=>ya(()=>import("./web-BLBAIcsL.js"),[]).then(t=>new t.FilesystemWeb)});Bie();var ow;(function(t){t.Heavy="HEAVY",t.Medium="MEDIUM",t.Light="LIGHT"})(ow||(ow={}));var gA;(function(t){t.Success="SUCCESS",t.Warning="WARNING",t.Error="ERROR"})(gA||(gA={}));const xA=Yr("Haptics",{web:()=>ya(()=>import("./web-Byk0tW4l.js"),[]).then(t=>new t.HapticsWeb)});var yA;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(yA||(yA={}));var vA;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(vA||(vA={}));const bA=Yr("Keyboard"),wA=Yr("Network",{web:()=>ya(()=>import("./web-BHLs1QLW.js"),[]).then(t=>new t.NetworkWeb)});Yr("Preferences",{web:()=>ya(()=>import("./web-DoZ7Gk3A.js"),[]).then(t=>new t.PreferencesWeb)});Yr("Share",{web:()=>ya(()=>import("./web-D1sTblbG.js"),[]).then(t=>new t.ShareWeb)});const Wie=Yr("SplashScreen",{web:()=>ya(()=>import("./web-D2J0E2yT.js"),[]).then(t=>new t.SplashScreenWeb)});var aw;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(aw||(aw={}));var kA;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(kA||(kA={}));const CA=Yr("StatusBar"),Uie=async()=>{try{await Wie.hide(),ra.isNativePlatform()&&(await CA.setStyle({style:aw.Light}),await CA.setBackgroundColor({color:"#ff6b35"}));const t=await DL.getInfo();console.log("Device Info:",t);const e=await wA.getStatus();return console.log("Network Status:",e),hA.addListener("appStateChange",n=>{console.log("App state changed:",n)}),hA.addListener("appUrlOpen",n=>{console.log("App opened with URL:",n)}),ra.isNativePlatform()&&(bA.addListener("keyboardWillShow",n=>{console.log("Keyboard will show:",n)}),bA.addListener("keyboardDidHide",()=>{console.log("Keyboard hidden")})),wA.addListener("networkStatusChange",n=>{console.log("Network status changed:",n)}),!0}catch(t){return console.error("Error initializing Capacitor plugins:",t),!1}},OL=()=>{const[t,e]=N.useState(null),[n,r]=N.useState(!1);return N.useEffect(()=>{(async()=>{try{r(ra.isNativePlatform());const i=await DL.getInfo();e(i)}catch(i){console.error("Error getting device info:",i)}})()},[]),{deviceInfo:t,isNative:n}},RL=()=>({impact:async(n=ow.Medium)=>{try{ra.isNativePlatform()&&await xA.impact({style:n})}catch(r){console.error("Error with haptic feedback:",r)}},vibrate:async()=>{try{ra.isNativePlatform()&&await xA.vibrate()}catch(n){console.error("Error with vibration:",n)}}}),Vie=({onMoodAdded:t})=>{const[e,n]=N.useState(null),[r,s]=N.useState(""),[i,o]=N.useState(!1),{impact:a}=RL(),l=[{id:"sad",label:"Sad",icon:h5,color:"text-red-500",bgColor:"bg-red-50"},{id:"normal",label:"Normal",icon:y5,color:"text-yellow-500",bgColor:"bg-yellow-50"},{id:"happy",label:"Happy",icon:I5,color:"text-green-500",bgColor:"bg-green-50"},{id:"excited",label:"Excited",icon:p5,color:"text-orange-500",bgColor:"bg-orange-50"}],c=h=>{a(),n(h),o(!0)},u=()=>{if(!e)return;const h={id:crypto.randomUUID(),mood:e,timestamp:new Date,note:r.trim()||void 0};Ce.saveMoodEntry(h),n(null),s(""),o(!1),t==null||t()},d=()=>{n(null),s(""),o(!1)};if(i){const h=l.find(f=>f.id===e);return v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-orange-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Add Mood Entry"})]}),v.jsx("div",{className:"flex items-center justify-center mb-6",children:h&&v.jsx("div",{className:`p-6 rounded-2xl ${h.bgColor} border-2 border-opacity-50`,children:v.jsx("div",{className:"text-center",children:v.jsx(h.icon,{size:32,className:h.color})})})}),v.jsxs("div",{className:"mb-4",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" How are you feeling? (Optional note)"}),v.jsx("textarea",{value:r,onChange:f=>s(f.target.value),placeholder:"Add any notes about your mood...",className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-transparent resize-none",rows:3})]}),v.jsxs("div",{className:"flex space-x-3",children:[v.jsx("button",{onClick:u,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-medium hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-lg",children:" Save Mood"}),v.jsx("button",{onClick:d,className:"flex-1 bg-gray-200 text-gray-800 py-3 rounded-xl font-medium hover:bg-gray-300 transition-colors",children:" Cancel"})]})]})}return v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-orange-400",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"How are you feeling?"})]}),v.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:v.jsx(IP,{size:20,className:"text-orange-600"})})]}),v.jsxs("p",{className:"text-sm text-gray-600 mb-6 flex items-center",children:[v.jsx("span",{className:"mr-2",children:""}),"Track your mood 4 times a day"]}),v.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map(h=>v.jsx("button",{onClick:()=>c(h.id),className:`p-4 rounded-2xl border-2 border-gray-200 hover:border-orange-300 transition-all duration-200 hover:shadow-lg transform hover:scale-105 ${h.bgColor}`,children:v.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[v.jsx(h.icon,{size:28,className:h.color}),v.jsx("span",{className:"text-sm font-medium text-gray-700",children:h.label})]})},h.id))})]})},Gie=({onSleepAdded:t})=>{const[e,n]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState(5),[a,l]=N.useState(!1),c=(h,f)=>{let p=0;h>=7&&h<=9?p=100:h>=6&&h<=10?p=80:h>=5&&h<=11?p=60:p=40;const m=f*10;return Math.round(p*.6+m*.4)},u=()=>{if(!e||!r)return;const h=new Date(`2024-01-01T${e}:00`),f=new Date(`2024-01-01T${r}:00`);f<h&&f.setDate(f.getDate()+1);const p=(f.getTime()-h.getTime())/(1e3*60*60),m=c(p,i),x={id:crypto.randomUUID(),bedtime:h,wakeTime:f,duration:p,quality:i,score:m};Ce.saveSleepEntry(x),n(""),s(""),o(5),l(!1),t==null||t()},d=Ce.getSleepEntries().slice(-1)[0];return a?v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-indigo-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Log Sleep"})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" Bedtime"}),v.jsx("input",{type:"time",value:e,onChange:h=>n(h.target.value),className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" Wake Time"}),v.jsx("input",{type:"time",value:r,onChange:h=>s(h.target.value),className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-transparent"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" Sleep Quality (1-10)"}),v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("input",{type:"range",min:"1",max:"10",value:i,onChange:h=>o(Number(h.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #f59e0b 0%, #f59e0b ${i*10}%, #e5e7eb ${i*10}%, #e5e7eb 100%)`}}),v.jsxs("div",{className:"flex items-center space-x-1",children:[v.jsx("span",{className:"text-2xl font-bold text-indigo-600",children:i}),v.jsx("span",{className:"text-lg",children:"".repeat(Math.min(i,5))})]})]})]}),v.jsxs("div",{className:"flex space-x-3 pt-4",children:[v.jsx("button",{onClick:u,disabled:!e||!r,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-medium hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-lg disabled:from-gray-300 disabled:to-gray-400",children:" Save Sleep"}),v.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-gray-200 text-gray-800 py-3 rounded-xl font-medium hover:bg-gray-300 transition-colors",children:" Cancel"})]})]})]}):v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-indigo-400",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Sleep Tracker"})]}),v.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg",children:v.jsx(SP,{size:20,className:"text-indigo-600"})})]}),d?v.jsxs("div",{className:"space-y-4 mb-4",children:[v.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-indigo-50 to-cyan-50 rounded-xl border border-indigo-100",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"text-sm text-gray-600",children:"Last Sleep"}),v.jsxs("div",{className:"font-semibold text-gray-800",children:[d.duration.toFixed(1)," hours"]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("div",{className:"text-sm text-gray-600",children:"Quality"}),v.jsxs("div",{className:"flex items-center space-x-1",children:[v.jsxs("span",{className:"font-bold text-indigo-600",children:[d.quality,"/10"]}),v.jsx("span",{children:"".repeat(Math.min(d.quality,5))})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"text-sm text-gray-600",children:"Sleep Score"}),v.jsxs("div",{className:"font-bold text-green-600 text-xl",children:[d.score,"/100"]})]})]}),v.jsx(EP,{size:24,className:"text-green-600"})]})]}):v.jsxs("div",{className:"flex items-center space-x-2 mb-4 p-3 bg-gray-50 rounded-xl",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("p",{className:"text-sm text-gray-600",children:"Track your sleep quality and duration"})]}),v.jsx("button",{onClick:()=>l(!0),className:"w-full bg-gradient-to-r from-indigo-500 to-cyan-500 text-white py-3 rounded-xl font-medium hover:from-indigo-600 hover:to-cyan-600 transition-all duration-200 shadow-lg transform hover:scale-105",children:" Log Sleep"})]})},sc=["I have felt sad or down most of the day","I have lost interest in activities I used to enjoy","I have trouble sleeping or sleep too much","I feel tired and have little energy","I have poor appetite or overeating","I feel bad about myself or like a failure","I have trouble concentrating on things","I move or speak slowly or am restless","I have thoughts of death or self-harm","I feel hopeless about the future","I worry excessively about different things","I feel nervous or on edge","I have trouble relaxing","I am easily annoyed or irritable","I feel afraid something awful might happen","I avoid social situations","I have panic attacks or sudden fear","I feel overwhelmed by daily tasks","I have difficulty making decisions","I feel isolated from others","I experience mood swings","I have physical symptoms (headaches, stomach issues)","I have trouble at work or school","I use substances to cope with feelings","I feel like my problems are getting worse"],Hie=({onCompleted:t})=>{const[e,n]=N.useState(0),[r,s]=N.useState({}),[i,o]=N.useState(!1),a=Ce.getAssessment(),l=x=>{s(g=>({...g,[e]:x}))},c=()=>{e<sc.length-1?n(e+1):f()},u=()=>{e>0&&n(e-1)},d=x=>{const g=Object.values(x).reduce((y,b)=>y+b,0);return Math.round(g/(sc.length*4)*100)},h=x=>x<30?"low":x<60?"medium":"high",f=()=>{const x=d(r),g={id:crypto.randomUUID(),answers:r,completedAt:new Date,score:x,riskLevel:h(x)};Ce.saveAssessment(g),o(!0),t==null||t()};if(a)return v.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"p-3 bg-green-50 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:v.jsx(Vd,{size:32,className:"text-green-600"})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Assessment Completed"}),v.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Completed on ",a.completedAt.toLocaleDateString()]}),v.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[v.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:[a.score,"/100"]}),v.jsxs("div",{className:`text-sm font-medium ${a.riskLevel==="high"?"text-red-600":a.riskLevel==="medium"?"text-yellow-600":"text-green-600"}`,children:[a.riskLevel.toUpperCase()," RISK"]})]})]})});if(i)return v.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"p-3 bg-green-50 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:v.jsx(Vd,{size:32,className:"text-green-600"})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Assessment Complete!"}),v.jsx("p",{className:"text-sm text-gray-600",children:"Your responses have been saved"})]})});const p=(e+1)/sc.length*100,m=r[e];return v.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[v.jsxs("div",{className:"mb-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Initial Assessment"}),v.jsxs("span",{className:"text-sm text-gray-600",children:[e+1," of ",sc.length]})]}),v.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:v.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p}%`}})})]}),v.jsxs("div",{className:"mb-8",children:[v.jsx("h4",{className:"text-base font-medium text-gray-800 mb-6 leading-relaxed",children:sc[e]}),v.jsx("div",{className:"space-y-3",children:[{value:0,label:"Never"},{value:1,label:"Sometimes"},{value:2,label:"Often"},{value:3,label:"Almost Always"},{value:4,label:"Always"}].map(x=>v.jsx("button",{onClick:()=>l(x.value),className:`w-full p-4 rounded-lg border-2 transition-all duration-200 text-left ${m===x.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"font-medium",children:x.label}),m===x.value?v.jsx(Vd,{size:20,className:"text-blue-600"}):v.jsx(kP,{size:20,className:"text-gray-400"})]})},x.value))})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsxs("button",{onClick:u,disabled:e===0,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",children:[v.jsx(s5,{size:20}),v.jsx("span",{children:"Previous"})]}),v.jsxs("button",{onClick:c,disabled:m===void 0,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[v.jsx("span",{children:e===sc.length-1?"Complete":"Next"}),v.jsx(u1,{size:20})]})]})]})},Kie=()=>{const t=Ce.getTasks().filter(s=>!s.completed).sort((s,i)=>s.dueDate.getTime()-i.dueDate.getTime()).slice(0,5),e=s=>kie(s.dueDate)&&!rw(s.dueDate)?{color:"text-red-600",bg:"bg-red-50",label:"Overdue",emoji:""}:rw(s.dueDate)?{color:"text-orange-600",bg:"bg-orange-50",label:"Today",emoji:""}:Cie(s.dueDate)?{color:"text-green-600",bg:"bg-green-50",label:"Tomorrow",emoji:""}:{color:"text-gray-600",bg:"bg-gray-50",label:Ze(s.dueDate,"MMM d"),emoji:""},n=s=>{switch(s){case"high":return"border-l-red-500";case"medium":return"border-l-yellow-500";case"low":return"border-l-green-500";default:return"border-l-gray-300"}},r=s=>{switch(s){case"high":return"";case"medium":return"";case"low":return"";default:return""}};return t.length===0?v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-400",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Upcoming Tasks"})]}),v.jsx(Vd,{size:20,className:"text-green-600"})]}),v.jsxs("div",{className:"text-center py-8",children:[v.jsx("div",{className:"text-6xl mb-4",children:""}),v.jsx("p",{className:"text-gray-600 font-medium",children:"All caught up!"}),v.jsx("p",{className:"text-sm text-gray-500",children:"No upcoming tasks"})]})]}):v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-cyan-400",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Upcoming Tasks"})]}),v.jsx(l5,{size:20,className:"text-cyan-600"})]}),v.jsx("div",{className:"space-y-3",children:t.map(s=>{const i=e(s);return v.jsx("div",{className:`p-4 rounded-xl border-l-4 ${n(s.priority)} bg-gradient-to-r from-gray-50 to-cyan-50 hover:shadow-md transition-all duration-200`,children:v.jsx("div",{className:"flex items-start justify-between",children:v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[v.jsx("span",{children:r(s.priority)}),v.jsx("h4",{className:"font-medium text-gray-800 text-sm",children:s.title})]}),s.description&&v.jsx("p",{className:"text-xs text-gray-600 mt-1 ml-6",children:s.description}),v.jsxs("div",{className:"flex items-center space-x-3 mt-2 ml-6",children:[v.jsxs("div",{className:"flex items-center space-x-1",children:[v.jsx("span",{className:"text-xs",children:""}),v.jsx("span",{className:"text-xs text-gray-500",children:Ze(s.dueDate,"MMM d, yyyy")})]}),v.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium border ${i.bg} ${i.color}`,children:[v.jsx("span",{className:"mr-1",children:i.emoji}),i.label]})]})]})})},s.id)})}),t.length===5&&v.jsx("div",{className:"text-center mt-4",children:v.jsxs("button",{className:"text-cyan-600 text-sm font-medium hover:text-cyan-700 flex items-center justify-center space-x-1 mx-auto",children:[v.jsx("span",{children:""}),v.jsx("span",{children:"View all tasks"})]})})]})},SA=({onRefresh:t})=>{const e=Ce.getUserProfile(),n=Ce.getAssessment();return v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50",children:[v.jsx(Nie,{title:"Dashboard",subtitle:e?`Welcome, ${e.name} `:"Welcome to Mindfit AI "}),v.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[v.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[v.jsx(Vie,{onMoodAdded:t}),v.jsx(Gie,{onSleepAdded:t}),!n&&v.jsx(Hie,{onCompleted:t}),v.jsx(Kie,{})]}),v.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl p-6 text-white shadow-lg",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold",children:"Today's Summary"})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[v.jsxs("div",{className:"text-center p-3 bg-white bg-opacity-20 rounded-xl",children:[v.jsx("div",{className:"text-2xl font-bold",children:Ce.getMoodEntries().filter(r=>new Date(r.timestamp).toDateString()===new Date().toDateString()).length}),v.jsxs("div",{className:"text-sm opacity-90 flex items-center justify-center space-x-1",children:[v.jsx("span",{children:""}),v.jsx("span",{children:"Mood Check-ins"})]})]}),v.jsxs("div",{className:"text-center p-3 bg-white bg-opacity-20 rounded-xl",children:[v.jsx("div",{className:"text-2xl font-bold",children:Ce.getTasks().filter(r=>!r.completed).length}),v.jsxs("div",{className:"text-sm opacity-90 flex items-center justify-center space-x-1",children:[v.jsx("span",{children:""}),v.jsx("span",{children:"Pending Tasks"})]})]}),v.jsxs("div",{className:"text-center p-3 bg-white bg-opacity-20 rounded-xl",children:[v.jsx("div",{className:"text-2xl font-bold",children:Ce.getFaceDiaryEntries().length}),v.jsxs("div",{className:"text-sm opacity-90 flex items-center justify-center space-x-1",children:[v.jsx("span",{children:""}),v.jsx("span",{children:"Face Diary"})]})]})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-green-400 to-emerald-400 rounded-2xl p-6 text-white shadow-lg",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-3xl mb-2",children:""}),v.jsx("h3",{className:"text-lg font-semibold mb-2",children:"You're doing great!"}),v.jsx("p",{className:"text-sm opacity-90",children:"Every step towards better mental health matters. Keep tracking your progress! "})]})})]})]})},qie=({onTaskUpdated:t})=>{const[e,n]=N.useState("day"),[r,s]=N.useState(!1),[i,o]=N.useState(null),[a,l]=N.useState({title:"",description:"",dueDate:Ze(new Date,"yyyy-MM-dd"),priority:"medium"}),c=Ce.getTasks(),u=()=>{const g=new Date;switch(e){case"day":return c.filter(C=>rw(C.dueDate));case"week":const y=uu(g),b=Cse(g);return c.filter(C=>sw(C.dueDate,{start:y,end:b}));case"month":const w=wse(g),k=bse(g);return c.filter(C=>sw(C.dueDate,{start:w,end:k}));default:return c}},d=()=>{const g={id:(i==null?void 0:i.id)||crypto.randomUUID(),title:a.title,description:a.description||void 0,dueDate:new Date(a.dueDate),completed:(i==null?void 0:i.completed)||!1,priority:a.priority};Ce.saveTask(g),l({title:"",description:"",dueDate:Ze(new Date,"yyyy-MM-dd"),priority:"medium"}),s(!1),o(null),t==null||t()},h=g=>{const y={...g,completed:!g.completed};Ce.saveTask(y),t==null||t()},f=g=>{l({title:g.title,description:g.description||"",dueDate:Ze(g.dueDate,"yyyy-MM-dd"),priority:g.priority}),o(g),s(!0)},p=g=>{const y=c.filter(b=>b.id!==g);localStorage.setItem("mindfit_tasks",JSON.stringify(y)),t==null||t()},m=g=>{switch(g){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200"}},x=u().sort((g,y)=>g.dueDate.getTime()-y.dueDate.getTime());return v.jsxs("div",{className:"min-h-screen bg-gray-50",children:[v.jsx("div",{className:"bg-white shadow-sm border-b",children:v.jsxs("div",{className:"max-w-md mx-auto p-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Task Planner"}),v.jsx("button",{onClick:()=>s(!0),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:v.jsx(IP,{size:20})})]}),v.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["day","week","month"].map(g=>v.jsx("button",{onClick:()=>n(g),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium capitalize transition-colors ${e===g?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:g},g))})]})}),v.jsxs("div",{className:"max-w-md mx-auto p-4",children:[r&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm",children:[v.jsx("h3",{className:"text-lg font-semibold mb-4",children:i?"Edit Task":"Add New Task"}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),v.jsx("input",{type:"text",value:a.title,onChange:g=>l(y=>({...y,title:g.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Task title..."})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),v.jsx("textarea",{value:a.description,onChange:g=>l(y=>({...y,description:g.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,placeholder:"Task description..."})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),v.jsx("input",{type:"date",value:a.dueDate,onChange:g=>l(y=>({...y,dueDate:g.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),v.jsxs("select",{value:a.priority,onChange:g=>l(y=>({...y,priority:g.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[v.jsx("option",{value:"low",children:"Low"}),v.jsx("option",{value:"medium",children:"Medium"}),v.jsx("option",{value:"high",children:"High"})]})]}),v.jsxs("div",{className:"flex space-x-3 pt-4",children:[v.jsxs("button",{onClick:d,disabled:!a.title.trim(),className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-300",children:[i?"Update":"Add"," Task"]}),v.jsx("button",{onClick:()=>{s(!1),o(null),l({title:"",description:"",dueDate:Ze(new Date,"yyyy-MM-dd"),priority:"medium"})},className:"flex-1 bg-gray-200 text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),v.jsx("div",{className:"space-y-4",children:x.length===0?v.jsxs("div",{className:"text-center py-12",children:[v.jsx(wP,{size:48,className:"text-gray-300 mx-auto mb-4"}),v.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No tasks found"}),v.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first task to get started"}),v.jsx("button",{onClick:()=>s(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Task"})]}):x.map(g=>v.jsx("div",{className:`bg-white rounded-xl shadow-sm p-4 border-l-4 ${g.completed?"opacity-60":""} ${g.priority==="high"?"border-l-red-500":g.priority==="medium"?"border-l-yellow-500":"border-l-green-500"}`,children:v.jsxs("div",{className:"flex items-start space-x-3",children:[v.jsx("button",{onClick:()=>h(g),className:"mt-1",children:g.completed?v.jsx(Vd,{size:20,className:"text-green-600"}):v.jsx(kP,{size:20,className:"text-gray-400 hover:text-green-600"})}),v.jsx("div",{className:"flex-1",children:v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("div",{children:[v.jsx("h3",{className:`font-medium ${g.completed?"line-through text-gray-500":"text-gray-800"}`,children:g.title}),g.description&&v.jsx("p",{className:"text-sm text-gray-600 mt-1",children:g.description}),v.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[v.jsx("span",{className:"text-xs text-gray-500",children:Ze(g.dueDate,"MMM d, yyyy")}),v.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${m(g.priority)}`,children:g.priority})]})]}),v.jsxs("div",{className:"flex items-center space-x-1",children:[v.jsx("button",{onClick:()=>f(g),className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",children:v.jsx(NP,{size:16})}),v.jsx("button",{onClick:()=>p(g.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:v.jsx($P,{size:16})})]})]})})]})},g.id))})]})]})},Xie=()=>{const[t,e]=N.useState([]),[n,r]=N.useState(""),[s,i]=N.useState(!1),[o,a]=N.useState(null),[l,c]=N.useState([]),[u,d]=N.useState(!1);N.useState({recentTopics:[],sessionStartTime:new Date,followUpQuestions:[]});const h=N.useRef(null),{impact:f}=RL();N.useEffect(()=>{m(),o||g()},[]),N.useEffect(()=>{p()},[t]);const p=()=>{var S;(S=h.current)==null||S.scrollIntoView({behavior:"smooth"})},m=()=>{const S=JSON.parse(localStorage.getItem("mindfit_chat_sessions")||"[]").map(I=>({...I,createdAt:new Date(I.createdAt),messages:I.messages.map($=>({...$,timestamp:new Date($.timestamp)}))}));c(S)},x=S=>{const I=[...l],$=I.findIndex(E=>E.id===S.id);$>=0?I[$]=S:I.push(S),c(I),localStorage.setItem("mindfit_chat_sessions",JSON.stringify(I))},g=()=>{const S=crypto.randomUUID(),I={id:crypto.randomUUID(),text:"Hello!  I'm your AI mental health companion. I'm here to listen, support, and help you through whatever you're feeling. How are you doing today?",isBot:!0,timestamp:new Date,emotion:"supportive"};a(S),e([I]),x({id:S,messages:[I],createdAt:new Date,title:"New Chat"})},y=S=>{const I=l.find($=>$.id===S);I&&(a(S),e(I.messages),d(!1))},b=S=>{const I=l.filter($=>$.id!==S);c(I),localStorage.setItem("mindfit_chat_sessions",JSON.stringify(I)),o===S&&(I.length>0?y(I[0].id):g())},w=S=>{const I=S.toLowerCase(),$=["sad","depressed","hopeless","worthless","empty","lonely","tired","exhausted"],E=["anxious","worried","panic","scared","nervous","overwhelmed"],A=["good","better","happy","great","fine","okay"];if(["suicide","kill myself","end it all","don't want to live","hurt myself"].some(O=>I.includes(O)))return{text:` I'm very concerned about what you're sharing. Your life has value and meaning. Please reach out for immediate help:

 National Suicide Prevention Lifeline: 988
 Crisis Text Line: Text HOME to 741741
 Emergency Services: 911

You don't have to go through this alone. There are people who want to help you. `,emotion:"crisis"};if($.some(O=>I.includes(O))){const O=["I hear you, and I want you to know that what you're feeling is valid. Depression can make everything feel overwhelming, but you're not alone in this.  Can you tell me more about what's been weighing on your mind?","Thank you for sharing something so personal with me. Depression is incredibly difficult, but reaching out shows real strength.  What's one small thing that used to bring you joy?","I'm here with you through this difficult time. Depression can make us feel isolated, but you've taken a brave step by talking about it.  Have you been able to talk to anyone else about how you're feeling?","Your feelings matter, and so do you. Depression can cloud our perspective, but remember that feelings, even the most painful ones, are temporary.  What's been your biggest challenge today?"];return{text:O[Math.floor(Math.random()*O.length)],emotion:"empathetic"}}if(E.some(O=>I.includes(O))){const O=["Anxiety can feel so overwhelming. Let's try to slow things down together.  Can you take three deep breaths with me? In for 4, hold for 4, out for 4. What's making you feel most anxious right now?","I understand how scary anxiety can feel. Your body is trying to protect you, but sometimes it goes into overdrive.  What physical sensations are you noticing? Let's work through this together.","Anxiety is your mind's way of trying to prepare for challenges, but it can become exhausting.  You're safe right now. Can you name 5 things you can see around you?","Thank you for trusting me with your anxiety. It takes courage to acknowledge these feelings.  What usually helps you feel more grounded?"];return{text:O[Math.floor(Math.random()*O.length)],emotion:"calming"}}if(A.some(O=>I.includes(O))){const O=["I'm so glad to hear you're feeling good!  It's wonderful when we can appreciate these positive moments. What's contributing to your good mood today?","That's fantastic!  It's important to celebrate these better days. What's been different or helpful for you recently?","I love hearing that you're doing well!  These positive feelings are just as important to acknowledge as the difficult ones. What's bringing you joy?","Your positive energy is wonderful!  It's great that you're taking time to check in, even when things are going well. What's been the highlight of your day?"];return{text:O[Math.floor(Math.random()*O.length)],emotion:"encouraging"}}if(I.includes("sleep")||I.includes("tired")||I.includes("insomnia"))return{text:"Sleep struggles can really impact our mental health.  Poor sleep and depression often go hand in hand. Have you noticed any patterns with your sleep? Creating a bedtime routine and limiting screen time before bed can help. What's your current sleep schedule like?",emotion:"helpful"};if(I.includes("relationship")||I.includes("friend")||I.includes("family"))return{text:"Relationships can be both a source of support and stress.  It sounds like you're dealing with some interpersonal challenges. Remember that healthy relationships involve mutual respect and understanding. How are you taking care of yourself in this situation?",emotion:"supportive"};if(I.includes("work")||I.includes("job")||I.includes("school")||I.includes("stress"))return{text:"Work and school pressures can really take a toll on our mental health.  It's important to find balance and remember that your worth isn't defined by productivity. What's been the most challenging aspect? Are you able to take breaks throughout your day?",emotion:"understanding"};const P=["Thank you for sharing that with me. I'm here to listen and support you.  Can you tell me more about what's on your mind?","I appreciate you opening up. Your feelings and experiences are important.  What would be most helpful for you right now?","It sounds like you have a lot going on. I'm here to help you work through whatever you're facing.  What's been the most challenging part of your day?","I'm glad you're here and willing to talk. Sometimes just expressing our thoughts can be really helpful.  How long have you been feeling this way?","Your willingness to reach out shows real strength.  Mental health is just as important as physical health. What kind of support do you feel you need most right now?"];return{text:P[Math.floor(Math.random()*P.length)],emotion:"supportive"}},k=async()=>{if(!n.trim())return;f();const S={id:crypto.randomUUID(),text:n.trim(),isBot:!1,timestamp:new Date},I=[...t,S];e(I),r(""),i(!0),setTimeout(()=>{const $=w(S.text),E={id:crypto.randomUUID(),text:$.text,isBot:!0,timestamp:new Date,emotion:$.emotion},A=[...I,E];if(e(A),i(!1),o){const D=l.find(P=>P.id===o);if(D){const P={...D,messages:A,title:A.length===3?S.text.slice(0,30)+"...":D.title};x(P)}}},1e3+Math.random()*2e3)},C=S=>{switch(S){case"crisis":return"";case"empathetic":return"";case"calming":return"";case"encouraging":return"";case"helpful":return"";case"supportive":return"";case"understanding":return"";default:return""}};return u?v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50",children:[v.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white",children:v.jsx("div",{className:"max-w-md mx-auto p-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:"p-2 bg-white bg-opacity-20 rounded-xl",children:v.jsx(h1,{size:24})}),v.jsxs("div",{children:[v.jsx("h1",{className:"text-xl font-bold",children:"Chat Sessions"}),v.jsx("p",{className:"text-orange-100 text-sm",children:"Your conversation history"})]})]}),v.jsx("button",{onClick:()=>d(!1),className:"p-2 bg-white bg-opacity-20 rounded-xl hover:bg-opacity-30 transition-colors",children:""})]})})}),v.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-4",children:[v.jsx("button",{onClick:g,className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white p-4 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:v.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("span",{className:"font-semibold",children:"Start New Chat"})]})}),v.jsx("div",{className:"space-y-3",children:l.map(S=>v.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border-l-4 border-orange-400",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{onClick:()=>y(S.id),className:"flex-1 cursor-pointer",children:[v.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:S.title}),v.jsxs("p",{className:"text-sm text-gray-600",children:[S.messages.length," messages"]}),v.jsxs("p",{className:"text-xs text-gray-500",children:[S.createdAt.toLocaleDateString()," at ",S.createdAt.toLocaleTimeString()]})]}),v.jsx("button",{onClick:()=>b(S.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-xl transition-colors",children:v.jsx($P,{size:16})})]})},S.id))}),l.length===0&&v.jsxs("div",{className:"text-center py-12",children:[v.jsx("div",{className:"text-6xl mb-4",children:""}),v.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No chat sessions yet"}),v.jsx("p",{className:"text-gray-500",children:"Start your first conversation with the AI companion"})]})]})]}):v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50 flex flex-col",children:[v.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white",children:v.jsx("div",{className:"max-w-md mx-auto p-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:"p-2 bg-white bg-opacity-20 rounded-xl",children:v.jsx(o5,{size:24})}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("h1",{className:"text-xl font-bold",children:"AI Companion"}),v.jsx("span",{className:"text-2xl",children:""})]}),v.jsx("p",{className:"text-orange-100 text-sm",children:"Your mental health support buddy"})]})]}),v.jsx("button",{onClick:()=>d(!0),className:"p-2 bg-white bg-opacity-20 rounded-xl hover:bg-opacity-30 transition-colors",children:v.jsx(h1,{size:20})})]})})}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-4 max-w-md mx-auto w-full",children:[v.jsxs("div",{className:"space-y-4",children:[t.map(S=>v.jsx("div",{className:`flex ${S.isBot?"justify-start":"justify-end"}`,children:v.jsx("div",{className:`max-w-xs lg:max-w-md px-4 py-3 rounded-2xl shadow-lg ${S.isBot?"bg-white border-l-4 border-orange-400":"bg-gradient-to-r from-green-500 to-emerald-500 text-white"}`,children:v.jsxs("div",{className:"flex items-start space-x-2",children:[S.isBot&&v.jsx("span",{className:"text-lg flex-shrink-0 mt-1",children:C(S.emotion)}),v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:`text-sm leading-relaxed ${S.isBot?"text-gray-800":"text-white"}`,children:S.text}),v.jsx("p",{className:`text-xs mt-2 ${S.isBot?"text-gray-500":"text-green-100"}`,children:S.timestamp.toLocaleTimeString()})]}),!S.isBot&&v.jsx(fl,{size:16,className:"flex-shrink-0 mt-1 text-green-100"})]})})},S.id)),s&&v.jsx("div",{className:"flex justify-start",children:v.jsx("div",{className:"bg-white border-l-4 border-orange-400 px-4 py-3 rounded-2xl shadow-lg",children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("span",{className:"text-lg",children:""}),v.jsxs("div",{className:"flex space-x-1",children:[v.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce"}),v.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),v.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),v.jsx("span",{className:"text-sm text-gray-600",children:"AI is typing..."})]})})})]}),v.jsx("div",{ref:h})]}),v.jsxs("div",{className:"bg-white border-t border-gray-200 p-4 max-w-md mx-auto w-full",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("input",{type:"text",value:n,onChange:S=>r(S.target.value),onKeyPress:S=>S.key==="Enter"&&k(),placeholder:"Share what's on your mind... ",className:"flex-1 p-3 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-orange-400 focus:border-transparent"}),v.jsx("button",{onClick:k,disabled:!n.trim()||s,className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-2xl hover:from-orange-600 hover:to-red-600 transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:v.jsx(k5,{size:20})})]}),v.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:[{text:"I'm feeling really sad today",emoji:""},{text:"I'm anxious and overwhelmed",emoji:""},{text:"I need some encouragement",emoji:""},{text:"I'm having trouble sleeping",emoji:""},{text:"I'm stressed about work",emoji:""},{text:"I'm feeling lonely",emoji:""}].map((S,I)=>v.jsxs("button",{onClick:()=>r(S.text),className:"px-3 py-2 bg-orange-100 text-orange-700 rounded-xl text-xs hover:bg-orange-200 transition-colors flex items-center space-x-1",children:[v.jsx("span",{className:"mr-1",children:S.emoji}),v.jsx("span",{children:S.text.split(" ").slice(0,3).join(" ")})]},I))})]}),v.jsx("div",{className:"bg-gradient-to-r from-red-100 to-orange-100 p-4 max-w-md mx-auto w-full",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[v.jsx("span",{className:"mr-1",children:""}),"If you're in crisis, please contact:"]}),v.jsxs("div",{className:"flex justify-center space-x-4 text-xs",children:[v.jsx("span",{className:"text-red-600 font-medium",children:"988 - Suicide Prevention"}),v.jsx("span",{className:"text-red-600 font-medium",children:"911 - Emergency"})]})]})})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yie=1e-7,Qie=1e-4;class PL{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class DS{refCount(e){return pr("refCount")}incRef(e){return pr("incRef")}timerAvailable(){return!0}time(e){return pr("time")}read(e){return pr("read")}readSync(e){return pr("readSync")}readToGPU(e,n){return pr("readToGPU")}numDataIds(){return pr("numDataIds")}disposeData(e,n){return pr("disposeData")}write(e,n,r){return pr("write")}move(e,n,r,s,i){return pr("move")}createTensorFromGPUData(e,n,r){return pr("createTensorFromGPUData")}memory(){return pr("memory")}floatPrecision(){return pr("floatPrecision")}epsilon(){return this.floatPrecision()===32?Yie:Qie}dispose(){return pr("dispose")}}function pr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,lc(t,e,n)}function yl(t,e,n){return Math.max(t,Math.min(e,n))}function OS(t){return t%2===0?t:t+1}function lc(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Jie(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function RS(t,e,n=""){T(Qe(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function _L(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Q(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Qe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function hu(t){return t%1===0}function lw(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function zc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function IA(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function ML(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Me(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),T(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(r=>hu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function va(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Me(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Rn(t,e){return _t(t,e)}function _t(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function eoe(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function toe(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function FL(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Mg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function noe(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function af(t){return typeof t=="string"||t instanceof String}function roe(t){return typeof t=="boolean"}function cw(t){return typeof t=="number"}function Mu(t){return Array.isArray(t)?Mu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":cw(t)?"float32":af(t)?"string":roe(t)?"bool":"float32"}function uw(t){return!!(t&&t.constructor&&t.call&&t.apply)}function dw(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ve(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function LL(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<i;l++)s[l]=LL(t+l*a,o,n,r)}return s}function Gs(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return LL(0,t,e,n)}function soe(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function PS(t,e){const n=Pn(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Pn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function jL(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Gs(t,new Float32Array(n));if(e==="int32")return Gs(t,new Int32Array(n));if(e==="bool")return Gs(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function po(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function gi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function Fu(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function _S(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NA="tfjsflags";class ioe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ooe,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(_S(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);NA in e&&e[NA].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=loe(s,i)})}}function ooe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(aoe(e,r[0],r[1]),r.join("="))),e}function aoe(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function loe(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function H(){return zL}let zL=null;function coe(t){zL=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eb;function BL(){if(eb==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");eb=t}return eb}function uoe(){const t=BL();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function MS(t,e){const n=uoe();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Nx="Abs",lf="Acos",cf="Acosh",Lu="Add",FS="AddN",LS="All",jS="Any",$x="ArgMax",Ex="ArgMin",uf="Asin",df="Asinh",hf="Atan",ff="Atanh",pf="Atan2",Tx="AvgPool",zS="AvgPoolGrad",Ax="AvgPool3D",BS="AvgPool3DGrad",Dx="BatchMatMul",Ox="BatchToSpaceND",WS="Bincount",US="BitwiseAnd",doe="BroadcastTo",WL="BroadcastArgs",mf="Cast",gf="Ceil",xf="ClipByValue",VS="Complex",Rx="ComplexAbs",Px="Concat",_x="Conv2D",GS="Conv2DBackpropFilter",Mx="Conv2DBackpropInput",Fx="Conv3D",HS="Conv3DBackpropFilterV2",KS="Conv3DBackpropInputV2",yf="Cos",vf="Cosh",qS="Cumprod",Lx="Cumsum",XS="CropAndResize",YS="DenseBincount",QS="DepthToSpace",jx="DepthwiseConv2dNative",ZS="DepthwiseConv2dNativeBackpropFilter",JS="DepthwiseConv2dNativeBackpropInput",UL="Diag",zx="Dilation2D",hw="Dilation2DBackpropInput",fw="Dilation2DBackpropFilter",hoe="Draw",bf="RealDiv",e2="Einsum",wf="Elu",t2="EluGrad",kf="Erf",Bx="Equal",Cf="Exp",Wx="ExpandDims",Sf="Expm1",n2="FFT",r2="Fill",s2="FlipLeftRight",If="Floor",Nf="FloorDiv",Ux="FusedBatchNorm",Vx="GatherV2",VL="GatherNd",Gx="Greater",$f="GreaterEqual",Ef="Identity",i2="IFFT",o2="Imag",Tf="IsFinite",Af="IsInf",Df="IsNan",Hx="LeakyRelu",Kx="Less",qx="LessEqual",GL="LinSpace",Of="Log",Rf="Log1p",Xx="LogicalAnd",Yx="LogicalNot",Qx="LogicalOr",foe="LogSoftmax",Zx="LRN",a2="LRNGrad",Jx="Max",Pf="Maximum",ey="MaxPool",l2="MaxPoolGrad",ty="MaxPool3D",c2="MaxPool3DGrad",HL="MaxPoolWithArgmax",ny="Mean",ry="Min",_f="Minimum",sy="MirrorPad",Mf="Mod",KL="Multinomial",Ff="Multiply",iy="Neg",oy="NotEqual",u2="NonMaxSuppressionV3",d2="NonMaxSuppressionV4",h2="NonMaxSuppressionV5",ay="OnesLike",ly="OneHot",cy="Pack",uy="PadV2",Lf="Pow",dy="Prelu",hy="Prod",qL="RaggedGather",XL="RaggedRange",YL="RaggedTensorToTensor",f2="Range",p2="Real",jf="Reciprocal",zf="Relu",fy="Reshape",py="ResizeNearestNeighbor",m2="ResizeNearestNeighborGrad",my="ResizeBilinear",g2="ResizeBilinearGrad",Bf="Relu6",gy="Reverse",Wf="Round",Uf="Rsqrt",QL="ScatterNd",ZL="TensorScatterUpdate",JL="SearchSorted",xy="Select",Vf="Selu",yy="Slice",Gf="Sin",Hf="Sinh",Kf="Sign",qf="Sigmoid",Xf="Softplus",Yf="Sqrt",vy="Sum",by="SpaceToBatchND",wy="SplitV",ky="Softmax",ej="SparseFillEmptyRows",tj="SparseReshape",nj="SparseSegmentMean",rj="SparseSegmentSum",sj="SparseToDense",Qf="SquaredDifference",x2="Square",y2="StaticRegexReplace",v2="StridedSlice",ij="StringNGrams",oj="StringSplit",aj="StringToHashBucketFast",Zf="Sub",Jf="Tan",ep="Tanh",tp="Tile",b2="TopK",w2="Transform",Bc="Transpose",k2="Unique",Cy="Unpack",Sy="UnsortedSegmentSum",Iy="ZerosLike",np="Step",poe="FromPixels",C2="RotateWithOffset",Fg="_FusedMatMul",Lg="FusedConv2D",lj="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(...t){H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(...t)}function moe(...t){H().getBool("IS_TEST")||H().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jg=MS("kernelRegistry",()=>new Map),pw=MS("gradRegistry",()=>new Map);function $A(t,e){const n=uj(t,e);return jg.get(n)}function EA(t){return pw.get(t)}function TA(t){const e=jg.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function cj(t){const{kernelName:e,backendName:n}=t,r=uj(e,n);jg.has(r)&&Fr(`The kernel '${e}' for backend '${n}' is already registered`),jg.set(r,t)}function goe(t){const{kernelName:e}=t;pw.has(e)&&H().getBool("DEBUG")&&Fr(`Overriding the gradient for '${e}'`),pw.set(e,t)}function uj(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dj(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var hj=yt,ds=null;try{ds=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function yt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}yt.prototype.__isLong__;Object.defineProperty(yt.prototype,"__isLong__",{value:!0});function Er(t){return(t&&t.__isLong__)===!0}yt.isLong=Er;var AA={},DA={};function Bl(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=DA[t],r)?r:(n=vt(t,(t|0)<0?-1:0,!0),s&&(DA[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=AA[t],r)?r:(n=vt(t,t<0?-1:0,!1),s&&(AA[t]=n),n))}yt.fromInt=Bl;function hs(t,e){if(isNaN(t))return e?Ya:fs;if(e){if(t<0)return Ya;if(t>=fj)return gj}else{if(t<=-RA)return br;if(t+1>=RA)return mj}return t<0?hs(-t,e).neg():vt(t%fu|0,t/fu|0,e)}yt.fromNumber=hs;function vt(t,e,n){return new yt(t,e,n)}yt.fromBits=vt;var zg=Math.pow;function S2(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return fs;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return S2(t.substring(1),e,n).neg();for(var s=hs(zg(n,8)),i=fs,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=hs(zg(n,a));i=i.mul(c).add(hs(l))}else i=i.mul(s),i=i.add(hs(l))}return i.unsigned=e,i}yt.fromString=S2;function ti(t,e){return typeof t=="number"?hs(t,e):typeof t=="string"?S2(t,e):vt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}yt.fromValue=ti;var OA=65536,xoe=1<<24,fu=OA*OA,fj=fu*fu,RA=fj/2,PA=Bl(xoe),fs=Bl(0);yt.ZERO=fs;var Ya=Bl(0,!0);yt.UZERO=Ya;var $c=Bl(1);yt.ONE=$c;var pj=Bl(1,!0);yt.UONE=pj;var mw=Bl(-1);yt.NEG_ONE=mw;var mj=vt(-1,2147483647,!1);yt.MAX_VALUE=mj;var gj=vt(-1,-1,!0);yt.MAX_UNSIGNED_VALUE=gj;var br=vt(0,-2147483648,!1);yt.MIN_VALUE=br;var ce=yt.prototype;ce.toInt=function(){return this.unsigned?this.low>>>0:this.low};ce.toNumber=function(){return this.unsigned?(this.high>>>0)*fu+(this.low>>>0):this.high*fu+(this.low>>>0)};ce.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(br)){var n=hs(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=hs(zg(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ce.getHighBits=function(){return this.high};ce.getHighBitsUnsigned=function(){return this.high>>>0};ce.getLowBits=function(){return this.low};ce.getLowBitsUnsigned=function(){return this.low>>>0};ce.getNumBitsAbs=function(){if(this.isNegative())return this.eq(br)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ce.isZero=function(){return this.high===0&&this.low===0};ce.eqz=ce.isZero;ce.isNegative=function(){return!this.unsigned&&this.high<0};ce.isPositive=function(){return this.unsigned||this.high>=0};ce.isOdd=function(){return(this.low&1)===1};ce.isEven=function(){return(this.low&1)===0};ce.equals=function(e){return Er(e)||(e=ti(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ce.eq=ce.equals;ce.notEquals=function(e){return!this.eq(e)};ce.neq=ce.notEquals;ce.ne=ce.notEquals;ce.lessThan=function(e){return this.comp(e)<0};ce.lt=ce.lessThan;ce.lessThanOrEqual=function(e){return this.comp(e)<=0};ce.lte=ce.lessThanOrEqual;ce.le=ce.lessThanOrEqual;ce.greaterThan=function(e){return this.comp(e)>0};ce.gt=ce.greaterThan;ce.greaterThanOrEqual=function(e){return this.comp(e)>=0};ce.gte=ce.greaterThanOrEqual;ce.ge=ce.greaterThanOrEqual;ce.compare=function(e){if(Er(e)||(e=ti(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ce.comp=ce.compare;ce.negate=function(){return!this.unsigned&&this.eq(br)?br:this.not().add($c)};ce.neg=ce.negate;ce.add=function(e){Er(e)||(e=ti(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=i+c,h+=f>>>16,f&=65535,h+=s+l,d+=h>>>16,h&=65535,d+=r+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,vt(h<<16|f,u<<16|d,this.unsigned)};ce.subtract=function(e){return Er(e)||(e=ti(e)),this.add(e.neg())};ce.sub=ce.subtract;ce.multiply=function(e){if(this.isZero())return fs;if(Er(e)||(e=ti(e)),ds){var n=ds.mul(this.low,this.high,e.low,e.high);return vt(n,ds.get_high(),this.unsigned)}if(e.isZero())return fs;if(this.eq(br))return e.isOdd()?br:fs;if(e.eq(br))return this.isOdd()?br:fs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(PA)&&e.lt(PA))return hs(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=r*u+s*c+i*l+o*a,d&=65535,vt(f<<16|p,d<<16|h,this.unsigned)};ce.mul=ce.multiply;ce.divide=function(e){if(Er(e)||(e=ti(e)),e.isZero())throw Error("division by zero");if(ds){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ds.div_u:ds.div_s)(this.low,this.high,e.low,e.high);return vt(n,ds.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ya:fs;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ya;if(e.gt(this.shru(1)))return pj;i=Ya}else{if(this.eq(br)){if(e.eq($c)||e.eq(mw))return br;if(e.eq(br))return $c;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(fs)?e.isNegative()?$c:mw:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(br))return this.unsigned?Ya:fs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=fs}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:zg(2,a-48),c=hs(r),u=c.mul(e);u.isNegative()||u.gt(s);)r-=l,c=hs(r,this.unsigned),u=c.mul(e);c.isZero()&&(c=$c),i=i.add(c),s=s.sub(u)}return i};ce.div=ce.divide;ce.modulo=function(e){if(Er(e)||(e=ti(e)),ds){var n=(this.unsigned?ds.rem_u:ds.rem_s)(this.low,this.high,e.low,e.high);return vt(n,ds.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ce.mod=ce.modulo;ce.rem=ce.modulo;ce.not=function(){return vt(~this.low,~this.high,this.unsigned)};ce.and=function(e){return Er(e)||(e=ti(e)),vt(this.low&e.low,this.high&e.high,this.unsigned)};ce.or=function(e){return Er(e)||(e=ti(e)),vt(this.low|e.low,this.high|e.high,this.unsigned)};ce.xor=function(e){return Er(e)||(e=ti(e)),vt(this.low^e.low,this.high^e.high,this.unsigned)};ce.shiftLeft=function(e){return Er(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?vt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):vt(0,this.low<<e-32,this.unsigned)};ce.shl=ce.shiftLeft;ce.shiftRight=function(e){return Er(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?vt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):vt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ce.shr=ce.shiftRight;ce.shiftRightUnsigned=function(e){if(Er(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return vt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?vt(n,0,this.unsigned):vt(n>>>e-32,0,this.unsigned)};ce.shru=ce.shiftRightUnsigned;ce.shr_u=ce.shiftRightUnsigned;ce.toSigned=function(){return this.unsigned?vt(this.low,this.high,!1):this};ce.toUnsigned=function(){return this.unsigned?this:vt(this.low,this.high,!0)};ce.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ce.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ce.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};yt.fromBytes=function(e,n,r){return r?yt.fromBytesLE(e,n):yt.fromBytesBE(e,n)};yt.fromBytesLE=function(e,n){return new yt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};yt.fromBytesBE=function(e,n){return new yt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const xj=Ei(hj),yoe=NV({__proto__:null,default:xj},[hj]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja=xj||yoe;function Ny(t){return ja.fromString(t,!0,16)}const yj=Ny("c3a5c85c97cb3127"),La=Ny("b492b66fbe98f273"),Hn=Ny("9ae16a3b2f90404f");function gw(t){return t.xor(t.shru(47))}function vj(t,e,n){const r=t.slice(e,e+n);return ja.fromBytes(Array.from(r),!0,!0)}function ct(t,e){return vj(t,e,8)}function _A(t,e){return vj(t,e,4)}function an(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function qo(t,e,n=Ny("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function voe(t,e,n,r,s,i){s=s.add(t),i=an(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(an(s,44)),[s.add(r),i.add(o)]}function em(t,e,n,r){return voe(ct(t,e),ct(t,e+8),ct(t,e+16),ct(t,e+24),n,r)}function boe(t,e=t.length){if(e>=8){const n=Hn.add(e*2),r=ct(t,0).add(Hn),s=ct(t,e-8),i=an(s,37).mul(n).add(r),o=an(r,25).add(s).mul(n);return qo(i,o,n)}if(e>=4){const n=Hn.add(e*2),r=_A(t,0);return qo(r.shl(3).add(e),_A(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return gw(Hn.mul(i).xor(yj.mul(o))).mul(Hn)}return Hn}function woe(t,e=t.length){const n=Hn.add(e*2),r=ct(t,0).mul(La),s=ct(t,8),i=ct(t,e-8).mul(n),o=ct(t,e-16).mul(Hn);return qo(an(r.add(s),43).add(an(i,30)).add(o),r.add(an(s.add(Hn),18)).add(i),n)}function koe(t,e=t.length){const n=Hn.add(e*2),r=ct(t,0).mul(Hn),s=ct(t,8),i=ct(t,e-8).mul(n),o=ct(t,e-16).mul(Hn),a=an(r.add(s),43).add(an(i,30)).add(o),l=qo(a,r.add(an(s.add(Hn),18)).add(i),n),c=ct(t,16).mul(n),u=ct(t,24),d=a.add(ct(t,e-32)).mul(n),h=l.add(ct(t,e-24)).mul(n);return qo(an(c.add(u),43).add(an(d,30)).add(h),c.add(an(u.add(r),18)).add(d),n)}function Coe(t,e=t.length){const n=ja.fromNumber(81,!0);if(e<=32)return e<=16?boe(t,e):woe(t,e);if(e<=64)return koe(t,e);let r=n,s=n.mul(La).add(113),i=gw(s.mul(Hn).add(113)).mul(Hn),o=[ja.UZERO,ja.UZERO],a=[ja.UZERO,ja.UZERO];r=r.mul(Hn).add(ct(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=an(r.add(s).add(o[0]).add(ct(t,l+8)),37).mul(La),s=an(s.add(o[1]).add(ct(t,l+48)),42).mul(La),r=r.xor(a[1]),s=s.add(o[0]).add(ct(t,l+40)),i=an(i.add(a[0]),33).mul(La),o=em(t,l,o[1].mul(La),r.add(a[0])),a=em(t,l+32,i.add(a[1]),s.add(ct(t,l+16))),[i,r]=[r,i],l+=64;while(l!==c);const d=La.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=an(r.add(s).add(o[0]).add(ct(t,l+8)),37).mul(d),s=an(s.add(o[1]).add(ct(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(ct(t,l+40))),i=an(i.add(a[0]),33).mul(d),o=em(t,l,o[1].mul(d),r.add(a[0])),a=em(t,l+32,i.add(a[1]),s.add(ct(t,l+16))),[i,r]=[r,i],qo(qo(o[0],a[0],d).add(gw(s).mul(yj)).add(i),qo(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(t,e){return e==="string"?Xo(t):Wl([t],e)}function Soe(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Wl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=vl(t)),H().getBool("DEBUG")&&eoe(t,e),Soe(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function tr(){return H().platform.now()}function Xo(t,e="utf-8"){return e=e||"utf-8",H().platform.encode(t,e)}function sa(t,e="utf-8"){return e=e||"utf-8",H().platform.decode(t,e)}function ks(t){return H().platform.isTypedArray!=null?H().platform.isTypedArray(t):dj(t)}function vl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||_S(t)||t==null||ks(t)&&n)e.push(t);else if(Array.isArray(t)||ks(t))for(let r=0;r<t.length;++r)vl(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)vl(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ioe{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new $oe)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=tr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of s)c.dataSync();o=Promise.resolve({kernelMs:tr()-a})}if(H().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const u=s[c];u.data().then(d=>{Noe(d,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function Noe(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class $oe{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?zc(`${s}ms`,9):s.error,l=zc(e,25),c=n.rank,u=n.size,d=zc(n.shape.toString(),14);let h="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,x=m.length;h+=`${f}: ${x}D ${x>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(r[h.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,s[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(s[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];r[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function Toe(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Qe(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MA=20,yd=3,tb=7;function Aoe(t,e,n,r){const s=ve(e),i=Doe(t,e,n,s),o=e.length,a=Nm(t,e,n,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Doe(t,e,n,r){const s=Q(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?Ad(t):t;if(a>1)for(let c=0;c<s/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Td(l[u+d],0,n).length)}return o}function Td(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(tb))} + ${parseFloat(t[1].toFixed(tb))}j`:af(t)?r=`'${t}'`:n==="bool"?r=bj(t):r=parseFloat(t.toFixed(tb)).toString(),zc(r,e)}function bj(t){return t===0?"false":"true"}function Nm(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Ad(t);return[Td(m[0],0,n)]}return n==="bool"?[bj(t[0])]:[t[0].toString()]}if(l===1){if(a>MA){const x=yd*o;let g=Array.from(t.slice(0,x)),y=Array.from(t.slice((a-yd)*o,a*o));return n==="complex64"&&(g=Ad(g),y=Ad(y)),["["+g.map((b,w)=>Td(b,s[w],n)).join(", ")+", ..., "+y.map((b,w)=>Td(b,s[a-yd+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?Ad(t):Array.from(t)).map((x,g)=>Td(x,s[g],n)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*o,h=[];if(a>MA){for(let m=0;m<yd;m++){const x=m*d,g=x+d;h.push(...Nm(t.slice(x,g),c,n,u,s,!1))}h.push("...");for(let m=a-yd;m<a;m++){const x=m*d,g=x+d;h.push(...Nm(t.slice(x,g),c,n,u,s,m===a-1))}}else for(let m=0;m<a;m++){const x=m*d,g=x+d;h.push(...Nm(t.slice(x,g),c,n,u,s,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function Ad(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vn{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=Q(e),r!=null){const s=r.length;T(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||_t(n,this.size),this.strides=ve(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Ls().makeTensor(this.values,this.shape,this.dtype)}}let Ls=null,cc=null;function Ooe(t){Ls=t}function Roe(t){cc=t}class Xt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Q(e),this.strides=ve(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return cc.buffer(this.shape,this.dtype,e)}bufferSync(){return cc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Gs(this.shape,e,this.dtype==="complex64")}arraySync(){return Gs(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ls().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>sa(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ls().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ls().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>sa(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ls().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ls().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return cc.print(this,e)}clone(){return this.throwIfDisposed(),cc.clone(this)}toString(e=!1){const n=this.dataSync();return Aoe(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),cc.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Ls().makeVariable(this,e,n,r)}}Object.defineProperty(Xt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Y(){return MS("Tensor",()=>Xt)}Y();class Bg extends Xt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Qe(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ls().disposeTensor(this),this.dataId=e.dataId,Ls().incRef(this,null)}dispose(){Ls().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Bg,Symbol.hasInstance,{value:t=>t instanceof Xt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var FA;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(FA||(FA={}));var xw;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(xw||(xw={}));var yw;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(yw||(yw={}));var vw;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(vw||(vw={}));var bw;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(bw||(bw={}));const Poe={float32:vw,int32:xw,bool:yw,complex64:bw};function Ir(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Poe[t][e]}function I2(t){return Ir(t,"int32")}function wj(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function kj(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(t,e){if(t.dtype===e.dtype)return[t,e];const n=Ir(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Cj(t){const e=[];return Sj(t,e,new Set),e}function Sj(t,e,n){if(t==null)return;if(t instanceof Xt){e.push(t);return}if(!_oe(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),Sj(i,e,n))}}function _oe(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(t){return t.kernelName!=null}class LA{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class pu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new LA}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Fr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Ioe(this.backendInstance),!0}setupRegisteredKernels(){TA(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){TA(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof DS)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Fr(`Initialization of backend ${e} failed`),Fr(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Fr(`Initialization of backend ${e} failed`),Fr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return pu.nextTensorId++}nextVariableId(){return pu.nextVariableId++}clone(e){const n=j.runKernel(Ef,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return j.runKernel(mf,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!($A(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=nb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(nb(e)){const{kernelName:p,inputs:m,attrs:x}=e;this.backendName==null&&this.backend;const g=$A(p,this.backendName);T(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:x,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const w=b.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(s){const k=this.getTensorsForGradient(p,m,w);r=this.saveTensorsForBackwardMode(k)}return w}}else{const{forwardFunc:p}=e,m=x=>{s&&(r=x.map(g=>this.keep(this.clone(g))))};a=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,g),g}}const{inputs:u,attrs:d}=e,h=nb(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(c,u,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=EA(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=r.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&af(e[0])&&(i=e.map(l=>Xo(l)));const o=s.write(i,n,r),a=new Xt(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),c=noe(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new Xt(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new Bg(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Mg(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Bg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Mg(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=EA(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=r[d],f=Pn(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),s(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Cj(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(i instanceof Xt,()=>"The result y returned by f() must be a tensor.");const o=Eoe(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??Moe(i.shape),Toe(a,o,c=>this.tidy(c),Foe);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return T(uw(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof Xt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...n,l),T(r.value instanceof Xt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(uw(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const c=r.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(h=>h instanceof Xt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=tr(),r=await this.backend.time(e);return r.wallMs=tr()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new LA;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}pu.nextTensorId=0;pu.nextVariableId=0;function Moe(t){const e=PS(Q(t),"float32");return j.makeTensor(e,t,"float32")}function Ij(){const t=BL();if(t._tfengine==null){const e=new ioe(t);t._tfengine=new pu(e)}return coe(t._tfengine.ENV),Ooe(()=>t._tfengine),t._tfengine}const j=Ij();function Foe(t,e){const n={a:t,b:e};return j.runKernel(Lu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(){return typeof navigator<"u"&&navigator!=null}function Nj(t){if(t||Loe()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function $j(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lr=H();lr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});lr.registerFlag("IS_BROWSER",()=>$j());lr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");lr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));lr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));lr.registerFlag("PROD",()=>!1);lr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>lr.getBool("DEBUG"));lr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);lr.registerFlag("IS_TEST",()=>!1);lr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>lr.getBool("DEBUG"));lr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);lr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);lr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $y(t,e){let n=t;if(ks(t))return e==="string"?[]:[t.length];if(wj(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(kj(t))return[t.buffer.size/(e==null?4:Mg(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||ks(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ej(t,r,[]),r}function Ej(t,e,n){if(n=n||[],!Array.isArray(t)&&!ks(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)Ej(t[s],r,n.concat(s))}function jA(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function R(t,e,n,r="numeric"){if(t instanceof Y())return jA(r,t.dtype,e,n),t;let s=Mu(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),jA(r,s,e,n),t==null||!ks(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=$y(t,s);!ks(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Wl(t,s):vl(t,[],!0);return j.makeTensor(a,i,s)}function Tj(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>R(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe="__op";function W(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+joe;const s=(...i)=>{j.startScope(n);try{const o=r(...i);return _S(o)&&console.error("Cannot return a Promise inside of tidy."),j.endScope(o),o}catch(o){throw j.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t,e){const n=R(t,"real","complex"),r=R(e,"imag","complex");RS(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return j.runKernel(VS,s)}const mu=W({complex_:zoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ey(t,e,n,r){if(r==null)r=Mu(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(kj(t)||wj(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return j.backend.createTensorFromGPUData(t,e||n,r)}if(!ks(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){po(e);const s=Q(e),i=Q(n);T(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==Q(e.slice(o)):!0;T(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!ks(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Wl(t,r):vl(t,[],!0),j.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(t,e,n){const r=$y(t,n);return Ey(t,e,r,n)}class ju{static join(e){return new ju(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>ks(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(o.set(m,h),a+=m.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Boe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Boe(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(){return j}function zA(){return j.memory()}function G(t,e){return j.tidy(t,e)}function Le(t){Cj(t).forEach(n=>n.dispose())}function xi(t){return j.keep(t)}function Woe(){return j.ready()}function Dj(t,e,n=1){return j.registerBackend(t,e,n)}function Uoe(){return j.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BA=4;async function WA(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((x,g)=>x+g.length,0)+BA*h.length,p=new Uint8Array(f);let m=0;for(let x=0;x<h.length;x++){const g=h[x],y=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(y,m),m+=BA,p.set(g,m),m+=g.length}d(p)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(r);return{data:Voe(i),specs:n}}function Voe(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const N2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function UA(t){return N2?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Goe(t){if(N2)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function Hoe(t){if(N2){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function Koe(t){return ju.join(t)}function Oj(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:UA(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:UA(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ju(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Wn.instance==null&&(Wn.instance=new Wn),Wn.instance}static registerSaveRouter(e){Wn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Wn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Wn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Wn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Wn.getInstance().loadRouters:Wn.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const qoe=t=>Wn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ww="tensorflowjs",kw=1,Qa="models_store",_o="model_info_store";function Rj(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Cw(t){const e=t.result;e.createObjectStore(Qa,{keyPath:"modelPath"}),e.createObjectStore(_o,{keyPath:"modelPath"})}class bl{constructor(e){if(this.indexedDB=Rj(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open(ww,kw);i.onupgradeneeded=()=>Cw(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Qa,"readonly"),c=a.objectStore(Qa).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(o.close(),s(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=ju.join(n.weightData);const a=Oj(n),l=o.transaction(_o,"readwrite");let c=l.objectStore(_o),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return s(h)}let d;u.onsuccess=()=>{d=o.transaction(Qa,"readwrite");const h=d.objectStore(Qa);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return s(p)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(_o);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),s(f.error)),m.onerror=x=>(o.close(),s(f.error))}},u.onerror=h=>(o.close(),s(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}bl.URL_SCHEME="indexeddb://";const Pj=t=>H().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bl.URL_SCHEME)?Xoe(t.slice(bl.URL_SCHEME.length)):null;Wn.registerSaveRouter(Pj);Wn.registerLoadRouter(Pj);function Xoe(t){return new bl(t)}function Yoe(t){return t.startsWith(bl.URL_SCHEME)?t.slice(bl.URL_SCHEME.length):t}class Qoe{constructor(){this.indexedDB=Rj()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(ww,kw);r.onupgradeneeded=()=>Cw(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(_o,"readonly"),a=i.objectStore(_o).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=Yoe(e),new Promise((n,r)=>{const s=this.indexedDB.open(ww,kw);s.onupgradeneeded=()=>Cw(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(_o,"readwrite"),a=o.objectStore(_o),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(Qa,"readwrite");const f=c.objectStore(Qa).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),r(l.error))}},l.onerror=u=>(i.close(),r(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Li="/",uc="tensorflowjs_models",_j="info",Zoe="model_topology",Joe="weight_specs",eae="weight_data",tae="model_metadata";function Mj(t){return{info:[uc,t,_j].join(Li),topology:[uc,t,Zoe].join(Li),weightSpecs:[uc,t,Joe].join(Li),weightData:[uc,t,eae].join(Li),modelMetadata:[uc,t,tae].join(Li)}}function Fj(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function nae(t){const e=t.split(Li);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Li)}function rae(t){return t.startsWith(wl.URL_SCHEME)?t.slice(wl.URL_SCHEME.length):t}class wl{constructor(e){if(!H().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Mj(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Oj(e),i=ju.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Goe(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw Fj(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Hoe(o),n}}wl.URL_SCHEME="localstorage://";const Lj=t=>H().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wl.URL_SCHEME)?sae(t.slice(wl.URL_SCHEME.length)):null;Wn.registerSaveRouter(Lj);Wn.registerLoadRouter(Lj);function sae(t){return new wl(t)}class iae{constructor(){T(H().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=uc+Li,r=Li+_j;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=nae(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=rae(e);const n=Mj(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return Fj(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VA="://";class oi{constructor(){this.managers={}}static getInstance(){return oi.instance==null&&(oi.instance=new oi),oi.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(VA)&&(e=e.slice(0,e.indexOf(VA))),T(e.length>0,()=>"scheme must not be an empty string.");const r=oi.getInstance();T(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=oi.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(oi.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oae{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!H().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return dj(e)}}if(H().get("IS_BROWSER")){H().setPlatform("browser",new oae);try{oi.registerManager(wl.URL_SCHEME,new iae)}catch{}try{oi.registerManager(bl.URL_SCHEME,new Qoe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae={importFetch:()=>require("node-fetch")};let rb;class lae{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return H().global.fetch!=null?H().global.fetch(e,n):(rb==null&&(rb=aae.importFetch()),rb(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}H().get("IS_NODE")&&!H().get("IS_BROWSER")&&H().setPlatform("node",new lae);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(t,e="float32",n){return e=e||"float32",po(t),new vn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(t,e){const n=R(t,"x","cast");if(!toe(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return j.runKernel(mf,r,s)}const fe=W({cast_:cae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t){const n={x:R(t,"x","clone","string_or_numeric")};return j.runKernel(Ef,n)}const il=W({clone_:uae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ij();const hae={buffer:_e,cast:fe,clone:il,print:dae};Roe(hae);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fae(t,e){let n=R(t,"a","add"),r=R(e,"b","add");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Lu,s)}const re=W({add_:fae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t,e){let n=R(t,"a","floorDiv"),r=R(e,"b","floorDiv");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Nf,s)}const jj=W({floorDiv_:pae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t,e){let n=R(t,"a","div"),r=R(e,"b","div");if([n,r]=Ft(n,r),n.dtype==="int32"&&r.dtype==="int32")return jj(n,r);const s={a:n,b:r},i={};return j.runKernel(bf,s,i)}const we=W({div_:mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(t,e){let n=R(t,"a","mul"),r=R(e,"b","mul");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Ff,s)}const L=W({mul_:gae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t){const e=R(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return j.runKernel(Rx,n)}else{const n={x:e};return j.runKernel(Nx,n)}}const Un=W({abs_:xae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t){const n={x:R(t,"x","acos")};return j.runKernel(lf,n)}const vae=W({acos_:yae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t){const n={x:R(t,"x","acosh")};return j.runKernel(cf,n)}const wae=W({acosh_:bae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kae(t,e=null,n=!1){const s={x:R(t,"x","all","bool")},i={axis:e,keepDims:n};return j.runKernel(LS,s,i)}const zj=W({all_:kae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t,e=null,n=!1){const s={x:R(t,"x","any","bool")},i={axis:e,keepDims:n};return j.runKernel(jS,s,i)}const Sw=W({any_:Cae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t,e=0){const r={x:R(t,"x","argMax")},s={axis:e};return j.runKernel($x,r,s)}const Ih=W({argMax_:Sae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iae(t,e=0){const r={x:R(t,"x","argMin")},s={axis:e};return j.runKernel(Ex,r,s)}const Nae=W({argMin_:Iae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t){const n={x:R(t,"x","asin")};return j.runKernel(uf,n)}const Eae=W({asin_:$ae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(t){const n={x:R(t,"x","asinh")};return j.runKernel(df,n)}const Aae=W({asinh_:Tae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t){const n={x:R(t,"x","atan")};return j.runKernel(hf,n)}const Oae=W({atan_:Dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(t,e){let n=R(t,"a","atan2"),r=R(e,"b","atan2");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(pf,s)}const Pae=W({atan2_:Rae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(t){const n={x:R(t,"x","atanh")};return j.runKernel(ff,n)}const Mae=W({atanh_:_ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rp(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],l=go(s);return Cn(t,a,n,i,r,null,null,l)}function $s(t,e,n,r,s,i,o="channelsLast"){const[a,l]=Nh(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Cn(t,c,n,r,s,i,!1,o)}function mo(t,e,n,r,s,i,o="NDHWC"){const[a,l,c]=Iw(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return wa(t,u,n,r,s,!1,d,i)}function Cn(t,e,n,r,s,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,x]=Nh(n),[g,y]=Nh(r),b=Wc(h,g),w=Wc(f,y),{padInfo:k,outHeight:C,outWidth:S}=jae(s,c,u,m,x,b,w,i,a),I=o?p*d:p;let $;return a==="channelsFirst"?$=[l,I,C,S]:a==="channelsLast"&&($=[l,C,S,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:C,outWidth:S,outChannels:I,padInfo:k,strideHeight:m,strideWidth:x,filterHeight:h,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:g,dilationWidth:y,inShape:t,outShape:$,filterShape:e}}function wa(t,e,n,r,s,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,x]=e,[g,y,b]=Iw(n),[w,k,C]=Iw(r),S=Wc(f,w),I=Wc(p,k),$=Wc(m,C),{padInfo:E,outDepth:A,outHeight:D,outWidth:P}=zae(s,c,u,d,g,y,b,S,I,$,a),O=i?x*h:x;let F;return o==="channelsFirst"?F=[l,O,A,D,P]:o==="channelsLast"&&(F=[l,A,D,P,O]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:A,outHeight:D,outWidth:P,outChannels:O,padInfo:E,strideDepth:g,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:I,effectiveFilterWidth:$,dilationDepth:w,dilationHeight:k,dilationWidth:C,inShape:t,outShape:F,filterShape:e}}function Fae(t,e,n,r,s){r==null&&(r=$2(t,e,n));const i=t[0],o=t[1],a=$h((i-e+2*r)/n+1,s),l=$h((o-e+2*r)/n+1,s);return[a,l]}function Lae(t,e,n,r,s,i){s==null&&(s=$2(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=$h((t[a]-e[a]+2*s)/r[a]+1,i));return o}function $2(t,e,n,r=1){const s=Wc(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function Nh(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Iw(t){return typeof t=="number"?[t,t,t]:t}function Wc(t,e){return e<=1?t:t+(t-1)*(e-1)}function jae(t,e,n,r,s,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=Fae([e,n],i,r,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/r),d=Math.ceil(n/s);const h=Math.max(0,(u-1)*r+i-e),f=Math.max(0,(d-1)*s+o-n),p=Math.floor(h/2),m=h-p,x=Math.floor(f/2),g=f-x;c={top:p,bottom:m,left:x,right:g,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=$h((e-i+h+f)/r+1,a),d=$h((n-o+p+m)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function zae(t,e,n,r,s,i,o,a,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=Lae([e,n,r,1],[a,l,c],1,[s,i,o],t,u);h=x[0],f=x[1],p=x[2]}else if(t==="same"){h=Math.ceil(e/s),f=Math.ceil(n/i),p=Math.ceil(r/o);const m=(h-1)*s+a-e,x=(f-1)*i+l-n,g=(p-1)*o+c-r,y=Math.floor(m/2),b=m-y,w=Math.floor(x/2),k=x-w,C=Math.floor(g/2),S=g-C;d={top:w,bottom:k,left:C,right:S,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function $h(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function kl(t){const[e,n,r]=Nh(t);return e===1&&n===1&&r===1}function Mn(t,e){return kl(t)||kl(e)}function Cl(t){return Nh(t).every(e=>e>0)}function go(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function fr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(hu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{T(hu(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bae(t,e){const r={x:R(t,"x","reshape","string_or_numeric")},s={shape:e};return j.runKernel(fy,r,s)}const B=W({reshape_:Bae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(t,e,n,r,s){const i=R(t,"x","avgPool","float32"),o=1;T(Mn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),fr("avgPool",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=j.runKernel(Tx,c,u);return d=fe(d,i.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const E2=W({avgPool_:Wae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uae(t,e,n,r,s,i="NDHWC"){const o=R(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),fr("avgPool3d",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let d=j.runKernel(Ax,c,u);return d=fe(d,a.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Vae=W({avgPool3d_:Uae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=Tj(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return il(n[0]);const r=n,s={axis:e};return j.runKernel(Px,r,s)}const ar=W({concat_:Gae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t,e,n=!1,r=!1){let s=R(t,"a","matMul"),i=R(e,"b","matMul");[s,i]=Ft(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return j.runKernel(Dx,o,a)}const qe=W({matMul_:Hae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(t){const n={x:R(t,"x","sigmoid","float32")};return j.runKernel(qf,n)}const zu=W({sigmoid_:Kae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(t,e,n){const r=R(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return j.runKernel(yy,s,i)}const ut=W({slice_:qae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xae(t){const n={x:R(t,"x","tanh","float32")};return j.runKernel(ep,n)}const Ty=W({tanh_:Xae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yae(t,e,n){const r=R(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);T(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return j.runKernel(Ox,i,o)}const T2=W({batchToSpaceND_:Yae});function Qae(t){let e;return t.rank===0||t.rank===1?e=B(t,[1,1,1,t.size]):t.rank===2?e=B(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t,e,n,r,s,i){i==null&&(i=.001);const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;s!=null&&(c=R(s,"scale","batchNorm"));let u;r!=null&&(u=R(r,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Qae(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=j.runKernel(Ux,h,f);return B(p,o.shape)}const Ay=W({batchNorm_:Zae});function Jae(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;s!=null&&(c=R(s,"scale","batchNorm"));let u;return r!=null&&(u=R(r,"offset","batchNorm")),T(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Ay(o,a,l,u,c,i)}const ele=W({batchNorm2d_:Jae});function tle(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;s!=null&&(c=R(s,"scale","batchNorm"));let u;return r!=null&&(u=R(r,"offset","batchNorm")),T(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Ay(o,a,l,u,c,i)}const nle=W({batchNorm3d_:tle});function rle(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;s!=null&&(c=R(s,"scale","batchNorm"));let u;return r!=null&&(u=R(r,"offset","batchNorm")),T(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Ay(o,a,l,u,c,i)}const sle=W({batchNorm4d_:rle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ile(t,e,n){const r=R(t,"x","bincount"),s=R(e,"weights","bincount");T(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return j.runKernel(WS,i,o)}const ole=W({bincount_:ile});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(t,e){let n=R(t,"broadcastTo","x");const r=n.shape;if(po(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=B(n,c)}const s=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return il(n);const a={x:n},l={reps:i};return j.runKernel(tp,a,l)}const Xd=W({broadcastTo_:ale});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lle(t){const n={x:R(t,"x","ceil","float32")};return j.runKernel(gf,n)}const cle=W({ceil_:lle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dy(t,e,n){po(t),n=n||Mu(e);const r={shape:t,value:e,dtype:n};return j.runKernel(r2,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(t,e,n){const r=R(t,"x","clipByValue");if(T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Dy(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return j.runKernel(xf,s,i)}const Kr=W({clipByValue_:ule});function dle(t){return ar(t,0)}const hle=W({concat1d_:dle});function fle(t,e){return ar(t,e)}const ple=W({concat2d_:fle});function mle(t,e){return ar(t,e)}const gle=W({concat3d_:mle});function xle(t,e){return ar(t,e)}const yle=W({concat4d_:xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t,e,n,r,s="NHWC",i=[1,1],o){const a=R(t,"x","conv2d","float32"),l=R(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),fr("conv2d",r,o);const d=s==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(Mn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(Cl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(Cl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=j.runKernel(_x,h,f);return u?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Sl=W({conv2d_:vle});function ble(t,e,n,r,s="NWC",i=1,o){const a=R(t,"x","conv1d"),l=R(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=B(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),fr("conv1d",r,o),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(Mn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),T(Cl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(Cl(n),()=>"Error in conv1D: Stride should be larger than 0."),T(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=B(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=B(c,[c.shape[0],1,c.shape[1],c.shape[2]]),x=Sl(h,d,[1,n],r,"NHWC",[1,i],o);return u?B(x,[x.shape[2],x.shape[3]]):B(x,[x.shape[0],x.shape[2],x.shape[3]])}const Bj=W({conv1d_:ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t,e,n,r,s,i="NHWC",o){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),fr("conv2dDerInput",s,o);const h={dy:l,filter:n},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},p=j.runKernel(Mx,h,f);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const A2=W({conv2DBackpropInput_:wle});function kle(t,e,n,r,s,i){const o=R(t,"x","conv2dTranspose"),a=R(e,"filter","conv2dTranspose");return A2(n,o,a,r,s,"NHWC",i)}const Wj=W({conv2dTranspose_:kle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cle(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=R(t,"x","conv3d"),a=R(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=B(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(Mn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),T(Cl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(Cl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:i},h=j.runKernel(Fx,u,d);return c?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Sle=W({conv3d_:Cle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(t,e,n,r,s){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];T(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),T(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:s,strides:r,inputShape:i},h=j.runKernel(KS,u,d);return a?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Uj=W({conv3DBackpropInput_:Ile});function Nle(t,e,n,r,s){const i=R(t,"x","conv3dTranspose"),o=R(e,"filter","conv3dTranspose");return Uj(n,i,o,r,s)}const $le=W({conv3dTranspose_:Nle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(t){const n={x:R(t,"x","cos","float32")};return j.runKernel(yf,n)}const D2=W({cos_:Ele});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(t){const n={x:R(t,"x","cosh","float32")};return j.runKernel(vf,n)}const Vj=W({cosh_:Tle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(t,e=0,n=!1,r=!1){const i={x:R(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return j.runKernel(qS,i,o)}const Nw=W({cumprod_:Ale});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t,e=0,n=!1,r=!1){const i={x:R(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return j.runKernel(Lx,i,o)}const Gj=W({cumsum_:Dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(t,e,n,r=!1){const s=R(t,"x","denseBincount"),i=R(e,"weights","denseBincount");T(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),T(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return j.runKernel(YS,o,a)}const GA=W({denseBincount_:Ole});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t,e,n="NHWC"){const r=R(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),T(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),T(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return j.runKernel(QS,a,l)}const Ple=W({depthToSpace_:Rle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _le(t,e,n,r,s="NHWC",i=[1,1],o){const a=R(t,"x","depthwiseConv2d","float32"),l=R(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),fr("depthwiseConv2d",r,o);const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=j.runKernel(jx,h,f);return u?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const O2=W({depthwiseConv2d_:_le});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t,e,n,r,s=[1,1],i="NHWC"){const o=R(t,"x","dilation2d"),a=R(e,"filter","dilation2d");T(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=B(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:r,dilations:s},h=j.runKernel(zx,u,d);return c?B(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Fle=W({dilation2d_:Mle});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gu(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function nn(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function Ae(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(t,e){let n=R(t,"a","equal","string_or_numeric"),r=R(e,"b","equal","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Bx,s)}const Ci=W({equal_:Lle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t,e,n){const r=R(e,"a","where"),s=R(n,"b","where"),i=R(t,"condition","where","bool"),o=Ae(Ae(i.shape,r.shape),s.shape),a=Xd(i,o),l=Xd(r,o),c=Xd(s,o),u={condition:a,t:l,e:c};return j.runKernel(xy,u)}const Xn=W({where_:jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(t){const n={x:R(t,"x","zerosLike")};return j.runKernel(Iy,n)}const We=W({zerosLike_:zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t,e){let n=R(t,"a","div"),r=R(e,"b","div");[n,r]=Ft(n,r);const s=we(n,r),i=We(s),o=Ci(r,i);return Xn(o,i,s)}const Wle=W({divNoNan_:Ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(t,e){const n=R(t,"t1","dot"),r=R(e,"t2","dot");T((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(T(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=B(n,[1,-1]),a=B(r,[-1,1]),l=qe(o,a);return B(l,[])}else if(n.rank===1&&r.rank===2){const o=B(n,[1,-1]),a=B(r,[r.shape[0],r.shape[1]]),l=qe(o,a);return B(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=B(r,[-1,1]),a=qe(n,o);return B(a,[a.size])}else{const o=B(r,[r.shape[0],r.shape[1]]);return qe(n,o)}}const Vle=W({dot_:Ule});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t,...e){const n=e.map((s,i)=>R(s,`tensors${i}`,"einsum")),r={equation:t};return j.runKernel(e2,n,r)}const vd=W({einsum_:Gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t){const n={x:R(t,"x","elu","float32")};return j.runKernel(wf,n)}const Oy=W({elu_:Hle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t){let e=R(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=fe(e,"float32"));const n={x:e};return j.runKernel(kf,n)}const Hj=W({erf_:Kle});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Kj(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function fn(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function Ut(t,e){const n=e.map(r=>1);return Kj(t,n,e)}function Sn(t,e,n){T(R2(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Et(t,e){if(R2(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function ka(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Lt(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t,e=null,n=!1){const s={x:R(t,"x","max")},i={reductionIndices:e,keepDims:n};return j.runKernel(Jx,s,i)}const Hs=W({max_:qle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t,e=null,n=!1){const s={x:R(t,"x","min")},i={axis:e,keepDims:n};return j.runKernel(ry,s,i)}const Wg=W({min_:Xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t,e){let n=R(t,"base","pow"),r=R(e,"exp","pow");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Lf,s)}const Il=W({pow_:Yle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xe(t,e){if((ks(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ks(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ey(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const n={x:R(t,"x","sqrt","float32")};return j.runKernel(Yf,n)}const _n=W({sqrt_:Qle});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t){const e=R(t,"x","square"),n={};return j.runKernel("Square",{x:e},n)}const xt=W({square_:Zle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(t,e=null,n=!1){let r=R(t,"x","sum");r.dtype==="bool"&&(r=fe(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return j.runKernel(vy,s,i)}const be=W({sum_:Jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t,e="euclidean",n=null,r=!1){t=R(t,"x","norm");const s=qj(t,e,n);let i=s.shape;if(r){const o=Me(n,t.shape);i=Ut(s.shape,o)}return B(s,i)}function qj(t,e,n=null){if(t.rank===0)return Un(t);if(t.rank!==1&&n===null)return qj(B(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return be(Un(t),n);if(e===1/0)return Hs(Un(t),n);if(e===-1/0)return Wg(Un(t),n);if(e==="euclidean"||e===2)return _n(be(Il(Un(t),Xe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Hs(be(Un(t),n[0]),n[1]-1);if(e===1/0)return Hs(be(Un(t),n[1]),n[0]);if(e===-1/0)return Wg(be(Un(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return _n(be(xt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Ry=W({norm_:ece});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce(t,e=null,n=!1){return Ry(t,"euclidean",e,n)}const nce=W({euclideanNorm_:tce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t){const n={x:R(t,"x","exp")};return j.runKernel(Cf,n)}const Si=W({exp_:rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t,e=0){const n=R(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return j.runKernel(Wx,r,s)}const nr=W({expandDims_:sce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t){const n={x:R(t,"x","expm1")};return j.runKernel(Sf,n)}const oce=W({expm1_:ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(t,e){const n=R(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return j.runKernel(tp,r,s)}const Ws=W({tile_:ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e,n,r="float32"){e==null&&(e=t);const s=_e([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=B(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ws(nr(o,0),[n[0],1,1]);if(n.length===2)return Ws(nr(nr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ws(nr(nr(nr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Xj=W({eye_:lce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(t){const n={x:R(t,"x","floor","float32")};return j.runKernel(If,n)}const Py=W({floor_:cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n=0,r=0){const s=R(t,"x","gather"),i=R(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return j.runKernel(Vx,o,a)}const P2=W({gather_:uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t,e){let n=R(t,"a","greater","string_or_numeric"),r=R(e,"b","greater","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Gx,s)}const Qr=W({greater_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t,e){let n=R(t,"a","greaterEqual","string_or_numeric"),r=R(e,"b","greaterEqual","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel($f,s)}const Ul=W({greaterEqual_:hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(t){const n={input:R(t,"input","imag")};return j.runKernel(o2,n)}const _2=W({imag_:fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t){const n={x:R(t,"x","isFinite")};return j.runKernel(Tf,n)}const mce=W({isFinite_:pce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(t){const n={x:R(t,"x","isInf")};return j.runKernel(Af,n)}const xce=W({isInf_:gce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t){const n={x:R(t,"x","isNaN")};return j.runKernel(Df,n)}const vce=W({isNaN_:yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t,e=.2){const r={x:R(t,"x","leakyRelu")},s={alpha:e};return j.runKernel(Hx,r,s)}const M2=W({leakyRelu_:bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t,e){let n=R(t,"a","less","string_or_numeric"),r=R(e,"b","less","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Kx,s)}const Ug=W({less_:wce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(t,e){let n=R(t,"a","lessEqual","string_or_numeric"),r=R(e,"b","lessEqual","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(qx,s)}const Bu=W({lessEqual_:kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t,e=5,n=1,r=1,s=.5){const i=R(t,"x","localResponseNormalization");T(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),T(hu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:r,beta:s},u=j.runKernel(Zx,l,c);return a?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Sce=W({localResponseNormalization_:Cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t){const n={x:R(t,"x","log","float32")};return j.runKernel(Of,n)}const Ii=W({log_:Ice});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t){const n={x:R(t,"x","log1p")};return j.runKernel(Rf,n)}const Yj=W({log1p_:Nce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t,e){T(uw(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(c=>c instanceof Bg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in j.registeredVariables)e.push(j.registeredVariables[c])}const r=n?e.filter(c=>!c.trainable):null,s=e.length;e=e.filter(c=>c.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=j.gradients(t,e,null,i);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:o,grads:l}}function xu(t){return j.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ece(t){const n={x:R(t,"x","neg")};return j.runKernel(iy,n)}const Mt=W({neg_:Ece});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t){const n={x:R(t,"x","softplus")};return j.runKernel(Xf,n)}const sp=W({softplus_:Tce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(t){const e=R(t,"x","logSigmoid");return xu(r=>({value:Mt(sp(Mt(r))),gradFunc:o=>L(o,zu(Mt(r)))}))(e)}const Dce=W({logSigmoid_:Ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(t,e){let n=R(t,"a","sub"),r=R(e,"b","sub");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Zf,s)}const Se=W({sub_:Oce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t,e=-1){const n=R(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return xu((s,i)=>{const a=Hs(s,e,!0),l=Se(s,a),c=Se(fe(l,"float32"),Ii(be(Si(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Si(f);return Se(d,L(be(d,e,p),m))}}})(n)}const Qj=W({logSoftmax_:Rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(t,e=null,n=!1){const r=R(t,"x","logSumExp"),s=Me(e,r.shape),i=Hs(r,s,!0),o=Se(r,i),a=Si(o),l=be(a,s),c=Ii(l),u=re(B(i,c.shape),c);if(n){const d=Ut(u.shape,s);return B(u,d)}return u}const Zj=W({logSumExp_:Pce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e){const n=R(t,"a","logicalAnd","bool"),r=R(e,"b","logicalAnd","bool");Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Xx,s)}const so=W({logicalAnd_:_ce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t){const n={x:R(t,"x","logicalNot","bool")};return j.runKernel(Yx,n)}const F2=W({logicalNot_:Mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t,e){const n=R(t,"a","logicalOr","bool"),r=R(e,"b","logicalOr","bool");Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Qx,s)}const Jj=W({logicalOr_:Fce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t,e){const n=R(t,"a","logicalXor","bool"),r=R(e,"b","logicalXor","bool");return Ae(n.shape,r.shape),so(Jj(t,e),F2(so(t,e)))}const jce=W({logicalXor_:Lce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t,e,n,r,s){const i=R(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(Mn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),fr("maxPool",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=j.runKernel(ey,c,u);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const L2=W({maxPool_:zce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=R(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),fr("maxPool3d",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},d=j.runKernel(ty,c,u);return l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Wce=W({maxPool3d_:Bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(t,e){let n=R(t,"a","maximum"),r=R(e,"b","maximum");[n,r]=Ft(n,r),n.dtype==="bool"&&(n=fe(n,"int32"),r=fe(r,"int32")),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(Pf,s)}const Ca=W({maximum_:Uce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t,e=null,n=!1){const s={x:R(t,"x","mean")},i={axis:e,keepDims:n};return j.runKernel(ny,s,i)}const Wt=W({mean_:Vce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ln(t,e="float32"){if(po(t),e==="complex64"){const r=ln(t,"float32"),s=ln(t,"float32");return mu(r,s)}const n=Pn(Q(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(t,e="float32"){if(po(t),e==="complex64"){const r=Sa(t,"float32"),s=ln(t,"float32");return mu(r,s)}const n=PS(Q(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gce(t,e){let n=R(t,"a","minimum"),r=R(e,"b","minimum");[n,r]=Ft(n,r),n.dtype==="bool"&&(n=fe(n,"int32"),r=fe(r,"int32")),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(_f,s)}const Eh=W({minimum_:Gce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=R(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return j.runKernel(sy,o,i)}const Kce=W({mirrorPad_:Hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(t,e){let n=R(t,"a","mod"),r=R(e,"b","mod");[n,r]=Ft(n,r);const s={a:n,b:r};return j.runKernel(Mf,s)}const Xce=W({mod_:qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t,e=null,n=!1){t=R(t,"x","moments");const r=Me(e,t.shape),s=Wt(t,r,n);let i=s.shape;n||(i=Ut(s.shape,r));const o=xt(Se(fe(t,"float32"),B(s,i))),a=Wt(o,r,n);return{mean:s,variance:a}}const j2=W({moments_:Yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(t,e){let n=R(t,"a","notEqual","string_or_numeric"),r=R(e,"b","notEqual","string_or_numeric");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r};return j.runKernel(oy,s)}const Vg=W({notEqual_:Qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:R(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return j.runKernel(ly,o,a)}const e4=W({oneHot_:Zce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t){const n={x:R(t,"x","onesLike")};return j.runKernel(ay,n)}const Cs=W({onesLike_:Jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t,e,n=0){const r=R(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return j.runKernel(uy,i,s)}const z2=W({pad_:eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(t,e,n){const r=R(t,"x","spaceToBatchND");T(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return j.runKernel(by,s,i)}const B2=W({spaceToBatchND_:tue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=R(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(Mn(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=$s(l.shape,e,i,s,r),d=[u.dilationHeight,u.dilationWidth];let h;r==="same"?h=sue([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=rue([u.inHeight,u.inWidth],d,h),x=f?r:"valid",g=f?l:B2(l,d,p),b=(n==="avg"?()=>E2(g,e,i,x,o):()=>L2(g,e,i,x,o))(),w=f?b:T2(b,d,m);return c?B(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function rue(t,e,n){const r=n.map(u=>u[0]),s=n.map(u=>u[1]),i=t.concat(r,s),o=e.map((u,d)=>(u-i[d]%u)%u),a=s.map((u,d)=>u+o[d]),l=e.map((u,d)=>[r[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function sue(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const iue=W({pool_:nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(t,e){const n=R(t,"x","prelu"),r=R(e,"alpha","prelu"),s={x:n,alpha:r};return j.runKernel(dy,s)}const W2=W({prelu_:oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(t,e=null,n=!1){let r=R(t,"x","prod");r.dtype==="bool"&&(r=fe(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return j.runKernel(hy,s,i)}const lue=W({prod_:aue});var U2={exports:{}};U2.exports;(function(t){(function(e,n,r){function s(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new s(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(Ol,t)})(U2);var cue=U2.exports,V2={exports:{}};V2.exports;(function(t){(function(e,n,r){function s(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new s(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Ol,t)})(V2);var uue=V2.exports,G2={exports:{}};G2.exports;(function(t){(function(e,n,r){function s(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new s(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Ol,t)})(G2);var due=G2.exports,H2={exports:{}};H2.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new s(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Ol,t)})(H2);var hue=H2.exports,K2={exports:{}};K2.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,x,g=[],y=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,y=Math.max(y,d.length)),p=0,m=-32;m<y;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(x=x+1640531527|0,h=g[m&127]^=f+x,p=h==0?p+1:0);for(p>=128&&(g[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=g[p+34&127],h=g[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,g[p]=f^h;u.w=x,u.X=g,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new s(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Ol,t)})(K2);var fue=K2.exports,q2={exports:{}};q2.exports;(function(t){(function(e,n,r){function s(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new s(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Ol,t)})(q2);var pue=q2.exports,t4={exports:{}};const mue={},gue=Object.freeze(Object.defineProperty({__proto__:null,default:mue},Symbol.toStringTag,{value:"Module"})),xue=$V(gue);(function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),c=r.pow(2,o),u=c*2,d=s-1,h;function f(w,k,C){var S=[];k=k==!0?{entropy:!0}:k||{};var I=g(x(k.entropy?[w,b(n)]:w??y(),3),S),$=new p(S),E=function(){for(var A=$.g(i),D=l,P=0;A<c;)A=(A+P)*s,D*=s,P=$.g(1);for(;A>=u;)A/=2,D/=2,P>>>=1;return(A+P)/D};return E.int32=function(){return $.g(4)|0},E.quick=function(){return $.g(4)/4294967296},E.double=E,g(b($.S),n),(k.pass||C||function(A,D,P,O){return O&&(O.S&&m(O,$),A.state=function(){return m($,{})}),P?(r[a]=A,D):A})(E,I,"global"in k?k.global:this==r,k.state)}function p(w){var k,C=w.length,S=this,I=0,$=S.i=S.j=0,E=S.S=[];for(C||(w=[C++]);I<s;)E[I]=I++;for(I=0;I<s;I++)E[I]=E[$=d&$+w[I%C]+(k=E[I])],E[$]=k;(S.g=function(A){for(var D,P=0,O=S.i,F=S.j,U=S.S;A--;)D=U[O=d&O+1],P=P*s+U[d&(U[O]=U[F=d&F+D])+(U[F]=D)];return S.i=O,S.j=F,P})(s)}function m(w,k){return k.i=w.i,k.j=w.j,k.S=w.S.slice(),k}function x(w,k){var C=[],S=typeof w,I;if(k&&S=="object")for(I in w)try{C.push(x(w[I],k-1))}catch{}return C.length?C:S=="string"?w:w+"\0"}function g(w,k){for(var C=w+"",S,I=0;I<C.length;)k[d&I]=d&(S^=k[d&I]*19)+C.charCodeAt(I++);return b(k)}function y(){try{var w;return h&&(w=h.randomBytes)?w=w(s):(w=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var k=e.navigator,C=k&&k.plugins;return[+new Date,e,C,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(g(r.random(),n),t.exports){t.exports=f;try{h=xue}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:Ol,[],Math)})(t4);var yue=t4.exports,vue=cue,bue=uue,wue=due,kue=hue,Cue=fue,Sue=pue,Vl=yue;Vl.alea=vue;Vl.xor128=bue;Vl.xorwow=wue;Vl.xorshift7=kue;Vl.xor4096=Cue;Vl.tychei=Sue;var X2=Vl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n4{constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=X2.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Iue{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=X2.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t,e=0,n=1,r,s){if(po(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new n4(e,n,r,!1,s),o=_e(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const $ue=W({randomNormal_:Nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t,e=0,n=1,r="float32",s){po(t);const i=_e(t,r),o=new Iue(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const ip=W({randomUniform_:Eue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Th(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return j.runKernel(f2,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tue(t){const n={input:R(t,"input","real")};return j.runKernel(p2,n)}const Gg=W({real_:Tue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(t){const n={x:R(t,"x","reciprocal")};return j.runKernel(jf,n)}const Due=W({reciprocal_:Aue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t){const n={x:R(t,"x","relu")};return j.runKernel(zf,n)}const Gl=W({relu_:Oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t){const n={x:R(t,"x","relu6")};return j.runKernel(Bf,n)}const r4=W({relu6_:Rue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t,e){const r={x:R(t,"x","reverse")},s={dims:e};return j.runKernel(gy,r,s)}const Nl=W({reverse_:Pue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const n={x:R(t,"x","round")};return j.runKernel(Wf,n)}const s4=W({round_:_ue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mue(t){const n={x:R(t,"x","rsqrt","float32")};return j.runKernel(Uf,n)}const i4=W({rsqrt_:Mue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fue(t){const n={x:R(t,"x","selu")};return j.runKernel(Vf,n)}const o4=W({selu_:Fue});function Lue(t,e,n,r,s,i=[1,1],o="NHWC"){const a=R(t,"x","separableConv2d"),l=R(e,"depthwiseFilter","separableConv2d"),c=R(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=O2(u,l,r,s,o,i),x=Sl(p,c,1,"valid",o);return d?B(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const a4=W({separableConv2d_:Lue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(t){const n={x:R(t,"x","sign")};return j.runKernel(Kf,n)}const zue=W({sign_:jue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(t){const n={x:R(t,"x","sin","float32")};return j.runKernel(Gf,n)}const l4=W({sin_:Bue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const n={x:R(t,"x","sinh")};return j.runKernel(Hf,n)}const c4=W({sinh_:Wue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t,e,n){const r=R(t,"x","slice1d");return T(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),ut(r,[e],[n])}const Y2=W({slice1d_:Uue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t,e,n){const r=R(t,"x","slice2d");return T(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),ut(r,e,n)}const u4=W({slice2d_:Vue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t,e,n){const r=R(t,"x","slice3d");return T(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),ut(r,e,n)}const Q2=W({slice3d_:Gue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hue(t,e,n){const r=R(t,"x","slice4d");return T(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),ut(r,e,n)}const Hg=W({slice4d_:Hue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t,e=-1){const n=R(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return j.runKernel(ky,r,s)}const Z2=W({softmax_:Kue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(n2,e)}const d4=W({fft_:que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(i2,e)}const $w=W({ifft_:Xue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=B(t,[n,e]);r=$w(s)}else{const s=[n,2*(e-1)],i=B(Gg(t),[n,e]),o=B(_2(t),[n,e]),a=Nl(ut(i,[0,1],[n,e-2]),1),l=L(Nl(ut(o,[0,1],[n,e-2]),1),Xe(-1)),c=ar([i,a],1),u=ar([o,l],1),d=B(mu(c,u),[s[0],s[1]]);r=$w(d)}if(r=Gg(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=B(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const Que=W({irfft_:Yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t,e,n=0){const s={x:R(t,"x","split")},i={numOrSizeSplits:e,axis:n};return j.runKernel(wy,s,i)}const Wr=W({split_:Zue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const p=t.shape.map(x=>0),m=t.shape.map(x=>x);m[t.shape.length-1]=e,s=ut(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,s=ar([t,ln(p)],t.shape.length-1),n=e}else s=t;const i=We(s),o=B(mu(s,i),[r,n]),a=d4(o),l=Math.floor(n/2)+1,c=Gg(a),u=_2(a),d=Wr(c,[l,n-l],c.shape.length-1),h=Wr(u,[l,n-l],u.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,B(mu(d[0],h[0]),f)}const ede=W({rfft_:Jue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(t,e){let n=R(t,"a","squaredDifference"),r=R(e,"b","squaredDifference");[n,r]=Ft(n,r),Ae(n.shape,r.shape);const s={a:n,b:r},i={};return j.runKernel(Qf,s,i)}const nde=W({squaredDifference_:tde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rde(t,e){const n=R(t,"x","squeeze","string_or_numeric");return B(n,va(n.shape,e).newShape)}const op=W({squeeze_:rde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(t,e=0){const n=Tj(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return j.runKernel(cy,r,s)}const io=W({stack_:sde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t,e=0){const r={x:R(t,"x","step")},s={alpha:e};return j.runKernel(np,r,s)}const ap=W({step_:ide});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(t,e,n,r,s=0,i=0,o=0,a=0,l=0){const u={x:R(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return j.runKernel(v2,u,d)}const ade=W({stridedSlice_:ode});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t){const n={x:R(t,"x","tan","float32")};return j.runKernel(Jf,n)}const cde=W({tan_:lde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wr(t,e){_L(t);const n=$y(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ey(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(t,e,n){if(_L(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=$y(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ey(t,e,r,n)}function h4(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function ude(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}h4(n,e,t)}function Hl(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=s;d<i;++d)o*=n[d];const a=s<1?1:s,l=Q(e.shape)/a,c=[...ve(n.slice(0,s)),1],u=Q(n);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t,e=1,n=!0){const r=R(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,l]=j.runKernel(b2,i,o);return{values:a,indices:l}}const hde=W({topk_:dde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(t,e=0,n=1,r,s){if(po(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new n4(e,n,r,!0,s),o=_e(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const f4=W({truncatedNormal_:fde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pde(t,e=0){const n=R(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=j.runKernel(k2,r,s);return{values:i,indices:o}}const mde=W({unique_:pde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t,e,n){const r=R(t,"x","unsortedSegmentSum"),s=R(e,"segmentIds","unsortedSegmentSum","int32");T(hu(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return j.runKernel(Sy,i,o)}const p4=W({unsortedSegmentSum_:gde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(t,e=0){const n=R(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return j.runKernel(Cy,r,s)}const $l=W({unstack_:xde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yde(t,e=!0,n,r){return j.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m4(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=_e(t,"int32"),s=_e([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vde(t,e,n){const r=R(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),T(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{T(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?G(()=>{let o=Gg(r),a=_2(r);return o=j.runKernel(Bc,{x:o},i),a=j.runKernel(Bc,{x:a},i),n&&(a=Mt(a)),mu(o,a)}):j.runKernel(Bc,s,i)}const Be=W({transpose_:vde});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(t,e){if(e==null)return t.shape.slice();if(Qe(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t,e,n,r){const s=R(t,"x","dropout");if(T(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Xt?s.clone():s;const i=bde(s,n),o=1-e,a=we(Py(re(ip(i,0,1,"float32",r),o)),o);return L(s,a)}const kde=W({dropout_:wde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),fr("conv2dDerFilter",s,o);const d={x:a,dy:l},h={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return j.runKernel(GS,d,h)}const J2=W({conv2DBackpropFilter_:Cde});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eI(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return L(t,ap(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function tI(t,e){let n=e;const r=nn(t.shape,e.shape);return r.length>0&&(n=be(n,r)),B(n,t.shape)}function nI(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Gl(t);if(e==="elu")return Oy(t);if(e==="relu6")return r4(t);if(e==="prelu")return W2(t,n);if(e==="leakyrelu")return M2(t,r);if(e==="sigmoid")return zu(t);throw new Error(`Unknown fused activation ${e}.`)}const rI=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",rI(j.state.gradientDepth,l)===!1){T(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=Sl(t,e,n,r,s,i,o);return a!=null&&(C=re(C,a)),nI(C,l,c,u)}const d=R(t,"x","conv2d","float32"),h=R(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=B(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),fr("fused conv2d",r,o);const m=s==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),T(Mn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const x=Cn(f.shape,h.shape,n,i,r,o);let g;a!=null&&(g=R(a,"bias","fused conv2d"),[g]=Ft(g,d),s==="NHWC"?Ae(x.outShape,g.shape):(T(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),T(g.shape.length===0||g.shape[0]===x.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let y;if(c!=null){const C=c.shape;if(T(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)T(C[0]===1||C[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${x.outChannels}).`);else if(C.length===3)try{Ae(C,x.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(I)}y=R(c,"prelu weights","fused conv2d")}const b=(C,S)=>{T(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[I,$,E,A]=S,D=eI(C,E,l);T(kl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const P=A2($.shape,D,I,n,r),O=J2($,D,I.shape,n,r),F=[P,O];if(A!=null){const U=tI(A,D);F.push(U)}return F},w={x:f,filter:h,bias:g,preluActivationWeights:y},k={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?xu((S,I,$)=>{let E=j.runKernel(Lg,w,k);return $([I,S,E]),p&&(E=B(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,h):xu((S,I,$,E)=>{let A=j.runKernel(Lg,w,k);return E([I,S,A,$]),p&&(A=B(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(f,h,g)}const Ide=W({fusedConv2d_:Sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return j.runKernel(ZS,c,u)}const $de=W({depthwiseConv2dNativeBackpropFilter_:Nde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(t,e,n,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},d=j.runKernel(JS,c,u);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Tde=W({depthwiseConv2dNativeBackpropInput_:Ede});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ade({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(rI(j.state.gradientDepth,i)===!1){let A=qe(t,e,n,r);return s!=null&&(A=re(A,s)),nI(A,i,o,a)}let l=R(t,"a","fused matMul"),c=R(e,"b","fused matMul");[l,c]=Ft(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),x=Q(p),g=Q(m);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=Ae(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),w=n?B(l,[x,u,h]):B(l,[x,h,u]),k=r?B(c,[g,f,d]):B(c,[g,d,f]);let C;s!=null&&(C=R(s,"bias","fused matMul"),[C]=Ft(C,l),Ae(b,C.shape));let S;o!=null&&(S=R(o,"prelu weights","fused matMul"));const I=(A,D)=>{const[P,O,F,U]=D,V=eI(B(A,F.shape),F,i);let _,z;if(!n&&!r?(_=qe(V,O,!1,!0),z=qe(P,V,!0,!1)):!n&&r?(_=qe(V,O,!1,!1),z=qe(V,P,!0,!1)):n&&!r?(_=qe(O,V,!1,!0),z=qe(P,V,!1,!1)):(_=qe(O,V,!0,!0),z=qe(V,P,!0,!0)),s!=null){const K=tI(U,V);return[_,z,K]}else return[_,z]},$={a:w,b:k,bias:C,preluActivationWeights:S},E={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?xu((D,P,O)=>{const F=j.runKernel(Fg,$,E);return O([D,P,F]),{value:B(F,b),gradFunc:I}})(w,k):xu((D,P,O,F)=>{const U=j.runKernel(Fg,$,E);return F([D,P,U,O]),{value:B(U,b),gradFunc:I}})(w,k,C)}const HA=W({fusedMatMul_:Ade});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dde(t,e,n,r,s="bilinear",i=0){const o=R(t,"image","cropAndResize"),a=R(e,"boxes","cropAndResize","float32"),l=R(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),T(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),T(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:o,boxes:a,boxInd:l},d={method:s,extrapolationValue:i,cropSize:r};return j.runKernel(XS,u,d)}const Ode=W({cropAndResize_:Dde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rde(t){const e=R(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return j.runKernel(s2,n,{})}const Pde=W({flipLeftRight_:Rde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(t){const e=R(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Ws(e,s)}const Mde=W({grayscaleToRGB_:_de});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(t){const e=R(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];T(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),T(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=fe(e,"float32"),o=wr([.2989,.587,.114]);let a;switch(e.rank){case 2:a=vd("ij,j->i",i,o);break;case 3:a=vd("ijk,k->ij",i,o);break;case 4:a=vd("ijkl,l->ijk",i,o);break;case 5:a=vd("ijklm,m->ijkl",i,o);break;case 6:a=vd("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=nr(a,-1),fe(a,s)}const Lde=W({rgbToGrayscale_:Fde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t,e,n=0,r=.5){const s=R(t,"image","rotateWithOffset","float32");T(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return j.runKernel(C2,i,o)}const zde=W({rotateWithOffset_:jde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wu(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),T(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),T(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bde(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppression","float32"),o=R(e,"scores","nonMaxSuppression","float32"),a=Wu(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return j.runKernel(u2,{boxes:i,scores:o},l)}const Wde=W({nonMaxSuppression_:Bde});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ude(t,e,n){const r=Vde(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function Vde(t,e,n){return Hde(t,e,n||Gde)}function Gde(t,e){return t>e?1:t<e?-1:0}function Hde(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sI(t,e,n,r,s){return aI(t,e,n,r,s,0)}function iI(t,e,n,r,s,i){return aI(t,e,n,r,s,0,!1,i,!0)}function oI(t,e,n,r,s,i){return aI(t,e,n,r,s,i,!0)}function aI(t,e,n,r,s,i,o=!1,a=!1,l=!1){const c=[];for(let x=0;x<e.length;x++)e[x]>s&&c.push({score:e[x],boxIndex:x,suppressBeginIndex:0});c.sort(KA);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const x=c.pop(),{score:g,boxIndex:y,suppressBeginIndex:b}=x;if(g<s)break;let w=!1;for(let k=d.length-1;k>=b;--k){const C=Kde(t,y,d[k]);if(C>=r){w=!0;break}if(x.score=x.score*qde(r,u,C),x.score<=s)break}x.suppressBeginIndex=d.length,w||(x.score===g?(d.push(y),h.push(x.score)):x.score>s&&Ude(c,x,KA))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return o&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function Kde(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),f=(a-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),x=Math.max(o,u),g=Math.min(a,d),y=Math.min(l,h),b=Math.max(g-m,0)*Math.max(y-x,0);return b/(f+p-b)}function qde(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function KA(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xde(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppressionAsync"),o=R(e,"scores","nonMaxSuppressionAsync"),a=Wu(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=sI(c,u,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),wr(d,"int32")}const Yde=Xde;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Wu(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=j.runKernel(h2,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const Zde=W({nonMaxSuppressionWithScore_:Qde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Jde(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Wu(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=oI(u,d,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:wr(h,"int32"),selectedScores:wr(f)}}const ehe=Jde;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Wu(o,a,n,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},p=j.runKernel(d2,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const nhe=W({nonMaxSuppressionPadded_:the});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function rhe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Wu(o,a,n,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=iI(h,f,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:wr(p,"int32"),validOutputs:Xe(m,"int32")}}const she=rhe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t,e,n=!1,r=!1){const s=R(t,"images","resizeBilinear");T(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=B(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},c=j.runKernel(my,a,l);return o?B(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const g4=W({resizeBilinear_:ihe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(t,e,n=!1,r=!1){const s=R(t,"images","resizeNearestNeighbor");T(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=B(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},c=j.runKernel(py,a,l);return o?B(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const x4=W({resizeNearestNeighbor_:ohe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ahe(t,e="binary",n=!1,r=.5){const s=R(t,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let c=L(wr([r]),255),u,d,h,f;if(T(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),T(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),T(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,d,h]=Wr(s,[1,1,1],-1);const x=L(u,i),g=L(d,o),y=L(h,a);f=re(re(x,g),y)}else f=t;if(e==="otsu"){const x=ole(fe(s4(f),"int32"),Aj([]),256);c=lhe(x,l)}const p=n?Bu(f,c):Qr(f,c);return fe(L(p,255),"int32")}function lhe(t,e){let n=wr([-1]),r=wr([0]),s=wr([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=ut(t,0,d+1),o=ut(t,d+1),c=we(be(i),e),u=we(be(o),e);const h=be(L(i,Th(0,i.size)));a=we(h,be(i));const f=Dy(o.shape,i.size),p=re(Th(0,o.size),f),m=L(o,p);l=we(be(m),be(o));const x=Se(a,l),g=Se(a,l),y=L(c,u);s=L(L(y,x),g);const b=Qr(s,r);r=Xn(b,s,r),n=Xn(b,wr([d]),n)}return n}const che=W({threshold_:ahe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uhe(t,e,n="nearest",r="constant",s=0,i){const o=R(t,"image","transform","float32"),a=R(e,"transforms","transform","float32");T(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return j.runKernel(w2,l,c)}const dhe=W({transform_:uhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hhe(t,e,n){const r=R(t,"a","bandPart");T(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=R(e<0?i:e,"numLower","bandPart")):(T(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Xn(Ug(e,0),i,Eh(e,i))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=R(n<0?o:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Xn(Ug(n,0),o,Eh(n,o)));const c=B(Th(0,i,1,"int32"),[-1,1]),u=Th(0,o,1,"int32"),d=Se(c,u),h=so(Bu(d,a),Ul(d,Mt(l))),f=ln([i,o],r.dtype);return B(io($l(B(r,[-1,i,o])).map(p=>Xn(h,p,f))),s)}const fhe=W({bandPart_:hhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function phe(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)T(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=Wr(t,t.shape[0],0).map(s=>op(s,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(j.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=L(be(L(n[o],i)),n[o]);i=Se(i,a)}return we(i,Ry(i,"euclidean"))}));return e?io(n,0):n}const mhe=W({gramSchmidt_:phe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ghe(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return qA(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=$l(B(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[c,u]=qA(l,e);s.push(c),i.push(u)});const o=B(io(s,0),t.shape),a=B(io(i,0),t.shape);return[o,a]}}function qA(t,e=!1){return j.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=Xj(n),i=il(t);const o=sb([[1]],[1,1]);let a=il(o);const l=n>=r?r:n;for(let c=0;c<l;++c){const u=i,d=a,h=s;[a,i,s]=j.tidy(()=>{const f=ut(i,[c,c],[n-c,1]),p=Ry(f),m=ut(i,[c,c],[1,1]),x=Xn(Qr(m,0),sb([[-1]]),sb([[1]])),g=Se(m,L(x,p)),y=we(f,g);y.shape[0]===1?a=il(o):a=ar([o,ut(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=Mt(we(qe(x,g),p)),w=ut(i,[c,0],[n-c,r]),k=L(b,a),C=Be(a);if(c===0)i=Se(w,qe(k,qe(C,w)));else{const $=Se(w,qe(k,qe(C,w)));i=ar([ut(i,[0,0],[c,r]),$],0)}const S=Be(k),I=ut(s,[0,c],[n,s.shape[1]-c]);if(c===0)s=Se(I,qe(qe(I,a),S));else{const $=Se(I,qe(qe(I,a),S));s=ar([ut(s,[0,0],[n,c]),$],1)}return[a,i,s]}),Le([u,d,h])}return!e&&n>r&&(s=ut(s,[0,0],[n,r]),i=ut(i,[0,0],[r,r])),[s,i]})}const xhe=W({qr_:ghe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ui={flipLeftRight:Pde,grayscaleToRGB:Mde,resizeNearestNeighbor:x4,resizeBilinear:g4,rgbToGrayscale:Lde,rotateWithOffset:zde,cropAndResize:Ode,nonMaxSuppression:Wde,nonMaxSuppressionAsync:Yde,nonMaxSuppressionWithScore:Zde,nonMaxSuppressionWithScoreAsync:ehe,nonMaxSuppressionPadded:nhe,nonMaxSuppressionPaddedAsync:she,threshold:che,transform:dhe},yhe={bandPart:fhe,gramSchmidt:mhe,qr:xhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe=new Map,bhe=new Map;class Uu{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ls{constructor(){this.classNameMap={}}static getMap(){return ls.instance==null&&(ls.instance=new ls),ls.instance}static register(e){ls.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ne(t,e,n){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return ls.register(t),vhe.set(s,t),bhe.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ia extends Uu{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Le(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return $ce(e,n)}dispose(){this.iterations_!=null&&Le(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Xe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Ia,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y4 extends Ia{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=j.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:G(()=>We(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:G(()=>We(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;G(()=>{const u=re(L(l,this.rho),L(xt(a),1-this.rho)),d=L(we(_n(re(c,this.epsilon)),_n(re(l,this.epsilon))),a),h=re(L(c,this.rho),L(xt(d),1-this.rho));l.assign(u),c.assign(h);const f=re(L(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Le(this.accumulatedGrads.map(e=>e.variable)),Le(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v4 extends Ia{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=j.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:G(()=>Dy(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;G(()=>{const l=re(a,xt(o));a.assign(l);const c=re(L(we(o,_n(re(l,j.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Le(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b4 extends Ia{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=Xe(n).variable(),this.accBeta2=Xe(r).variable()}),s==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);G(()=>{const r=Se(1,this.accBeta1),s=Se(1,this.accBeta2);n.forEach((i,o)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:G(()=>We(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:G(()=>We(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=re(L(u,this.beta1),L(c,1-this.beta1)),f=re(L(d,this.beta2),L(xt(c),1-this.beta2)),p=we(h,r),m=we(f,s);u.assign(h),d.assign(f);const x=re(L(we(p,re(_n(m),this.epsilon)),-this.learningRate),a);a.assign(x)}),this.accBeta1.assign(L(this.accBeta1,this.beta1)),this.accBeta2.assign(L(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Le(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Le(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),G(()=>{this.accBeta1.assign(Il(this.beta1,this.iterations_+1)),this.accBeta2.assign(Il(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w4 extends Ia{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=Xe(0).variable(),this.accBeta1=Xe(n).variable()}),s==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);G(()=>{const r=Se(1,this.accBeta1),s=we(-this.learningRate,re(L(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:We(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:We(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=re(L(u,this.beta1),L(c,1-this.beta1)),f=L(d,this.beta2),p=Un(c),m=Ca(f,p);u.assign(h),d.assign(m);const x=re(L(we(s,r),we(h,re(m,this.epsilon))),a);a.assign(x)}),this.iteration.assign(re(this.iteration,1)),this.accBeta1.assign(L(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Le(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Le(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lI extends Ia{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=j.registeredVariables[r];G(()=>{const a=re(L(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=xi(Xe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k4 extends lI{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Xe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=j.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:G(()=>We(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&G(()=>{let l;const c=re(L(this.m,o),a);this.useNesterov?l=re(L(this.c,re(a,L(c,this.m))),i):l=re(L(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Le(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C4 extends Ia{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=j.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=j.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:G(()=>We(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:G(()=>We(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:G(()=>We(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;G(()=>{const u=re(L(l,this.decay),L(xt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=re(L(d,this.decay),L(a,1-this.decay)),f=we(L(a,this.learningRate),_n(Se(u,re(xt(h),this.epsilon)))),p=re(L(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=Se(i,p);i.assign(m)}else{const d=re(L(l,this.decay),L(xt(a),1-this.decay)),h=re(L(c,this.momentum),we(L(a,this.learningRate),_n(re(d,this.epsilon))));l.assign(d),c.assign(h);const f=Se(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Le(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Le(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Le(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe=[y4,v4,b4,w4,k4,C4,lI];function khe(){for(const t of whe)ne(t)}function cI(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(Q(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=t.shape,l=s.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...ve(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ew=-2,Che=-1;function uI(t,e,n){const r=t.shape.length;T(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),T(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)T(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function She(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function dI(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function S4(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function I4(t,e,n){return n<=t?n:n-(e-1)}function N4(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Ihe(t,e,n,r,s,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=$4(o,f,p,r,t),d=E4(a,f,p,s,t),h=S4(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=A4(o,r,i,t,f,l),d[f]=D4(a,s,i,t,f,l),h[f]=T4(i,f,l);return{begin:u,end:d,strides:h}}function $4(t,e,n,r,s){const i=[...s],o=N4(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=I4(e,n,a);let c=r[l];t&1<<l&&(c=0),i[a]=c}return i}function E4(t,e,n,r,s){const i=[...s],o=N4(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=I4(e,n,a);let c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=yl(0,i[a],s[a])}return i}function T4(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function A4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=yl(0,o,l-1),o}function D4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=yl(0,o,l):o=yl(-1,o,l-1),o}function hI(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function fI(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function _y(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{T(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(T(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function pI(t,e,n,r,s,i,o,a,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Nhe(d,h);let f=!0,p=!0,m=!0;const x=[],g=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(h.shrinkAxisMask&1<<b),k=t[b];if(k===-1){x.push(w?1:-1);continue}const C=[h.beginMask&1<<b,h.endMask&1<<b],S=[h.strides[b]>0?0:-1,h.strides[b]>0?k:k-1];if(w&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[b]===1;const I=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(w){const D=h.begin[b]<0?k+h.begin[b]:h.begin[b];if(h.begin[b]=D,h.end[b]=h.begin[b]+1,D<0||D>=k)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=XA(h.begin[b],0,h.strides[b],k,C,S),h.end[b]=XA(h.end[b],1,h.strides[b],k,C,S);const A=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===k;f=f&&A,p=p&&(b===0&&h.strides[b]===1||A)}else f=f&&h.strides[b]===1&&I,p=p&&(b===0&&h.strides[b]===1||I);let $,E=!1;if(h.beginValid&&h.endValid?($=h.end[b]-h.begin[b],E=!0):w?($=1,E=!0):I&&k>=0&&(h.strides[b]<0?$=-k:$=k,E=!0),E){let A;$===0||$<0!=h.strides[b]<0?A=0:A=Math.trunc($/h.strides[b])+($%h.strides[b]!==0?1:0),x.push(A)}else x.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const w=h.finalShapeGatherIndices[b];w>=0?g.push(x[w]):w===Ew&&g.push(1)}return{finalShapeSparse:g.filter((b,w)=>h.finalShapeGatherIndices[w]!==Ew),finalShape:g,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function Nhe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Ew),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(Che),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function XA(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const $he=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:uI,computeFlatOffset:fI,computeOutShape:dI,getNormalizedAxes:Ihe,isSliceContinous:hI,maskToAxes:She,parseSliceParams:_y,sliceInfo:pI,startForAxis:A4,startIndicesWithElidedDims:$4,stopForAxis:D4,stopIndicesWithElidedDims:E4,stridesForAxis:T4,stridesWithElidedDims:S4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ehe{static sgd(e){return new lI(e)}static momentum(e,n,r=!1){return new k4(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,i=!1){return new C4(e,n,r,s,i)}static adam(e=.001,n=.9,r=.999,s=null){return new b4(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new y4(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,i=0){return new w4(e,n,r,s,i)}static adagrad(e,n=.1){return new v4(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ic=Ehe;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function O4(){return new Promise(t=>The(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(t,e){const n=t[0].length;t.forEach((s,i)=>{T(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)T(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function yi(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var js;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(js||(js={}));function R4(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function P4(t){const e={FIRST_DIM_SIZE:js.FIRST_DIM_SIZE,VALUE_ROWIDS:js.VALUE_ROWIDS,ROW_LENGTHS:js.ROW_LENGTHS,ROW_SPLITS:js.ROW_SPLITS,ROW_LIMITS:js.ROW_LIMITS,ROW_STARTS:js.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function _4(t){return t.length===0?0:t[0]===js.FIRST_DIM_SIZE?t.length-1:t.length}function M4(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI=30;function My(t){return t<=gI?t:dw(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xI(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lp(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function cp(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function up(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function yI(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function vI(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fy=1.7580993408473768,Ly=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bI=.3275911,wI=.254829592,kI=-.284496736,CI=1.421413741,SI=-1.453152027,II=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function F4(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function L4(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function j4(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function NI(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function z4(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function B4(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function W4(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ib="->",Ahe=/->/g,YA=",",QA="...";function $I(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Ahe,"").length)/ib.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${ib}").`);const[r,s]=t.split(ib);T(r.indexOf(QA)===-1,()=>`The ellipsis notation ("${QA}") is not supported yet.`);const i=r.split(YA),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const f=s[h];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<r.length;++h){const f=r[h];a.indexOf(f)===-1&&f!==YA&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const c=a.length,u=s.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function EI(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function TI(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:T(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function AI(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=Dhe(e,a);for(const c of l)i.indexOf(c)===-1&&(r[o].push(c),i.push(c))}return{path:n,steps:r}}function DI(t){return t.every((e,n)=>e===n)}function Dhe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function OI(t,e,n=0){let r=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);T(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}T(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function V4(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function G4(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H4(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function K4(t,e){return`size ${t} must be non-negative, not ${e}`}function q4(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function X4(t,e){const n=Q(t),r=Q(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function Y4(t,e){const n=Q(t),r=Q(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tw(){return"segment ids must be >= 0"}function Q4(){return"segment ids are not increasing"}function Z4(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function J4(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(t,e){let n=!1,r;for(t<=gI?(r=t,n=!0):r=dw(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=dw(t,r+1);return r}function tz(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function RI(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const Ohe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:RI,computeOutShape:tz,segOpComputeOptimalWindowSize:ez},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(t){try{return t.map(e=>sa(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function nz(t){return t.map(e=>Xo(e))}const Rhe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:wI,ERF_A2:kI,ERF_A3:CI,ERF_A4:SI,ERF_A5:II,ERF_P:bI,PARALLELIZE_THRESHOLD:gI,get RowPartitionType(){return js},SELU_SCALE:Ly,SELU_SCALEALPHA:Fy,applyActivation:nI,assertAndGetBroadcastShape:Ae,assertAxesAreInnerMostDims:Sn,assertParamsConsistent:mI,assignToTypedArray:z4,axesAreInnerMostDims:R2,calculateShapes:Hl,checkEinsumDimSizes:TI,checkPadOnDimRoundingMode:fr,combineLocations:Kj,combineRaggedTensorToTensorShapes:R4,complexWithEvenIndex:L4,complexWithOddIndex:j4,computeConv2DInfo:Cn,computeConv3DInfo:wa,computeDefaultPad:$2,computeDilation2DInfo:rp,computeOptimalWindowSize:My,computeOutAndReduceShapes:fn,computeOutShape:yi,computePool2DInfo:$s,computePool3DInfo:mo,convertConv2DDataFormat:go,decodeEinsumEquation:$I,eitherStridesOrDilationsAreOne:Mn,expandShapeToKeepDim:Ut,exponent:W4,exponents:B4,fromStringArrayToUint8:nz,fromUint8ToStringArray:ao,getAxesPermutation:Et,getBroadcastDims:gu,getComplexWithIndex:NI,getEinsumComputePath:AI,getEinsumPermutation:EI,getFusedBiasGradient:tI,getFusedDyActivation:eI,getImageCenter:xI,getInnerMostAxes:Lt,getPermuted:cp,getRaggedRank:_4,getReductionAxes:nn,getReshaped:lp,getReshapedPermuted:up,getRowPartitionTypesHelper:P4,getSliceBeginCoords:yI,getSliceSize:vI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:U4,getSparseFillEmptyRowsNegativeIndexErrorMessage:V4,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:G4,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:q4,getSparseReshapeInputOutputMismatchErrorMessage:Y4,getSparseReshapeInputOutputMultipleErrorMessage:X4,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:H4,getSparseReshapeNegativeOutputDimErrorMessage:K4,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:J4,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Tw,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Q4,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Z4,getUndoAxesPermutation:ka,isIdentityPermutation:DI,log:moe,mergeRealAndImagArrays:oo,prepareAndValidate:cI,prepareSplitSize:OI,segment_util:Ohe,shouldFuse:rI,slice_util:$he,splitRealAndImagArrays:F4,stridesOrDilationsArePositive:Cl,tupleValuesAreOne:kl,upcastType:Ir,validateDefaultValueShape:M4,validateInput:ude,validateUpdateShape:h4,warn:Fr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */khe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rz={kernelName:Nx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,ap(fe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Phe={kernelName:lf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=xt(fe(n,"float32")),s=_n(Se(Xe(1),r));return Mt(we(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he={kernelName:cf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=_n(Se(xt(fe(n,"float32")),1));return we(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe={kernelName:Lu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{let a=t;const l=nn(n.shape,s);return l.length>0&&(a=be(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=nn(r.shape,s);return l.length>0&&(a=be(a,l)),B(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe={kernelName:FS,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lhe={kernelName:$x,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe={kernelName:Ex,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zhe={kernelName:uf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,_n(Se(Xe(1),xt(fe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe={kernelName:df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=_n(re(Xe(1),xt(fe(n,"float32"))));return we(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe={kernelName:pf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{const a=re(xt(n),xt(r));let l=L(t,we(r,a));const c=nn(n.shape,s);return c.length>0&&(l=be(l,c)),B(l,n.shape)},b:()=>{const a=re(xt(n),xt(r));let l=Mt(L(t,we(n,a)));const c=nn(r.shape,s);return c.length>0&&(l=be(l,c)),B(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uhe={kernelName:hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,re(xt(fe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe={kernelName:ff,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,Se(Xe(1),xt(fe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t,e,n,r,s,i){const o=R(t,"dy","avgPool3dGrad"),a=R(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=B(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),fr("avgPool3dGrad",s,i);const d={dy:l,input:c},h={filterSize:n,strides:r,pad:s,dimRoundingMode:i},f=j.runKernel(BS,d,h);return u?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Hhe=W({avgPool3dGrad_:Ghe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe={kernelName:Ax,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Hhe(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t,e,n,r,s){const i=R(t,"dy","avgPoolGrad"),o=R(e,"input","avgPoolGrad");T(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=B(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:r,pad:s},h=j.runKernel(zS,u,d);return c?B(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Xhe=W({avgPoolGrad_:qhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe={kernelName:Tx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=n;return{x:()=>Xhe(t,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qhe={kernelName:Dx,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>qe(t,s,!1,!0),b:()=>qe(r,t,!0,!1)}:!i&&o?{a:()=>qe(t,s,!1,!1),b:()=>qe(t,r,!0,!1)}:i&&!o?{a:()=>qe(s,t,!1,!0),b:()=>qe(r,t,!1,!1)}:{a:()=>qe(s,t,!0,!0),b:()=>qe(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe={kernelName:Ox,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>B2(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jhe={kernelName:doe,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>be(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const efe={kernelName:mf,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tfe={kernelName:gf,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nfe={kernelName:xf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>Xn(so(Ul(r,s),Bu(r,i)),t,We(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rfe={kernelName:Rx,inputsToSave:["x"],gradFunc:rz.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe={kernelName:Px,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,i=Me(s,e[0].shape)[0],o=r.map(l=>l[i]);return Wr(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ife={kernelName:_x,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return T(kl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>A2(r.shape,t,s,o,a,l),filter:()=>J2(r,t,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ofe={kernelName:Mx,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Sl(t,s,i,o,a,1,l),filter:()=>J2(t,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(t,e,n,r,s){let i=t;t.rank===4&&(i=B(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),T(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),T(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:n};return j.runKernel(HS,a,l)}const lfe=W({conv3DBackpropFilter_:afe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cfe={kernelName:Fx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;T(kl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>Uj(o.shape,t,a,s,i),filter:()=>lfe(o,t,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ufe={kernelName:yf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Mt(l4(fe(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dfe={kernelName:vf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(c4(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe={kernelName:Lx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=n;return{x:()=>{const a=Et([s],r.rank);let l=Gj(t,s,i,!o);return a!=null&&(l=Be(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe={kernelName:jx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=n,a=r??[1,1];T(kl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(Mn(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),fr("depthwiseConv2d",i,o),{x:()=>Tde(l.shape,t,c,s,i,a,o),filter:()=>$de(l,t,c.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pfe={kernelName:zx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},o={x:r,filter:s,dy:t};return{x:()=>j.runKernel(hw,i,n),filter:()=>j.runKernel(fw,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe={kernelName:wf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>j.runKernel(t2,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gfe={kernelName:kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=L(Si(Mt(xt(n))),2/Math.sqrt(Math.PI));return{x:()=>L(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xfe={kernelName:Cf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe={kernelName:Wx,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe={kernelName:Sf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,Si(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe={kernelName:If,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe={kernelName:Nf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{const a=we(t,fe(r,"float32")),l=nn(n.shape,s);return l.length>0?B(be(a,l),n.shape):a},b:()=>{let a=L(t,fe(n,"float32"));const l=nn(r.shape,s);l.length>0&&(a=B(be(a,l),r.shape));const c=xt(r);return Mt(we(a,fe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe={kernelName:Ux,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,o,a]=e,l=a??Xe(1),c=nn(i.shape,s.shape),u=[];if(i.rank===1){for(let w=0;w<s.shape.length-1;++w)u.push(s.shape[w]);u.push(1)}const d=Se(s,i),h=L(t,l),f=i4(re(o,Xe(r))),p=L(L(L(f,f),f),Xe(-.5));return{x:()=>i.rank===1?B(L(L(t,Ws(B(f,[1,1,1,i.shape[0]]),u)),l),s.shape):B(L(L(t,f),l),s.shape),mean:()=>{let w=L(L(f,Xe(-1)),h);return i.rank===1&&(w=be(w,c)),B(w,i.shape)},variance:()=>{let w=L(L(p,d),h);return i.rank===1&&(w=be(w,c)),B(w,i.shape)},scale:()=>{const w=L(d,f);let k=L(t,w);return i.rank===1&&(k=be(k,c)),B(k,i.shape)},offset:()=>{let w=t;return i.rank===1&&(w=be(w,c)),B(w,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe={kernelName:Vx,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i,batchDims:o}=n,a=Me(i,r.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,x=h.slice(i,h.length).slice(1),g=x.length,y=ZA(0,m),b=ZA(m+1,m+1+g),w=JA([p,[f],x]),k=B(d,w),C=B(u,[f]),S=JA([[m],y,b]),I=Be(k,S);let $=p4(I,C,c.shape[a]);const E=ka(S);return $=Be($,E),$};if(o===1){const c=r.shape[0],u=r.split(c,0);return{x:()=>io(u.map((f,p)=>l(f,s.slice(p,1),t.slice(p,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,t),indices:()=>s}}};function ZA(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function JA(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe={kernelName:$f,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>We(n),b:()=>We(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ife={kernelName:Ef,gradFunc:t=>({x:()=>fe(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe={kernelName:Tf,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $fe={kernelName:Af,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Efe={kernelName:Df,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tfe={kernelName:Hx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=Qr(r,0);return{x:()=>Xn(i,t,L(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Afe={kernelName:Rf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,re(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe={kernelName:Of,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,fe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe={kernelName:foe,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const o=Si(r);return Se(t,L(be(t,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t,e,n,r=5,s=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:i,beta:o};return j.runKernel(a2,a,l)}const Pfe=W({localResponseNormalizationBackprop_:Rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _fe={kernelName:Zx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>Pfe(r,s,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t,e,n,r){return e.rank<n.rank&&(e=B(e,Ut(e.shape,r))),t.rank<n.rank&&(t=B(t,Ut(t.shape,r))),{x:()=>L(t,fe(Ci(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD={kernelName:Jx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],o=e[1],a=Me(s,i.shape),l=sz(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mfe={kernelName:Pf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>L(t,fe(Ul(n,r),"float32")),b:()=>L(t,fe(Ug(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(t,e,n,r,s,i,o){const a=R(t,"dy","maxPool3dGrad"),l=R(e,"input","maxPool3dGrad"),c=R(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=B(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=B(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),fr("maxPool3dGrad",i,o);const p={dy:u,input:d,output:h},m={filterSize:r,strides:s,pad:i,dimRoundingMode:o},x=j.runKernel(c2,p,m);return f?B(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const Lfe=W({maxPool3dGrad_:Ffe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe={kernelName:ty,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Lfe(t,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zfe(t,e,n,r,s,i,o){const a=R(t,"dy","maxPoolGrad"),l=R(e,"input","maxPoolGrad"),c=R(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),fr("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return j.runKernel(l2,u,d)}const Bfe=W({maxPoolGrad_:zfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe={kernelName:ey,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Bfe(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ufe={kernelName:ny,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=Me(s,r.shape),a=fn(r.shape,i)[1],l=Q(a);return{x:()=>{const u=r.shape.slice();i.forEach(f=>{u[f]=1});const d=B(t,u);return we(L(d,Sa(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vfe={kernelName:ry,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,o]=e,a=Me(s,i.shape),l=sz(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe={kernelName:_f,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>L(t,fe(Bu(n,r),"float32")),b:()=>L(t,fe(Qr(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe={kernelName:sy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>ut(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe={kernelName:Mf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{const a=nn(n.shape,s);return a.length>0?B(be(t,a),n.shape):t},b:()=>{const a=L(t,Mt(Py(we(n,r)))),l=nn(r.shape,s);return l.length>0?B(be(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe={kernelName:Ff,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{const a=L(t,fe(r,"float32")),l=nn(n.shape,s);return l.length>0?B(be(a,l),n.shape):a},b:()=>{const a=L(t,fe(n,"float32")),l=nn(r.shape,s);return l.length>0?B(be(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe={kernelName:iy,gradFunc:t=>({x:()=>Mt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe={kernelName:ly,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>ln(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qfe={kernelName:ay,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe={kernelName:cy,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return $l(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD={kernelName:uy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>ut(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jfe={kernelName:Lf,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,o=r,a=Ae(i.shape,o.shape);return{a:()=>{const u=fe(o,"float32");let d=L(t,L(u,Il(i,Se(u,Xe(1)))));const h=nn(i.shape,a);return h.length>0&&(d=be(d,h)),B(d,i.shape)},b:()=>{const u=Qr(i,0),d=Xn(u,Ii(i),We(i));let h=L(t,L(s,d));const f=nn(o.shape,a);return f.length>0&&(h=be(h,f)),B(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe={kernelName:dy,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=Qr(n,0);return{x:()=>Xn(s,t,L(t,r)),alpha:()=>{let i=Xn(s,We(t),L(t,n));const o=nn(r.shape,t.shape);return o.length>0&&(i=be(i,o)),B(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t,e,n){const r=t.shape.slice();r[n]=1;const s=B(e,r),i=Nw(t,n,!0,!1),o=Nw(t,n,!0,!0),a=L(i,o);return L(s,a)}function npe(t,e,n){const r=t.shape.length,s=r-n.length,i=Et(n,r);let o=t;i!=null&&(o=Be(t,i));const a=o.shape.slice(),c=a.splice(r-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=o.reshape(a);let d=tpe(u,e,s);if(d=d.reshape(o.shape),i!=null){const h=ka(i);d=Be(d,h)}return d}const rpe={kernelName:hy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>npe(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe={kernelName:bf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{const a=we(t,fe(r,"float32")),l=nn(n.shape,s);return l.length>0?B(be(a,l),n.shape):a},b:()=>{let a=L(t,fe(n,"float32"));const l=nn(r.shape,s);l.length>0&&(a=B(be(a,l),r.shape));const c=xt(r);return Mt(we(a,fe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ipe={kernelName:jf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,Mt(xt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope={kernelName:Bf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=L(Bu(n,6),ap(n));return{x:()=>L(t,fe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape={kernelName:zf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,fe(ap(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe={kernelName:fy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe={kernelName:my,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>j.runKernel(g2,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe={kernelName:py,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>j.runKernel(m2,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe={kernelName:gy,gradFunc:(t,e,n)=>{const{dims:r}=n,s=Me(r,t.shape);return{x:()=>Nl(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe={kernelName:Wf,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe={kernelName:Uf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(we(t,L(Il(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe={kernelName:xy,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>fe(We(n),"float32"),t:()=>L(t,fe(n,t.dtype)),e:()=>L(t,fe(F2(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe={kernelName:Vf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Qr(n,Xe(0)),s=Xe(Fy),i=Xe(Ly),o=L(t,i),a=L(L(t,s),Si(fe(n,"float32")));return Xn(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe={kernelName:qf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,L(n,Se(Xe(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe={kernelName:Kf,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype={kernelName:Gf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(D2(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe={kernelName:Hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Vj(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe={kernelName:yy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,o=r.shape,[a,l]=_y(r,s,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>z2(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe={kernelName:ky,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=!0,o=L(t,r);return{logits:()=>Se(o,L(be(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe={kernelName:Xf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,zu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nD={kernelName:by,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>T2(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rD={kernelName:wy,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>ar(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe={kernelName:Yf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,L(_n(fe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spe={kernelName:x2,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,L(fe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe={kernelName:Qf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Xe(2);return{a:()=>L(t,L(s,Se(n,r))),b:()=>L(t,L(s,Se(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe={kernelName:np,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $pe={kernelName:Zf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ae(n.shape,r.shape);return{a:()=>{let a=t;const l=nn(n.shape,s);return l.length>0&&(a=be(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=nn(r.shape,s);return l.length>0&&(a=be(a,l)),B(Mt(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe={kernelName:vy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;Me(i,r.shape).forEach(c=>{s[c]=1});const a=B(t,s),l=L(a,Sa(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe={kernelName:Jf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>we(t,xt(D2(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape={kernelName:ep,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Se(Xe(1),xt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe={kernelName:tp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let o=We(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=re(o,ut(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=re(o,ut(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)o=re(o,ut(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)for(let u=0;u<s[3];++u)o=re(o,ut(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ope={kernelName:Bc,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=ka(s);return{x:()=>Be(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpe={kernelName:Cy,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>io(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe={kernelName:Sy,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_pe(t,n)}}};function _pe(t,e){const n=Ca(e,We(e)),r=P2(t,n);let s=Ul(e,Xe(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=nr(s,a+1);s=so(s,Sa(r.shape,"bool"));const o=We(r);return Xn(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mpe={kernelName:Iy,gradFunc:t=>({x:()=>We(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe=[rz,Phe,_he,Mhe,Fhe,Lhe,jhe,zhe,Bhe,Whe,Uhe,Vhe,Khe,Yhe,Qhe,Zhe,Jhe,efe,tfe,nfe,rfe,sfe,ofe,ife,cfe,ufe,dfe,hfe,ffe,pfe,spe,mfe,gfe,xfe,yfe,vfe,wfe,bfe,kfe,Cfe,Sfe,Ife,Nfe,$fe,Efe,Tfe,Afe,Dfe,Ofe,_fe,eD,eD,Mfe,jfe,Wfe,Ufe,Vfe,Gfe,Hfe,Kfe,qfe,Xfe,Yfe,Qfe,Zfe,tD,tD,Jfe,epe,rpe,ipe,ope,ape,lpe,cpe,upe,dpe,hpe,fpe,ppe,mpe,gpe,xpe,ype,vpe,bpe,wpe,kpe,nD,nD,rD,rD,Cpe,Ipe,Spe,Npe,$pe,Epe,Tpe,Ape,Dpe,Ope,Rpe,Ppe,Mpe];for(const t of Fpe)goe(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.abs=function(){return this.throwIfDisposed(),Un(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.acos=function(){return this.throwIfDisposed(),vae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.acosh=function(){return this.throwIfDisposed(),wae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.add=function(t){return this.throwIfDisposed(),re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.all=function(t,e){return this.throwIfDisposed(),zj(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.any=function(t,e){return this.throwIfDisposed(),Sw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.argMax=function(t){return this.throwIfDisposed(),Ih(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.argMin=function(t){return this.throwIfDisposed(),Nae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),B(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asType=function(t){return this.throwIfDisposed(),fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as1D=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as2D=function(t,e){return this.throwIfDisposed(),B(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),B(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),B(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),B(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asin=function(){return this.throwIfDisposed(),Eae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asinh=function(){return this.throwIfDisposed(),Aae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atan=function(){return this.throwIfDisposed(),Oae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atan2=function(t){return this.throwIfDisposed(),Pae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atanh=function(){return this.throwIfDisposed(),Mae(this)};Y().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),E2(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),T2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),Ay(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Xd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cast=function(t){return this.throwIfDisposed(),fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.ceil=function(){return this.throwIfDisposed(),cle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Kr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Xt&&(t=[t]),ar([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Bj(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),Wj(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Sl(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cos=function(){return this.throwIfDisposed(),D2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cosh=function(){return this.throwIfDisposed(),Vj(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Nw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Gj(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Ple(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),O2(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),Fle(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.divNoNan=function(t){return this.throwIfDisposed(),Wle(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.div=function(t){return this.throwIfDisposed(),we(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.dot=function(t){return this.throwIfDisposed(),Vle(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.elu=function(){return this.throwIfDisposed(),Oy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.equal=function(t){return this.throwIfDisposed(),Ci(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.erf=function(){return this.throwIfDisposed(),Hj(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),nce(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.exp=function(){return this.throwIfDisposed(),Si(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.expandDims=function(t){return this.throwIfDisposed(),nr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.expm1=function(){return this.throwIfDisposed(),oce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.fft=function(){return this.throwIfDisposed(),d4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.flatten=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.floor=function(){return this.throwIfDisposed(),Py(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.floorDiv=function(t){return this.throwIfDisposed(),jj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.gather=function(t,e,n){return this.throwIfDisposed(),P2(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ul(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.greater=function(t){return this.throwIfDisposed(),Qr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.ifft=function(){return this.throwIfDisposed(),$w(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.irfft=function(){return this.throwIfDisposed(),Que(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isFinite=function(){return this.throwIfDisposed(),mce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isInf=function(){return this.throwIfDisposed(),xce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isNaN=function(){return this.throwIfDisposed(),vce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.leakyRelu=function(t){return this.throwIfDisposed(),M2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.lessEqual=function(t){return this.throwIfDisposed(),Bu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.less=function(t){return this.throwIfDisposed(),Ug(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Sce(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSigmoid=function(){return this.throwIfDisposed(),Dce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Qj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Zj(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.log=function(){return this.throwIfDisposed(),Ii(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.log1p=function(){return this.throwIfDisposed(),Yj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalAnd=function(t){return this.throwIfDisposed(),so(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalNot=function(){return this.throwIfDisposed(),F2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalOr=function(t){return this.throwIfDisposed(),Jj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalXor=function(t){return this.throwIfDisposed(),jce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),qe(this,t,e,n)};Y().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),L2(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.max=function(t,e){return this.throwIfDisposed(),Hs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.maximum=function(t){return this.throwIfDisposed(),Ca(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mean=function(t,e){return this.throwIfDisposed(),Wt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.min=function(t,e){return this.throwIfDisposed(),Wg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.minimum=function(t){return this.throwIfDisposed(),Eh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Kce(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mod=function(t){return this.throwIfDisposed(),Xce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mul=function(t){return this.throwIfDisposed(),L(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.neg=function(){return this.throwIfDisposed(),Mt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Ry(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.notEqual=function(t){return this.throwIfDisposed(),Vg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),e4(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.onesLike=function(){return this.throwIfDisposed(),Cs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.pad=function(t,e){return this.throwIfDisposed(),z2(this,t,e)};Y().prototype.pool=function(t,e,n,r,s,i){return this.throwIfDisposed(),iue(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.pow=function(t){return this.throwIfDisposed(),Il(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.prelu=function(t){return this.throwIfDisposed(),W2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.prod=function(t,e){return this.throwIfDisposed(),lue(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reciprocal=function(){return this.throwIfDisposed(),Due(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.relu=function(){return this.throwIfDisposed(),Gl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.relu6=function(){return this.throwIfDisposed(),r4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reshapeAs=function(t){return this.throwIfDisposed(),B(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reshape=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),g4(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),x4(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reverse=function(t){return this.throwIfDisposed(),Nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.rfft=function(){return this.throwIfDisposed(),ede(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.round=function(){return this.throwIfDisposed(),s4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.rsqrt=function(){return this.throwIfDisposed(),i4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.selu=function(){return this.throwIfDisposed(),o4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),a4(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sigmoid=function(){return this.throwIfDisposed(),zu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sign=function(){return this.throwIfDisposed(),zue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sin=function(){return this.throwIfDisposed(),l4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sinh=function(){return this.throwIfDisposed(),c4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.slice=function(t,e){return this.throwIfDisposed(),ut(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.softmax=function(t){return this.throwIfDisposed(),Z2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.softplus=function(){return this.throwIfDisposed(),sp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),B2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.split=function(t,e){return this.throwIfDisposed(),Wr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sqrt=function(){return this.throwIfDisposed(),_n(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.square=function(){return this.throwIfDisposed(),xt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.squaredDifference=function(t){return this.throwIfDisposed(),nde(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.squeeze=function(t){return this.throwIfDisposed(),op(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Xt?[this,t]:[this,...t];return io(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.step=function(t){return this.throwIfDisposed(),ap(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.stridedSlice=function(t,e,n,r,s,i,o,a){return this.throwIfDisposed(),ade(this,t,e,n,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sub=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sum=function(t,e){return this.throwIfDisposed(),be(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tan=function(){return this.throwIfDisposed(),cde(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tanh=function(){return this.throwIfDisposed(),Ty(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tile=function(t){return this.throwIfDisposed(),Ws(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toBool=function(){return this.throwIfDisposed(),fe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toFloat=function(){return this.throwIfDisposed(),fe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toInt=function(){return this.throwIfDisposed(),fe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.topk=function(t,e){return this.throwIfDisposed(),hde(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.transpose=function(t){return this.throwIfDisposed(),Be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unique=function(t){return this.throwIfDisposed(),mde(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),p4(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unstack=function(t){return this.throwIfDisposed(),$l(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.where=function(t,e){return this.throwIfDisposed(),Xn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.zerosLike=function(){return this.throwIfDisposed(),We(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ai extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ai.prototype)}}class ps extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ps.prototype)}}class M extends Error{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype)}}class Re extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Re.prototype)}}class PI extends Error{constructor(e){super(e),Object.setPrototypeOf(this,PI.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iz{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function El(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function li(t,e){if(!t)throw new PI(e)}function sD(t,e){let n=0;for(const r of t)r===e&&n++;return n}function rr(t){return t.length===1?t[0]:t}function Je(t){return Array.isArray(t)?t:[t]}function _i(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function za(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ts={};function _I(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Aw(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Aw(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:Aw(r))}}}function dp(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in ts)o=ts[i];else if(o=e[i],o==null)throw new M(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new M(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in ts?[a,l]=ts.className:o in e&&([a,l]=e[o]),a==null)throw new M(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(ts))c[f]=ts[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const d=Object.assign({},ts);for(const f of Object.keys(n))ts[f]=n[f];Aw(i.config);const h=l(a,i.config,n,s);return ts=Object.assign({},d),h}else{const c=Object.assign({},ts);for(const d of Object.keys(n))ts[d]=n[d];const u=new a(i.config);return ts=Object.assign({},c),u}}}function Lpe(t,e){return t<e?-1:t>e?1:0}function tm(t,e){return-1*Lpe(t,e)}function Yo(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function jpe(t){if(t==null)throw new M(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Kl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new M(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function MI(t,e,n=0,r=1/0){return li(n>=0),li(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function un(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>un(n,`element ${r+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${oz(t)}.`)}function oz(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>oz(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function zpe(t,e,n){let r=n!=null?n():tr(),s;return(...o)=>{const a=n!=null?n():tr();return a-r<e||(r=a,s=t(...o)),s}}function az(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Bpe=0;function lz(){return Bpe++}const nm={};function jy(t=""){return t in nm||(nm[t]=0),nm[t]+=1,t+nm[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Wpe=["channelsFirst","channelsLast"],Upe=["nearest","bilinear"],Vpe=["valid","same","causal"],Gpe=["max","avg"],Hpe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const oc=new Map;function jt(t){Kl(Wpe,"DataFormat",t)}function Kpe(t){Kl(Upe,"InterpolationFormat",t)}function Zr(t){Kl(Vpe,"PaddingMode",t)}function cz(t){Kl(Gpe,"PoolMode",t)}const Yd=[],iD="/";function ol(t,e){Yd.push(t);try{const n=e();return Yd.pop(),n}catch(n){throw Yd.pop(),n}}function qpe(){return Yd.length===0?"":Yd.join(iD)+iD}function uz(t){if(!hz(t))throw new Error("Not a valid tensor name: '"+t+"'");return qpe()+t}function dz(t){if(!hz(t))throw new Error("Not a valid tensor name: '"+t+"'");oc.has(t)||oc.set(t,0);const e=oc.get(t);if(oc.set(t,oc.get(t)+1),e>0){const n=`${t}_${e}`;return oc.set(n,1),n}else return t}const Xpe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function hz(t){return!!t.match(Xpe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ype(t){return t===parseInt(t.toString(),10)}function Qo(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function yu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function ia(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Ys(t,e){if(e<t)throw new M(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ob;function Qt(){return ob==null&&(ob=Uoe().epsilon()),ob}function Qs(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vi(t,e){return fe(t,e)}function hp(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),B(t,n)}function Qpe(t,e){return G(()=>{if(t.shape.length!==2)throw new M(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=hp(t,1);return Dw(n,[1,e,1])})}function Zpe(t){const e=[Qo(t.shape)];return B(t,e)}function Jpe(t){if(t.rank<=1)throw new M(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Qo(t.shape,1)];return B(t,e)}function al(t,e,n){return G(()=>{switch(t.rank){case 1:return Y2(t,e,n);case 2:return u4(t,[e,0],[n,t.shape[1]]);case 3:return Q2(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Hg(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ut(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ut(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new M(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function ab(t,e,n){return G(()=>{switch(t.rank){case 1:return Y2(t,e,n);case 2:return u4(t,[0,e],[t.shape[0],n]);case 3:return Q2(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Hg(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new M(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function rm(t,e,n,r){return G(()=>{switch(t.rank){case 1:return Y2(t,e,n);case 2:switch(r){case 1:return al(t,e,n);case 2:return ab(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return al(t,e,n);case 2:return Q2(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return ab(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return al(t,e,n);case 2:return Hg(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Hg(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return ab(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}default:throw new M(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function FI(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),ar(t,e)}function oD(t,e){switch(t.rank){case 1:return hle([t,e]);case 2:return ple([t,e],0);case 3:return gle([t,e],0);case 4:return yle([t,e],0);default:throw new M(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Dw(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new M(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ws(t,e)}function zy(t,e=0,n=1,r,s){return $ue(t,e,n,r,s)}function bi(t,e,n,r){if(t.rank<2||e.rank<2)throw new Re(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new Re(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return HA({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?Ow(t.rank,r,Qs()):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=B(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=B(Be(e,u),[l,-1]);const d=[...s,...c];return B(HA({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?Ow(t.rank,r,Qs()):null,activation:n}),d)}}function fz(t,e,n){return G(()=>(Array.isArray(e)?e=wr(e,"int32"):e=fe(e,"int32"),P2(t,e,n)))}function fp(t){return L(t,t)}function Ow(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new M(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1,1,1]):B(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,1,1,r[0]]):B(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1,1]):B(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,1,r[0]]):B(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1]):B(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,r[0]]):B(e,[1].concat(r))}else if(t<3)return e;throw new M(`Unsupported input rank by biasAdd: ${e.rank}`)}function ni(t,e,n){return G(()=>(n==null&&(n=Qs()),jt(n),re(t,Ow(t.rank,e,n))))}function eme(t,e=1){if(e!==1)throw new Re(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Oy(t)}function tme(t){return G(()=>we(t,re(Un(t),1)))}function pz(t,e,n,r){return G(()=>kde(t,e,n,r))}function nme(t){return G(()=>{const e=re(.5,L(.2,t));return Kr(e,0,1)})}function pp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const rme=["fanIn","fanOut","fanAvg"],sme=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ime(t){Kl(rme,"FanMode",t)}function ome(t){Kl(sme,"Distribution",t)}class Es extends Uu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class mz extends Es{apply(e,n){return ln(e,n)}}mz.className="Zeros";ne(mz);class LI extends Es{apply(e,n){return Sa(e,n)}}LI.className="Ones";ne(LI);class gz extends Es{constructor(e){if(super(),typeof e!="object")throw new M(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new M(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return G(()=>L(Xe(this.value),Sa(e,n)))}getConfig(){return{value:this.value}}}gz.className="Constant";ne(gz);class xz extends Es{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return ip(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}xz.className="RandomUniform";ne(xz);class yz extends Es{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Re(`randomNormal does not support dType ${n}.`);return zy(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}yz.className="RandomNormal";ne(yz);class vz extends Es{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Re(`truncatedNormal does not support dType ${n}.`);return f4(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}vz.className="TruncatedNormal";ne(vz);class bz extends Es{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return G(()=>{if(e.length!==2||e[0]!==e[1])throw new M("Identity matrix initializer can only be used for 2D square matrices.");return L(this.gain,Xj(e[0]))})}getConfig(){return{gain:this.gain}}}bz.className="Identity";ne(bz);function ame(t,e="channelsLast"){let n,r;if(jt(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=Qo(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=Qo(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=Qo(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class Nr extends Es{constructor(e){if(super(),e.scale<0)throw new M(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,ime(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,ome(this.distribution),this.seed=e.seed}apply(e,n){const r=ame(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Re(`${this.getClassName()} does not support dType ${n}.`);return f4(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return ip(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Nr.className="VarianceScaling";ne(Nr);class jI extends Nr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}jI.className="GlorotUniform";ne(jI);class zI extends Nr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}zI.className="GlorotNormal";ne(zI);class BI extends Nr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}BI.className="HeNormal";ne(BI);class WI extends Nr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}WI.className="HeUniform";ne(WI);class UI extends Nr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}UI.className="LeCunNormal";ne(UI);class VI extends Nr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Nr.className}}VI.className="LeCunUniform";ne(VI);class wz extends Es{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return G(()=>{if(e.length<2)throw new Re("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=Q(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=zy(o,0,1,n,this.seed),l=yhe.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return c=L(c,d.sign()),r<s&&(c=c.transpose()),L(Xe(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}wz.className="Orthogonal";ne(wz);const aD={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function lD(t,e={}){return dp(t,ls.getMap().classNameMap,e,"initializer")}function $t(t){return _I(t)}function Ct(t){if(typeof t=="string"){const e=t in aD?aD[t]:t;if(e==="GlorotNormal")return new zI;if(e==="GlorotUniform")return new jI;if(e==="HeNormal")return new BI;if(e==="HeUniform")return new WI;if(e==="LeCunNormal")return new UI;if(e==="LeCunUniform")return new VI;{const n={};return n.className=e,n.config={},lD(n)}}else return t instanceof Es?t:lD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rw(t){return Array.isArray(t)&&Array.isArray(t[0])}function Kg(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function $e(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new M(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ve(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new M(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qg(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cD="Variable";class lme{constructor(e,n="float32",r=cD,s=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=lz(),r=r??cD,this.originalName=uz(r),this.name=dz(this.originalName),this.trainable_=s,this.constraint=i,this.val=yde(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),cme(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function cme(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Pw(t){return t.map(e=>e.read())}function GI(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ni{constructor(e,n,r,s,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=lz(),o!=null&&(this.originalName=uz(o),this.name=dz(this.originalName)),this.rank=n.length}}let ume=0;class By{constructor(e,n){this.callArgs=n,this.id=ume++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let dme=0;class Fe extends Uu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=dme++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=_i(r)+"_"+jy(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new ps(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new M(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return rr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return rr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ai(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ai(`Layer ${this.name} is not connected, no input to return.`);return rr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ai(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ai(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return rr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Je(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=Je(this.inputSpec);if(n.length!==r.length)throw new M(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new M(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=Je(e),s=pme(e),i=mme(e);if(s===i)throw new M("Arguments to apply() must be all SymbolicTensors or all Tensors");return ol(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Je(e))o.push(a.shape);this.build(rr(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=Je(o),l=[];for(let c of a)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=rr(l),this.activityRegularizer!=null)throw new Re("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=hme(e),a=this.computeOutputShape(o);let l;const c=fme(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new Ni(c,u,this,Je(e),n,this.name,d)):l=new Ni(c,a,this,Je(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Re("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ai(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ai(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ps(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return qg(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Pw(e?this.trainableWeights:this.weights)}setWeights(e){G(()=>{const n=this.weights;if(n.length!==e.length)throw new M(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=Pw(n);for(let i=0;i<s.length;++i){const o=s[i],a=n[i],l=e[i];if(!Qe(o.shape,l.shape))throw new M(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}GI(r)})}addWeight(e,n,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new M(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():Ct("zeros"));const c=s.apply(n,r),u=new lme(c,r,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Je(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=Je(n),o=Je(s);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,r,s,i,o,a=null){const l=Je(e);n=Je(n),r=Je(r),s=Je(s),i=Kg(i),o=Kg(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new By({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function hme(t){t=Je(t);const e=[];for(const n of t)e.push(n.shape);return rr(e)}function fme(t){return"float32"}function kz(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],c=kz(o,a,l);for(const u of c)s.indexOf(u)===-1&&s.push(u)}return s}}}function pme(t){let e=!0;for(const n of Je(t))if(!(n instanceof Ni)){e=!1;break}return e}function mme(t){let e=!0;for(const n of Je(t))if(n instanceof Ni){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mp extends Fe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:jy("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new M("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new M("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new M("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new Ni(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new By({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new M(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}mp.className="InputLayer";ne(mp);function gme(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new M("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new mp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xme(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return fe(e,t.dtype)}catch{throw new M(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Mo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Mo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=xme(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new M(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ni){if(this.id2Value[e.id]==null)throw new M(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new M(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Ni){if(this.id2Value[e.id]==null)throw new M(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new M(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Le(this.id2Mask)}}const Xg=new iz,Yg=new iz;function yme(t){Xg!=null&&Xg.setMaxEntries(t),Yg!=null&&Yg.setMaxEntries(t)}function Dd(t,e,n,r){const s=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Xg.get(u),h;if(d==null){const p=vme(o,e);d=p.sorted,h=p.recipientCounts,Xg.put(u,d),Yg.put(u,h)}h={},s||Object.assign(h,Yg.get(u));const f=new Mo(e);for(let p=0;p<d.length;++p){const m=d[p],x=m.sourceLayer;if(x instanceof mp)continue;const g=[],y=[],b=[];let w=!1;for(const $ of m.inputs){const E=f.getValue($),A=f.getMask($);g.push(E),y.push(A),A!=null&&(w=!0),s||(h[$.name]--,h[$.name]===0&&!e.hasKey($)&&a.indexOf($.name)===-1&&!E.isDisposed&&$.sourceLayer.stateful!==!0&&b.push(E))}w&&(n=n||{},n.mask=y[0]);const k=Je(x.apply(g,n));let C=null;x.supportsMasking&&(C=x.computeMask(g,y));const S=wme(m),I=Array.isArray(S)?S:[S];for(let $=0;$<I.length;++$){f.hasKey(I[$])||f.add(I[$],k[$],Array.isArray(C)?C[0]:C);const E=a.indexOf(I[$].name);E!==-1&&(l[E]=k[$])}s||Le(b)}return f.disposeMasks(),i?l:l[0]}function vme(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=uD(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of t){const{sorted:o,recipientMap:a}=uD(i,e);for(const l of o)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:bme(r)}}function bme(t){const e={};for(const n in t)e[n]=t[n].size;return e}function uD(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)s[c.name]==null&&(s[c.name]=new Set),s[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:r,recipientMap:s}}function wme(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme=H();kme.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,yme);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HI(t,e){return G(()=>_n(be(L(t,t),e,!0)))}class gp extends Uu{getConfig(){return{}}}class Cz extends gp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{const n=HI(e,this.axis),r=Kr(n,0,this.maxValue);return L(e,we(r,re(Qt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Cz.className="MaxNorm";ne(Cz);class Sz extends gp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>we(e,re(Qt(),HI(e,this.axis))))}getConfig(){return{axis:this.axis}}}Sz.className="UnitNorm";ne(Sz);class Iz extends gp{apply(e){return Gl(e)}}Iz.className="NonNeg";ne(Iz);class Nz extends gp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{const n=HI(e,this.axis),r=re(L(this.rate,Kr(n,this.minValue,this.maxValue)),L(1-this.rate,n));return L(e,we(r,re(Qt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Nz.className="MinMaxNorm";ne(Nz);const dD={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function en(t){return _I(t)}function hD(t,e={}){return dp(t,ls.getMap().classNameMap,e,"constraint")}function tn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in dD?dD[t]:t,config:{}};return hD(n)}else return t instanceof gp?t:hD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Aa(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)t[n[i]]=s[i][0];Le(r)}}function $z(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var fD;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(fD||(fD={}));const Cme=125;class Ah{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Sme{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Ime extends Ah{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const i=n[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=G(()=>re(this.totals[s],L(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:G(()=>{const s=L(we(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),xi(n[r])}))}}class Nme extends Ah{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=s[i][0]}}class $me extends Ah{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||O4,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Cme),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");cw(this.yieldEvery)&&(this.maybeWait=zpe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await Aa(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Aa(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await Aa(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Aa(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await Aa(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):cw(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await Aa(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Aa(e),await this.trainEnd(e))}}function Ez(t,e){return t==null&&(t={}),t instanceof Ah?[t]:Array.isArray(t)&&t[0]instanceof Ah?t:Je(t).map(r=>new $me(r,e))}class ss{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ss.checkForDuplicate(n),ss.constructors[e]==null&&(ss.constructors[e]=[]),ss.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ss.constructors)ss.constructors[+n].forEach(s=>{if(s===e)throw new M("Duplicate callback constructor.")})}static clear(){ss.constructors={}}static createCallbacks(e){const n=[];for(const r in ss.constructors){const s=+r;e>=s&&n.push(...ss.constructors[s])}return n.map(r=>new r)}}ss.constructors={};function Tz(t,e,n,r,s,i,o,a,l){const c=new Nme,u=[new Ime,...ss.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new Sme(u);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qi(t,e={},n=!1){return dp(t,ls.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qg(t,e){return G(()=>{t.dtype!=="float32"&&(t=fe(t,"float32"));const n=be(fp(t),e,!0),r=Dy(n.shape,Qt()),s=_n(Ca(n,r));return we(t,s)})}function Wy(t,e){return G(()=>Wt(fp(Se(e,t)),-1))}function KI(t,e){return G(()=>Wt(Un(Se(e,t)),-1))}function qI(t,e){return G(()=>{const n=Se(t,e),r=Kr(Un(t),Qt(),Number.MAX_VALUE),s=Un(we(n,r));return L(100,Wt(s,-1))})}function Eme(t,e){return G(()=>{const n=Kr(e,Qt(),Number.MAX_VALUE),r=Ii(re(1,n)),s=Kr(t,Qt(),Number.MAX_VALUE),i=Ii(re(1,s));return Wt(fp(Se(r,i)),-1)})}function Tme(t,e){return G(()=>{const n=Ca(0,Se(1,L(t,e)));return Wt(fp(n),-1)})}function Ame(t,e){return G(()=>{const n=Ca(0,Se(1,L(t,e)));return Wt(n,-1)})}function Dme(t,e){return G(()=>{const n=be(L(t,e),-1),r=Hs(L(Se(1,t),e),-1);return Ca(0,re(1,Se(r,n)))})}function Ome(t,e){return G(()=>{const n=Math.log(2),r=Se(e,t),s=Se(re(r,sp(L(-2,r))),n);return Wt(s,-1)})}function Dh(t,e,n=!1){return G(()=>{if(n)e=Z2(e);else{const r=be(e,e.shape.length-1,!0);e=we(e,r)}return e=Kr(e,Qt(),1-Qt()),Mt(be(L(fe(t,"float32"),Ii(e)),e.shape.length-1))})}function Zg(t,e,n=!1){return G(()=>{const r=fe(Py(Zpe(t)),"int32");e=Kr(e,Qt(),1-Qt());const s=e.shape,i=B(e4(r,s[s.length-1]),s);return Dh(i,e,n)})}function Rme(t,e){if(!Qe(t.shape,e.shape))throw new M(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return G(()=>{const n=Gl(e),r=Mt(Un(e));return re(Se(n,L(e,t)),Yj(Si(r)))})}function Uy(t,e){return G(()=>{let n;return n=Kr(e,Qt(),1-Qt()),n=Ii(we(n,Se(1,n))),Wt(Rme(t,n),-1)})}function Pme(t,e){return G(()=>{const n=Kr(t,Qt(),1),r=Kr(e,Qt(),1);return be(L(t,Ii(we(n,r))),-1)})}function _me(t,e){return G(()=>{const n=Ii(re(Qt(),e));return Wt(Se(e,L(t,n)),-1)})}function Az(t,e){return G(()=>{const n=Qg(t,-1),r=Qg(e,-1),s=L(n,r);return Mt(be(s,-1))})}const Jg={meanSquaredError:Wy,meanAbsoluteError:KI,meanAbsolutePercentageError:qI,meanSquaredLogarithmicError:Eme,squaredHinge:Tme,hinge:Ame,categoricalHinge:Dme,logcosh:Ome,categoricalCrossentropy:Dh,sparseCategoricalCrossentropy:Zg,binaryCrossentropy:Uy,kullbackLeiblerDivergence:Pme,poisson:_me,cosineProximity:Az};function lb(t){if(typeof t=="string"){if(t in Jg)return Jg[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new M(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dz(t,e){return G(()=>{const n=L(.5,Cs(e)),r=vi(Qr(e,n),t.dtype);return Wt(Ci(t,r),-1)})}function Oz(t,e){return G(()=>vi(Ci(Ih(t,-1),Ih(e,-1)),"float32"))}function Mme(t,e){return G(()=>fe(be(so(Ci(t,1),Ci(e,1))),"float32"))}function Fme(t,e){return G(()=>fe(be(so(Ci(t,0),Ci(e,1))),"float32"))}function Lme(t,e){return G(()=>{const n=Mme(t,e),r=Fme(t,e),s=re(n,r);return fe(Xn(Qr(s,0),we(n,s),0),"float32")})}function jme(t,e){return Uy(t,e)}function zme(t,e){return t.rank===e.rank&&(t=op(t,[t.rank-1])),e=Ih(e,-1),e.dtype!==t.dtype&&(e=fe(e,t.dtype)),fe(Ci(t,e),"float32")}const Bme=Wy,Wme=Wy,Ume=KI,Vme=KI,Gme=qI,Hme=qI,Rz=Dh,Kme=Az,Pz=Zg,e0={binaryAccuracy:Dz,categoricalAccuracy:Oz,precision:Lme,categoricalCrossentropy:Rz,sparseCategoricalCrossentropy:Pz,mse:Bme,MSE:Wme,mae:Ume,MAE:Vme,mape:Gme,MAPE:Hme,cosine:Kme};function qme(t){if(typeof t=="string"&&t in e0)return e0[t];if(typeof t!="string"&&t!=null)return t;throw new M(`Unknown metric ${t}`)}function sm(t){if(li(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Jg))if(Jg[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(e0))if(e0[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xme(t){const e={Adagrad:()=>ic.adagrad(.01),Adadelta:()=>ic.adadelta(1,.95,Qt()),Adam:()=>ic.adam(.001,.9,.999,Qt()),Adamax:()=>ic.adamax(.002,.9,.999,Qt(),0),RMSProp:()=>ic.rmsprop(.001,.9,0,Qt()),SGD:()=>ic.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new M(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const pD=1*1024*1024;function mD(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!_w(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>pD&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${pD}.`)}}function _w(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!_w(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!_w(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yme(t,e,n,r=console.log){const s=Zme(t),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!s){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}r("_".repeat(e)),t0(i,n,r),r("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)s?Jme(a[u],n,r):ege(a[u],n,o,r),r((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Qme(t),c=qg(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(e))}function Qme(t){let e;return t.collectedTrainableWeights!=null?e=qg(t.collectedTrainableWeights):e=qg(t.trainableWeights),e}function Zme(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function t0(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function Jme(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,s,r,t.countParams().toString()];t0(a,e,n)}function ege(t,e,n,r){let s,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,s,t.countParams().toString(),c];t0(u,e,r);for(let d=1;d<o.length;++d)t0(["","","","",o[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _z(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Mw(t,e){if(t===null)return null;if(typeof t=="string")return za(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];_z(e,s,i)?n.push(i):n.push(Mw(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const i=za(r);n[i]=Mw(s,i)}}return n}}function Fw(t,e){if(t==null)return null;if(typeof t=="string")return _i(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];_z(e,s,i)?n.push(i):n.push(Fw(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],i=_i(r);(r==="name"||r==="className")&&typeof s=="string"?n[i]=s:n[i]=Fw(s,r)}return n}}/** @license See the LICENSE file. */const Mz="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tge=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Rs extends Fe{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=jy(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Yo(this.inputs).length!==this.inputs.length)throw new M(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);Yo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,w=y.nodeIndex,k=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(k)}for(const y of this.inputs){const b=y.sourceLayer,w=y.nodeIndex,k=y.tensorIndex;li(w===0,"input layer has >1 nodes"),li(k===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof mp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},r={},s={},i={},o={},a=[],l=(y,b,w,k,C,S)=>{(k==null||C==null||S==null)&&(k=y.sourceLayer,C=y.nodeIndex,S=y.tensorIndex);const I=k.inboundNodes[C];if(w.indexOf(I)!==-1)throw new ps(`The tensor ${y.name} at layer "${k.name}" is part of a cycle.`);if(b.indexOf(I)!==-1)return;this.containerNodes.add(Rs.nodeKey(k,C)),k.id in o||(o[k.id]=Object.keys(o).length),w.indexOf(I)===-1&&w.push(I);const $=I.inboundLayers.length;for(let E=0;E<$;E++){const A=I.inputTensors[E],D=I.inboundLayers[E],P=I.nodeIndices[E],O=I.tensorIndices[E];l(A,b,w,D,P,O)}for(b.push(I);w.indexOf(I)>=0;)w.splice(w.indexOf(I),1);a.push(I)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const d=a.slice().reverse();for(const y of d){r[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const w=s[y.outboundLayer.id]==null?0:s[y.outboundLayer.id];b=Math.max(b,w),s[y.outboundLayer.id]=b,i[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let k=0;k<y.inboundLayers.length;k++){const C=y.inboundLayers[k],S=y.nodeIndices[k],I=C.inboundNodes[S],$=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(b+1,$),r[I.id]=I}}const h={};for(const y in n){const b=n[y];b in h||(h[b]=[]),h[b].push(r[y])}const f={};for(const y in s){const b=s[y];b in f||(f[b]=[]),f[b].push(i[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(tm);this.layers=[];for(const y of p){const b=f[y];b.sort((w,k)=>{const C=o[w.id],S=o[k.id];return C<S?-1:C>S?1:0});for(const w of b)w instanceof Rs&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,p=Object.keys(h).map(y=>parseInt(y,10)).sort(tm);const m=this.inputs.slice(),x=[];for(const y of p)for(const b of h[y]){const w=b.outboundLayer;if(w!=null){for(const k of b.inputTensors)if(m.indexOf(k)===-1)throw new ps(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${w.name}". The following previous layers were accessed without issue: ${x}`);for(const k of b.outputTensors)m.push(k);x.push(w.name)}}this.nodesByDepth=h;const g=this.layers.map(y=>y.name);for(const y of g){const b=g.filter(w=>w===y).length;if(b!==1)throw new ps(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new By({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new M("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const i=tge(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new M(`Duplicate weight name: ${u}`);r[u]=c,s++}const o=[];for(const a in e){let l=a;if(r[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)o.push([r[l],e[a]]);else if(n)throw new M(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new M(`${a.length} of ${s} weights are not set: ${a}`)}GI(o)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${Mz}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=Fw(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return G(()=>{e=Je(e);const r=new Mo;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return Dd(this.outputs,r,n)})}computeMask(e,n){return G(()=>{e=Je(e);let r;return n==null?r=El(null,e.length):r=Je(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=Kg(e);if(n.length!==this.inputLayers.length)throw new M(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";r[u]=c}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(tm);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const x=c.inboundLayers[m],g=c.nodeIndices[m],y=c.tensorIndices[m],b=`${x.name}_${g}_${y}`,w=r[b];d.push(w)}const h=u.computeOutputShape(rr(d)),f=Kg(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const x=`${u.name}_${p}_${m}`;r[x]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];li(l in r),i.push(r[l])}return rr(i)}runInternalGraph(e,n){n==null&&(n=El(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];r[c.id]=[u,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(tm);for(const l of s){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in r&&p.push(r[m.id]);if(p.length===h.length){let m={},x,g,y,b;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[w,k]=p[0];m.mask==null&&(m.mask=k),y=Je(d.call(w,m)),b=Je(d.computeMask(w,k)),x=[w],g=[k]}else x=p.map(w=>w[0]),g=p.map(w=>w[1]),m.mask==null&&(m.mask=g),y=Je(d.call(x,m)),b=Je(d.computeMask(x,g));if(d.activityRegularizer)throw new Re("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){const k=f[w],C=y[w],S=b[w];r[k.id]=[C,S]}}}}const i=[],o=[],a=[];for(const l of this.outputs){li(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=r[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof Rs?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=Rs.nodeKey(s,i);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new M("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new M(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new M(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return G(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=Rs.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=Rs.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let x=0;x<h.inboundLayers.length;x++){const g=h.inboundLayers[x],y=h.nodeIndices[x],b=h.tensorIndices[x],w=Rs.nodeKey(g,y);let k=n[w];k==null&&(k=0),m.push([g.name,k,b,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,r.push(u)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Rs.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];s.push([a.name,u,d])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Rs.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,r={},s=!1){const i={},o={};function a(x,g){x.name in o?o[x.name].push(g):o[x.name]=[g]}function l(x,g){const y=[];let b;for(const w of g){const k=w[0],C=w[1],S=w[2];if(b=w[3]==null?{}:w[3],!(k in i)){a(x,g);return}const I=i[k];if(I.inboundNodes.length<=C){a(x,g);return}const $=I.inboundNodes[C];y.push($.outputTensors[S])}y.length>0&&x.apply(rr(y),b)}function c(x){const g=x.name,y=qi(x,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(s),i[g]=y,x.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new M(`Corrupted configuration, expected array for nodeData: ${w}`);a(y,w)})}const u=n.name,d=n.layers;for(const x of d)c(x);for(;!jpe(o);)for(const x of d){const g=i[x.name];if(g.name in o){const y=o[g.name];delete o[g.name];for(const b of y)l(g,b)}}const h=[],f=[],p=n.inputLayers;for(const x of p){const g=x[0],y=x[1],b=x[2];li(g in i);const k=i[g].inboundNodes[y].outputTensors;h.push(k[b])}const m=n.outputLayers;for(const x of m){const g=x[0],y=x[1],b=x[2];li(g in i);const k=i[g].inboundNodes[y].outputTensors;f.push(k[b])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new M("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nge(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(i=>{i in t?s.push(t[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function Fz(t,e){return nge(t,e,"classWeight")}async function Lz(t,e,n,r){if(n!=null){const s=G(()=>{if(t.shape.length===1)return il(t);if(t.shape.length===2){if(t.shape[1]>1)return Ih(t,1);if(t.shape[1]===1)return B(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Le(s);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),wr(o,"float32")}else return null}function rge(t,e){return L(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const sge=32;function jz(t,e){let n,r;const s=e;n=s.xs,r=s.ys,T(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=gD("input",t.inputNames,n),o=gD("output",t.outputNames,r),a=i[0].shape[0];T(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function gD(t,e,n){if(n instanceof Xt)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new M(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function ige(t){if(t.length===3)throw new Re("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function oge(t,e,n){const r=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let i,o;if(s)if(xD(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=ige(n.validationData);i=x.xs,o=x.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;s?c=l.slice().concat(l.map(x=>"val_"+x)):c=l.slice();const u=Ez(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=Tz(u,d,n.epochs,null,null,age(e,n),null,s,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const x={};await h.onEpochBegin(p);let g=0,y=0;for(r||(m=await e.iterator());!r||g<n.batchesPerEpoch;){const b=await m.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:w,ys:k}=jz(t,b.value),C={};C.batch=y,C.size=w[0].shape[0],await h.onBatchBegin(y,C);const S=[];if(n.classWeight!=null){const E=Fz(n.classWeight,t.outputNames);for(let A=0;A<E.length;++A)S.push(await Lz(k[A],null,E[A]))}const I=w.concat(k).concat(S),$=a(I);Le(I);for(let E=0;E<l.length;++E){const A=l[E],D=$[E];C[A]=D,xi(D)}await h.onBatchEnd(y,C),$z(C),y++,g++}if(r?g>=n.batchesPerEpoch:b.done){if(s){let w;xD(n.validationData)?w=Je(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):w=Je(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?sge:n.validationBatchSize,verbose:0}));for(let k=0;k<t.metricsNames.length;++k)x[`val_${t.metricsNames[k]}`]=w[k]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,x),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function age(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function xD(t){return typeof t.iterator=="function"}function lge(t){return typeof t.next=="function"}async function cge(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let i=[];if(n.verbose>0)throw new Re("Verbose mode is not implemented yet.");T(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=lge(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const c=await o.next();if(i=G(()=>{if(c.value){const{xs:u,ys:d}=jz(t,c.value),h=u.concat(d),f=G(()=>s(h));if(Le(h),l===0)for(let m=0;m<f.length;++m)i.push(Xe(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const x=f[m],g=i[m];i[m]=G(()=>re(i[m],L(p,x))),l>0&&Le(g)}Le(f),a+=p,++l}return i}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=we(i[c],a),Le(u)}return rr(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cb(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function bd(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>al(r,e,n-e)):al(t,e,n-e)}function Lw(t,e){return G(()=>t==null?null:Array.isArray(t)?t.map(n=>Lw(n,e)):fz(t,e.dtype==="int32"?e:fe(e,"int32")))}function ub(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function zz(t){const e=[];t instanceof Xt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(hp(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Os(t,e){if(t==null)return;const n=[];if(e instanceof Xt)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const i=e[s];n.push(i.id)}const r=[];if(t instanceof Xt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const i=t[s];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uge(t){return t instanceof Xt}function jw(t){return Array.isArray(t)}function yD(t){return!uge(t)&&!jw(t)}function vD(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(jw(t)&&t.length>0)o=!0;else if(yD(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new M(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(yD(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new M(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(jw(t)){if(t=t,t.length!==e.length)throw new M(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new M(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=zz(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new M(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new M(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function dge(t,e,n){const r=Yo(t.map(i=>i.shape[0]));r.sort();const s=Yo(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new M(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>1)throw new M(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!Qe(r,s))throw new M(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function hge(t,e,n){const r=[Wy,Uy,Dh];for(let s=0;s<t.length;++s){const i=t[s],o=e[s],a=n[s];if(o!=null){if(o===Dh&&i.shape[i.shape.length-1]===1)throw new M(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new M(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function bD(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new M(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new M(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new M(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new M(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function fge(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let i=n.hasOwnProperty(s)?n[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const pge="layers-model";class Uc extends Rs{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new M("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Yme(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Xme(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Ia))throw new M("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new M(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(lb(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new M(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>lb(a))}else{const o=lb(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ol("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=fge(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};ol("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const x=this.internalOutputShapes[o];x[x.length-1]===1||this.lossFunctions[o]===Uy?["accuracy","acc"].indexOf(p)!==-1?h=Dz:["crossentropy","ce"].indexOf(p)!==-1&&(h=jme):this.lossFunctions[o]===Zg?["accuracy","acc"].indexOf(p)!==-1?h=zme:["crossentropy","ce"].indexOf(p)!==-1&&(h=Pz):["accuracy","acc"].indexOf(p)!==-1?h=Oz:["crossentropy","ce"].indexOf(p)!==-1&&(h=Rz);let g;["accuracy","acc"].indexOf(p)!==-1?g="acc":["crossentropy","ce"].indexOf(p)!==-1&&(g="ce"),f=h,d=u+g}else f=qme(p),d=u+sm(p);let m;ol(d,()=>{m=f}),i(o,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;cb(s);const o=this.standardizeUserDataXY(e,n,!0,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,s,r.verbose,r.steps);return rr(c)}finally{Os(o[0],e),Os(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),cge(this,e,n)}checkNumSamples(e,n,r,s="steps"){let i;if(r!=null){if(i=null,n!=null)throw new M(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new M(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new M("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],i=this.retrieveSymbolicTensors(s),o=new Mo;if(e instanceof Xt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new M(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new M(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Dd(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const n=El(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((i,o)=>{i==null&&s.push(e[o])}),new M(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return G(()=>{const s=this.checkNumSamples(e);if(r)throw new Re("Verbose predictLoop() is not implemented yet.");const i=ub(s,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)G(()=>{const c=i[a][0],u=i[a][1],d=bd(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new Mo(h);return Dd(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return rr(o.map(a=>ar(a,0)))})}predict(e,n={}){const r=zz(e);bD(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return cb(s),this.predictLoop(r,s)}finally{Os(r,e)}}predictOnBatch(e){bD(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new ps("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===Zg?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=vD(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=vD(n,this.feedOutputNames,i,!1,"target"),dge(e,n),hge(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new M(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(s!=null){const u=Fz(s,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await Lz(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,r,s=0,i){return G(()=>{const o=this.checkNumSamples(n,r,i,"steps"),a=[];if(s>0)throw new Re("Verbose mode is not implemented yet.");if(i!=null)throw new Re("steps mode in testLoop() is not implemented yet");{const l=ub(o,r),c=wr(Ys(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=al(c,d,h-d),p=Lw(n,f),m=e(p);if(u===0)for(let x=0;x<m.length;++x)a.push(Xe(0));for(let x=0;x<m.length;++x){const g=m[x];a[x]=re(a[x],L(h-d,g))}}for(let u=0;u<a.length;++u)a[u]=we(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(sD(e,s)>1){const o=sD(e.slice(0,r),s);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:r[m]});const h=new Mo(d),f=Dd(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const x=this.lossFunctions[m];let g=x(s[m],f[m]);i[m]!=null&&(g=rge(g,i[m]));const y=Wt(g);n.push(y),m===0?p=g:p=re(p,g)}for(let m=0;m<this.metricsTensors.length;++m){let x;if(this.outputs.length>1&&m<this.outputs.length)x=n[m];else{const g=this.metricsTensors[m][0],y=this.metricsTensors[m][1];x=Wt(g(s[y],f[y]))}xi(x),o.push(x)}return p=Wt(p),this.calculateLosses().forEach(m=>{p=re(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>G(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:s[c]});const a=new Mo(o),l=Dd(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=Wt(u(i[c],l[c]));c===0?r=d:r=re(r,d),n.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=Wt(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,c,u,d,h;try{const f=r.batchSize==null?32:r.batchSize;cb(f);const m=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,f);s=m[0],i=m[1],h=m[2];let x=!1,g;if(r.validationData!=null&&r.validationData.length>0){if(x=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new Re("validationData including sample weights is not supported yet."):new M(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const E=await this.standardizeUserData(l,c,null,null,!0,f);u=E[0],d=E[1],g=u.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){x=!0;const $=Math.floor(s[0].shape[0]*(1-r.validationSplit)),E=s[0].shape[0];u=bd(s,$,E),o=s,s=bd(s,0,$),d=bd(i,$,E),a=i,i=bd(i,0,$),g=u.concat(d)}else r.validationSteps!=null&&(x=!0);const y=s.concat(i).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let k,C;x?(this.makeTestFunction(),k=this.testFunction,C=w.slice().concat(w.map($=>"val_"+$))):(k=null,g=[],C=w.slice());const S=Ez(r.callbacks,r.yieldEvery);return await this.fitLoop(b,y,w,f,r.epochs,r.verbose,S,k,g,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,Os(s,e),Os(i,n),Os(o,e),Os(a,n),Os(u,l),Os(d,c),h!=null&&Le(h)}}async fitLoop(e,n,r,s,i,o,a,l,c,u,d,h,f,p){s==null&&(s=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new M("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,s,f,"steps_per_epoch");let g;x!=null&&(g=Ys(0,x)),o==null&&(o=1);const{callbackList:y,history:b}=Tz(a,o,i,h,x,f,s,m,d);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let w=h;w<i;++w){await y.onEpochBegin(w);const k={};if(f!=null)throw new Re("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Re("batch shuffling is not implemneted yet");u&&Zie(g);const C=wr(g),S=ub(x,s);for(let I=0;I<S.length;++I){const $={};if(await y.onBatchBegin(I,$),G(()=>{const E=S[I][0],A=S[I][1],D=al(C,E,A-E);$.batch=I,$.size=A-E;const P=Lw(n,D),O=e(P);for(let F=0;F<r.length;++F){const U=r[F],V=O[F];$[U]=V,xi(V)}if(I===S.length-1&&m){const F=this.testLoop(l,c,s);for(let U=0;U<r.length;++U){const V=r[U],_=F[U];xi(_),k["val_"+V]=_}}}),await y.onBatchEnd(I,$),$z($),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(w,k),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return oge(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Le(a),Os(r[0],e),Os(r[1],n),rr(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||n.push({name:s[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=zA().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-zA().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=_i(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>_i(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=_i(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[_i(sm(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>_i(sm(e)));{const e={};for(const n in this.metrics)e[n]=_i(sm(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Mw(e.optimizer_config),r=qi(n);let s;if(typeof e.loss=="string")s=za(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>za(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=za(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>za(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=za(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const c=qoe(e);if(c.length===0)throw new M(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new M(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new M("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await WA(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:pge,generatedBy:`TensorFlow.js tfjs-layers v${Mz}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await WA(await this.optimizer.getWeights(),c);r.specs.push(...d),r.data=Koe([r.data,u])}return this.userDefinedMetadata!=null&&(mD(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){mD(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Uc.className="Model";ne(Uc);class Bz extends Uc{}Bz.className="Functional";ne(Bz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Oh extends Uc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:jy("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new M(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Oh||e instanceof Uc;let r;if(n){if(r=e,r.outputs.length!==1)throw new M("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new M("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new M("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=gme({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new M(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new M("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=kz(this.outputs[0])}this.inboundNodes=[],new By({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:El(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ve(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Uc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new ps("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new ps("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new ps("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new ps("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new M("Legacy serialization format not supported yet.");i=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof Oh))throw new Re(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=qi(l,void 0,s);s&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new M("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new M("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}Oh.className="Sequential";ne(Oh);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Fn=class extends Uu{getConfig(){return{}}};class Wz extends Fn{apply(e,n=1){return eme(e,n)}}Wz.className="elu";ne(Wz);class Uz extends Fn{apply(e){return o4(e)}}Uz.className="selu";ne(Uz);class Vz extends Fn{apply(e){return Gl(e)}}Vz.className="relu";ne(Vz);class Gz extends Fn{apply(e){return G(()=>Eh(6,Gl(e)))}}Gz.className="relu6";ne(Gz);class Hz extends Fn{apply(e){return e}}Hz.className="linear";ne(Hz);class Kz extends Fn{apply(e){return zu(e)}}Kz.className="sigmoid";ne(Kz);class qz extends Fn{apply(e){return nme(e)}}qz.className="hardSigmoid";ne(qz);class Xz extends Fn{apply(e){return sp(e)}}Xz.className="softplus";ne(Xz);class Yz extends Fn{apply(e){return tme(e)}}Yz.className="softsign";ne(Yz);class Qz extends Fn{apply(e){return Ty(e)}}Qz.className="tanh";ne(Qz);let XI=class extends Fn{apply(e,n=-1){return Z2(e,n)}};XI.className="softmax";ne(XI);class Zz extends Fn{apply(e,n=-1){return Qj(e,n)}}Zz.className="logSoftmax";ne(Zz);class Jz extends Fn{apply(e){return G(()=>G(()=>{const n=Math.sqrt(2),r=L(.5,re(1,Hj(we(e,n))));return L(e,r)}))}}Jz.className="gelu";ne(Jz);class eB extends Fn{apply(e){return G(()=>L(.5,L(e,re(1,Ty(L(_n(we(2,Math.PI)),re(e,L(.044715,Il(e,3)))))))))}}eB.className="gelu_new";ne(eB);class tB extends Fn{apply(e){return G(()=>L(e,Ty(sp(e))))}}tB.className="mish";ne(tB);class nB extends Fn{apply(e,n=1){return G(()=>L(zu(L(e,n)),e))}}nB.className="swish";ne(nB);function oa(t){return t.getClassName()}function db(t,e={}){return dp(t,ls.getMap().classNameMap,e,"activation")}function aa(t){if(t==null){const e={};return e.className="linear",e.config={},db(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},db(e)}else return t instanceof Fn?t:db(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mge(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class rB extends Uu{}class sB extends rB{constructor(e){super(),mge(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return G(()=>{let n=ln([1]);return this.hasL1&&(n=re(n,be(L(this.l1,Un(e))))),this.hasL2&&(n=re(n,be(L(this.l2,fp(e))))),B(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}sB.className="L1L2";ne(sB);const wD={l1l2:"L1L2"};function at(t){return _I(t)}function kD(t,e={}){return dp(t,ls.getMap().classNameMap,e,"regularizer")}function St(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in wD?wD[t]:t,config:{}};return kD(n)}else return t instanceof rB?t:kD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iB extends Fe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=$e(e);let r=Gl(e);return this.maxValue!=null&&(r=Kr(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}iB.className="ReLU";ne(iB);class oB extends Fe{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=$e(e);return M2(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}oB.className="LeakyReLU";ne(oB);class aB extends Fe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Ct(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=St(e.alphaRegularizer),this.alphaConstraint=tn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new M(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ve(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Zt({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=$e(e),W2(e,this.alpha.read())}getConfig(){const e={alphaInitializer:$t(this.alphaInitializer),alphaRegularizer:at(this.alphaRegularizer),alphaConstraint:en(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}aB.className="PReLU";ne(aB);let lB=class extends Fe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Re(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=$e(e);return Oy(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};lB.className="ELU";ne(lB);class cB extends Fe{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=$e(e);return L(r,fe(Qr(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}cB.className="ThresholdedReLU";ne(cB);class uB extends Fe{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new XI().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return G(()=>{let r=$e(e);const s=n.mask;if(s!=null){const i=L(Se(Sa(r.shape),fe(s,r.dtype)),Xe(-1e9));r=re(r,i)}return this.axis instanceof Array?this.axis.length>1?Si(Se(r,Zj(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}uB.className="Softmax";ne(uB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vc(t,e,n){if(typeof t=="number")return El(t,e);if(t.length!==e)throw new M(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!Ype(s))throw new M(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function Ks(t,e,n,r,s=1){if(t==null)return t;const i=e+(e-1)*(s-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+r-1)/r)}function ci(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+ia([n-e,0]);else if(r==="same")t=t*e;else throw new M(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YI(t,e){return G(()=>(jt(e),e==="channelsFirst"?Be(t,[0,2,3,1]):t))}function dB(t,e){return G(()=>(jt(e),e==="channelsFirst"?Be(t,[0,2,3,4,1]):t))}function gge(t,e,n,r=1,s="valid",i,o=1){return G(()=>{if(i==null&&(i=Qs()),jt(i),t.shape.length!==3)throw new M(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new M(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new M(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Be(t,[0,2,1])),s==="causal")throw new Re("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Bj(t,e,r,s==="same"?"same":"valid","NWC",o);return n!=null&&(a=ni(a,n)),a})}function CD(t,e,n,r=[1,1],s="valid",i,o,a=null){return G(()=>{if(i==null&&(i=Qs()),jt(i),t.rank!==3&&t.rank!==4)throw new M(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new M(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=YI(t,i);if(s==="causal")throw new Re("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Ide({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Be(l,[0,3,1,2])),l})}function xge(t,e,n,r=[1,1,1],s="valid",i,o){return G(()=>{if(i==null&&(i=Qs()),jt(i),t.rank!==4&&t.rank!==5)throw new M(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new M(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=dB(t,i);if(s==="causal")throw new Re("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Sle(a,e,r,s==="same"?"same":"valid","NDHWC",o),n!=null&&(a=ni(a,n)),i==="channelsFirst"&&(a=Be(a,[0,4,1,2,3])),a})}class Vy extends Fe{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Vy.verifyArgs(n),this.rank=e,un(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Re(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Vc(n.kernelSize,e,"kernelSize"),this.strides=Vc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Zr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,jt(this.dataFormat),this.activation=aa(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Ct(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=tn(n.biasConstraint),this.biasRegularizer=St(n.biasRegularizer),this.activityRegularizer=St(n.activityRegularizer),this.dilationRate=Vc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new M(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new M(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new M(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(li("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!MI(e.kernelSize,"number",1,3))throw new M(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:oa(this.activation),useBias:this.useBias,biasInitializer:$t(this.biasInitializer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),biasConstraint:en(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Vu extends Vy{constructor(e,n){super(e,n),this.kernel=null,Vu.verifyArgs(n),this.filters=n.filters,un(this.filters,"filters"),this.kernelInitializer=Ct(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=tn(n.kernelConstraint),this.kernelRegularizer=St(n.kernelRegularizer)}build(e){e=Ve(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return G(()=>{e=$e(e);let r;const s=this.bias==null?null:this.bias.read(),i=az(this.activation.getClassName());if(i!=null&&this.rank===2)r=CD(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=gge(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=CD(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=xge(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Re("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ve(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=Ks(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:$t(this.kernelInitializer),kernelRegularizer:at(this.kernelRegularizer),kernelConstraint:en(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new M(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class xp extends Vu{constructor(e){super(2,e),xp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!MI(e.kernelSize,"number",1,2))throw new M(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}xp.className="Conv2D";ne(xp);class yp extends Vu{constructor(e){super(3,e),yp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new M(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}yp.className="Conv3D";ne(yp);class hB extends xp{constructor(e){if(super(e),this.inputSpec=[new Zt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new M(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ve(e),e.length!==4)throw new M("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zt({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return G(()=>{let r=$e(e);if(r.shape.length!==4)throw new M(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],c=s[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=ci(l,h,u,this.padding),m=ci(c,f,d,this.padding),x=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=Be(r,[0,2,3,1]));let g=Wj(r,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=Be(g,[0,3,1,2])),this.bias!=null&&(g=ni(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=Ve(e);const n=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[r]=this.filters,n[s]=ci(n[s],l,o,this.padding),n[i]=ci(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}hB.className="Conv2DTranspose";ne(hB);class fB extends yp{constructor(e){if(super(e),this.inputSpec=[new Zt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new M(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ve(e),e.length!==5)throw new M("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zt({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return G(()=>{let r=$e(e);if(r.shape.length!==5)throw new M(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=s[l],u=s[o],d=s[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],x=this.strides[1],g=this.strides[2],y=ci(c,m,h,this.padding),b=ci(u,x,f,this.padding),w=ci(d,g,p,this.padding),k=[i,y,b,w,this.filters];this.dataFormat!=="channelsLast"&&(r=Be(r,[0,2,3,4,1]));let C=$le(r,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Be(C,[0,4,1,2,3])),this.bias!==null&&(C=ni(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Ve(e);const n=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[s]=ci(n[s],u,a,this.padding),n[i]=ci(n[i],d,l,this.padding),n[o]=ci(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}fB.className="Conv3DTranspose";ne(fB);class pB extends Vu{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new M("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new M("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new M(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Ct(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=St(n.depthwiseRegularizer),this.depthwiseConstraint=tn(n.depthwiseConstraint),this.pointwiseInitializer=Ct(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=St(n.pointwiseRegularizer),this.pointwiseConstraint=tn(n.pointwiseConstraint)}build(e){if(e=Ve(e),e.length<this.rank+2)throw new M(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new M(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Zt({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return G(()=>{e=$e(e);let r;if(this.rank===1)throw new Re("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Be(e,[0,2,3,1])),r=a4(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=ni(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Be(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=$t(this.depthwiseInitializer),e.pointwiseInitializer=$t(this.pointwiseInitializer),e.depthwiseRegularizer=at(this.depthwiseRegularizer),e.pointwiseRegularizer=at(this.pointwiseRegularizer),e.depthwiseConstraint=en(this.depthwiseConstraint),e.pointwiseConstraint=en(this.pointwiseConstraint),e}}pB.className="SeparableConv";class mB extends pB{constructor(e){super(2,e)}}mB.className="SeparableConv2D";ne(mB);class Gy extends Vu{constructor(e){super(1,e),Gy.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!MI(e.kernelSize,"number",1,1))throw new M(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Gy.className="Conv1D";ne(Gy);class gB extends Fe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return G(()=>{if(e=$e(e),this.dataFormat==="channelsLast"){const r=rm(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return rm(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=rm(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return rm(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}gB.className="Cropping2D";ne(gB);class xB extends Fe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Kpe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return G(()=>{let r=$e(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=Be(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?Ui.resizeNearestNeighbor(r,[i,o]):Ui.resizeBilinear(r,[i,o]);return Be(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?Ui.resizeNearestNeighbor(r,[i,o]):Ui.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}xB.className="UpSampling2D";ne(xB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yge(t,e,n=[1,1],r="valid",s,i){return G(()=>{s==null&&(s=Qs()),jt(s);let o=YI(t,s);if(t.rank!==4)throw new M(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new M(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=O2(o,e,n,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=Be(o,[0,3,1,2])),o})}class yB extends Vy{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Ct(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=tn(e.depthwiseConstraint),this.depthwiseRegularizer=St(e.depthwiseRegularizer)}build(e){if(e=Ve(e),e.length<4)throw new M(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new M(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{e=$e(e);let r=yge(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=ni(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ve(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Ks(n,this.kernelSize[0],this.padding,this.strides[0]),o=Ks(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=$t(this.depthwiseInitializer),e.depthwiseRegularizer=at(this.depthwiseRegularizer),e.depthwiseConstraint=en(this.depthwiseRegularizer),e}}yB.className="DepthwiseConv2D";ne(yB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vB(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new M("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function bB(t,e,n,r=!1,s,i,o=!1,a=!1){return G(()=>{const l=e.shape.length;if(l<3)throw new M(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Ys(2,l));e=Be(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=fe(fe(s,"bool"),"float32"),s.rank===l-1&&(s=nr(s,-1)),s=Be(s,c)),r&&(e=Nl(e,0),s!=null&&(s=Nl(s,0)));const u=[];let d,h=n;const f=e.shape[0],p=$l(e);let m;s!=null&&(m=$l(s));for(let g=0;g<f;++g){const y=p[g],b=G(()=>t(y,h));if(s==null)d=b[0],h=b[1];else{const w=G(()=>{const k=m[g],C=Se(Cs(k),k),S=re(L(b[0],k),L(h[0],C)),I=h.map(($,E)=>re(L(b[1][E],k),L($,C)));return{output:S,newStates:I}});d=w.output,h=w.newStates}a&&u.push(d)}let x;return a&&(x=io(u,1)),[d,x,h]})}class Na extends Fe{constructor(e){super(e);let n;if(e.cell==null)throw new M("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new JI({cells:e.cell}):n=e.cell,n.stateSize==null)throw new M("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Zt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ys(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Rw(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,n){return G(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Re("Constants support is not implemented in RNN yet.");Rw(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Zt({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Qe(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new M(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Zt({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){G(()=>{if(!this.stateful)throw new ai("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new M("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>ln([r,s])):this.states_=[ln([r,this.cell.stateSize])];else if(e==null)Le(this.states_),this.keptStates!=null&&(Le(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>ln([r,s])):this.states_[0]=ln([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new M(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Le(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!Qe(i.shape,a))throw new M(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>xi(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=vB(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new Zt({shape:c.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Ni){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return G(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let i=n==null?null:n.initialState;e=$e(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new M(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},c=bB((p,m)=>{const x=this.cell.call([p].concat(m),a);return[x[0],x.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,s);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return G(()=>{let n=ln(e.shape);return n=be(n,[1,2]),n=hp(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?Dw(n,[1,r]):n):this.cell.stateSize>1?[Dw(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Na.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,i=qi(s,r);return new e(Object.assign(n,{cell:i}))}}Na.className="RNN";ne(Na);class Hy extends Fe{}class QI extends Hy{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,un(this.units,"units"),this.activation=aa(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=yu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=yu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ve(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{if(e=e,e.length!==2)throw new M(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>Cs(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>Cs(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=bi(L(e,o),this.kernel.read()):i=bi(e,this.kernel.read()),this.bias!=null&&(i=ni(i,this.bias.read())),a!=null&&(r=L(r,a));let l=re(i,bi(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}QI.className="SimpleRNNCell";ne(QI);class wB extends Na{constructor(e){e.cell=new QI(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Le(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Le(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return new e(n)}}wB.className="SimpleRNN";ne(wB);class ZI extends Hy{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new M("GRUCell does not support reset_after parameter set to true.");this.units=e.units,un(this.units,"units"),this.activation=aa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=aa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=yu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=yu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ve(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{if(e=e,e.length!==2)throw new M(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>Cs(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>Cs(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=L(e,i[0]));let u=bi(e,this.kernel.read());this.useBias&&(u=ni(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=L(s,o[0]));const d=this.recurrentKernel.read(),[h,f]=Wr(d,[2*this.units,this.units],d.rank-1),p=bi(s,h),[m,x,g]=Wr(u,3,u.rank-1),[y,b]=Wr(p,2,p.rank-1);a=this.recurrentActivation.apply(re(m,y)),l=this.recurrentActivation.apply(re(x,b));const w=bi(L(l,s),f);c=this.activation.apply(re(g,w));const k=re(L(a,s),L(re(1,Mt(a)),c));return[k,k]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}ZI.className="GRUCell";ne(ZI);class kB extends Na{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ZI(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Le(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Le(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}kB.className="GRU";ne(kB);class Ky extends Hy{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,un(this.units,"units"),this.activation=aa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=aa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=tn(e.kernelConstraint),this.recurrentConstraint=tn(e.recurrentConstraint),this.biasConstraint=tn(e.biasConstraint),this.dropout=yu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=yu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ve(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(n=class extends Es{apply(l,c){const u=i.apply([o]),d=new LI().apply([o]),h=i.apply([o*2]);return oD(oD(u,d),h)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return G(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new M(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>Cs(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>Cs(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=L(e,o[0]));let h=bi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=L(s,a[0])),h=re(h,bi(s,this.recurrentKernel.read())),this.useBias&&(h=ni(h,this.bias.read()));const[f,p,m,x]=Wr(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=re(L(c,i),L(l,this.activation.apply(m))),d=this.recurrentActivation.apply(x);const g=L(d,this.activation.apply(u));return[g,g,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Ky.className="LSTMCell";ne(Ky);class CB extends Na{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ky(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Le(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Le(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}CB.className="LSTM";ne(CB);class JI extends Hy{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return G(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,n),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){Rw(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{ol(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const i of n.cells)s.push(qi(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Pw(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],i[o]])}GI(n)}}JI.className="StackedRNNCells";ne(JI);function la(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):pz(e(),n),a=()=>pp(o,e,r);return!s||s<=1?xi(a().clone()):Array(s).fill(void 0).map(a).map(c=>xi(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var vge=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class SB extends Na{constructor(e){if(e.unroll)throw new Re("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Re("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Zt({ndim:5})]}call(e,n){return G(()=>{if(this.cell.dropoutMask!=null&&(Le(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Le(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new M("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return G(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=ln(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){G(()=>{if(!this.stateful)throw new ai("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new M("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>ln(i)):this.states_=[ln(i)];else if(e==null)Le(this.states_),this.keptStates!=null&&(Le(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>ln(i)):this.states_[0]=ln(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new M(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Le(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!Qe(l.shape,c))throw new M(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>xi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Ks(c,s[0],i,o[0],a[0]),h=Ks(u,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,d,h]:[d,h,r]]}}SB.className="ConvRNN2D";class eN extends Ky{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,un(this.filters,"filters"),this.kernelSize=Vc(r,2,"kernelSize"),this.kernelSize.forEach(l=>un(l,"kernelSize")),this.strides=Vc(s||1,2,"strides"),this.strides.forEach(l=>un(l,"strides")),this.padding=i||"valid",Zr(this.padding),this.dataFormat=o||"channelsLast",jt(this.dataFormat),this.dilationRate=Vc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>un(l,"dilationRate"))}build(e){var n;e=Ve(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new M(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Es{apply(h,f){const p=c.apply([u]),m=Sa([u]),x=c.apply([u*2]);return FI([p,m,x])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return G(()=>{if(e.length!==3)throw new M(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>Cs(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(K,Z,q)=>!Z||!Z[q]?K:L(Z[q],K);let u=c(s,l,0),d=c(s,l,1),h=c(s,l,2),f=c(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>Cs(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),x=c(i,p,1),g=c(i,p,2),y=c(i,p,3);const b=3,[w,k,C,S]=Wr(this.kernel.read(),a,b),[I,$,E,A]=this.useBias?Wr(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,w,I,this.padding),d=this.inputConv(d,k,$,this.padding),h=this.inputConv(h,C,E,this.padding),f=this.inputConv(f,S,A,this.padding);const[D,P,O,F]=Wr(this.recurrentKernel.read(),a,b);m=this.recurrentConv(m,D),x=this.recurrentConv(x,P),g=this.recurrentConv(g,O),y=this.recurrentConv(y,F);const U=this.recurrentActivation.apply(re(u,m)),V=this.recurrentActivation.apply(re(d,x)),_=re(L(V,o),L(U,this.activation.apply(re(h,g)))),z=L(this.recurrentActivation.apply(re(f,y)),this.activation.apply(_));return[z,z,_]})}getConfig(){const e=super.getConfig(),n=vge(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,s){const i=Sl(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?ni(i,r,this.dataFormat):i}recurrentConv(e,n){return Sl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}eN.className="ConvLSTM2DCell";ne(eN);class IB extends SB{constructor(e){const n=new eN(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}IB.className="ConvLSTM2D";ne(IB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tN extends Fe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,i=this.getNoiseShape(r);return pp(()=>pz(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}tN.className="Dropout";ne(tN);class NB extends tN{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}NB.className="SpatialDropout1D";ne(NB);class $B extends Fe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,un(this.units,"units"),this.activation=aa(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=tn(e.kernelConstraint),this.biasConstraint=tn(e.biasConstraint),this.kernelRegularizer=St(e.kernelRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.activityRegularizer=St(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ve(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ve(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e),s=az(this.activation.getClassName());let i;return s!=null?i=bi(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=bi(r,this.kernel.read()),this.bias!=null&&(i=ni(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),biasConstraint:en(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}$B.className="Dense";ne($B);class EB extends Fe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ve(e);for(const n of e.slice(1))if(n==null)throw new M(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Qo(e,1)]}call(e,n){return G(()=>{this.invokeCallHook(e,n);let r=$e(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=Be(r,s)}return Jpe(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}EB.className="Flatten";ne(EB);class TB extends Fe{constructor(e){super(e),this.supportsMasking=!0,this.activation=aa(e.activation)}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e);return this.activation.apply(r)})}getConfig(){const e={activation:oa(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}TB.className="Activation";ne(TB);class AB extends Fe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return G(()=>(e=$e(e),Qpe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}AB.className="RepeatVector";ne(AB);class DB extends Fe{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const c=s[l];if(this.isUnknown(c))if(o===null)o=l;else throw new M("Can only specifiy one unknown dimension.");else i*=c}const a=Qo(e);if(o!==null){if(i===0||a%i!==0)throw new M(r);s[o]=a/i}else if(a!==i)throw new M(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return B(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}DB.className="Reshape";ne(DB);class OB extends Fe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ys(1,e.dims.length+1);if(!Qe(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Zt({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ve(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return Be($e(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}OB.className="Permute";ne(OB);class RB extends Fe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=$e(e);return Sw(Vg(r,this.maskValue),-1)}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e),o=Sw(Vg(r,this.maskValue),-1,!0);return L(r,fe(o,r.dtype))})}}RB.className="Masking";ne(RB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PB extends Fe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Je(e.inputLength))}this.inputDim=e.inputDim,un(this.inputDim,"inputDim"),this.outputDim=e.outputDim,un(this.outputDim,"outputDim"),this.embeddingsInitializer=Ct(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=St(e.embeddingsRegularizer),this.activityRegularizer=St(e.activityRegularizer),this.embeddingsConstraint=tn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return G(()=>this.maskZero?(e=$e(e),Vg(e,We(e))):null)}computeOutputShape(e){if(e=Ve(e),this.inputLength==null)return[...e,this.outputDim];const n=Je(this.inputLength);if(n.length!==e.length-1)throw new M(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const i=n[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new M(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=o),r++}}return[e[0],...n,this.outputDim]}call(e,n){return G(()=>{this.invokeCallHook(e,n);let r=$e(e);r.dtype!=="int32"&&(r=vi(r,"int32"));const s=fz(this.embeddings.read(),B(r,[r.size]));return B(s,Ve(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:$t(this.embeddingsInitializer),embeddingsRegularizer:at(this.embeddingsRegularizer),activityRegularizer:at(this.activityRegularizer),embeddingsConstraint:en(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}PB.className="Embedding";ne(PB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ql extends Fe{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Re}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const i=e[e.length-n.length+s],o=n[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new M("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ve(e)]),e=e,e.length<2)throw new M(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Yo(n),n.length>1)throw new M(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&Yo(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return G(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=ia(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=hp(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=B(l,[d].concat(Qo(u.slice(1))));f=Be(f,[1,0]),f=B(f,h),r.push(f),i=!0}else if(c>1){const u=Ys(1,c).concat([0]);r.push(Be(l,u)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=B(Be(B(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Ys(0,a-1));o=Be(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=Yo(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return G(()=>{if(n==null)return null;if(!Array.isArray(n))throw new M("`mask` should be an Array");if(!Array.isArray(e))throw new M("`inputs` should be an Array");if(n.length!==e.length)throw new M(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:nr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=so(r,n[s]);return r})}}class _B extends ql{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=re(n,e[r]);return n})}}_B.className="Add";ne(_B);class MB extends ql{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=L(n,e[r]);return n})}}MB.className="Multiply";ne(MB);class FB extends ql{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=re(n,e[r]);return L(1/e.length,n)})}}FB.className="Average";ne(FB);class LB extends ql{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Ca(n,e[r]);return n})}}LB.className="Maximum";ne(LB);class jB extends ql{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Eh(n,e[r]);return n})}}jB.className="Minimum";ne(jB);class zB extends ql{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new M("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(Qe(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new M("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return G(()=>FI(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new M("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new M("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new M("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new M(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return G(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)n[o]==null?s.push(fe(Cs(e[o]),"bool")):n[o].rank<e[o].rank?s.push(nr(n[o],-1)):s.push(n[o]);const i=ar(s,this.axis);return zj(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}zB.className="Concatenate";ne(zB);function wd(t,e){for(;t<0;)t+=e;return t}function bge(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Re("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Re("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const i=n;return G(()=>{let o;if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);e=B(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);t=B(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=be(L(t,e),i[0]):a=be(L(Be(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=qe(t,e,l,c)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=op(a,c)}return a.shape.length===1&&(a=nr(a,1)),a})}class BB extends ql{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new Re("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new M(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new M(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>wd(i,e[o].shape.length)):s=[wd(this.axes,n.shape.length),wd(this.axes,r.shape.length)],this.normalize&&(n=Qg(n,s[0]),r=Qg(r,s[1])),bge(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[wd(this.axes,e.length),wd(this.axes,n.length)],r}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new Re("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}BB.className="Dot";ne(BB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WB extends Fe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e);return pp(()=>re(zy(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}WB.className="GaussianNoise";ne(WB);class UB extends Fe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const r=$e(e);return this.rate>0&&this.rate<1?pp(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return L(r,zy(r.shape,1,i))},()=>r,n.training||!1):r})}}UB.className="GaussianDropout";ne(UB);class VB extends Fe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||$e(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return G(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return pp(()=>{const i=$e(e),l=-1.6732632423543772*1.0507009873554805;let c=Ul(ip(r),this.rate);c=vi(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=re(L(i,c),L(re(c,-1),l));return re(L(h,u),d)},()=>$e(e),n.training||!1)}return e})}}VB.className="AlphaDropout";ne(VB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rh(t,e,n,r,s,i=.001){let o;if(t.rank===2)o=ele(t,e,n,r,s,i);else if(t.rank===3)o=nle(t,e,n,r,s,i);else if(t.rank===4)o=sle(t,e,n,r,s,i);else throw new Re(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function wge(t,e,n,r,s=.001){return G(()=>{const i=j2(t,r),o=i.mean,a=i.variance;return[Rh(t,o,a,n,e,s),o,a]})}function kge(t,e,n,r,s=.001){return G(()=>{const i=j2(t,r),o=i.mean,a=i.variance,l=[];for(const p of Ys(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=B(o,l),u=B(a,l),d=e==null?null:B(e,l),h=n==null?null:B(n,l);return[Rh(t,c,u,h,d,s),o,a]})}function Cge(t,e,n,r,s=.001){return Qe(r.slice().sort(),Ys(0,t.rank-1))?wge(t,e,n,r,s):kge(t,e,n,r,s)}class GB extends Fe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ct(e.betaInitializer||"zeros"),this.gammaInitializer=Ct(e.gammaInitializer||"ones"),this.movingMeanInitializer=Ct(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ct(e.movingVarianceInitializer||"ones"),this.betaConstraint=tn(e.betaConstraint),this.gammaConstraint=tn(e.gammaConstraint),this.betaRegularizer=St(e.betaRegularizer),this.gammaRegularizer=St(e.gammaRegularizer)}build(e){e=Ve(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new M(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Zt({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return G(()=>{const r=n.training==null?!1:n.training,s=$e(e),i=s.shape,o=i.length,a=Ys(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=El(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!Qe(u,Ys(0,o).slice(0,o-1)),h=()=>{if(d){const y=B(this.movingMean.read(),c),b=B(this.movingVariance.read(),c),w=this.center?B(this.beta.read(),c):null,k=this.scale?B(this.gamma.read(),c):null;return Rh(s,y,b,w,k,this.epsilon)}else return Rh(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[f,p,m]=Cge(s,this.gamma.read(),this.beta.read(),a,this.epsilon),x=(y,b,w)=>{G(()=>{const k=1-w,C=y.read(),S=L(Se(C,b),k);y.write(Se(C,S))})};return(()=>{x(this.movingMean,p,this.momentum),x(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$t(this.betaInitializer),gammaInitializer:$t(this.gammaInitializer),movingMeanInitializer:$t(this.movingMeanInitializer),movingVarianceInitializer:$t(this.movingVarianceInitializer),betaRegularizer:at(this.betaRegularizer),gammaRegularizer:at(this.gammaRegularizer),betaConstraint:en(this.betaConstraint),gammaConstraint:en(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}GB.className="BatchNormalization";ne(GB);class HB extends Fe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ct(e.betaInitializer||"zeros"),this.gammaInitializer=Ct(e.gammaInitializer||"ones"),this.betaRegularizer=St(e.betaRegularizer),this.gammaRegularizer=St(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ve(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Yo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=$e(e),s=r.shape,i=s.length;return G(()=>{let{mean:a,variance:l}=j2(r,this.axis,!0);const c=El(1,i);for(const m of this.axis)c[m]=s[m];const u=m=>m!=null&&m.shape.length!==i?B(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(s[m]),p.push(1)):(f.push(1),p.push(s[m]));return a=Ws(a,f),l=Ws(l,f),d!=null&&(d=Ws(d,p)),h!=null&&(h=Ws(h,p)),Rh(r,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$t(this.betaInitializer),gammaInitializer:$t(this.gammaInitializer),betaRegularizer:at(this.betaRegularizer),gammaRegularizer:at(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}HB.className="LayerNormalization";ne(HB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sge(t,e,n){return G(()=>{if(t.rank!==4)throw new M(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new M("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Qs()),n!=="channelsLast"&&n!=="channelsFirst")throw new M(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],z2(t,r)})}class KB extends Fe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Qs():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new M(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new M(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new M(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){e=Ve(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return G(()=>Sge($e(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}KB.className="ZeroPadding2D";ne(KB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qy(t,e,n,r,s,i){return G(()=>{jt(s),cz(i),Zr(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=Qs()),i==null&&(i="max"),t=YI(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=L2(t,e,n,a):o=E2(t,e,n,a),s==="channelsFirst"&&(o=Be(o,[0,3,1,2])),o})}function qB(t,e,n,r,s,i){return G(()=>{jt(s),cz(i),Zr(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=Qs()),i==null&&(i="max"),t=dB(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=Wce(t,e,n,a):o=Vae(t,e,n,a),s==="channelsFirst"&&(o=Be(o,[0,4,1,2,3])),o})}class XB extends Fe{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new M(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(un(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new M(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Zr(this.padding),this.inputSpec=[new Zt({ndim:3})]}computeOutputShape(e){e=Ve(e);const n=Ks(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return G(()=>{this.invokeCallHook(e,n),e=hp($e(e),2);const r=this.poolingFunction($e(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return op(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class YB extends XB{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qy(e,n,r,s,i,"max")}}YB.className="MaxPooling1D";ne(YB);class QB extends XB{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qy(e,n,r,s,i,"avg")}}QB.className="AveragePooling1D";ne(QB);class ZB extends Fe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new M(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];un(this.poolSize,"poolSize"),un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),Zr(this.padding),this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){e=Ve(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Ks(n,this.poolSize[0],this.padding,this.strides[0]),r=Ks(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return G(()=>(this.invokeCallHook(e,n),this.poolingFunction($e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class JB extends ZB{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qy(e,n,r,s,i,"max")}}JB.className="MaxPooling2D";ne(JB);class eW extends ZB{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qy(e,n,r,s,i,"avg")}}eW.className="AveragePooling2D";ne(eW);class tW extends Fe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new M(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];un(this.poolSize,"poolSize"),un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),Zr(this.padding),this.inputSpec=[new Zt({ndim:5})]}computeOutputShape(e){e=Ve(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Ks(n,this.poolSize[0],this.padding,this.strides[0]),r=Ks(r,this.poolSize[1],this.padding,this.strides[1]),s=Ks(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return G(()=>(this.invokeCallHook(e,n),this.poolingFunction($e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class nW extends tW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qB(e,n,r,s,i,"max")}}nW.className="MaxPooling3D";ne(nW);class rW extends tW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return jt(i),Zr(s),qB(e,n,r,s,i,"avg")}}rW.className="AveragePooling3D";ne(rW);class sW extends Fe{constructor(e){super(e),this.inputSpec=[new Zt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Re}}class iW extends sW{constructor(e){super(e||{})}call(e,n){return G(()=>{const r=$e(e);return Wt(r,1)})}}iW.className="GlobalAveragePooling1D";ne(iW);class oW extends sW{constructor(e){super(e||{})}call(e,n){return G(()=>{const r=$e(e);return Hs(r,1)})}}oW.className="GlobalMaxPooling1D";ne(oW);class aW extends Fe{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Re}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class lW extends aW{call(e,n){return G(()=>{const r=$e(e);return this.dataFormat==="channelsLast"?Wt(r,[1,2]):Wt(r,[2,3])})}}lW.className="GlobalAveragePooling2D";ne(lW);class cW extends aW{call(e,n){return G(()=>{const r=$e(e);return this.dataFormat==="channelsLast"?Hs(r,[1,2]):Hs(r,[2,3])})}}cW.className="GlobalMaxPooling2D";ne(cW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uW extends Fe{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,i=qi(s,r);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class dW extends uW{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ve(e),e.length<3)throw new M(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ve(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return G(()=>(e=$e(e),bB((o,a)=>[$e(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}dW.className="TimeDistributed";ne(dW);function Ige(t){Kl(Hpe,"BidirectionalMergeMode",t)}const Nge="concat";class hW extends uW{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=qi(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=qi(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Nge:e.mergeMode,Ige(this.mergeMode),e.weights)throw new Re("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):rr(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=vB(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const o=[],a=[];if(r!=null){const c=r.length;if(c%2>0)throw new M("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const u=r.map(d=>new Zt({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(s!=null)throw new Re("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Ni;for(const c of o)if(c instanceof Ni!==l)throw new M("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return G(()=>{const r=n.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=Nl(i,1));let a;return this.mergeMode==="concat"?a=FI([s,i]):this.mergeMode==="sum"?a=re(s,i):this.mergeMode==="ave"?a=L(.5,re(s,i)):this.mergeMode==="mul"?a=L(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){ol(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),ol(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=qi(n.layer);if(delete n.layer,n.numConstants!=null)throw new Re("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}hW.className="Bidirectional";ne(hW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fW extends Fe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return G(()=>(e=$e(e),e.dtype!=="float32"&&(e=vi(e,"float32")),re(L(e,this.scale),this.offset)))}}fW.className="Rescaling";ne(fW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:$ge,cropAndResize:Ege}=Ui;class pW extends Fe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,i,o,a,l){return G(()=>{let c,u=!1;const d=n/o,h=r/a,f=(s+n)/o,p=(i+r)/a,m=[d,h,f,p],x=[];e.rank===3?(u=!0,c=io([e])):c=e;for(let k=0;k<c.shape[0];k++)x.push(m);const g=Aj(x,[x.length,4]),y=Th(0,x.length,1,"int32"),w=Ege(c,g,y,[s,i],"nearest");return vi(u?$e($l(w)):w,l)})}upsize(e,n,r,s){return G(()=>{const i=$ge(e,[n,r]);return vi(i,s)})}call(e,n){return G(()=>{const r=$e(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ve(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}pW.className="CenterCrop";ne(pW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tge(t,e,n,r){let s=$e(t);if(s.dtype!=="int32"&&(s=vi(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=nr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=nr(s,-1)),s.rank>2)throw new M(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=GA(a,r,n,o):l=GA(a,[],n,o),e!=="tfIdf")return l;if(r)return L(l,r);throw new M("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mW extends Fe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ve(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return G(()=>{e=$e(e),e.dtype!=="int32"&&(e=vi(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new M(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=$e(n.countWeights)}const s=Hs(e),i=Wg(e),o=Qr(this.numTokens,s).bufferSync().get(0),a=Ul(i,0).bufferSync().get(0);if(!(o&&a))throw new M(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Tge(e,this.outputMode,this.numTokens,r)})}}mW.className="CategoryEncoding";ne(mW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Age=["bilinear","nearest"],SD=new Set(Age);class gW extends Fe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(SD.has(e.interpolation))this.interpolation=e.interpolation;else throw new M(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ve(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return G(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Ui.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Ui.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...SD]} are supported`)})}}gW.className="Resizing";ne(gW);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xW{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}xW.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yW extends Fe{constructor(e){super(e),this.randomGenerator=new xW(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}yW.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Dge=["bilinear","nearest"],ID=new Set(Dge);class vW extends yW{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new M(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new M(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new M(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(ID.has(r))this.interpolation=r;else throw new M(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ve(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return G(()=>{const r=$e(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=ip([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Ui.resizeBilinear(e,o);case"nearest":return Ui.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...ID]} are supported`)}})}}vW.className="RandomWidth";ne(vW);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=H();Oge.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ND;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(ND||(ND={}));var $D;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})($D||($D={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ED;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(ED||(ED={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rge=m4;class Xy extends DS{nextDataId(){return Xy.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new PL(this,ii())}write(e,n,r){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&Fr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&af(r[0])){const i=r.map(o=>Xo(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,i){this.data.set(e,{values:n,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return oo(s,i)}return soe(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>sa(s));return _e(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return _e(e.shape,e.dtype,n)}makeOutput(e,n,r){return ii().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=tr();return e(),{kernelMs:tr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){xe([e],"where");const n=this.readSync(e.dataId);return Rge(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Xy.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Pge=t=>{const{x:e}=t.inputs,n=t.backend;xe(e,"abs");let r=new Float32Array(Q(e.shape));const s=n.data.get(e.dataId).values;return r=bW(s),n.makeOutput(r,e.shape,e.dtype)},_ge={kernelName:Nx,backendName:"cpu",kernelFunc:Pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zt(t){return(e,n,r,s,i)=>{const o=Ae(e,n),a=o.length,l=ve(o),c=Q(o),u=Rn(i,c),d=e.length,h=n.length,f=ve(e),p=ve(n),m=gu(e,o),x=gu(n,o);if(m.length+x.length===0)for(let g=0;g<u.length;++g)u[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<u.length;++g){const y=Fu(g,a,l),b=y.slice(-d);m.forEach(S=>b[S]=0);const w=gi(b,d,f),k=y.slice(-h);x.forEach(S=>k[S]=0);const C=gi(k,h,p);u[g]=t(r[w],s[C])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xr(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",o)},a}const Mge={kernelName:VS,backendName:"cpu",kernelFunc:xr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0(t,e,n="float32"){if(n==="complex64"){const s=n0(t,e,"float32"),i=n0(t,e,"float32");return xr({inputs:{real:s,imag:i},backend:t})}const r=Pn(Q(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $i(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Fge={kernelName:Ef,backendName:"cpu",kernelFunc:$i};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const Lge={kernelName:p2,backendName:"cpu",kernelFunc:Tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Wl([0],n),[i,o]=zt((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function ca(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return $i({inputs:{x:s},backend:n});const u=n0(n,s.shape,s.dtype),d=ca({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),h=xr({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(s.dtype==="complex64"){const u=Tl({inputs:{input:s},backend:n}),d=ca({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!FL(s.dtype,i)){const u=$i({inputs:{x:s},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(s.dataId).values,[a,l,c]=wW(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,c)}const jge={kernelName:mf,backendName:"cpu",kernelFunc:ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rn(t,e,n,r){return n==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;xe([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?ao(c):c,h=o.dtype==="string"?ao(u):u,f=r||o.dtype,[p,m]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=ca({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=ca({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(m.dataId),g=x.complexTensorInfos.real,y=x.complexTensorInfos.imag,b=l.data.get(g.dataId).values,w=l.data.get(y.dataId).values,[k,C,S]=n(o.shape,a.shape,f,p,b,w),I=l.makeTensorInfo(S,"float32",k),$=l.makeTensorInfo(S,"float32",C),E=xr({inputs:{real:I,imag:$},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo($),E}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=r||o.dtype,[h,f]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function nN(t){return(e,n,r,s,i,o)=>{const a=Ae(e,n),l=Q(a),c=a.length,u=ve(a),d=Rn("float32",l),h=Rn("float32",l),f=gu(e,a),p=gu(n,a),m=oo(r,s),x=oo(i,o),g=e.length,y=ve(e),b=n.length,w=ve(n);if(f.length+p.length===0)for(let k=0;k<d.length;k++){const C=k%m.length,S=k%x.length,I=t(m[C*2],m[C*2+1],x[S*2],x[S*2+1]);d[k]=I.real,h[k]=I.imag}else for(let k=0;k<d.length;k++){const C=Fu(k,c,u),S=C.slice(-g);f.forEach(D=>S[D]=0);const I=gi(S,g,y),$=C.slice(-b);p.forEach(D=>$[D]=0);const E=gi($,b,w),A=t(m[I*2],m[I*2+1],x[E*2],x[E*2+1]);d[k]=A.real,h[k]=A.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW=zt((t,e)=>t+e),zge=nN((t,e,n,r)=>({real:t+n,imag:e+r})),vu=rn(Lu,kW,zge),Bge={kernelName:Lu,backendName:"cpu",kernelFunc:vu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(t,e,n,r,s){const i=Q(r),o=Pn(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function CW(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=_e([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SW=zt((t,e)=>t&e),Wge=rn(US,SW),Uge={kernelName:US,backendName:"cpu",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ai(t){return(e,n,r)=>{const s=_t(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function et(t,e,n){const r=Ai(e);return $a(t,r,n)}function $a(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;xe(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=ao(l)}else c=l;const u=n||o.dtype,d=e(c,u,s);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW=Ai(t=>Math.ceil(t)),Vge=$a(gf,IW),Gge={kernelName:gf,backendName:"cpu",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(t,e,n,r){const s=_t(n,Q(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=Q(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?ao(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)s[u+d]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $W=zt((t,e)=>t===e?1:0),EW=rn(Bx,$W,null,"bool"),Hge={kernelName:Bx,backendName:"cpu",kernelFunc:EW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TW=Ai(t=>Math.exp(t)),AW=$a(Cf,TW,"float32"),Kge={kernelName:Cf,backendName:"cpu",kernelFunc:AW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DW=Ai(t=>Math.expm1(t)),qge=$a(Sf,DW),Xge={kernelName:Sf,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OW=Ai(t=>Math.floor(t)),Yge=$a(If,OW),Qge={kernelName:If,backendName:"cpu",kernelFunc:Yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RW=zt((t,e)=>Math.floor(t/e)),Zge=rn(Nf,RW,null,"int32"),Jge={kernelName:Nf,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(t,e,n,r,s,i,o,a,l){const c=_e([r,i],n);for(let u=0;u<r;u++){const d=[];let h=0;for(let f=0;f<s;f++){const p=t[u*s+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(h*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t,e,n){const r=_e(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(r.values[s]=t.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MW=zt((t,e)=>t>e?1:0),e0e=rn(Gx,MW,null,"bool"),t0e={kernelName:Gx,backendName:"cpu",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FW=zt((t,e)=>t>=e?1:0),n0e=rn($f,FW,null,"bool"),r0e={kernelName:$f,backendName:"cpu",kernelFunc:n0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW=zt((t,e)=>t<e?1:0),s0e=rn(Kx,LW,null,"bool"),i0e={kernelName:Kx,backendName:"cpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW=zt((t,e)=>t<=e?1:0),o0e=rn(qx,jW,null,"bool"),a0e={kernelName:qx,backendName:"cpu",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e,n){const r=(e-t)/(n-1),s=Pn(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BW=Ai(t=>Math.log(t)),l0e=$a(Of,BW),c0e={kernelName:Of,backendName:"cpu",kernelFunc:l0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t,e,n,r){const s=Rn(r,Q(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UW=zt((t,e)=>Math.max(t,e)),u0e=rn(Pf,UW),d0e={kernelName:Pf,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW=zt((t,e)=>Math.min(t,e)),h0e=rn(_f,VW),f0e={kernelName:_f,backendName:"cpu",kernelFunc:h0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sN=zt((t,e)=>t*e),p0e=nN((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),Yy=rn(Ff,sN,p0e),m0e={kernelName:Ff,backendName:"cpu",kernelFunc:Yy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(t,e,n){const r=ba(-1,n);return sN([],e,r,t,n)}function g0e(t){const{inputs:e,backend:n}=t,{x:r}=e;xe(r,"neg");const s=n.data.get(r.dataId).values,[i,o]=GW(s,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const x0e={kernelName:iy,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HW=zt((t,e)=>t!==e?1:0),y0e=rn(oy,HW,null,"bool"),v0e={kernelName:oy,backendName:"cpu",kernelFunc:y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iN(t,e,n,r,s){const i=e.length,o=Q(e),a=ve(e),l=ve(s),c=Rn(n,Q(s));for(let u=0;u<o;++u){const d=Fu(u,i,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[r[p]];const f=gi(h,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;xe(s,"transpose");const o=s.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=s.shape[i[d]];const l=r.data.get(s.dataId).values,c=iN(l,s.shape,s.dtype,i,a);return{dataId:r.write(c,a,s.dtype),shape:a,dtype:s.dtype}}const b0e={kernelName:Bc,backendName:"cpu",kernelFunc:cr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t,e,n,r){const[s,i]=fn(t,r),o=Ir(e,"int32"),a=Pn(Q(s),o),l=Q(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:s,outDtype:o}}function w0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;xe(s,"prod");const a=s.shape.length,l=Me(i,s.shape),c=Et(l,a);let u=l,d=s;const h=[];c!=null&&(d=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),h.push(d),u=Lt(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:x}=KW(d.shape,d.dtype,f,u);let g=m;return o&&(g=Ut(m,l)),h.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(g,x,p)}const k0e={kernelName:hy,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=Fu(s,e.length,ve(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function S0e(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function I0e(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);S0e(n,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],x=m[m.length-1]-f[u];for(let g=u;g<d;++g)a[p].push(f[g+1]+x)}u=f[u],d=f[d]}d!==u&&(s.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:s,numValues:i}}function N0e(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=_t("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function TD(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function $0e(t,e,n,r,s,i){const o=TD(e,2)[1],a=TD(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)s[l*a+d]=t[u*o+d];++l}}function E0e(t,e,n,r,s){const i=e.slice();i[0]=s;const o=_t(n,Q(i)),a=t.length,l=a===0?0:a/e[0];return $0e(t,e,r,l,o,i),[o,i]}function qW(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(C0e(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:d,numValues:h}=I0e(i,o,t,c),f=N0e(u),p=E0e(n,r,s,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AD=2147483647;function XW(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(s[0]),c||u.push(o[0]);for(let x=1;x<u.length;++x)if(u[x]!==u[x-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=_t("int32",d+1);h[0]=0;for(let x=0;x<d;++x){const g=a?t[0]:t[x],y=l?r[0]:r[x],b=c?i[0]:i[x];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&y<g||b<0&&y>g)w=0;else if(w=Math.ceil(Math.abs((y-g)/b)),w>AD)throw new Error(`Requires ((limit - start) / delta) <= ${AD}`);h[x+1]=h[x]+w}const f=h[d],p=_t(n,f);let m=0;for(let x=0;x<d;++x){const g=h[x+1]-h[x];let y=a?t[0]:t[x];const b=c?i[0]:i[x];for(let w=0;w<g;++w)p[m++]=y,y+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ns=js;class r0{constructor(e,n,r,s,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=P4(u),this.raggedRank=_4(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ns.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ns.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ns.VALUE_ROWIDS:return r0.getMaxWidthValueRowID(n);case ns.ROW_SPLITS:return r0.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ns[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return OD(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;M4(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=R4(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return T(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(s,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=r;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<s?c+=r:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case ns.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case ns.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${ns[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ns.FIRST_DIM_SIZE:return e[0];case ns.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ns.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ns[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=OD(r,!1),o=_t(this.valuesDType,Q(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,s[c],r[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=Q(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;G(()=>{const m=B(u,p);u=Xd(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const x=i.subarray(d*l),g=o.subarray(h*l),y=(f-h)*l;DD(g,x,y)}if(p>=c){const x=r.length;m=Math.floor(x/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const x=o.slice(f*l);DD(x,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function DD(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function OD(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function YW(t,e,n,r,s,i,o,a,l,c){return new r0(t,e,n,r,s,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return Pn(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=Pn(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZW=Ai(t=>1/Math.sqrt(t)),T0e=$a(Uf,ZW),A0e={kernelName:Uf,backendName:"cpu",kernelFunc:T0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t,e,n,r,s,i,o,a,l,c){const u=[r/s,s],d=t.values,h=e.values;if(r===0)return _e(n,e.dtype);const f=l instanceof vn?l:_e(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let x=0;for(let g=0;g<o;g++){const y=d[p*o+g];m.push(y),x+=y*a[g]}if(x<0||x>=r/s)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<s;g++)c?f.values[x*s+g]+=h[p*s+g]:f.values[x*s+g]=e.rank===0?h[0]:h[p*s+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e=Ai(t=>1/(1+Math.exp(-t))),JW=et(qf,t=>1/(1+Math.exp(-t))),O0e={kernelName:qf,backendName:"cpu",kernelFunc:JW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t,e,n,r,s){const i=hI(r,e,n),o=Q(n),a=ve(r);if(i){const d=fI(e,a);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=s==="string"?ao(t):t,c=_e(r,s,l),u=_e(n,s);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return s==="string"?nz(u.values):u.values}function Al(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r;xe(s,"slice");const[a,l]=_y(s,i,o);uI(s,a,l);const c=n.data.get(s.dataId).values,u=eU(c,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,u)}const R0e={kernelName:yy,backendName:"cpu",kernelFunc:Al};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n,r,s,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(U4(a));const x=_t(n,0),g=_t(s,0);return[x,[0,d],g,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let x=0;x<a;++x){const g=t[x*d];if(g<0)throw new Error(V4(x,g));if(g>=l)throw new Error(G4(x,g,l));++p[g],h=h&&g>=f,f=g}let m=!0;for(let x=0;x<l;++x){const g=p[x]===0;c[x]=g,m=m&&!g,p[x]=Math.max(p[x],1),x>0&&(p[x]+=p[x-1])}if(m&&h){const x=t,g=r;for(let y=0;y<a;++y)u[y]=y;return[x,[a,d],g,c,u]}else{const x=p[l-1],g=_t(n,x*d),y=_t(s,x),b=new Array(l).fill(0);for(let w=0;w<a;++w){const k=t[w*d],C=b[k],S=(k===0?0:p[k-1])+C;b[k]++;for(let I=0;I<d;++I)g[S*d+I]=t[w*d+I];y[S]=r[w],u[w]=S}for(let w=0;w<l;++w)if(b[w]===0){const C=w===0?0:p[w-1];g[C*d+0]=w;for(let S=1;S<d;++S)g[C*d+S]=0;y[C]=o}return[g,[x,d],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(t,e,n,r,s){const i=Q(r),o=e[0],a=s.length,l=[];let c=1,u=-1;for(let x=0;x<a;++x){const g=s[x];if(g===-1){if(u!==-1)throw new Error(H4(u,x));u=x,l.push(1)}else{if(g<0)throw new Error(K4(x,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(q4());const x=Math.trunc(i/c);if(c*x!==i)throw new Error(X4(r,l));l[u]=x}if(Q(l)!==i)throw new Error(Y4(r,l));const h=r.length,f=[];if(h>0){f[h-1]=1;for(let x=h-2;x>=0;--x)f[x]=f[x+1]*r[x+1]}const p=[];if(a>0){p[a-1]=1;for(let x=a-2;x>=0;--x)p[x]=p[x+1]*l[x+1]}const m=_t(n,o*a);for(let x=0;x<o;++x){let g=0;for(let y=0;y<h;++y)g+=t[x*h+y]*f[y];for(let y=0;y<a;++y)m[x*a+y]=Math.trunc(g/p[y]),g%=p[y]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oN(t,e,n,r,s,i=!1,o=0){const a=r.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(Tw());const h=e.slice();h[0]=d;const f=h.reduce((b,w)=>b*w,1),p=_t(n,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(Tw());let m=0,x=1,g=0,y=s[m];for(;;){let b=0;if(x<a){if(b=s[x],y===b){++x;continue}if(y>=b)throw new Error(Q4())}if(y<0||y>=d)throw new Error(Z4(y,d));y>g&&p.fill(o,g*c,y*c);for(let w=m;w<x;++w){const k=r[w];if(k<0||k>=l[0])throw new Error(J4(w,r[w],l[0]));for(let C=0;C<c;C++)p[y*c+C]+=t[k*c+C]}if(i)for(let w=0;w<c;w++)p[y*c+w]/=x-m;if(m=x,++x,g=y+1,y=b,x>a)break}return g<d&&p.fill(o,g*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P0e=Ai(t=>Math.sqrt(t)),_0e=et(Yf,t=>Math.sqrt(t)),M0e={kernelName:Yf,backendName:"cpu",kernelFunc:_0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rU=zt((t,e)=>{const n=t-e;return n*n}),F0e=rn(Qf,rU),L0e={kernelName:Qf,backendName:"cpu",kernelFunc:F0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sU=Ai((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),j0e=$a(y2,sU),z0e={kernelName:y2,backendName:"cpu",kernelFunc:j0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e,n,r){const s=_e(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B0e{constructor(e,n,r,s,i,o){this.separator=Xo(e),this.nGramWidths=n,this.leftPad=Xo(r),this.rightPad=Xo(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<d;++y)f+=e[h+y].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,r[s+a]=new Uint8Array(f);const m=r[s+a];let x=0;const g=y=>y.forEach(b=>m[x++]=b);for(let y=0;y<c;++y)g(this.leftPad),g(this.separator);for(let y=0;y<d-1;++y)g(e[h+y]),g(this.separator);if(d>0){g(e[h+d-1]);for(let y=0;y<u;++y)g(this.separator),g(this.rightPad)}else{for(let y=0;y<u-1;++y)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<s;++c){let u=n[c]>=l;if(u=u&&n[c]<=r,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${r}]`);l=n[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=_t("int32",s);if(r===0||s===0){const l=new Array(r);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function oU(t,e,n,r,s,i,o,a){return new B0e(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function aU(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let h=0;h<r;++h){const f=s.length;W0e(t[h],e,n,s);const p=s.length-f;a[h]=p,i+=p,o=Math.max(o,p)}const l=_t("int32",i*2),c=new Array(i),u=[r,o];let d=0;for(let h=0;h<r;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=s[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lU(t,e){const n=_t("int32",t.length);for(let r=0;r<t.length;++r)n[r]=Coe(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cU=zt((t,e)=>t-e),U0e=nN((t,e,n,r)=>({real:t-n,imag:e-r})),aN=rn(Zf,cU,U0e),V0e={kernelName:Zf,backendName:"cpu",kernelFunc:aN};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=_e(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Od=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function dU(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(r,Math.floor(e+(a-l)*u/a+d));dU(t,e,h,f)}const s=t[e];let i=n,o=r;for(lc(t,n,e),Od(t[r],s)>0&&lc(t,n,r);i<o;){for(lc(t,i,o),i++,o--;Od(t[i],s)<0;)i=i+1;for(;Od(t[o],s)>0;)o=o-1}Od(t[n],s)===0?lc(t,n,o):(o=o+1,lc(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function hU(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Rn(n,o*r),c=Rn("int32",o*r);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((y,b)=>p[b]={value:y,index:b}),r<p.length&&(dU(p,r),p=p.slice(0,r)),s&&p.sort(Od);const m=d*r,x=l.subarray(m,m+r),g=c.subarray(m,m+r);for(let y=0;y<r;y++)x[y]=p[y].value,g[y]=p[y].index}const u=e.slice();return u[u.length-1]=r,[_e(u,n,l),_e(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e,n,r){const s=Me(e,n)[0],i=[1,n[0],1];for(let p=0;p<s;p++)i[0]*=n[p];i[1]=n[s];for(let p=s+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[s]),l=new vn(i,r,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[s];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let y=0;y<i[0];y++)for(let b=0;b<i[2];b++)g.push(l.get(y,p,b));m=g.join(",")}const x=o.get(m);if(x!=null)a[p]=x;else{const g=o.size;o.set(m,g),a[p]=g,c.push(p)}}const d=i.slice();d[1]=o.size;const h=new vn(d,r);c.forEach((p,m)=>{for(let x=0;x<i[0];x++)for(let g=0;g<i[2];g++)h.set(l.get(x,p,g),x,m,g)});const f=n.slice();return f[s]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G0e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:kW,bincountImpl:rN,bincountReduceImpl:CW,bitwiseAndImpl:SW,castImpl:wW,ceilImpl:IW,concatImpl:NW,equalImpl:$W,expImpl:TW,expm1Impl:DW,floorDivImpl:RW,floorImpl:OW,gatherNdImpl:PW,gatherV2Impl:_W,greaterEqualImpl:FW,greaterImpl:MW,lessEqualImpl:jW,lessImpl:LW,linSpaceImpl:zW,logImpl:BW,maxImpl:WW,maximumImpl:UW,minimumImpl:VW,multiplyImpl:sN,negImpl:GW,notEqualImpl:HW,prodImpl:KW,raggedGatherImpl:qW,raggedRangeImpl:XW,raggedTensorToTensorImpl:YW,rangeImpl:QW,rsqrtImpl:ZW,scatterImpl:Za,sigmoidImpl:D0e,simpleAbsImpl:bW,sliceImpl:eU,sparseFillEmptyRowsImpl:tU,sparseReshapeImpl:nU,sparseSegmentReductionImpl:oN,sqrtImpl:P0e,squaredDifferenceImpl:rU,staticRegexReplaceImpl:sU,stridedSliceImpl:iU,stringNGramsImpl:oU,stringSplitImpl:aU,stringToHashBucketFastImpl:lU,subImpl:cU,tileImpl:uU,topKImpl:hU,transposeImpl:iN,uniqueImpl:fU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dj("cpu",()=>new Xy,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pU=et(wf,t=>t>=0?t:Math.exp(t)-1),H0e={kernelName:wf,backendName:"cpu",kernelFunc:pU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r;xe([s],"leakyRelu");const o=Q(s.shape),a=n.data.get(s.dataId).values,l=Rn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(s.shape,"float32",l)}const K0e={kernelName:Hx,backendName:"cpu",kernelFunc:mU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=zt((t,e)=>t<0?e*t:t);function gU(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;xe([r,s],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,[a,l]=q0e(r.shape,s.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const X0e={kernelName:dy,backendName:"cpu",kernelFunc:gU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xU=et(zf,t=>Math.max(0,t)),Y0e={kernelName:zf,backendName:"cpu",kernelFunc:xU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yU=et(Bf,t=>Math.min(Math.max(0,t),6)),Q0e={kernelName:Bf,backendName:"cpu",kernelFunc:yU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0(t,e,n,r,s){if(n==="linear")return $i({inputs:{x:e},backend:t});if(n==="relu")return xU({inputs:{x:e},backend:t});if(n==="elu")return pU({inputs:{x:e},backend:t});if(n==="relu6")return yU({inputs:{x:e},backend:t});if(n==="prelu")return gU({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return mU({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return JW({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ft(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=Q(s.shape),a=ML(i,o),l=Q(a);T(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const c=n.data.get(s.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const Z0e={kernelName:fy,backendName:"cpu",kernelFunc:ft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;xe([s,i],"matMul");const l=s.shape.length,c=i.shape.length,u=o?s.shape[l-2]:s.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?s.shape[l-1]:s.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=s.shape.slice(0,-2),m=i.shape.slice(0,-2),x=Q(p),g=Q(m),b=Ae(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const w=o?[x,u,h]:[x,h,u],k=a?[g,f,d]:[g,d,f],C=ft({inputs:{x:s},backend:n,attrs:{shape:w}}),S=ft({inputs:{x:i},backend:n,attrs:{shape:k}}),I=o?C.shape[1]:C.shape[2],$=o?C.shape[2]:C.shape[1],E=a?S.shape[1]:S.shape[2],A=Math.max(x,g),D=n.data.get(C.dataId).values,P=n.data.get(S.dataId).values,O=ve(C.shape),F=ve(S.shape),[U,V,_]=o?[O[0],1,O[1]]:[O[0],O[1],1],[z,K,Z]=a?[1,F[1],F[0]]:[F[1],1,F[0]],q=$*E,te=_e([A,$,E],C.dtype),ie=te.values,oe=n.blockSize;for(let le=0;le<A;le++){const ge=le%x,ke=le%g;for(let ee=0;ee<$;ee+=oe){const ue=Math.min(ee+oe,$);for(let de=0;de<E;de+=oe){const J=Math.min(de+oe,E);for(let Oe=0;Oe<I;Oe+=oe){const Ie=Math.min(Oe+oe,I);for(let Pe=ee;Pe<ue;Pe++)for(let De=de;De<J;De++){let Ke=0;for(let it=Oe;it<Ie;it++){const Di=D[ge*U+Pe*V+it*_],pn=P[it*z+De*K+ke*Z];Ke+=Di*pn}ie[le*q+(Pe*E+De)]+=Ke}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(b,te.dtype,te.values)}const J0e={kernelName:Dx,backendName:"cpu",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function exe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;let h,f,p;const m=[];h=vU({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=vu({inputs:{a:h,b:o},backend:n}),m.push(h),h=f),u&&(p=s0(n,h,u,a,d),m.push(h),h=p);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}const txe={kernelName:Fg,backendName:"cpu",kernelFunc:exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nxe=et(lf,t=>Math.acos(t)),rxe={kernelName:lf,backendName:"cpu",kernelFunc:nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sxe=et(cf,t=>Math.acosh(t)),ixe={kernelName:cf,backendName:"cpu",kernelFunc:sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oxe(t){const{inputs:e,backend:n}=t,r=e;xe(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),i=_e(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const axe={kernelName:FS,backendName:"cpu",kernelFunc:oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;xe(s,"all");const a=Me(i,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Lt(l.length,s.shape.length)),Sn("all",l,u.shape.length);const[d,h]=fn(u.shape,l),f=Q(h),p=Pn(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let w=0;w<f;++w){const k=m[y+w];b=b&&k}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(o){const g=Ut(d,a),y=ft({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const cxe={kernelName:LS,backendName:"cpu",kernelFunc:lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;xe(s,"any");const a=Me(i,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Lt(l.length,s.shape.length)),Sn("any",l,u.shape.length);const[d,h]=fn(u.shape,l),f=Q(h),p=Pn(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let w=0;w<f;++w){const k=m[y+w];b=b||k}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(o){const g=Ut(d,a),y=ft({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const dxe={kernelName:jS,backendName:"cpu",kernelFunc:uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;xe(s,"argMax");let o=Me(i,s.shape);const a=Et(o,s.shape.length);let l=s;const c=[];a!=null&&(l=cr({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),o=Lt(o.length,l.shape.length)),o=[o[0]],Sn("argMax",o,l.shape.length);const[u,d]=fn(l.shape,o),h=Q(u),f=Pn(h,"int32"),p=Q(d),m=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const g=x*p;let y=m[g],b=0;for(let w=0;w<p;++w){const k=m[g+w];k>y&&(y=k,b=w)}f[x]=b}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(u,"int32",f)}const fxe={kernelName:$x,backendName:"cpu",kernelFunc:hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;xe(s,"argMin");let o=Me(i,s.shape);const a=Et(o,s.shape.length);let l=s;const c=[];a!=null&&(l=cr({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),o=Lt(o.length,l.shape.length)),o=[o[0]],Sn("argMin",o,l.shape.length);const[u,d]=fn(l.shape,o),h=Q(u),f=Pn(h,"int32"),p=Q(d),m=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const g=x*p;let y=m[g],b=0;for(let w=0;w<p;++w){const k=m[g+w];k<y&&(y=k,b=w)}f[x]=b}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(u,"int32",f)}const mxe={kernelName:Ex,backendName:"cpu",kernelFunc:pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gxe=et(uf,t=>Math.asin(t)),xxe={kernelName:uf,backendName:"cpu",kernelFunc:gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxe=et(df,t=>Math.asinh(t)),vxe={kernelName:df,backendName:"cpu",kernelFunc:yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bxe=et(hf,t=>Math.atan(t)),wxe={kernelName:hf,backendName:"cpu",kernelFunc:bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe=zt((t,e)=>Math.atan2(t,e)),Cxe=rn(pf,kxe),Sxe={kernelName:pf,backendName:"cpu",kernelFunc:Cxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ixe=et(ff,t=>Math.atanh(t)),Nxe={kernelName:ff,backendName:"cpu",kernelFunc:Ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(t,e,n,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,f=s.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=_e(s.outShape,n),x=m.values,g=s.outShape[1]*s.outShape[2]*s.outShape[3],y=s.outShape[2]*s.outShape[3],b=s.outShape[3];for(let w=0;w<s.batchSize;++w){const k=w*g,C=w*r[0];for(let S=0;S<s.inChannels;++S)for(let I=0;I<s.outHeight;++I){const $=I*o-h,E=Math.max(0,$),A=Math.min(s.inHeight,u+$),D=k+I*y;for(let P=0;P<s.outWidth;++P){const O=P*a-f,F=Math.max(0,O),U=Math.min(s.inWidth,d+O);let V=p,_=0,z=0;for(let Z=E;Z<A;Z+=l){const q=C+Z*r[1];for(let te=F;te<U;te+=c){const ie=q+te*r[2],oe=t[ie+S];i==="max"&&oe>V?V=oe:i==="avg"&&(_+=oe,z++)}if(isNaN(V))break}const K=D+P*b+S;x[K]=i==="avg"?_/z:V}}}return m}function bU(t,e,n,r,s=!1,i=!1){const o=_e(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,m=_e(e,n,t);for(let x=0;x<r.batchSize;++x)for(let g=0;g<r.inChannels;++g)for(let y=0;y<r.outHeight;++y){const b=y*a-f;let w=b;for(;w<0;)w+=c;const k=Math.min(r.inHeight,d+b);for(let C=0;C<r.outWidth;++C){const S=C*l-p;let I=S;for(;I<0;)I+=u;const $=Math.min(r.inWidth,h+S);let E=Number.NEGATIVE_INFINITY,A=-1;for(let D=w;D<k;D+=c){const P=D-b;for(let O=I;O<$;O+=u){const F=O-S,U=m.get(x,D,O,g);U>E&&(E=U,s?A=i?((x*r.inHeight+D)*r.inWidth+O)*r.inChannels+g:(D*r.inWidth+O)*r.inChannels+g:A=P*h+F)}}o.set(A,x,y,C,g)}}return o}function wU(t,e,n,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,c=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,m=s.padInfo.front,x=s.padInfo.top,g=s.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=_e(s.outShape,n),w=b.values,k=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[2]*s.outShape[3]*s.outShape[4],S=s.outShape[3]*s.outShape[4],I=s.outShape[4];for(let $=0;$<s.batchSize;++$){const E=$*k,A=$*r[0];for(let D=0;D<s.inChannels;++D)for(let P=0;P<s.outDepth;++P){const O=P*o-m;let F=O;for(;F<0;)F+=c;const U=Math.min(s.inDepth,h+O),V=E+P*C;for(let _=0;_<s.outHeight;++_){const z=_*a-x;let K=z;for(;K<0;)K+=u;const Z=Math.min(s.inHeight,f+z),q=V+_*S;for(let te=0;te<s.outWidth;++te){const ie=te*l-g;let oe=ie;for(;oe<0;)oe+=d;const le=Math.min(s.inWidth,p+ie),ge=q+te*I;let ke=y,ee=0,ue=0;for(let J=F;J<U;J+=c){const Oe=A+J*r[1];for(let Ie=K;Ie<Z;Ie+=u){const Pe=Oe+Ie*r[2];for(let De=oe;De<le;De+=d){const Ke=Pe+De*r[3],it=t[Ke+D];if(i==="max"&&it>ke?ke=it:i==="avg"&&(ee+=it,ue++),isNaN(ke))break}if(isNaN(ke))break}if(isNaN(ke))break}const de=ge+D;w[de]=i==="avg"?ee/Math.max(ue,1):ke}}}}return b}function $xe(t,e){const n=_e(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let x=0;x<e.inChannels;++x)for(let g=0;g<e.outDepth;++g){const y=g*r-h;let b=y;for(;b<0;)b+=o;const w=Math.min(e.inDepth,c+y);for(let k=0;k<e.outHeight;++k){const C=k*s-f;let S=C;for(;S<0;)S+=a;const I=Math.min(e.inHeight,u+C);for(let $=0;$<e.outWidth;++$){const E=$*i-p;let A=E;for(;A<0;)A+=l;const D=Math.min(e.inWidth,d+E);let P=Number.NEGATIVE_INFINITY,O=-1;for(let F=b;F<w;F+=o){const U=F-y;for(let V=S;V<I;V+=a){const _=V-C;for(let z=A;z<D;z+=l){const K=z-E,Z=t.get(m,F,V,z,x);Z>=P&&(P=Z,O=U*u*d+_*u+K)}}}n.set(O,m,g,k,$,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;xe(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=1;T(Mn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=$s(s.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))d=$i({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,f=ve(s.shape),p=lN(h,s.shape,s.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,s.dtype,p.values)}return d}const Txe={kernelName:Tx,backendName:"cpu",kernelFunc:Exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Axe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=r;xe(s,"avgPool3d");const u=mo(s.shape,i,o,1,a,l,c),d=n.data.get(s.dataId).values,h=wU(d,s.shape,s.dtype,ve(s.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const Dxe={kernelName:Ax,backendName:"cpu",kernelFunc:Axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=r;xe([s,i],"avgPool3DGrad");const u=mo(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,x=u.filterWidth,g=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,w=u.effectiveFilterDepth,k=u.effectiveFilterHeight,C=u.effectiveFilterWidth,S=w-1-u.padInfo.front,I=C-1-u.padInfo.left,$=k-1-u.padInfo.top,E=_e(i.shape,"float32"),A=1/(p*m*x),D=n.bufferSync(s);for(let P=0;P<u.batchSize;++P)for(let O=0;O<u.inChannels;++O)for(let F=0;F<u.inDepth;++F)for(let U=0;U<u.inHeight;++U)for(let V=0;V<u.inWidth;++V){const _=F-S,z=U-$,K=V-I;let Z=0;for(let q=0;q<w;q+=g){const te=(_+q)/d;if(!(te<0||te>=u.outDepth||Math.floor(te)!==te))for(let ie=0;ie<k;ie+=y){const oe=(z+ie)/h;if(!(oe<0||oe>=u.outHeight||Math.floor(oe)!==oe))for(let le=0;le<C;le+=b){const ge=(K+le)/f;if(ge<0||ge>=u.outWidth||Math.floor(ge)!==ge)continue;const ke=D.get(P,te,oe,ge,O);Z+=ke}}}E.set(Z*A,P,F,U,V,O)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Rxe={kernelName:BS,backendName:"cpu",kernelFunc:Oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;xe([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=$s(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,x=u.dilationWidth,g=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,w=g-1-u.padInfo.top,k=_e(o.shape,"float32"),C=1/(f*p),S=n.data.get(s.dataId).values,I=_e(s.shape,"float32",S);for(let $=0;$<u.batchSize;++$)for(let E=0;E<u.inChannels;++E)for(let A=0;A<u.inHeight;++A)for(let D=0;D<u.inWidth;++D){const P=A-w,O=D-b;let F=0;for(let U=0;U<g;U+=m){const V=(P+U)/d;if(!(V<0||V>=u.outHeight||Math.floor(V)!==V))for(let _=0;_<y;_+=x){const z=(O+_)/h;if(z<0||z>=u.outWidth||Math.floor(z)!==z)continue;const K=I.get($,V,z,E);F+=K}}k.set(F*C,$,A,D,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const _xe={kernelName:zS,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:i,offset:o,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),xe([s,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const u=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),x=p.length,g=f.length,y=h.length,b=d.length;let w=0,k=0,C=0,S=0;for(let I=0;I<u.length;++I)m[I]=p[w++]+(u[I]-d[k++])*f[C++]/Math.sqrt(h[S++]+c),w>=x&&(w=0),k>=b&&(k=0),C>=g&&(C=0),S>=y&&(S=0);return n.makeTensorInfo(s.shape,s.dtype,m)}const Fxe={kernelName:Ux,backendName:"cpu",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;xe([s],"batchToSpaceND");const a=i.reduce((g,y)=>g*y),l=lp(s.shape,i,a),c=cp(l.length,i.length),u=up(s.shape,i,a),d=yI(o,i.length),h=vI(u,o,i.length),f=ft({inputs:{x:s},backend:n,attrs:{shape:l}}),p=cr({inputs:{x:f},backend:n,attrs:{perm:c}}),m=ft({inputs:{x:p},backend:n,attrs:{shape:u}}),x=Al({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const jxe={kernelName:Ox,backendName:"cpu",kernelFunc:Lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,c=rN(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Bxe={kernelName:WS,backendName:"cpu",kernelFunc:zxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=Ae(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Uxe={kernelName:WL,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vxe=et(xf,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Gxe={kernelName:xf,backendName:"cpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hxe=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Q(e.shape)),s=n.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];r[c]=Math.hypot(u,d)}return n.makeOutput(r,e.shape,"float32")},Kxe={kernelName:Rx,backendName:"cpu",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bu(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const qxe={kernelName:o2,backendName:"cpu",kernelFunc:bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wu(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Me(s,e[0].shape)[0],o=e.map(m=>m.shape);mI(o,i);let a=yi(e.map(m=>m.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>Q(m.shape)>0);if(l.length===1)return $i({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(w=>Tl({inputs:{input:w},backend:n})),x=l.map(w=>bu({inputs:{input:w},backend:n})),g=wu({inputs:m,backend:n,attrs:{axis:i}}),y=wu({inputs:x,backend:n,attrs:{axis:i}}),b=xr({inputs:{real:g,imag:y},backend:n});return m.forEach(w=>n.disposeIntermediateTensorInfo(w)),x.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const c=l.map(m=>{const g=[-1,Q(m.shape.slice(i))];return ft({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=yi(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=NW(u,a,e[0].dtype,d),f=yi(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Xxe={kernelName:Px,backendName:"cpu",kernelFunc:wu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r;xe([s,i],"conv2d");const d=go(l),h=Cn(s.shape,i.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,x=h.dilationWidth,g=h.padInfo.left,y=h.padInfo.top,b=h.dataFormat==="channelsLast",w=new vn(h.outShape,s.dtype),k=ve(s.shape),C=ve(i.shape),S=k[0],I=b?k[1]:k[2],$=b?k[2]:1,E=b?1:k[1],A=w.strides[0],D=b?w.strides[1]:w.strides[2],P=b?w.strides[2]:1,O=b?1:w.strides[1],F=n.data.get(s.dataId).values,U=n.data.get(i.dataId).values,V=w.values;for(let _=0;_<h.batchSize;++_){const z=_*S,K=_*A;for(let Z=0;Z<h.outHeight;++Z){const q=K+Z*D,te=Z*h.strideHeight-y;for(let ie=0;ie<f;++ie){const oe=te+ie*m;if(oe<0||oe>=h.inHeight)continue;const le=ie*C[0],ge=z+oe*I;for(let ke=0;ke<h.outWidth;++ke){const ee=q+ke*P,ue=ke*h.strideWidth-g;for(let de=0;de<p;++de){const J=ue+de*x;if(J<0||J>=h.inWidth)continue;const Oe=le+de*C[1],Ie=ge+J*$;let Pe=Oe;for(let De=0;De<h.inChannels;++De){const Ke=F[Ie+De*E];for(let it=0;it<h.outChannels;++it)V[ee+it*O]+=Ke*U[Pe+it];Pe+=h.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,V)}const Yxe={kernelName:_x,backendName:"cpu",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;xe([s,i],"conv2dBackpropFilter");const d=go(l),h=Cn(s.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:x}=h,g=h.dataFormat==="channelsLast",y=new vn(h.filterShape,"float32"),b=h.padInfo.left,w=h.padInfo.top,k=n.data.get(s.dataId).values,C=n.data.get(i.dataId).values,S=new vn(s.shape,s.dtype,k),I=new vn(i.shape,i.dtype,C);for(let $=0;$<m;++$){const E=Math.max(0,Math.ceil((w-$)/f)),A=Math.min(h.outHeight,(h.inHeight+w-$)/f);for(let D=0;D<x;++D){const P=Math.max(0,Math.ceil((b-D)/p)),O=Math.min(h.outWidth,(h.inWidth+b-D)/p);for(let F=0;F<h.inChannels;++F)for(let U=0;U<h.outChannels;++U){let V=0;for(let _=0;_<h.batchSize;++_)for(let z=E;z<A;++z){const K=$+z*f-w;for(let Z=P;Z<O;++Z){const q=D+Z*p-b;g?V+=S.get(_,K,q,F)*I.get(_,z,Z,U):V+=S.get(_,F,K,q)*I.get(_,U,z,Z)}}y.set(V,$,D,F,U)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Zxe={kernelName:GS,backendName:"cpu",kernelFunc:Qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r;xe([s,i],"conv2dBackpropInput");const d=ve(i.shape),h=ve(s.shape);let f=go(c);const p=Cn(o,i.shape,a,1,l,u,!1,f),m=new vn(p.inShape,"float32"),x=m.values,g=n.data.get(s.dataId).values,y=n.data.get(i.dataId).values,[b,w,k]=d,{batchSize:C,filterHeight:S,filterWidth:I,inChannels:$,inHeight:E,inWidth:A,outChannels:D,outHeight:P,outWidth:O,strideHeight:F,strideWidth:U}=p;f=p.dataFormat;const V=S-1-p.padInfo.top,_=I-1-p.padInfo.left,z=f==="channelsLast",K=m.strides[0],Z=z?m.strides[1]:m.strides[2],q=z?m.strides[2]:1,te=z?1:m.strides[1],ie=h[0],oe=z?h[1]:h[2],le=z?h[2]:1,ge=z?1:h[1];for(let ke=0;ke<C;++ke)for(let ee=0;ee<$;++ee)for(let ue=0;ue<E;++ue){const de=ue-V,J=Math.max(0,Math.ceil(de/F)),Oe=Math.min(P,(S+de)/F);for(let Ie=0;Ie<A;++Ie){const Pe=Ie-_,De=Math.max(0,Math.ceil(Pe/U)),Ke=Math.min(O,(I+Pe)/U);let it=0;for(let pn=J;pn<Oe;++pn){const yo=pn*F-de;for(let Tr=De;Tr<Ke;++Tr){const Ta=Tr*U-Pe,As=ie*ke+oe*pn+le*Tr,Oi=b*(S-1-yo)+w*(I-1-Ta)+k*ee;for(let vo=0;vo<D;++vo){const bo=g[As+ge*vo],wo=y[Oi+vo];it+=bo*wo}}}const Di=K*ke+Z*ue+q*Ie+te*ee;x[Di]=it}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const eye={kernelName:Mx,backendName:"cpu",kernelFunc:Jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;xe([s,i],"conv3d");const c=wa(s.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:x}=c,g=x.front,y=x.left,b=x.top,w=new vn(c.outShape,s.dtype),k=n.data.get(s.dataId).values,C=n.data.get(i.dataId).values,S=w.values,I=ve(s.shape),$=ve(i.shape);for(let E=0;E<c.batchSize;++E){const A=E*I[0],D=E*w.strides[0];for(let P=0;P<c.outDepth;++P){const O=D+P*w.strides[1],F=P*c.strideDepth-g;for(let U=0;U<u;++U){const V=F+U*f;if(V<0||V>=c.inDepth)continue;const _=U*$[0],z=A+V*I[1];for(let K=0;K<c.outHeight;++K){const Z=O+K*w.strides[2],q=K*c.strideHeight-b;for(let te=0;te<d;++te){const ie=q+te*p;if(ie<0||ie>=c.inHeight)continue;const oe=_+te*$[1],le=z+ie*I[2];for(let ge=0;ge<c.outWidth;++ge){const ke=Z+ge*c.outChannels,ee=ge*c.strideWidth-y;for(let ue=0;ue<h;++ue){const de=ee+ue*m;if(de<0||de>=c.inWidth)continue;const J=oe+ue*$[2],Oe=le+de*c.inChannels;let Ie=J;for(let Pe=0;Pe<c.inChannels;++Pe){const De=k[Oe+Pe];for(let Ke=0;Ke<c.outChannels;++Ke)S[ke+Ke]+=De*C[Ie+Ke];Ie+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const nye={kernelName:Fx,backendName:"cpu",kernelFunc:tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;xe([s,i],"conv3dBackpropFilterV2");const c=ve(s.shape),u=ve(i.shape),d=wa(s.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,x=d.filterHeight,g=d.filterWidth,y=new vn(d.filterShape,"float32"),b=y.values,[w,k,C,S]=y.strides,I=n.data.get(i.dataId).values,[$,E,A,D]=u,P=n.data.get(s.dataId).values,[O,F,U,V]=c,_=d.padInfo.front,z=d.padInfo.left,K=d.padInfo.top;for(let Z=0;Z<m;++Z){const q=Math.max(0,Math.ceil((_-Z)/h)),te=Math.min(d.outDepth,(d.inDepth+_-Z)/h),ie=Z*w;for(let oe=0;oe<x;++oe){const le=Math.max(0,Math.ceil((K-oe)/f)),ge=Math.min(d.outHeight,(d.inHeight+K-oe)/f),ke=oe*k+ie;for(let ee=0;ee<g;++ee){const ue=Math.max(0,Math.ceil((z-ee)/p)),de=Math.min(d.outWidth,(d.inWidth+z-ee)/p),J=ee*C+ke;for(let Oe=0;Oe<d.inChannels;++Oe){const Ie=Oe*S+J;for(let Pe=0;Pe<d.outChannels;++Pe){let De=0;for(let Ke=0;Ke<d.batchSize;++Ke){const it=Ke*O,Di=Ke*$;for(let pn=q;pn<te;++pn){const Tr=(Z+pn*h-_)*F+it,Ta=pn*E+Di;for(let As=le;As<ge;++As){const vo=(oe+As*f-K)*U+Tr,bo=As*A+Ta;for(let wo=ue;wo<de;++wo){const nv=(ee+wo*p-z)*V+vo,rv=wo*D+bo;De+=P[nv+Oe]*I[rv+Pe]}}}}b[Ie+Pe]=De}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const sye={kernelName:HS,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;xe([s],"conv3dBackpropInputV2");const c=ve(s.shape),u=ve(i.shape),d=wa(l,i.shape,a,1,o),h=new vn(d.inShape,"float32"),f=h.values,[p,m,x,g]=h.strides,y=n.data.get(s.dataId).values,[b,w,k,C]=c,S=n.data.get(i.dataId).values,[I,$,E,A]=u,{batchSize:D,filterDepth:P,filterHeight:O,filterWidth:F,inChannels:U,inDepth:V,inHeight:_,inWidth:z,outChannels:K,outDepth:Z,outHeight:q,outWidth:te,strideDepth:ie,strideHeight:oe,strideWidth:le}=d,ge=P-1-d.padInfo.front,ke=O-1-d.padInfo.top,ee=F-1-d.padInfo.left;for(let ue=0;ue<D;++ue)for(let de=0;de<U;++de)for(let J=0;J<V;++J){const Oe=J-ge,Ie=Math.max(0,Math.ceil(Oe/ie)),Pe=Math.min(Z,(P+Oe)/ie);for(let De=0;De<_;++De){const Ke=De-ke,it=Math.max(0,Math.ceil(Ke/oe)),Di=Math.min(q,(O+Ke)/oe);for(let pn=0;pn<z;++pn){const yo=pn-ee,Tr=Math.max(0,Math.ceil(yo/le)),Ta=Math.min(te,(F+yo)/le);let As=0;for(let Oi=Ie;Oi<Pe;++Oi){const vo=Oi*ie-Oe;for(let bo=it;bo<Di;++bo){const wo=bo*oe-Ke;for(let Ju=Tr;Ju<Ta;++Ju){const nv=Ju*le-yo,rv=b*ue+w*Oi+k*bo+C*Ju,wV=I*(P-1-vo)+$*(O-1-wo)+E*(F-1-nv)+A*de;for(let Ip=0;Ip<K;++Ip){const kV=y[rv+Ip],CV=S[wV+Ip];As+=kV*CV}}}}f[p*ue+m*J+x*De+g*pn+de]=As}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const oye={kernelName:KS,backendName:"cpu",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye=et(yf,t=>Math.cos(t)),lye={kernelName:yf,backendName:"cpu",kernelFunc:aye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=et(vf,t=>Math.cosh(t)),uye={kernelName:vf,backendName:"cpu",kernelFunc:cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dye(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=r,[u,d,h,f]=s.shape,p=i.shape[0],[m,x]=a,g=_e([p,m,x,f],"float32"),y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,w=n.data.get(s.dataId).values,k=ve(s.shape),C=ve(g.shape);for(let S=0;S<p;S++){const I=S*4,$=y[I],E=y[I+1],A=y[I+2],D=y[I+3],P=b[S];if(P>=u)continue;const O=m>1?(A-$)*(d-1)/(m-1):0,F=x>1?(D-E)*(h-1)/(x-1):0;for(let U=0;U<m;U++){const V=m>1?$*(d-1)+U*O:.5*($+A)*(d-1);if(V<0||V>d-1){for(let _=0;_<x;_++)for(let z=0;z<f;z++){const K=z+_*C[2]+U*C[1]+S*C[0];g.values[K]=c}continue}if(l==="bilinear"){const _=Math.floor(V),z=Math.ceil(V),K=V-_;for(let Z=0;Z<x;Z++){const q=x>1?E*(h-1)+Z*F:.5*(E+D)*(h-1);if(q<0||q>h-1){for(let le=0;le<f;le++){const ge=le+Z*C[2]+U*C[1]+S*C[0];g.values[ge]=c}continue}const te=Math.floor(q),ie=Math.ceil(q),oe=q-te;for(let le=0;le<f;le++){let ge=le+te*k[2]+_*k[1]+P*k[0];const ke=w[ge];ge=le+ie*k[2]+_*k[1]+P*k[0];const ee=w[ge];ge=le+te*k[2]+z*k[1]+P*k[0];const ue=w[ge];ge=le+ie*k[2]+z*k[1]+P*k[0];const de=w[ge],J=ke+(ee-ke)*oe,Oe=ue+(de-ue)*oe;ge=le+Z*C[2]+U*C[1]+S*C[0],g.values[ge]=J+(Oe-J)*K}}}else for(let _=0;_<x;++_){const z=x>1?E*(h-1)+_*F:.5*(E+D)*(h-1);if(z<0||z>h-1){for(let q=0;q<f;q++){const te=q+_*C[2]+U*C[1]+S*C[0];g.values[te]=c}continue}const K=Math.round(z),Z=Math.round(V);for(let q=0;q<f;q++){const te=q+K*k[2]+Z*k[1]+P*k[0],ie=q+_*C[2]+U*C[1]+S*C[0];g.values[ie]=w[te]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const hye={kernelName:XS,backendName:"cpu",kernelFunc:dye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;xe(s,"cumprod");const l=Et([i],s.shape.length);let c=s;l!=null&&(c=cr({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=Lt(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Ir(c.dtype,"int32"),h=PS(Q(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,y)=>g+p-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=p)for(let y=0;y<p;y++){const b=m(g,y);if(y===0)h[b]=o?1:f[b];else{const w=m(g,y-1);h[b]=o?f[w]*h[w]:f[b]*h[w]}}const x=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=ka(l),y=cr({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),y}return x}const pye={kernelName:qS,backendName:"cpu",kernelFunc:fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;xe(s,"cumsum");const l=Et([i],s.shape.length);let c=s;l!=null&&(c=cr({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=Lt(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Ir(c.dtype,"int32"),h=Pn(Q(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,y)=>g+p-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=p)for(let y=0;y<p;y++){const b=m(g,y);if(y===0)h[b]=o?0:f[b];else{const w=m(g,y-1);h[b]=o?f[w]+h[w]:f[b]+h[w]}}const x=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=ka(l),y=cr({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),y}return x}const gye={kernelName:Lx,backendName:"cpu",kernelFunc:mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,u=rN(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(s.shape.length===2){const l=n.bufferSync(s),c=n.bufferSync(i),u=CW(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const yye={kernelName:YS,backendName:"cpu",kernelFunc:xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r;T(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],c=s.shape[2],u=s.shape[3],d=l*i,h=c*i,f=u/(i*i),p=n.data.get(s.dataId).values,m=new Float32Array(a*d*h*f);let x=0;for(let g=0;g<a;++g)for(let y=0;y<d;++y){const b=Math.floor(y/i),w=y%i;for(let k=0;k<h;++k){const C=Math.floor(k/i),S=k%i,I=(w*i+S)*f;for(let $=0;$<f;++$){const A=$+I+u*(C+c*(b+l*g));m[x++]=p[A]}}}return n.makeTensorInfo([a,d,h,f],s.dtype,m)}const bye={kernelName:QS,backendName:"cpu",kernelFunc:vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=r;xe([s,i],"depthwiseConv2DNative");const u=ve(s.shape),d=ve(i.shape);let h=l;h==null&&(h=[1,1]),T(Mn(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Cn(s.shape,i.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:x,dilationWidth:g,padInfo:y}=f,b=y.left,w=y.top,k=f.outChannels/f.inChannels,C=new vn(f.outShape,s.dtype),S=n.data.get(s.dataId).values,I=n.data.get(i.dataId).values,$=C.values;for(let E=0;E<f.batchSize;++E){const A=E*u[0],D=E*C.strides[0];for(let P=0;P<f.outHeight;++P){const O=D+P*C.strides[1],F=P*f.strideHeight-w;for(let U=0;U<p;++U){const V=F+U*x;if(V<0||V>=f.inHeight)continue;const _=U*d[0],z=A+V*u[1];for(let K=0;K<f.outWidth;++K){const Z=O+K*C.strides[2],q=K*f.strideWidth-b;for(let te=0;te<m;++te){const ie=q+te*g;if(ie<0||ie>=f.inWidth)continue;const oe=_+te*d[1],le=z+ie*f.inChannels;let ge=Z,ke=oe;for(let ee=0;ee<f.inChannels;++ee){const ue=S[le+ee];for(let de=0;de<k;++de)$[ge+de]+=ue*I[ke+de];ge+=k,ke+=k}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const wye={kernelName:jx,backendName:"cpu",kernelFunc:CU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r;xe([s,i],"depthwiseConv2dNativeBackpropFilter");const d=Cn(s.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,x=new vn(d.filterShape,"float32"),g=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,w=n.data.get(s.dataId).values,k=new vn(s.shape,s.dtype,w),C=n.data.get(i.dataId).values,S=new vn(i.shape,i.dtype,C);for(let I=0;I<p;++I){const $=Math.max(0,Math.ceil((y-I)/h)),E=Math.min(d.outHeight,(d.inHeight+y-I)/h);for(let A=0;A<m;++A){const D=Math.max(0,Math.ceil((g-A)/f)),P=Math.min(d.outWidth,(d.inWidth+g-A)/f);for(let O=0;O<d.outChannels;++O){const F=Math.trunc(O/b),U=O%b;let V=0;for(let _=0;_<d.batchSize;++_)for(let z=$;z<E;++z){const K=I+z*h-y;for(let Z=D;Z<P;++Z){const q=A+Z*f-g;V+=k.get(_,K,q,F)*S.get(_,z,Z,O)}}x.set(V,I,A,F,U)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Cye={kernelName:ZS,backendName:"cpu",kernelFunc:kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r;xe([s,i],"depthwiseConv2DNativeBackpropInput");const d=ve(s.shape),h=ve(i.shape),f=Cn(u,i.shape,o,a,l,c,!0),p=new vn(f.inShape,"float32"),m=p.values,[x,g,y]=p.strides,b=n.data.get(s.dataId).values,[w,k,C]=d,S=n.data.get(i.dataId).values,[I,$,E]=h,{batchSize:A,filterHeight:D,filterWidth:P,inChannels:O,inHeight:F,inWidth:U,outChannels:V,outHeight:_,outWidth:z,strideHeight:K,strideWidth:Z}=f,q=D-1-f.padInfo.top,te=P-1-f.padInfo.left,ie=V/O;for(let oe=0;oe<A;++oe)for(let le=0;le<O;++le)for(let ge=0;ge<F;++ge){const ke=ge-q,ee=Math.max(0,Math.ceil(ke/K)),ue=Math.min(_,(D+ke)/K);for(let de=0;de<U;++de){const J=de-te,Oe=Math.max(0,Math.ceil(J/Z)),Ie=Math.min(z,(P+J)/Z);let Pe=0;for(let De=ee;De<ue;++De){const Ke=De*K-ke;for(let it=Oe;it<Ie;++it){const Di=it*Z-J,pn=w*oe+k*De+C*it,yo=I*(D-1-Ke)+$*(P-1-Di)+E*le;for(let Tr=0;Tr<ie;++Tr){const Ta=le*ie+Tr,As=b[pn+Ta],Oi=S[yo+Tr];Pe+=As*Oi}}}m[x*oe+g*ge+y*de+le]=Pe}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Iye={kernelName:JS,backendName:"cpu",kernelFunc:Sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nye(t){const{inputs:e,backend:n}=t,{x:r}=e,s=Q(r.shape),i=n.data.get(r.dataId).values,o=_e([s,s],r.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*s+c]=i[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const $ye={kernelName:UL,backendName:"cpu",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eye={kernelName:zx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(s.dataId).values,h=s.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:x,outHeight:g,outWidth:y,padInfo:b,strideHeight:w,strideWidth:k,filterHeight:C,filterWidth:S,dilationHeight:I,dilationWidth:$,outShape:E}=rp(r.shape,s.shape,i,o,"NHWC",a),A=Q(E),D=E.length,P=_t(r.dtype,A);for(let F=0;F<f;++F)for(let U=0;U<g;++U){const V=U*w-b.top;for(let _=0;_<y;++_){const z=_*k-b.left;for(let K=0;K<x;++K){let Z=Number.MIN_SAFE_INTEGER;for(let te=0;te<C;++te){const ie=V+te*I;if(ie>=0&&ie<p)for(let oe=0;oe<S;++oe){const le=z+oe*$;if(le>=0&&le<m){const ge=gi([F,ie,le,K],u,ve(r.shape)),ke=gi([te,oe,K],h,ve(s.shape)),ee=c[ge]+d[ke];ee>Z&&(Z=ee)}}}const q=gi([F,U,_,K],D,ve(E));P[q]=Z}}}return{dataId:l.write(Wl(P,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tye={kernelName:fw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Gs(r.shape,c.data.get(r.dataId).values),d=Gs(s.shape,c.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:w,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:$}=rp(r.shape,s.shape,o,a,"NHWC",l);T(i.rank===$.length,()=>`Error in ${fw}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const E=Gs($,c.data.get(i.dataId).values),A=jL(s.shape,s.dtype);for(let P=0;P<h;++P)for(let O=0;O<x;++O){const F=O*b-y.top;for(let U=0;U<g;++U){const V=U*w-y.left;for(let _=0;_<m;++_){let z=Number.MIN_SAFE_INTEGER,K=0,Z=0;for(let q=0;q<k;++q){const te=F+q*S;if(te>=0&&te<f)for(let ie=0;ie<C;++ie){const oe=V+ie*I;if(oe>=0&&oe<p){const le=u[P][te][oe][_]+d[q][ie][_];le>z&&(z=le,K=q,Z=ie)}}}A[K][Z][_]+=E[P][O][U][_]}}}return{dataId:c.write(Wl(A,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye={kernelName:hw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Gs(r.shape,c.data.get(r.dataId).values),d=Gs(s.shape,c.data.get(s.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:w,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:$}=rp(r.shape,s.shape,o,a,"NHWC",l);T(i.rank===$.length,()=>`Error in ${hw}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const E=Gs($,c.data.get(i.dataId).values),A=jL(r.shape,r.dtype);for(let P=0;P<h;++P)for(let O=0;O<x;++O){const F=O*b-y.top;for(let U=0;U<g;++U){const V=U*w-y.left;for(let _=0;_<m;++_){let z=Number.MIN_SAFE_INTEGER,K=F<0?0:F,Z=V<0?0:V;for(let q=0;q<k;++q){const te=F+q*S;if(te>=0&&te<f)for(let ie=0;ie<C;++ie){const oe=V+ie*I;if(oe>=0&&oe<p){const le=u[P][te][oe][_]+d[q][ie][_];le>z&&(z=le,K=te,Z=oe)}}}A[P][K][Z][_]+=E[P][O][U][_]}}}return{dataId:c.write(Wl(A,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dye(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=s.shape.slice(0,2),p=s.shape.length===2?1:s.shape[2],m=n.data.get(s.dataId).values,x=s.dtype==="float32"?255:1,g=new Uint8ClampedArray(f*h*4);for(let b=0;b<h*f;++b){const w=[0,0,0,255*c];for(let C=0;C<p;C++){const S=m[b*p+C];if(s.dtype==="float32"){if(S<0||S>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${S}.`)}else if(s.dtype==="int32"&&(S<0||S>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${S}.`);p===1?(w[0]=S*x,w[1]=S*x,w[2]=S*x):w[C]=S*x}const k=b*4;g[k+0]=Math.round(w[0]),g[k+1]=Math.round(w[1]),g[k+2]=Math.round(w[2]),g[k+3]=Math.round(w[3])}i.width=f,i.height=h;const y=new ImageData(g,f,h);return d.putImageData(y,0,0),s}const Oye={kernelName:hoe,backendName:"cpu",kernelFunc:Dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;xe(s,"sum");let a;s.dtype==="bool"?a=ca({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=$i({inputs:{x:s},backend:n});const l=a.shape.length,c=Me(i,a.shape),u=Et(c,l);let d=c,h=a;u!=null&&(h=cr({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Lt(d.length,l)),Sn("sum",d,h.shape.length);const[f,p]=fn(h.shape,d),m=Ir(h.dtype,"int32");let x=n0(n,f,m);const g=Q(p),y=n.data.get(x.dataId).values,b=n.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const k=w*g;let C=0;for(let S=0;S<g;++S)C+=b[k+S];y[w]=C}if(o){const w=Ut(x.shape,c),k=x;x=ft({inputs:{x},backend:n,attrs:{shape:w}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),x}const Rye={kernelName:vy,backendName:"cpu",kernelFunc:vp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=$I(s,i.length);TI(o.length,l,i);const{path:c,steps:u}=AI(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const x of u[m]){const{permutationIndices:g,expandDims:y}=EI(f,l[x]);let b;DI(g)?b=i[x]:(b=cr({inputs:{x:i[x]},backend:n,attrs:{perm:g}}),p.push(b));const w=b.shape.slice();for(let k=0;k<y.length;++k)w.splice(y[k],0,1);Qe(b.shape,w)||(b=ft({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),h===null?h=b:(h=Yy({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=vp({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const _ye={kernelName:e2,backendName:"cpu",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;xe([r,s],"eluGrad");const i=new Float32Array(Q(s.shape)),o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(s.shape,"float32",i)}const Fye={kernelName:t2,backendName:"cpu",kernelFunc:Mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye=bI,jye=wI,zye=kI,Bye=CI,Wye=SI,Uye=II,Vye=et(kf,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Lye*n);return e*(1-((((Uye*r+Wye)*r+Bye)*r+zye)*r+jye)*r*Math.exp(-n*n))}),Gye={kernelName:kf,backendName:"cpu",kernelFunc:Vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(T(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),ft({inputs:{x:s},backend:n,attrs:{shape:a}})}const Hye={kernelName:Wx,backendName:"cpu",kernelFunc:i0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kye=zt((t,e)=>t/e),cN=rn(bf,Kye),zw={kernelName:bf,backendName:"cpu",kernelFunc:cN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(t,e,n){const r=t.shape,s=r[0],i=r[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[s,i],u=Q(c),d=Rn("float32",u),h=Rn("float32",u);for(let x=0;x<s;x++){const g=Al({inputs:{x:a},backend:n,attrs:{begin:[x,0],size:[1,i]}}),y=Al({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,i]}}),b=xr({inputs:{real:g,imag:y},backend:n}),{real:w,imag:k}=qye(b,e,n),C=oo(w,k);for(let S=0;S<i;S++){const I=NI(C,S);d[x*i+S]=I.real,h[x*i+S]=I.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=xr({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function qye(t,e,n){const r=Q(t.shape),s=n.data.get(t.dataId),i=n.data.get(s.complexTensorInfos.real.dataId).values,o=n.data.get(s.complexTensorInfos.imag.dataId).values;if(Xye(r)){const a=Bw(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",ba(r,"float32")),h=$i({inputs:{x:d},backend:n}),f=zw.kernelFunc({inputs:{a:c,b:d},backend:n}),p=zw.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,x=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:x}}return a}else{const a=oo(i,o),l=Yye(a,r,e);return F4(l)}}function Xye(t){return(t&t-1)===0}function Bw(t,e,n,r,s){if(n===1)return{real:t,imag:e};const i=oo(t,e),o=n/2,a=L4(i),l=a.real,c=a.imag,u=[l.length],d=s.makeTensorInfo(u,"float32",l),h=s.makeTensorInfo(u,"float32",c),f=xr({inputs:{real:d,imag:h},backend:s}),p=j4(i),m=p.real,x=p.imag,g=[m.length],y=s.makeTensorInfo(g,"float32",m),b=s.makeTensorInfo(g,"float32",x),w=xr({inputs:{real:y,imag:b},backend:s}),k=Bw(l,c,o,r,s),C=k.real,S=k.imag,I=[C.length],$=s.makeTensorInfo(I,"float32",C),E=s.makeTensorInfo(I,"float32",S),A=xr({inputs:{real:$,imag:E},backend:s}),D=Bw(m,x,o,r,s),P=D.real,O=D.imag,F=[P.length],U=s.makeTensorInfo(F,"float32",P),V=s.makeTensorInfo(F,"float32",O),_=xr({inputs:{real:U,imag:V},backend:s}),z=B4(n,r),K=[z.real.length],Z=s.makeTensorInfo(K,"float32",z.real),q=s.makeTensorInfo(K,"float32",z.imag),te=xr({inputs:{real:Z,imag:q},backend:s}),ie=Yy({inputs:{a:te,b:_},backend:s}),oe=vu({inputs:{a:A,b:ie},backend:s}),le=aN({inputs:{a:A,b:ie},backend:s}),ge=Tl({inputs:{input:oe},backend:s}),ke=Tl({inputs:{input:le},backend:s}),ee=bu({inputs:{input:oe},backend:s}),ue=bu({inputs:{input:le},backend:s}),de=wu({inputs:[ge,ke],backend:s,attrs:{axis:0}}),J=wu({inputs:[ee,ue],backend:s,attrs:{axis:0}}),Oe=s.data.get(de.dataId).values,Ie=s.data.get(J.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo($),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(A),s.disposeIntermediateTensorInfo(U),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(q),s.disposeIntermediateTensorInfo(te),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(oe),s.disposeIntermediateTensorInfo(le),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(ee),s.disposeIntermediateTensorInfo(ke),s.disposeIntermediateTensorInfo(ue),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(J),{real:Oe,imag:Ie}}function Yye(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=W4(s*a,e,n),c=NI(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),z4(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qye(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Q(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=ft({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=SU(a,!1,n),c=ft({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Zye={kernelName:n2,backendName:"cpu",kernelFunc:Qye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uN(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:i}=n,o=i||Mu(s),a=_t(o,Q(r));return eve(a,s,o),e.makeTensorInfo(r,o,a)}const Jye={kernelName:r2,backendName:"cpu",kernelFunc:uN};function eve(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tve={kernelName:s2,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,i=Rn(r.dtype,Q(r.shape)),[o,a,l,c]=r.shape,u=s.data.get(r.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let x=0;x<l;x++){const g=x*c;for(let y=0;y<c;y++){const b=Math.round(l-x-1),w=f+m+g+y;let k=u[w];if(b>=0&&b<l){const C=b*c,S=f+m+C+y;k=u[S]}i[w]=k}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let m=kU({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const x=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const g=ft({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=vu({inputs:{a:m,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else m=vu({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(f){const x=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const g=ft({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=s0(n,m,f,g,p),n.disposeIntermediateTensorInfo(g)}else m=s0(n,m,f,a,p);n.disposeIntermediateTensorInfo(x)}return m}const rve={kernelName:Lg,backendName:"cpu",kernelFunc:nve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let m=CU({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const x=m;m=vu({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(f){const x=m;m=s0(n,m,f,a,p),n.disposeIntermediateTensorInfo(x)}return m}const ive={kernelName:lj,backendName:"cpu",kernelFunc:sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=Q(r.shape),o=s.shape,a=o[o.length-1],[l,c,u,d]=cI(r,s);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(s.dataId).values,f=n.bufferSync(r),p=PW(h,f,r.dtype,c,a,u,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,p.values)}const ave={kernelName:VL,backendName:"cpu",kernelFunc:ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;xe([s,i],"gatherV2");const l=Me(o,s.shape)[0],c=n.data.get(i.dataId).values,u=s.shape[l];for(let w=0;w<c.length;++w){const k=c[w];T(k<=u-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=Q(i.shape),f=RI(s,i,l,d),p=ft({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=ft({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),x=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],g=n.bufferSync(m),y=n.bufferSync(p),b=_W(y,g,x);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const cve={kernelName:Vx,backendName:"cpu",kernelFunc:lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uve(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Q(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=ft({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=SU(a,!0,n),c=ft({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const dve={kernelName:i2,backendName:"cpu",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hve=et(Tf,t=>Number.isFinite(t)?1:0,"bool"),fve={kernelName:Tf,backendName:"cpu",kernelFunc:hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pve=et(Af,t=>Math.abs(t)===1/0?1:0,"bool"),mve={kernelName:Af,backendName:"cpu",kernelFunc:pve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gve=et(Df,t=>Number.isNaN(t)?1:0,"bool"),xve={kernelName:Df,backendName:"cpu",kernelFunc:gve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=zW(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const vve={kernelName:GL,backendName:"cpu",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bve=et(Rf,t=>Math.log1p(t)),wve={kernelName:Rf,backendName:"cpu",kernelFunc:bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kve=zt((t,e)=>t&&e),Cve=rn(Xx,kve,null,"bool"),Sve={kernelName:Xx,backendName:"cpu",kernelFunc:Cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ive=et(Yx,t=>t?0:1,"bool"),Nve={kernelName:Yx,backendName:"cpu",kernelFunc:Ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ve=zt((t,e)=>t||e),Eve=rn(Qx,$ve,null,"bool"),Tve={kernelName:Qx,backendName:"cpu",kernelFunc:Eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;xe(s,"LRN");const c=s.shape[3],u=c-1,d=n.data.get(s.dataId).values,h=Q(s.shape),f=new Float32Array(h);function p(m){const x=m%c;let g=m-x+Math.max(0,x-i);const y=m-x+Math.min(x+i,u);let b=0;for(;g<=y;g++){const w=d[g];b+=w*w}return b}for(let m=0;m<h;m++){const x=p(m),g=d[m]*Math.pow(o+a*x,-l);f[m]=g}return n.makeTensorInfo(s.shape,s.dtype,f)}const Dve={kernelName:Zx,backendName:"cpu",kernelFunc:Ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r;xe(o,"LRNGrad");const d=Q(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(s.dataId).values,m=n.data.get(i.dataId).values,x=new Float32Array(d),g=d;for(let y=0;y<g;y++){const b=y%h,w=y-b+Math.max(0,b-a),k=y-b+Math.min(h,b+a+1);let C=0;for(let S=w;S<k;S++)C+=Math.pow(p[S],2);C=c*C+l;for(let S=w;S<k;S++){let I=-2*c*u*p[S]*m[y]/C;y===S&&(I+=Math.pow(C,-u)),I*=f[y],x[S]+=I}}return n.makeTensorInfo(o.shape,s.dtype,x)}const Rve={kernelName:a2,backendName:"cpu",kernelFunc:Ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=n;let l=s.shape;const c=l.length,u=Me(i,l);let d=u;const h=Et(d,c);let f=a.data.get(s.dataId).values;if(h!=null){const w=new Array(c);for(let k=0;k<w.length;k++)w[k]=l[h[k]];f=iN(f,l,s.dtype,h,w),d=Lt(d.length,c),l=w}xe(s,"max"),Sn("max",d,c);const[p,m]=fn(l,d),x=Q(m),g=WW(f,x,p,s.dtype),y=a.write(g,p,s.dtype);let b=p;return o&&(b=Ut(p,u)),{dataId:y,shape:b,dtype:s.dtype}}const Pve={kernelName:Jx,backendName:"cpu",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;xe(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=1;T(Mn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=$s(s.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))d=$i({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,f=ve(s.shape),p=lN(h,s.shape,s.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,s.dtype,p.values)}return d}const Mve={kernelName:ey,backendName:"cpu",kernelFunc:_ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=r;xe(s,"maxPool3d");const u=mo(s.shape,i,o,1,a,l,c),d=n.data.get(s.dataId).values,h=wU(d,s.shape,s.dtype,ve(s.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Lve={kernelName:ty,backendName:"cpu",kernelFunc:Fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=r;xe([s,i],"maxPool3DGrad");const u=mo(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=$xe(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,x=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,C=b-1-u.padInfo.front,S=k-1-u.padInfo.left,I=w-1-u.padInfo.top,$=_e(i.shape,"float32"),E=n.bufferSync(s);for(let A=0;A<u.batchSize;++A)for(let D=0;D<u.inChannels;++D)for(let P=0;P<u.inDepth;++P)for(let O=0;O<u.inHeight;++O)for(let F=0;F<u.inWidth;++F){const U=P-C,V=O-I,_=F-S;let z=0;for(let K=0;K<b;K+=x){const Z=(U+K)/f;if(!(Z<0||Z>=u.outDepth||Math.floor(Z)!==Z))for(let q=0;q<w;q+=g){const te=(V+q)/p;if(!(te<0||te>=u.outHeight||Math.floor(te)!==te))for(let ie=0;ie<k;ie+=y){const oe=(_+ie)/m;if(oe<0||oe>=u.outWidth||Math.floor(oe)!==oe)continue;const le=b*w*k-1-h.get(A,Z,te,oe,D),ge=K*w*k+q*k+ie,ke=le===ge?1:0;if(ke===0)continue;const ee=E.get(A,Z,te,oe,D);z+=ee*ke}}}$.set(z,A,P,O,F,D)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const zve={kernelName:c2,backendName:"cpu",kernelFunc:jve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;xe([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=$s(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=_e(h.outShape,a.dtype,bU(f,a.shape,a.dtype,h).values),m=h.strideHeight,x=h.strideWidth,g=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,w=h.effectiveFilterWidth,k=w-1-h.padInfo.left,C=b-1-h.padInfo.top,S=_e(a.shape,"float32"),I=n.data.get(s.dataId).values,$=_e(s.shape,"float32",I);for(let E=0;E<h.batchSize;++E)for(let A=0;A<h.inChannels;++A)for(let D=0;D<h.inHeight;++D)for(let P=0;P<h.inWidth;++P){const O=D-C,F=P-k;let U=0;for(let V=0;V<b;V+=g){const _=(O+V)/m;if(!(_<0||_>=h.outHeight||Math.floor(_)!==_))for(let z=0;z<w;z+=y){const K=(F+z)/x;if(K<0||K>=h.outWidth||Math.floor(K)!==K)continue;const Z=b*w-1-p.get(E,_,K,A),q=V*w+z,te=Z===q?1:0;if(te===0)continue;const ie=$.get(E,_,K,A);U+=ie*te}}S.set(U,E,D,P,A)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Wve={kernelName:l2,backendName:"cpu",kernelFunc:Bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(t,e,n,r,s){const i=ve(e),o=lN(t,e,n,i,s,"max"),a=bU(t,e,n,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vve={kernelName:HL,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;xe(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,u=$s(r.shape,s,i,[1,1],o),[d,h]=Uve(c,r.shape,r.dtype,a,u),f=l.write(d,u.outShape,r.dtype),p=l.write(h,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=Me(i,s.shape),c=fn(s.shape,a)[1],u=Q(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=ca({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=cN({inputs:{a:f,b:h},backend:n});d.push(p);const m=vp({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const Hve={kernelName:ny,backendName:"cpu",kernelFunc:Gve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;xe(s,"min");const a=Me(i,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Lt(l.length,s.shape.length)),Sn("min",l,u.shape.length);const[d,h]=fn(u.shape,l),f=Q(h),p=Pn(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let w=0;w<f;++w){const k=m[y+w];(Number.isNaN(k)||k<b)&&(b=k)}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(o){const g=Ut(d,a),y=ft({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const qve={kernelName:ry,backendName:"cpu",kernelFunc:Kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,mode:o}=r;xe(s,"mirrorPad");const a=i.map((b,w)=>b[0]+s.shape[w]+b[1]),l=i.map(b=>b[0]),c=i.map((b,w)=>b[0]+s.shape[w]),u=o==="reflect"?0:1,d=n.data.get(s.dataId).values,h=s.shape.length,f=ve(s.shape),p=Q(a),m=a.length,x=ve(a),g=Rn(s.dtype,p);for(let b=0;b<p;b++){let w=Fu(b,m,x);for(let C=0;C<m;C++)w[C]<l[C]?w[C]=l[C]*2-w[C]-u:w[C]>=c[C]&&(w[C]=(c[C]-1)*2-w[C]+u);w=w.map((C,S)=>C-l[S]);const k=gi(w,h,f);g[b]=d[k]}return{dataId:n.write(g,a,s.dtype),shape:a,dtype:s.dtype}}const Yve={kernelName:sy,backendName:"cpu",kernelFunc:Xve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qve=zt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Zve=rn(Mf,Qve),Jve={kernelName:Mf,backendName:"cpu",kernelFunc:Zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Me([a],s.shape),c=IU({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Ut(c.shape,l),d=ft({inputs:{x:c},backend:n,attrs:{shape:u}}),h=aN({inputs:{a:s,b:d},backend:n}),f=AW({inputs:{x:h},backend:n}),p=vp({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=ft({inputs:{x:p},backend:n,attrs:{shape:u}}),x=cN({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const ebe={kernelName:ky,backendName:"cpu",kernelFunc:NU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tbe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;xe(s,"multinomial");const l=a?s:NU({inputs:{logits:s},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],f=Pn(Q(h),"int32");for(let p=0;p<c;++p){const m=p*u,x=new Float32Array(u-1);x[0]=d[m];for(let b=1;b<x.length;++b)x[b]=x[b-1]+d[m+b];const g=X2.alea(o.toString()),y=p*i;for(let b=0;b<i;++b){const w=g();f[y+b]=x.length;for(let k=0;k<x.length;k++)if(w<x[k]){f[y+b]=k;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const nbe={kernelName:KL,backendName:"cpu",kernelFunc:tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rbe=sI;function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;xe(s,"NonMaxSuppression");const c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=rbe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const ibe={kernelName:u2,backendName:"cpu",kernelFunc:sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const obe=iI;function abe(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r;xe(s,"NonMaxSuppressionPadded");const u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=obe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const lbe={kernelName:d2,backendName:"cpu",kernelFunc:abe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cbe=oI;function ube(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r;xe(s,"NonMaxSuppressionWithScore");const u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,p=l,m=c,{selectedIndices:x,selectedScores:g}=cbe(u,d,h,f,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const dbe={kernelName:h2,backendName:"cpu",kernelFunc:ube};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;xe(s,"oneHot");const c=Q(s.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(s.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...s.shape,o],i,u)}const fbe={kernelName:ly,backendName:"cpu",kernelFunc:hbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Tl({inputs:{input:r},backend:n}),i=o0({inputs:{x:s},backend:n}),o=bu({inputs:{input:r},backend:n}),a=o0({inputs:{x:o},backend:n}),l=xr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return uN({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const pbe={kernelName:Iy,backendName:"cpu",kernelFunc:o0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Tl({inputs:{input:r},backend:n}),i=$U({inputs:{x:s},backend:n}),o=bu({inputs:{input:r},backend:n}),a=o0({inputs:{x:o},backend:n}),l=xr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return uN({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const mbe={kernelName:ay,backendName:"cpu",kernelFunc:$U};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return i0({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{RS(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=i0({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(d),d}),c=wu({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const gbe={kernelName:cy,backendName:"cpu",kernelFunc:EU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;xe(s,"pad");const a=i.map((y,b)=>y[0]+s.shape[b]+y[1]),l=i.map(y=>y[0]),c=n.data.get(s.dataId).values,u=Q(s.shape),d=s.shape.length,h=ve(s.shape),f=Q(a),p=a.length,m=ve(a),x=Rn(s.dtype,f);o!==0&&x.fill(o);for(let y=0;y<u;y++){const w=Fu(y,d,h).map((C,S)=>C+l[S]),k=gi(w,p,m);x[k]=c[y]}return{dataId:n.write(x,a,s.dtype),shape:a,dtype:s.dtype}}const TU={kernelName:uy,backendName:"cpu",kernelFunc:xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe=zt((t,e)=>Math.pow(t,e)),vbe=rn(Lf,ybe),bbe={kernelName:Lf,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,a=s.map(x=>n.data.get(x.dataId).values),l=s.map(x=>x.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[d,h,f]=qW(a,l,c,i.shape,i.dtype,u,o.shape),p=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),m=n.makeTensorInfo(f,i.dtype,h);return p.concat([m])}const kbe={kernelName:qL,backendName:"cpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[c,u]=XW(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const Sbe={kernelName:XL,backendName:"cpu",kernelFunc:Cbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(x=>n.data.get(x.dataId).values),f=a.map(x=>x.shape),[p,m]=YW(c,s.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const Nbe={kernelName:YL,backendName:"cpu",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $be(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:o}=n,a=QW(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const Ebe={kernelName:f2,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbe=et(jf,t=>1/t),Abe={kernelName:jf,backendName:"cpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;xe(s,"resizeBilinear");const l=ve(s.shape),[c,u]=a,[d,h,f,p]=s.shape,m=n.data.get(s.dataId).values,x=new Float32Array(Q([d,c,u,p])),g=[i&&c>1?h-1:h,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u];let b=0;const w=g[0]/y[0],k=g[1]/y[1];for(let C=0;C<d;C++)for(let S=0;S<c;S++){let I;o?I=w*(S+.5)-.5:I=w*S;const $=Math.max(0,Math.floor(I)),E=I-$,A=Math.min(h-1,Math.ceil(I)),D=C*l[0]+$*l[1],P=C*l[0]+A*l[1];for(let O=0;O<u;O++){let F;o?F=k*(O+.5)-.5:F=k*O;const U=Math.max(0,Math.floor(F)),V=F-U,_=Math.min(f-1,Math.ceil(F)),z=D+U*l[2],K=P+U*l[2],Z=D+_*l[2],q=P+_*l[2];for(let te=0;te<p;te++){const ie=m[z+te],oe=m[K+te],le=m[Z+te],ge=m[q+te],ke=ie+(le-ie)*V,ee=oe+(ge-oe)*V,ue=ke+(ee-ke)*E;x[b++]=ue}}}return n.makeTensorInfo([d,c,u,p],"float32",x)}const Obe={kernelName:my,backendName:"cpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;xe([i,s],"resizeBilinearGrad");const a=ve(s.shape),[l,c,u,d]=s.shape,[,h,f]=i.shape,p=new Float32Array(l*c*u*d),m=[o&&h>1?c-1:c,o&&f>1?u-1:u],x=[o&&h>1?h-1:h,o&&f>1?f-1:f],g=m[0]/x[0],y=m[1]/x[1],b=n.data.get(i.dataId).values;let w=0;for(let k=0;k<l;k++){const C=k*a[0];for(let S=0;S<h;S++){const I=S*g,$=Math.floor(I),E=Math.min(Math.ceil(I),c-1),A=C+$*a[1],D=C+E*a[1],P=I-$,O=1-P;for(let F=0;F<f;F++){const U=F*y,V=Math.floor(U),_=Math.min(Math.ceil(U),u-1),z=U-V,K=1-z,Z=A+V*a[2],q=A+_*a[2],te=D+V*a[2],ie=D+_*a[2],oe=O*K,le=O*z,ge=P*K,ke=P*z;for(let ee=0;ee<d;ee++){const ue=b[w++];p[Z+ee]+=ue*oe,p[q+ee]+=ue*le,p[te+ee]+=ue*ge,p[ie+ee]+=ue*ke}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const Pbe={kernelName:g2,backendName:"cpu",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _be(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;xe(s,"resizeNearestNeighbor");const l=ve(s.shape),[c,u]=a,[d,h,f,p]=s.shape,m=n.data.get(s.dataId).values,x=new Float32Array(d*c*u*p),g=[i&&c>1?h-1:h,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=g[0]/y[0],w=g[1]/y[1];let k=0;for(let C=0;C<d;C++){const S=C*l[0];for(let I=0;I<c;I++){const $=o?b*(I+.5):b*I;let E=Math.min(h-1,i?Math.round($):Math.floor($));o&&(E=Math.max(0,E));const A=S+E*l[1];for(let D=0;D<u;D++){const P=o?w*(D+.5):w*D;let O=Math.min(f-1,i?Math.round(P):Math.floor(P));o&&(O=Math.max(0,O));const F=A+O*l[2];for(let U=0;U<p;U++){const V=m[F+U];x[k++]=V}}}}return n.makeTensorInfo([d,c,u,p],s.dtype,x)}const Mbe={kernelName:py,backendName:"cpu",kernelFunc:_be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;xe([i,s],"resizeNearestNeighborGrad");const a=ve(s.shape),l=ve(i.shape),[c,u,d,h]=s.shape,[,f,p]=i.shape,m=new Float32Array(c*u*d*h),x=n.data.get(i.dataId).values,g=[o&&f>1?u-1:u,o&&p>1?d-1:d],y=[o&&f>1?f-1:f,o&&p>1?p-1:p],b=g[0]/y[0],w=g[1]/y[1],k=1/b,C=1/w,S=Math.ceil(k)*2+2,I=Math.ceil(C)*2+2;for(let $=0;$<c;$++){const E=$*a[0];for(let A=0;A<u;A++){const D=E+A*a[1],P=Math.floor(A*k),O=Math.floor(P-S/2);for(let F=0;F<d;F++){const U=D+F*a[2],V=Math.floor(F*C),_=Math.floor(V-I/2);for(let z=0;z<h;z++){let K=0;for(let Z=0;Z<S;Z++){const q=Z+O;if(q<0||q>=f)continue;const te=E+q*l[1],ie=q*b,oe=Math.min(u-1,o?Math.round(ie):Math.floor(ie));if(A===oe)for(let le=0;le<I;le++){const ge=le+_;if(ge<0||ge>=p)continue;const ke=te+ge*l[2],ee=ge*w,ue=Math.min(d-1,o?Math.round(ee):Math.floor(ee));F===ue&&(K+=x[ke+z])}}m[U+z]=K}}}}return n.makeTensorInfo(s.shape,s.dtype,m)}const Lbe={kernelName:m2,backendName:"cpu",kernelFunc:Fbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r;xe(s,"reverse");const o=s.shape.length,a=Me(i,s.shape);if(o===0)return $i({inputs:{x:s},backend:n});const l=new vn(s.shape,s.dtype),c=n.bufferSync(s);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=s.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const zbe={kernelName:gy,backendName:"cpu",kernelFunc:jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bbe={kernelName:C2,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=Rn(r.dtype,Q(r.shape)),[c,u,d,h]=r.shape,[f,p]=xI(o,u,d),m=255,x=Math.sin(s),g=Math.cos(s),y=a.data.get(r.dataId).values;for(let w=0;w<c;w++){const k=w*d*u*h;for(let C=0;C<u;C++){const S=C*(d*h);for(let I=0;I<d;I++){const $=I*h;for(let E=0;E<h;E++){const A=[c,C,I,E],D=A[2],P=A[1];let O=(D-f)*g-(P-p)*x,F=(D-f)*x+(P-p)*g;O=Math.round(O+f),F=Math.round(F+p);let U=i;if(typeof i!="number"&&(E===3?U=m:U=i[E]),O>=0&&O<d&&F>=0&&F<u){const _=F*(d*h),z=O*h,K=k+_+z+E;U=y[K]}const V=k+S+$+E;l[V]=U}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wbe=et(Wf,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Ube={kernelName:Wf,backendName:"cpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hl(i,s,o),h=!0,f=n.bufferSync(s),p=n.bufferSync(i),m=Za(f,p,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,m.dtype,m.values)}const Gbe={kernelName:QL,backendName:"cpu",kernelFunc:Vbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function Kbe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function qbe(t,e,n,r,s,i){const o=_t("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),c=a*s;for(let u=0;u<s;++u)o[c+u]=i==="left"?Hbe(l,e[u+c]):Kbe(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,c=qbe(a,l,s.shape[0],s.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const Ybe={kernelName:JL,backendName:"cpu",kernelFunc:Xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qbe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e;xe([r,s,i],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,u=Ir(s.dtype,i.dtype),d=Pn(Q(s.shape),u);let h=0;const f=o===0||o>1||s.shape.length===1?1:Q(s.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(s.shape,u,d)}const Zbe={kernelName:xy,backendName:"cpu",kernelFunc:Qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jbe=Fy,e1e=Ly,t1e=et(Vf,t=>t>=0?e1e*t:Jbe*(Math.exp(t)-1)),n1e={kernelName:Vf,backendName:"cpu",kernelFunc:t1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=et(Kf,t=>t<0?-1:t>0?1:0),s1e={kernelName:Kf,backendName:"cpu",kernelFunc:r1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1e=et(Gf,t=>Math.sin(t)),o1e={kernelName:Gf,backendName:"cpu",kernelFunc:i1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1e=et(Hf,t=>Math.sinh(t)),l1e={kernelName:Hf,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c1e=11920928955078125e-23,RD=Math.log(c1e)+2,u1e=et(Xf,t=>{const e=t>-RD,n=t<RD,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),d1e={kernelName:Xf,backendName:"cpu",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;xe([s],"spaceToBatchND");const a=Q(i),l=[[0,0]];l.push(...o);for(let C=1+i.length;C<s.shape.length;++C)l.push([0,0]);const c=TU.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),u=lp(c.shape,i,a,!1),d=cp(u.length,i.length,!1),h=up(c.shape,i,a,!1),m=ft({inputs:{x:c},backend:n,attrs:{shape:u}}),y=cr({inputs:{x:m},backend:n,attrs:{perm:d}}),k=ft({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),k}const f1e={kernelName:by,backendName:"cpu",kernelFunc:h1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,f,p,m]=tU(a,r.shape,r.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const m1e={kernelName:ej,backendName:"cpu",kernelFunc:p1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=nU(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const x1e={kernelName:tj,backendName:"cpu",kernelFunc:g1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[c,u]=oN(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const v1e={kernelName:nj,backendName:"cpu",kernelFunc:y1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[c,u]=oN(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const w1e={kernelName:rj,backendName:"cpu",kernelFunc:b1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Hl(i,s,a),f=!1,p=n.bufferSync(s);let m;switch(i.dtype){case"bool":{const x=n.bufferSync(i),g=!!n.data.get(o.dataId).values[0];m=Za(p,x,a,h,u,c,l,d,g,f);break}case"float32":{const x=n.bufferSync(i),g=n.data.get(o.dataId).values[0];m=Za(p,x,a,h,u,c,l,d,g,f);break}case"int32":{const x=n.bufferSync(i),g=n.data.get(o.dataId).values[0];m=Za(p,x,a,h,u,c,l,d,g,f);break}case"string":{const x=n.bufferSync(i),g=sa(n.data.get(o.dataId).values[0]);m=Za(p,x,a,h,u,c,l,d,g,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const C1e={kernelName:sj,backendName:"cpu",kernelFunc:k1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Me(o,s.shape)[0],l=OI(s,i,a),c=new Array(s.shape.length).fill(0),u=s.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=Al({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const I1e={kernelName:wy,backendName:"cpu",kernelFunc:S1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N1e={kernelName:x2,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;xe(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=et(np,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),E1e={kernelName:np,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r;xe(s,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:g,begin:y,end:b,strides:w}=pI(s.shape,i,o,a,l,c,u,d,h);let k;if(m)k=ft({inputs:{x:s},backend:n,attrs:{shape:p}});else if(x||g){T(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=dI(y,b,w),S=Al({inputs:{x:s},backend:n,attrs:{begin:y,size:C}});k=ft({inputs:{x:S},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(S)}else{const C=n.bufferSync(s),S=iU(f,C,w,y);k=n.makeTensorInfo(p,S.dtype,S.values)}return k}const A1e={kernelName:v2,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=oU(h,f,s,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const O1e={kernelName:ij,backendName:"cpu",kernelFunc:D1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=aU(a,l,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const P1e={kernelName:oj,backendName:"cpu",kernelFunc:R1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=lU(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const M1e={kernelName:aj,backendName:"cpu",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1e=et(Jf,t=>Math.tan(t)),L1e={kernelName:Jf,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1e=et(ep,t=>Math.tanh(t)),z1e={kernelName:ep,backendName:"cpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1e(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Hl(i,s,r.shape),d=!1,h=n.bufferSync(s),f=n.bufferSync(i),p=n.bufferSync(r),m=Za(h,f,r.shape,u,l,a,o,c,p,d);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const W1e={kernelName:ZL,backendName:"cpu",kernelFunc:B1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;xe(s,"tile");const o=uU(n.bufferSync(s),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const V1e={kernelName:tp,backendName:"cpu",kernelFunc:U1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r;xe(s,"topk");const a=n.data.get(s.dataId).values,[l,c]=hU(a,s.shape,s.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const H1e={kernelName:b2,backendName:"cpu",kernelFunc:G1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=s.shape,[p,m]=c??[d,h],x=[u,p,m,f],g=ve(s.shape),y=g[0],b=g[1],w=g[2],k=ve(x),C=k[0],S=k[1],I=k[2],$=Rn(s.dtype,Q(x));$.fill(l);const E=r.data.get(s.dataId).values,A=r.data.get(i.dataId).values;for(let P=0;P<u;++P){const O=i.shape[0]===1?A:A.subarray(P*8,P*8+8);for(let F=0;F<p;++F)for(let U=0;U<m;++U)for(let V=0;V<f;++V){let _;const z=O[6]*U+O[7]*F+1;if(z===0)continue;const K=(O[0]*U+O[1]*F+O[2])/z,Z=(O[3]*U+O[4]*F+O[5])/z,q=PD(K,h,a),te=PD(Z,d,a);switch(o){case"nearest":_=J1e(E,d,h,y,b,w,P,te,q,V,l);break;case"bilinear":_=ewe(E,d,h,y,b,w,P,te,q,V,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ie=P*C+F*S+U*I+V;$[ie]=_}return r.makeTensorInfo(x,s.dtype,$)}return{dataId:r.write($,x,s.dtype),shape:s.shape,dtype:s.dtype}}const q1e={kernelName:w2,backendName:"cpu",kernelFunc:K1e};function PD(t,e,n){switch(n){case"reflect":return X1e(t,e);case"wrap":return Y1e(t,e);case"nearest":return Z1e(t,e);case"constant":default:return Q1e(t)}}function X1e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return yl(0,n,e-1)}function Y1e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return yl(0,n,e-1)}function Q1e(t,e){return t}function Z1e(t,e){return yl(0,t,e-1)}function Rd(t,e,n,r,s,i,o,a,l,c,u){const d=o*r+a*s+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function J1e(t,e,n,r,s,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Rd(t,e,n,r,s,i,o,d,h,c,u)}function ewe(t,e,n,r,s,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*Rd(t,e,n,r,s,i,o,d,h,c,u)+(l-h)*Rd(t,e,n,r,s,i,o,d,p,c,u),x=(p-l)*Rd(t,e,n,r,s,i,o,f,h,c,u)+(l-h)*Rd(t,e,n,r,s,i,o,f,p,c,u);return(f-a)*m+(a-d)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function twe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;xe(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=fU(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const nwe={kernelName:k2,backendName:"cpu",kernelFunc:twe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=s.shape[f]);const u=new Array(o).fill(0),d=s.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[i]=f;const p=Al({inputs:{x:s},backend:n,attrs:{begin:u,size:d}});h[f]=ft({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const swe={kernelName:Cy,backendName:"cpu",kernelFunc:rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r;xe(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let p=0;p<d;++p){const m=i0({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<o;++p){const m=ba(p,"int32"),x=n.makeTensorInfo([],"int32",m),g=EW({inputs:{a:x,b:h},backend:n}),y=ca({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),b=Yy({inputs:{a:y,b:s},backend:n}),w=vp({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(x),u.push(g),u.push(y),u.push(b),u.push(w)}const f=EU({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const owe={kernelName:Sy,backendName:"cpu",kernelFunc:iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const awe=[txe,_ge,rxe,ixe,Bge,axe,cxe,dxe,fxe,mxe,xxe,vxe,wxe,Sxe,Nxe,Txe,Dxe,Rxe,_xe,J0e,Fxe,jxe,Bxe,Uge,Uxe,jge,Gge,Gxe,Mge,Kxe,Xxe,Yxe,Zxe,eye,nye,sye,oye,lye,uye,hye,pye,gye,yye,bye,wye,Cye,Iye,$ye,Eye,Tye,Aye,Oye,_ye,H0e,Fye,Hge,Gye,Kge,Hye,Xge,Zye,Jye,tve,Qge,Jge,rve,ive,ave,cve,t0e,r0e,Fge,dve,qxe,fve,mve,xve,K0e,i0e,a0e,vve,c0e,wve,Sve,Nve,Tve,Dve,Rve,Pve,d0e,Mve,Lve,zve,Wve,Vve,Hve,qve,f0e,Yve,Jve,nbe,m0e,x0e,ibe,lbe,dbe,v0e,fbe,mbe,gbe,TU,bbe,X0e,k0e,kbe,Sbe,Nbe,Ebe,Lge,zw,Abe,Y0e,Q0e,Z0e,Obe,Pbe,Mbe,Lbe,zbe,Bbe,Ube,A0e,Gbe,Ybe,Zbe,n1e,O0e,s1e,o1e,l1e,R0e,ebe,d1e,f1e,m1e,x1e,v1e,w1e,C1e,I1e,M0e,N1e,L0e,z0e,E1e,A1e,O1e,P1e,M1e,V0e,Rye,L1e,z1e,W1e,V1e,H1e,q1e,b0e,nwe,swe,owe,pbe];for(const t of awe)cj(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ba={},im={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function lwe(t,e){Ba[t]=e}function Zs(t,e){if(!(t in Ba)||e!=null){const r=uwe(t,e);if(r!==null)Ba[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ba[t];return n==null||n.isContextLost()?(delete Ba[t],Zs(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ba[t])}function cwe(t){if(!H().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function uwe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??cwe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ba[t]},!1),H().getBool("SOFTWARE_WEBGL_ENABLED")&&(im.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",im)||n.getContext("experimental-webgl",im):n.getContext("webgl2",im)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ph;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Ph||(Ph={}));var jr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(jr||(jr={}));var xn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(xn||(xn={}));function bp(t,e){return[e,t]}function dwe(t,e){return t*e}function om(t){const e=Q(t),n=Math.ceil(e/4);return lw(n)}function Gu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function hwe(t,e){const[n,r]=Gu(t,e);return n*r*4}function dN(t,e){const n=t;let r,s,i,o,a,l,c,u,d,h;return H().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function he(t,e){const n=e();return H().getBool("DEBUG")&&fwe(t),n}function fwe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+xwe(t,e))}const pwe=596e-10,mwe=65504;function gwe(t){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||pwe<Math.abs(t)&&Math.abs(t)<mwe)}function xwe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function am(t,e){return xo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ywe(t,e){const n=xo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(he(t,()=>t.shaderSource(n,e)),he(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function vwe(t,e){const n=xo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(he(t,()=>t.shaderSource(n,e)),he(t,()=>t.compileShader(n)),H().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw AU(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const bwe=/ERROR: [0-9]+:([0-9]+):/g;function AU(t,e){const n=bwe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((d,h)=>zc((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,r-1),c=o.slice(r-1,r),u=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${zc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function wwe(t){return xo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function kwe(t,e){if(he(t,()=>t.linkProgram(e)),!H().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function hb(t,e){if(he(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Cwe(t,e){const n=xo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return he(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),he(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Swe(t,e){const n=xo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return he(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),he(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Iwe(t){return xo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Nwe(t,e){const n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function $we(t){return xo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function _D(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(he(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),he(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),he(t,()=>t.enableVertexAttribArray(a)),!0)}function Ewe(t,e,n){Rwe(t,n),he(t,()=>t.activeTexture(t.TEXTURE0+n)),he(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Twe(t,e,n){return xo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Awe(t,e,n){return t.getUniformLocation(e,n)}function Dwe(t,e,n,r){he(t,()=>Ewe(t,e,r)),he(t,()=>t.uniform1i(n,r))}function fb(t,e,n){he(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),he(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function MD(t,e){he(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),he(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function lm(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Owe(t,e))}function Owe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function xo(t,e,n){const r=he(t,()=>e());if(r==null)throw new Error(n);return r}function Rwe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function ku(t,e=2){return Q(t.slice(0,t.length-e))}function Cu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function cm(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ku(t),...Cu(t)]),e}function Pwe(t,e=!1){let n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=H().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&H().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?OS(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=va(t).newShape);let s=Q(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=ku(t);let l=2,c=2;t.length&&([l,c]=Cu(t)),s=a*(l/2)*(c/2),i=lw(s).map(u=>u*2)}else i=lw(s);return i}function um(t){return t%2===0}function a0(t,e){if(t=t.slice(-2),e=e.slice(-2),Qe(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||um(n)&&um(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&um(t[0])&&um(e[0])}let pb,mb;function _we(t){if(pb==null){const e=Zs(t);pb=e.getParameter(e.MAX_TEXTURE_SIZE)}return pb}function Mwe(t){if(mb==null){const e=Zs(t);mb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,mb)}function Fwe(t){if(t===0)return 0;let e;const n=Zs(t);return ms(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ms(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ms(t,e){return t.getExtension(e)!=null}function FD(t){try{if(Zs(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Lwe(t){if(t===0)return!1;const e=Zs(t);if(t===1){if(!ms(e,"OES_texture_float"))return!1}else if(!ms(e,"EXT_color_buffer_float"))return!1;return Ww(e)}function jwe(t){if(t===0)return!1;const e=Zs(t);if(t===1){if(!ms(e,"OES_texture_float")||!ms(e,"WEBGL_color_buffer_float"))return!1}else{if(ms(e,"EXT_color_buffer_float"))return Ww(e);const r="EXT_color_buffer_half_float";if(ms(e,r)){const s=e.getExtension(r);return zwe(e,s)}return!1}return Ww(e)}function Ww(t){const e=dN(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function zwe(t,e){const n=dN(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function Bwe(t){return t!==2?!1:Zs(t).fenceSync!=null}function wp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ye=H();ye.registerFlag("HAS_WEBGL",()=>ye.getNumber("WEBGL_VERSION")>0);ye.registerFlag("WEBGL_VERSION",()=>FD(2)?2:FD(1)?1:0);ye.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ye.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ye.get("WEBGL_VERSION")===2);ye.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ye.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ye.registerFlag("WEBGL_PACK",()=>ye.getBool("HAS_WEBGL"));ye.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_CLIP",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_REDUCE",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_LAZILY_UNPACK",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_CONV_IM2COL",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>_we(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Mwe(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=ye.getNumber("WEBGL_VERSION");return t===0?0:Fwe(t)});ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ye.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Nj());ye.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Lwe(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ye.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ye.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ye.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>jwe(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Bwe(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ye.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ye.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});ye.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Nj()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});ye.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ye.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ye.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ye.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ye.registerFlag("WEBGL_EXP_CONV",()=>!1);ye.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ye.getBool("IS_TEST"));ye.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ye.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ye.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ye.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(){let t,e,n,r,s,i,o,a,l,c;return H().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=H().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(t,e,n="index"){const r=ve(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function Qy(t,e,n="index"){const r=ve(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Wwe(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function Uwe(t,e,n="index"){const r=t.map((i,o)=>o),s=Wwe(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,l=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function hN(t){const e=ve(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function fN(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const DU=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:OU}=Rhe;function Vwe(t,e,n){const r=[];if(t.forEach(f=>{const p=Q(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=pN(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(f=>Gwe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=Jn(),l=qwe(a);let c,u,d=Qwe(a);return e.isPacked?(c=Hwe(e.logicalShape,o,n.enableShapeUniforms),u=Ywe(a)):(c=Kwe(e.logicalShape,o,n.enableShapeUniforms),u=Xwe(a)),n.packedInputs&&(d+=tke),[d,l,u,s,c,i,n.userCode].join(`
`)}function Hu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return fke(t,e);case 1:return mke(t,e);case 2:return xke(t,e);case 3:return vke(t,e);case 4:return wke(t,e);case 5:return kke(t);case 6:return Cke(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function RU(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return hke(t);case 1:return pke(t,e);case 2:return gke(t,e);case 3:return yke(t,e);default:return bke(t,e)}}function Gwe(t,e,n=!1,r){let s="";n?s+=RU(t,r):s+=Hu(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=Ske(t,e):s+=Ike(t,e)),s}function Hwe(t,e,n){switch(t.length){case 0:return PU();case 1:return nke(t,e,n);case 2:return uke(t,e,n);case 3:return ske(t,e,n);default:return oke(t,e,n)}}function Kwe(t,e,n){switch(t.length){case 0:return PU();case 1:return rke(t,e,n);case 2:return dke(t,e,n);case 3:return ike(t,e,n);case 4:return ake(t,e,n);case 5:return lke(t,e);case 6:return cke(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function qwe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Xwe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Ywe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Qwe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Zwe}
    ${Jwe}
    ${eke}
  `}const Zwe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Jwe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,eke=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tke=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function PU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function nke(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function rke(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function ske(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function ike(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Qy(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Xl(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function oke(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function ake(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Qy(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Xl(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function lke(t,e){const n=Xl(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function cke(t,e){const n=Xl(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function uke(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Qe(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function dke(t,e,n){return Qe(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Yl(t){return`offset${t}`}function hke(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Jn();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function fke(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Yl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function pke(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=Jn();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function mke(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Ku(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Yl(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function gke(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=Jn();if(i!=null&&Qe(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function xke(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Qe(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=va(n),l=o;if(l.length<n.length){const h=qu(t,l),f=["row","col"];return`
      ${Hu(h,e)}
      float ${s}(int row, int col) {
        return ${s}(${Xu(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ku(t)}
      }
    `;const c=i[0],u=i[1],d=Yl(r);return u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function yke(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=qu(t,h),m=["b","row","col"];return`
        ${RU(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Xu(m,f)});
        }
      `}const a=Jn();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function vke(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=va(n),c=a;if(c.length<n.length){const m=qu(t,c),x=["row","col","depth"];return`
        ${Hu(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Xu(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Ku(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Yl(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function bke(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Jn();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,h*=i[o-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${r}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${s.texture2D}(${n}, uv);
    }
  `}function wke(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=va(n);if(l.length<n.length){const y=qu(t,l),b=["row","col","depth","depth2"];return`
      ${Hu(y,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Xu(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Ku(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=Yl(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function kke(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=va(e);if(l.length<e.length){const m=qu(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${Hu(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Xu(x,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${Ku(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Yl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Cke(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=va(e);if(s.length<e.length){const x=qu(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${Hu(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Xu(g,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Ku(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Yl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ku(t){const e=t.name,n=Q(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Ske(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=OU(t.shapeInfo.logicalShape,e.logicalShape),l=st(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${d[y+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((y,b)=>`coords.${d[b+c]}`).join(", ");let f="return outputValue;";const m=Q(t.shapeInfo.logicalShape)===1,g=Q(e.logicalShape)===1;if(i===1&&!m&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=i-2,b=i-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${h});
      ${f}
    }
  `}function Ike(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Qe(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=st(l),u=OU(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${s}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function st(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function pN(t,e,n){const{newShape:r,keptDims:s}=va(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!t&&i>1&&!Qe(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function qu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Xu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t,e,n,r){const s=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=s.map(u=>u.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Vwe(s,o,e),l=vwe(t.gl,a),c=t.createProgram(l);return H().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},_U(t,e,c)))}function _U(t,e,n){const r=[],s=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),H().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),r.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function LD(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!Qe(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Qe(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function $ke(t,e,n,r,s){e.program.enableShapeUniforms||(LD(e.inShapeInfos,n),LD([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),H().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=pN(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Q(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=ve(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=s[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Eke(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=pN(t.packedInputs,o.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${k[0]>1}_${k[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const k=ve(u);p=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}const m=o.shape.length,x=u.length===2&&Qe(o.shape,l),g=Q(o.shape)===1,y=gu(o.shape,n.shape),b=!t.packedInputs&&m===n.shape.length&&Qe(l,n.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${b}_${c?d:""}_${u.length}_${g}_${y}_${x}_${h}_${f}_${p}_${w}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${H().getNumber("WEBGL_VERSION")}`,i}function Ln(t){return H().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tke{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ph.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Qy(["r","c","d"],e):Xl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ake{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ph.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Qy(["r","c","d"],e):Xl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dke{constructor(e){this.variableNames=["A"],this.outTexUsage=jr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${DU}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oke{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=jr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${DU}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rke={R:0,G:1,B:2,A:3};class jD{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Jn();this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${Rke[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?fN():hN(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pke{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Jn();this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?fN():hN(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ke(t){const e=Jn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ywe(t,n)}function Mke(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Cwe(t,e)}function Fke(t){const e=new Uint16Array([0,1,2,2,1,3]);return Swe(t,e)}function kp(t,e,n,r,s,i){Nwe(e,n);const o=Iwe(t),a=t.TEXTURE_2D;return he(t,()=>t.bindTexture(a,o)),he(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),he(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),he(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),he(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),H().getNumber("WEBGL_VERSION")===1?he(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):he(t,()=>t.texStorage2D(a,1,r,e,n)),he(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function MU(t){return t.internalFormatFloat}function Lke(t,e,n,r){const[s,i]=bp(e,n);return kp(t,s,i,MU(r),r.textureFormatFloat,t.FLOAT)}function FU(t){return t.internalFormatHalfFloat}function jke(t,e,n,r){const[s,i]=bp(e,n);return kp(t,s,i,FU(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function LU(t){return t.downloadTextureFormat}function zke(t,e,n,r){const[s,i]=bp(e,n);return kp(t,s,i,LU(r),t.RGBA,t.UNSIGNED_BYTE)}function jU(t){return t.internalFormatPackedFloat}function Bke(t,e,n,r){const[s,i]=Gu(e,n);return kp(t,s,i,jU(r),t.RGBA,t.FLOAT)}function zU(t){return t.internalFormatPackedHalfFloat}function Wke(t,e,n,r){const[s,i]=Gu(e,n);return kp(t,s,i,zU(r),t.RGBA,r.textureTypeHalfFloat)}function Uke(t,e,n){return he(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),_D(t,e,"clipSpacePos",n,3,20,0)&&_D(t,e,"uv",n,2,20,12)}function Vke(t,e,n,r,s,i){he(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(s),H().getNumber("WEBGL_VERSION")===2?he(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):he(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,o)),he(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Gke(t,e,n){he(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?H().getNumber("WEBGL_VERSION")===2?he(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):he(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):H().getNumber("WEBGL_VERSION")===2?he(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):he(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),he(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Hke(t,e,n,r){const s=t.createBuffer();he(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return he(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),he(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),he(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function Kke(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function qke(t,e,n,r){const[s,i]=bp(e,n),o=4,a=new Uint8Array(dwe(e*n,o));return he(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Xke(t,e,n,r,s,i,o,a){const l=t,c=new Float32Array(hwe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Yke(t,e,n){const r=new Float32Array(e*n*4);return he(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=H().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,lwe(n,e)):this.gl=Zs(n),e=this.gl,H().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>he(i,()=>i.createVertexArray()),this.bindVertexArray=o=>he(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>he(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>he(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>he(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>he(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>he(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>he(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),H().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=am(this.gl,i),ms(this.gl,o))this.textureHalfFloatExtension=am(this.gl,o);else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ms(this.gl,s))this.colorBufferHalfFloatExtension=am(this.gl,s);else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ms(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ms(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Mke(this.gl),this.indexBuffer=Fke(this.gl),this.framebuffer=$we(this.gl),this.textureConfig=dN(this.gl,this.textureHalfFloatExtension)}get debug(){return H().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;he(e,()=>e.finish()),he(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),he(e,()=>e.deleteFramebuffer(this.framebuffer)),he(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),he(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),he(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Lke(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),jke(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),zke(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Gke(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Vke(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Wke(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Bke(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(MD(this.gl,this.framebuffer),this.outputTexture=null),he(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>qke(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return Xke(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Kke(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=Hke(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(H().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Yke(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=_ke(n));const r=wwe(n);he(n,()=>n.attachShader(r,this.vertexShader)),he(n,()=>n.attachShader(r,e)),kwe(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&hb(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;he(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Uke(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(he(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&hb(this.gl,this.program),he(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Twe(this.gl,e,n):Awe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),he(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Dwe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=Gu(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&hb(this.gl,this.program),lm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}he(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),he(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=am(this.gl,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await IA(()=>this.disposed||this.isQueryAvailable(e,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Qke(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in H().platform&&(r=H().platform.setTimeoutCustom.bind(H().platform)),IA(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),fb(this.gl,e,this.framebuffer),this.debug&&lm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(fb(this.gl,this.outputTexture,this.framebuffer),this.debug&&lm(this.gl)):MD(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;fb(s,e,this.framebuffer),this.debug&&lm(s),this.outputTexture=e,he(s,()=>s.viewport(0,0,n,r)),he(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),he(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Qke(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Zke,bincountImpl:BU,bincountReduceImpl:Jke,bitwiseAndImpl:eCe,castImpl:tCe,ceilImpl:nCe,concatImpl:rCe,equalImpl:sCe,expImpl:iCe,expm1Impl:oCe,floorImpl:aCe,gatherNdImpl:lCe,gatherV2Impl:cCe,greaterImpl:uCe,greaterEqualImpl:dCe,lessImpl:hCe,lessEqualImpl:fCe,linSpaceImpl:pCe,logImpl:mCe,maxImpl:gCe,maximumImpl:xCe,minimumImpl:yCe,multiplyImpl:vCe,negImpl:bCe,notEqualImpl:wCe,prodImpl:kCe,raggedGatherImpl:CCe,raggedRangeImpl:SCe,raggedTensorToTensorImpl:ICe,rangeImpl:NCe,rsqrtImpl:$Ce,scatterImpl:ECe,sigmoidImpl:TCe,simpleAbsImpl:WU,sliceImpl:ACe,sparseFillEmptyRowsImpl:DCe,sparseReshapeImpl:OCe,sparseSegmentReductionImpl:UU,sqrtImpl:RCe,staticRegexReplaceImpl:PCe,stridedSliceImpl:_Ce,stringNGramsImpl:MCe,stringSplitImpl:FCe,stringToHashBucketFastImpl:LCe,subImpl:jCe,tileImpl:zCe,topKImpl:BCe,transposeImpl:mN,uniqueImpl:WCe}=G0e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Kn(t,e){return e===1?[t]:VU(t,e)}function UCe(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VCe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Ln(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Kn("rc",this.rank),r=st(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GU{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${GCe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?fN():hN(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function GCe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Uwe(["r","c","d"],"inputShape"):Xl(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HCe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=BD(n,r),i=WD(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=zD(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===xn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===xn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===xn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===xn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===xn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=BD(r,s),o=WD(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=zD(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=H().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function KCe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function zD(t,e,n,r,s){const i=qCe(e,r);let o;if(s){const[l,c]=Gu(t[0],t[1]);o=l*c}else{const[l,c]=bp(t[0],t[1]);o=l*c}const a=KCe(n,i);return o*a}function qCe(t,e){switch(t){case xn.PACKED_2X2_FLOAT32:return jU(e);case xn.PACKED_2X2_FLOAT16:return zU(e);case xn.UNPACKED_FLOAT32:return MU(e);case xn.UNPACKED_FLOAT16:return FU(e);case xn.PACKED_4X1_UNSIGNED_BYTE:return LU(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function XCe(t){return H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?xn.PACKED_2X2_FLOAT32:xn.UNPACKED_FLOAT32:t?xn.PACKED_2X2_FLOAT16:xn.UNPACKED_FLOAT16}function BD(t,e){if(t===jr.UPLOAD)return xn.PACKED_2X2_FLOAT32;if(t===jr.RENDER||t==null)return XCe(e);if(t===jr.DOWNLOAD||t===jr.PIXELS)return xn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function WD(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hi{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ts="if (isnan(x)) return x;",YCe="return x;",UD="return abs(x);",QCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",ZCe=Ts+`
  return (x < 0.0) ? 0.0 : x;
`,JCe=Ts+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,To="return x;",eSe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tSe="return x;",nSe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,rSe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sSe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,iSe="return 1.0 / (1.0 + exp(-1.0 * x));";class Fo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oSe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length);const n=e.length,r=Kn("rc",n),s=st(n),i=UCe(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aSe=m4,lSe=1e-7,cSe=1e-4,dm={};function uSe(t){return t in dm||(dm[t]={}),dm[t]}const dSe=H().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),hSe=600;function fSe(){return H().global.screen==null?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*hSe/1024/1024}class Zy extends DS{nextDataId(){return Zy.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof gb)n=e;else{const r=Zs(H().getNumber("WEBGL_VERSION"),e);n=new gb(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Zs(H().getNumber("WEBGL_VERSION"));n=new gb(r),this.binaryCache=uSe(H().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new HCe(this.gpgpu),this.numMBBeforeWarning=fSe(),this.texData=new PL(this,ii())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const c=cm(n),u=new jD(c,!1,o),d=this.runWebGLProgram(u,[a],r,[[s,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((H().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||H().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:jr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:jr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new Fo(a,To):h=new hi(a,To);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const c=this.activeTimers!=null;let u;c&&(u=tr());let d;if(s==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=oo(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=tr()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new Fo(s,To):p=new hi(s,To);const m=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:o}],o),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(H().getBool("DEBUG")&&!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&H().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&H().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...om(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],x=p[1];d=oo(m,x)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=Q(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;he(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ii().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Fo(i,To):f=new hi(i,To);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=ii().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>sa(s));return _e(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return _e(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!gwe(r))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=Q(n);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...om(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const o=H().getBool("WEBGL_PACK")&&s===!0,a=o?cm(n):n,l=o?new Oke(a):new Dke(a),c=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=vl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=vl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=Jie(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:tr(),endMs:null}}endTimer(e){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=tr(),e)}async getQueryTime(e){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=dSe){return H().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Q(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Fr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return aSe(e.shape,n)}packedUnaryOp(e,n,r){const s=new Fo(e.shape,n),i=this.compileAndRun(s,[e],r);return ii().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=WU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,UD,e.dtype);const n=new hi(e.shape,UD),r=this.compileAndRun(n,[e]);return ii().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&af(r[0])){const i=r.map(o=>Xo(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return ii().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new oSe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new VCe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[ku(e.shape),...Cu(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[ku(n),...Cu(n)],o=new GU(i,r),a=!0,l=[r],c=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const h=Q(i),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=cm(i);let l;s?l=new Ake(a):l=new Tke(a);const c=!0,u=[n??om(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Ph.DENSE){const g=o??om(e.outputShape);l.texShape=g.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Q(a.shape)===0)return l.values=Rn(a.dtype,0),a;const c=[],u=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(g.dataId);if(y.texture==null){if(!e.packedInputs&&Q(g.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!y.isPacked!=!!e.packedInputs)g=y.isPacked?this.unpackTensor(g):this.packTensor(g),c.push(g),y=this.texData.get(g.dataId);else if(y.isPacked&&!a0(y.shape,g.shape)){const b=g,w=g.shape;g.shape=y.shape,g=this.packedReshape(g,w),c.push(g),y=this.texData.get(g.dataId),b.shape=w}return{shape:g.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=Eke(e,u,d),f=this.getAndSaveBinary(h,()=>Nke(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),H().get("ENGINE_COMPILE_ONLY")||$ke(this.gpgpu,f,u,d,s),c.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const x=H().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const g=tr();g-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!H().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=G(()=>{if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=H().getBool("DEBUG");H().set("DEBUG",!1);const n=this.abs(Xe(1e-8)).dataSync()[0];if(H().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?lSe:cSe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=tr());let d=n.texShape;if(d==null&&(d=Pwe(r,l),n.texShape=d),i!=null){const h=cm(r);let f,p=d[1],m=d[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([p,m]=Gu(d[0],d[1])),l?f=new Pke(h,x):f=new jD(h,x);const g=x?[m,p]:d,y=this.makeTensorInfo(g,s),b=this.texData.get(y.dataId);x?b.usage=jr.PIXELS:b.usage=jr.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,m,i);const w=[[m,p]],C=this.runWebGLProgram(f,[y],s,w,!0),S=this.texData.get(C.dataId);n.texShape=S.texShape,n.isPacked=S.isPacked,n.usage=S.usage,H().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=S.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=tr()-u)}else{const h=this.acquireTexture(d,a,s,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=pSe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Mg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await O4(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(AU(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=_U(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=ii().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(s,n,r,i,o,a);return ii().makeTensorFromDataId(c,n,r,l)}}Zy.nextDataId=0;function pSe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */$j()&&Dj("webgl",()=>new Zy,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gN=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Dl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Ae(n,r),this.enableShapeUniforms=Ln(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ql=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Yu{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ae(n,r);const i=this.outputShape.length;this.enableShapeUniforms=Ln(i);let o="";if(s)if(i===0||Q(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${st(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Kn("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const mSe={kernelName:Ef,backendName:"webgl",kernelFunc:$r};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=$r({inputs:{x:r},backend:n}),l=$r({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const gSe={kernelName:VS,backendName:"webgl",kernelFunc:Ea};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU="return (a < 0.) ? b * a : a;",KU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function xSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",ba(i,"float32")),a=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yu(KU,s.shape,o.shape):new Dl(HU,s.shape,o.shape),l=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const ySe={kernelName:Hx,backendName:"webgl",kernelFunc:xSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU="return (a < 0.) ? b * a : a;",XU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function vSe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yu(XU,r.shape,s.shape):new Dl(qU,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const bSe={kernelName:dy,backendName:"webgl",kernelFunc:vSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qu="if (isnan(x)) return x;";function Ue({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=H().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Fo(o.shape,e):u=new hi(o.shape,t),a.runWebGLProgram(u,[o],l)}}function In({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(r&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[x,g]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[w,k]=b,C={dataId:w.dataId,dtype:w.dtype,shape:l.shape},S={dataId:k.dataId,dtype:k.dtype,shape:c.shape},I=new Dl(t,l.shape,c.shape);return u.runWebGLProgram(I,[C,S],Ir(w.dtype,k.dtype))}),y=Ea({inputs:{real:x,imag:g},backend:u});return u.disposeIntermediateTensorInfo(x),u.disposeIntermediateTensorInfo(g),y}const d=i||Ir(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&s!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,x=l.dtype==="string"?ao(p):p,g=l.dtype==="string"?ao(m):m,[y,b]=s(l.shape,c.shape,x,g,d),w=u.makeTensorInfo(b,d),k=u.texData.get(w.dataId);return k.values=y,w}const h=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new Yu(e,l.shape,c.shape,n):f=new Dl(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function _h(t,e=!1){if(t==="linear")return e?tSe:YCe;if(t==="relu")return e?rSe:ZCe;if(t==="elu")return e?nSe:QCe;if(t==="relu6")return e?sSe:JCe;if(t==="prelu")return e?XU:qU;if(t==="leakyrelu")return e?KU:HU;if(t==="sigmoid")return e?iSe:eSe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YU{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Ln(this.outputShape.length);const u=s?e[1]:e[2],d=Math.ceil(u/2),h=s?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",g="";a&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class GD{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ae(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HD="return a * b;";function xN(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=Ir(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),c=new GD(VD.REAL,r.shape,s.shape),u=new GD(VD.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Ea({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[c,u]=vCe(r.shape,s.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Yu(HD,r.shape,s.shape):o=new Dl(HD,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const wSe={kernelName:Ff,backendName:"webgl",kernelFunc:xN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSe(t,e,n){const r=[ku(t.shape),...Cu(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[ku(e),...Cu(e)],o=new GU(i,r),a=!0,l=[r],c=n.runWebGLProgram(o,[s],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=Q(s.shape),l=ML(i,a),c=Q(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(s.dataId);return u.isPacked&&!a0(s.shape,l)&&!(u.texture!==null&&a0(u.shape,l))?kSe(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const CSe={kernelName:fy,backendName:"webgl",kernelFunc:ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KD{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${hu(d)?d.toPrecision(2):d}, ones);`}let u="";i%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SSe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=My(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Zl(t,e,n,r){const s=ISe(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:c}=s[o];let u,d;n==="mean"?u=o===0?new KD({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new KD({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new SSe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=r.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NSe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=st(this.rank),i=$Se(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function $Se(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ESe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[n[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=st(this.rank),i=VU("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jy(t,e,n){const r=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ESe(t.shape,e):new NSe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(t,e,n,r){const s=e,i=t.shape.length,o=Me(s,t.shape);let a=o;const l=Et(a,i),c=l!=null;let u=t;c&&(u=Jy(t,l,r),a=Lt(a.length,i)),Sn("sum",a,i);const[d,h]=fn(u.shape,a);let f=d;n&&(f=Ut(d,o));const p=Q(h),x=Q(t.shape)/p,g=ae({inputs:{x:u},attrs:{shape:[x,p]},backend:r}),y=I2(t.dtype),b=Zl(g,y,"sum",r),w=ae({inputs:{x:b},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),c&&r.disposeIntermediateTensorInfo(u),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ev(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return TSe(s,i,o,n)}const ASe={kernelName:vy,backendName:"webgl",kernelFunc:ev};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=s.shape[i[u]];let c;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,h=mN(d,s.shape,s.dtype,i,l);c=o.makeTensorInfo(l,s.dtype);const f=o.texData.get(c.dataId);f.values=h}else c=Jy(s,i,o);return c}const DSe={kernelName:Bc,backendName:"webgl",kernelFunc:Qn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU=1e3;function l0({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=r?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=r?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),x=e.shape.slice(0,-2),g=Q(m),y=Q(x),w=Ae(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const k=n?[g,d,f]:[g,f,d],C=r?[y,p,h]:[y,h,p],S=ae({inputs:{x:t},backend:s,attrs:{shape:k}}),I=ae({inputs:{x:e},backend:s,attrs:{shape:C}}),$=[S,I],E=Math.max(g,y),A=n?S.shape[1]:S.shape[2],D=i!=null,P=o!=null,O=l==="leakyrelu",F=l!=null?_h(l,!0):null,U=D||P||O||F!=null;let V;if((f===1||p===1)&&A>QU&&U===!1){let z=S,K=I;n&&(z=Qn({inputs:{x:S},backend:s,attrs:{perm:[0,2,1]}}),$.push(z)),r&&(K=Qn({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),$.push(K));const Z=p!==1,q=p===1;let te=z;Z&&(te=ae({inputs:{x:z},backend:s,attrs:{shape:[E,A,1]}}),$.push(te));const ie=p===1?2:1;let oe=K;q&&(oe=ae({inputs:{x:K},backend:s,attrs:{shape:[E,1,A]}}),$.push(oe));const le=xN({inputs:{a:te,b:oe},backend:s});V=ev({inputs:{x:le},backend:s,attrs:{axis:ie,keepDims:!0}}),$.push(le)}else{const z=Ir(t.dtype,e.dtype),K=new YU(k,C,[E,f,p],n,r,D,F,P,O),Z=[S,I];if(i!=null&&Z.push(i),P&&Z.push(o),O){const q=s.makeTensorInfo([],"float32",ba(a,"float32"));Z.push(q),$.push(q)}V=s.runWebGLProgram(K,Z,z)}const _=ae({inputs:{x:V},backend:s,attrs:{shape:w}});$.push(V);for(const z of $)s.disposeIntermediateTensorInfo(z);return _}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return l0({a:s,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const RSe={kernelName:Fg,backendName:"webgl",kernelFunc:OSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qD="return abs(x);";function PSe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=WU(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return H().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Fo(r.shape,qD):s=new hi(r.shape,qD),n.runWebGLProgram(s,[r],r.dtype)}const _Se={kernelName:Nx,backendName:"webgl",kernelFunc:PSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MSe=Ts+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,FSe=Ue({opSnippet:MSe}),LSe={kernelName:lf,backendName:"webgl",kernelFunc:FSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSe=Ts+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,zSe=Ue({opSnippet:jSe}),BSe={kernelName:cf,backendName:"webgl",kernelFunc:zSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XD="return a + b;",WSe=In({opSnippet:XD,packedOpSnippet:XD,supportsComplex:!0,cpuKernelImpl:Zke}),USe={kernelName:Lu,backendName:"webgl",kernelFunc:WSe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VSe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GSe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $m(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return $r({inputs:{x:r[0]},backend:n});if(r.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=$m({inputs:r.slice(0,l),backend:n}),u=$m({inputs:r.slice(l),backend:n});return $m({inputs:[c,u],backend:n})}const s=r.map(l=>l.dtype).reduce((l,c)=>Ir(l,c)),i=r.map(l=>l.shape),a=H().getBool("WEBGL_PACK")?new GSe(r[0].shape,i):new VSe(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const HSe={kernelName:FS,backendName:"webgl",kernelFunc:$m};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Me(i,s.shape);let c=l;const u=Et(c,a);let d=s;u!=null&&(d=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Lt(c.length,a)),Sn("all",c,a);const[h,f]=fn(d.shape,c),p=Q(f),m=ae({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Zl(m,m.dtype,"all",n);let g;if(o){const y=Ut(h,l);g=ae({inputs:{x},backend:n,attrs:{shape:y}})}else g=ae({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const qSe={kernelName:LS,backendName:"webgl",kernelFunc:KSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Me(i,s.shape);let c=l;const u=Et(c,a);let d=s;u!=null&&(d=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Lt(c.length,a)),Sn("any",c,a);const[h,f]=fn(d.shape,c),p=Q(f),m=ae({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Zl(m,m.dtype,"any",n);let g;if(o){const y=Ut(h,l);g=ae({inputs:{x},backend:n,attrs:{shape:y}})}else g=ae({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const YSe={kernelName:jS,backendName:"webgl",kernelFunc:XSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QSe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZSe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=st(l),u=Kn("coords",l);let d,h;if(o===1){h=l+1;const I=st(h);d=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(I=>"int "+I),x=Kn("sourceLocR",h-1).concat("inIdx.r"),g=Kn("sourceLocG",h-1).concat("inIdx.g"),y=Kn("sourceLocB",h-1).concat("inIdx.b"),b=Kn("sourceLocA",h-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",k=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,C=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,S=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=My(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new QSe(a,n,r==null),c=[e];r!=null&&c.push(r);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=ZU(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function JU(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=My(i),a=new ZSe(s,o,n,r==null),l=r==null?[e]:[e,r],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=JU(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function eV(t,e,n,r){const s=[n];if(Sn("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!H().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=fn(l.shape,s),d=Q(u),h=ae({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=ZU(t,h,r);i.push(f);const p=ae({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return JU(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Me(i,s.shape);const a=Et(o,s.shape.length);let l=s;const c=[];a!=null&&(l=Qn({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),o=Lt(o.length,l.shape.length)),Sn("argMax",[o[0]],l.shape.length);const u=eV(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const e2e={kernelName:$x,backendName:"webgl",kernelFunc:JSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Me(i,s.shape);const a=Et(o,s.shape.length);let l=s;const c=[];a!=null&&(l=Qn({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),o=Lt(o.length,l.shape.length)),Sn("argMin",[o[0]],l.shape.length);const u=eV(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const n2e={kernelName:Ex,backendName:"webgl",kernelFunc:t2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r2e=Ts+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,s2e=Ue({opSnippet:r2e}),i2e={kernelName:uf,backendName:"webgl",kernelFunc:s2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o2e=Ts+"return log(x + sqrt(x * x + 1.0));",a2e=Ue({opSnippet:o2e}),l2e={kernelName:df,backendName:"webgl",kernelFunc:a2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2e=Ts+`
  return atan(x);
`,u2e=Ue({opSnippet:c2e}),d2e={kernelName:hf,backendName:"webgl",kernelFunc:u2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h2e=gN+`
  return atan(a, b);
`,f2e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ql+`
  return result;
`,p2e=In({opSnippet:h2e,packedOpSnippet:f2e}),m2e={kernelName:pf,backendName:"webgl",kernelFunc:p2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g2e=Ts+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,x2e=Ue({opSnippet:g2e}),y2e={kernelName:ff,backendName:"webgl",kernelFunc:x2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mh{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(m||(y="-1.0 / 1e-20"),r){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?x:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const k=Math.floor(o/4)*4,C=o%4,S=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${S}
          }

          int xC = xCCorner + ${k};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${S}
          }
        }
        setOutput(${w});
      }
    `}}class yN{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,x=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${x}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const S=Math.floor(o/4)*4,I=o%4,$=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${x}, ${g}, ${y});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${S}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${S};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${$}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;wp(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=1;T(Mn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=$s(s.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))return $r({inputs:{x:s},backend:n});const d=new Mh(u,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const b2e={kernelName:Tx,backendName:"webgl",kernelFunc:v2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=mo(s.shape,i,o,u,a,l,c),h=new yN(d,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const k2e={kernelName:Ax,backendName:"webgl",kernelFunc:w2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class S2e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,x=f-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${x});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=mo(o.shape,a,l,d,c,u),f=new S2e(h);return n.runWebGLProgram(f,[s],o.dtype)}const N2e={kernelName:BS,backendName:"webgl",kernelFunc:I2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;wp([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=$s(o.shape,a,l,1,c),d=new C2e(u);return n.runWebGLProgram(d,[s],o.dtype)}const E2e={kernelName:zS,backendName:"webgl",kernelFunc:$2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2e(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return l0({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const A2e={kernelName:Dx,backendName:"webgl",kernelFunc:T2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D2e{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Ae(e,n),Ae(e,r);let a="0.0";s!=null&&(Ae(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Ae(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O2e{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ae(e,n),Ae(e,r);let a="vec4(0.0)";s!=null&&(Ae(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Ae(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R2e=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;T(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[r,s,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=H().getBool("WEBGL_PACK_NORMALIZATION")?new O2e(r.shape,s.shape,i.shape,u,d,l):new D2e(r.shape,s.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},P2e={kernelName:Ux,backendName:"webgl",kernelFunc:R2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _2e{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=st(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=M2e(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${Uw[a]} = start[${a}] + coords.${Uw[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Uw=["x","y","z","w","u","v"];function M2e(t){if(t===1)return"sourceLoc";if(t<=6)return Uw.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F2e{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=st(this.rank),r=Kn("coords",this.rank),s=Kn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=fI(e,ve(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function Zu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,l]=_y(s,i,o);if(uI(s,a,l),Q(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),h=ACe(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}const{isPacked:c}=n.texData.get(s.dataId),u=hI(s.shape,a,l);if(c||!u){const d=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new F2e(l):new _2e(l),h=[a];return n.runWebGLProgram(d,[s],s.dtype,h)}return n.uploadToGPU(s.dataId),L2e(s,a,l,n)}const j2e={kernelName:yy,backendName:"webgl",kernelFunc:Zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;T(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,b)=>y*b),l=lp(s.shape,i,a),c=cp(l.length,i.length),u=up(s.shape,i,a),d=yI(o,i.length),h=vI(u,o,i.length),f=[],p=ae({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Qn({inputs:{x:p},backend:n,attrs:{perm:c}}),x=ae({inputs:{x:m},backend:n,attrs:{shape:u}}),g=Zu({inputs:{x},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(x),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},B2e={kernelName:Ox,backendName:"webgl",kernelFunc:z2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),l=n.readSync(i.dataId),c=BU(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const U2e={kernelName:WS,backendName:"webgl",kernelFunc:W2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V2e=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,G2e=`
  return float(int(a.r) & int(b.r));
`;function H2e(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=H().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const l=n.texData.get(r.dataId).values,c=n.texData.get(s.dataId).values,[u,d]=eCe(r.shape,s.shape,l,c,r.dtype),h=n.makeTensorInfo(d,r.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return i?a=new Yu(V2e,r.shape,s.shape,!1):a=new Dl(G2e,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const K2e={kernelName:US,backendName:"webgl",kernelFunc:H2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=Ae(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const X2e={kernelName:WL,backendName:"webgl",kernelFunc:q2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y2e="return float(a != b);",tV=In({opSnippet:Y2e,cpuKernelImpl:wCe,dtype:"bool"}),Q2e={kernelName:oy,backendName:"webgl",kernelFunc:tV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cp(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return $r({inputs:{x:s.complexTensorInfos.real},backend:n})}const Z2e={kernelName:p2,backendName:"webgl",kernelFunc:Cp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2e="return float(int(x));";function eIe(t,e){const n=new hi(t.shape,J2e),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vw(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return $r({inputs:{x:s},backend:n});const o=ln(s.shape),a=Vw({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Ea({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=Cp({inputs:{input:s},backend:n}),a=Vw({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!FL(s.dtype,i)){const o=$r({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,l,c]=tCe(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return eIe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Rn("bool",1)),l=tV({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const tIe={kernelName:mf,backendName:"webgl",kernelFunc:Vw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD="return ceil(x);",nIe=Ue({opSnippet:YD,packedOpSnippet:YD,cpuKernelImpl:nCe}),rIe={kernelName:gf,backendName:"webgl",kernelFunc:nIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sIe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iIe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;H().getBool("WEBGL_PACK_CLIP")?a=new iIe(s.shape):a=new sIe(s.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,l)}const aIe={kernelName:xf,backendName:"webgl",kernelFunc:oIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lIe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QD(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function cIe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new lIe(r.shape),o=[QD(r,s.complexTensorInfos.real),QD(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const uIe={kernelName:Rx,backendName:"webgl",kernelFunc:cIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dIe{constructor(e){this.outputShape=[],this.outputShape=yi(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hIe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=yi(e,n);const r=this.outputShape,s=r.length,i=st(s),o=Kn("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const x=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${hm(a,c,x)}),
            vec2(${hm(u,c,x)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${hm(a,c,p)}),
          vec2(${hm(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function hm(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return $r({inputs:{x:s.complexTensorInfos.imag},backend:n})}const fIe={kernelName:o2,backendName:"webgl",kernelFunc:tv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pd(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(y=>Cp({inputs:{input:y},backend:n})),p=t.map(y=>tv({inputs:{input:y},backend:n})),m=Pd(f,e,n),x=Pd(p,e,n),g=Ea({inputs:{real:m,imag:x},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(w=>{const C=[-1,Q(w.shape.slice(e))];return ae({inputs:{x:w},backend:n,attrs:{shape:C}})}),p=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),m=yi(f.map(w=>w.shape),1),x=f[0].shape[0]===1,g=rCe(p,m,r,x),y=yi(t.map(w=>w.shape),e),b=n.makeTensorInfo(y,r,g);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const i=t.filter(f=>Q(f.shape)>0),o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new hi(t[0].shape,To):new Fo(t[0].shape,To);return n.runWebGLProgram(f,t,r)}const a=H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let m=0;m<i.length;m+=a){const x=i.slice(m,m+a);f.push(Pd(x,e,n))}const p=Pd(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(o){const f=new hIe(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,r)}const{tensors2D:l,outShape:c}=pIe(i,e,n),u=new dIe(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ae({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function pIe(t,e,n){const r=yi(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>ae({inputs:{x:i},attrs:{shape:[-1,Q(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Me(s,e[0].shape)[0],o=e.map(c=>c.shape);mI(o,i);const a=yi(e.map(c=>c.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>Q(c.shape)>0);return l.length===1?$r({inputs:{x:l[0]},backend:n}):Pd(l,i,n)}const mIe={kernelName:Px,backendName:"webgl",kernelFunc:nV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rV{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,x=e.dataFormat==="channelsLast",g=x?1:2,y=x?2:3,b=x?3:1;let w="",k="";r&&(s?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,k="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${k}
        setOutput(result);
      }
    `}}class gIe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sV{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ln(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<u;x++)h+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<u;x++)h+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const g=x*2;if(h+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<u)){const y=o%2===0?OS(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):y===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<u&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<u&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<u&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xIe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Ln(this.outputShape.length);const{dataFormat:r}=n,s=Jn(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function iV({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=r.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let x;const g=[];if(i!=null){const w=c0(i.shape,f);w!=null&&(i=ae({inputs:{x:i},backend:r,attrs:{shape:w}}),g.push(i))}if(s!=null){const w=c0(s.shape,f);w!=null&&(s=ae({inputs:{x:s},backend:r,attrs:{shape:w}}),g.push(s))}if(!((d===1||h===1)&&u>QU)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Qe(c.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),k={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},C=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(a0(c.shape,k.shape),()=>`packed reshape ${c.shape} to ${k.shape} isn't free`);const S=ae({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(S);const I=l0({a:k,b:S,backend:r,transposeA:p,transposeB:m,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),$=r.texData.get(I.dataId);T($.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=C,$.shape=n.outShape,x=$r({inputs:{x:I},backend:r}),x.shape=n.outShape,g.push(I)}else{const w=n.outHeight*n.outWidth,k=ae({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),C=ae({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),S=l0({a:f?k:C,b:f?C:k,transposeA:!f,transposeB:m,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});x=ae({inputs:{x:S},backend:r,attrs:{shape:n.outShape}}),g.push(k),g.push(C),g.push(S)}for(const w of g)r.disposeIntermediateTensorInfo(w);return x}function oV({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,x=h*d,g=[n.batchSize,m,x],y=!0,b=!1,w=[];if(i!=null){const _=c0(i.shape,p);_!=null&&(i=ae({inputs:{x:i},backend:r,attrs:{shape:_}}),w.push(i))}if(s!=null){const _=c0(s.shape,p);_!=null&&(s=ae({inputs:{x:s},backend:r,attrs:{shape:_}}),w.push(s))}const k=ae({inputs:{x:e},backend:r,attrs:{shape:[1,m,Q(e.shape)/m]}});w.push(k);const C=new xIe(g,n),S=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=r.runWebGLProgram(C,[t],"float32",S),$=ae({inputs:{x:I},backend:r,attrs:{shape:g}});w.push(I),w.push($);const E=s!=null,A=i!=null,D=a==="leakyrelu",P=a?_h(a,!0):null,O=new YU(p?$.shape:k.shape,p?k.shape:$.shape,p?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],y,b,E,P,A,D),F=p?[$,k]:[k,$];if(s&&F.push(s),A&&F.push(i),D){const _=r.makeTensorInfo([],"float32",ba(o,"float32"));F.push(_),w.push(_)}const U=r.runWebGLProgram(O,F,"float32"),V=ae({inputs:{x:U},backend:r,attrs:{shape:n.outShape}});w.push(U);for(const _ of w)r.disposeIntermediateTensorInfo(_);return V}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=go(l),h=Cn(s.shape,i.shape,o,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=iV({x:s,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&H().getBool("WEBGL_EXP_CONV")){const m=new sV(h),x=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[s,i],"float32",x)}else if(H().getBool("WEBGL_CONV_IM2COL"))f=oV({x:s,filter:i,convInfo:h,backend:n});else{const m=new rV(h);f=n.runWebGLProgram(m,[s,i],"float32")}const p=ae({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const vIe={kernelName:_x,backendName:"webgl",kernelFunc:yIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bIe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wIe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class kIe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class CIe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=r-1-e.padInfo.top,u=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=go(l),h=Cn(s.shape,u,o,1,a,c,!1,d),f=new bIe(h);return n.runWebGLProgram(f,[s,i],"float32")}const IIe={kernelName:GS,backendName:"webgl",kernelFunc:SIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NIe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Ln(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=go(c),h=Cn(o,i.shape,a,1,l,u,!1,d);if(H().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new NIe(h);return n.runWebGLProgram(p,[s,i],"float32",f)}else{const f=new wIe(h);return n.runWebGLProgram(f,[s,i],"float32")}}const EIe={kernelName:Mx,backendName:"webgl",kernelFunc:$Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,c=wa(s.shape,i.shape,o,l,a),u=new gIe(c);return n.runWebGLProgram(u,[s,i],"float32")}const AIe={kernelName:Fx,backendName:"webgl",kernelFunc:TIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,c=wa(s.shape,l,o,1,a),u=new kIe(c);return n.runWebGLProgram(u,[s,i],"float32")}const OIe={kernelName:HS,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,c=wa(l,i.shape,a,1,o),u=new CIe(c);return n.runWebGLProgram(u,[s,i],"float32")}const PIe={kernelName:KS,backendName:"webgl",kernelFunc:RIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ie=Qu+`
  return cos(x);
`,MIe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Ql}
  return result;
`,FIe=Ue({opSnippet:_Ie,packedOpSnippet:MIe}),LIe={kernelName:yf,backendName:"webgl",kernelFunc:FIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jIe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,zIe=Ue({opSnippet:jIe}),BIe={kernelName:vf,backendName:"webgl",kernelFunc:zIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WIe{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=r;this.outputShape=[u,d,h,c];const f=s==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[x,g,y]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,w,k]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${w};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UIe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=r,u=new WIe(s.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[s,i,o],"float32")},VIe={kernelName:XS,backendName:"webgl",kernelFunc:UIe};var Fh;(function(t){t.Prod="*",t.Sum="+"})(Fh||(Fh={}));class ZD{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Fh.Prod?"1.0":"0.0",a=r?o:`getX(${JD(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";r?(c=s?`end != ${l-1}`:"end != 0",u=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${l}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${st(i)} coords = getOutputCoords();
        int end = ${eO(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${eO(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${JD(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function JD(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function eO(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t,e,n,r,s,i){const o=e.shape.length,a=Et([r],o);let l=e;a!=null&&(l=Qn({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Lt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let d=$r({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new ZD(t,l.shape,!1,i),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(s){const h=new ZD(t,l.shape,s,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=ka(a),f=Qn({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return aV(Fh.Prod,s,n,i,o,a)}const HIe={kernelName:qS,backendName:"webgl",kernelFunc:GIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return aV(Fh.Sum,s,n,i,o,a)}const qIe={kernelName:Lx,backendName:"webgl",kernelFunc:KIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),c=n.readSync(i.dataId),u=BU(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(s.shape.length===2){const l=n.bufferSync(s),c=n.bufferSync(i),u=Jke(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const YIe={kernelName:YS,backendName:"webgl",kernelFunc:XIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QIe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],c=o==="NHWC"?s.shape[2]:s.shape[3],u=o==="NHWC"?s.shape[3]:s.shape[1],d=l*i,h=c*i,f=u/(i*i),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new QIe(p,i,o);return n.runWebGLProgram(m,[s],s.dtype)}const JIe={kernelName:QS,backendName:"webgl",kernelFunc:ZIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lV{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ln(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";r&&(s?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cV{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ln(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let g=0;g<d;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const y=g*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<d)){const b=a%2===0?OS(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<d&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<d&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<d&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=r;let u=l;u==null&&(u=[1,1]),T(Mn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Cn(s.shape,i.shape,o,u,a,c,!0);let h;H().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new cV(d):h=new lV(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,i],"float32",f)}const tNe={kernelName:jx,backendName:"webgl",kernelFunc:eNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nNe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class rNe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,d=Cn(s.shape,u,o,a,l,c,!0),h=new nNe(d);return n.runWebGLProgram(h,[s,i],"float32")}const iNe={kernelName:ZS,backendName:"webgl",kernelFunc:sNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,d=Cn(u,i.shape,o,a,l,c,!0),h=new rNe(d);return n.runWebGLProgram(h,[s,i],"float32")}const aNe={kernelName:JS,backendName:"webgl",kernelFunc:oNe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lNe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cNe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=Q(r.shape),o=ae({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new lNe(i),l=n.runWebGLProgram(a,[o],o.dtype),c=ae({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const uNe={kernelName:UL,backendName:"webgl",kernelFunc:cNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dNe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,c=rp(s.shape,i.shape,o,a,"NHWC",l);let u;const d=new dNe(c);u=n.runWebGLProgram(d,[s,i],"float32");const h=ae({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const fNe={kernelName:zx,backendName:"webgl",kernelFunc:hNe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=$I(s,i.length);TI(o.length,l,i);const{path:c,steps:u}=AI(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const x of u[m]){const{permutationIndices:g,expandDims:y}=EI(f,l[x]);let b;DI(g)?b=i[x]:(b=Qn({inputs:{x:i[x]},backend:n,attrs:{perm:g}}),p.push(b));const w=b.shape.slice();for(let k=0;k<y.length;++k)w.splice(y[k],0,1);Qe(b.shape,w)||(b=ae({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),h===null?h=b:(h=xN({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=ev({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const mNe={kernelName:e2,backendName:"webgl",kernelFunc:pNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe="return (x >= 0.0) ? x : (exp(x) - 1.0);",xNe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,yNe=Ue({opSnippet:gNe,packedOpSnippet:xNe}),vNe={kernelName:wf,backendName:"webgl",kernelFunc:yNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNe="return (b >= 0.0) ? a : a * (b + 1.0);",wNe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,kNe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yu(wNe,r.shape,s.shape):new Dl(bNe,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},CNe={kernelName:t2,backendName:"webgl",kernelFunc:kNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SNe=`
  return vec4(equal(a, b));
`,INe="return float(a == b);",NNe=In({opSnippet:INe,packedOpSnippet:SNe,dtype:"bool",cpuKernelImpl:sCe}),$Ne={kernelName:Bx,backendName:"webgl",kernelFunc:NNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ENe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${bI};
  float a1 = ${wI};
  float a2 = ${kI};
  float a3 = ${CI};
  float a4 = ${SI};
  float a5 = ${II};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,TNe=Ue({opSnippet:ENe}),ANe={kernelName:kf,backendName:"webgl",kernelFunc:TNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNe=Qu+`
  return exp(x);
`,ONe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uV=Ue({opSnippet:DNe,packedOpSnippet:ONe,cpuKernelImpl:iCe,dtype:"float32"}),RNe={kernelName:Cf,backendName:"webgl",kernelFunc:uV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(T(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),ae({inputs:{x:i},backend:r,attrs:{shape:a}})}const PNe={kernelName:Wx,backendName:"webgl",kernelFunc:Gw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tO="return exp(x) - 1.0;",_Ne=Ue({opSnippet:tO,packedOpSnippet:tO,cpuKernelImpl:oCe}),MNe={kernelName:Sf,backendName:"webgl",kernelFunc:_Ne};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nO{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(t,e,n){const r=n.texData.get(t.dataId),s=Q(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=ae({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new nO("real",l,e),u=new nO("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Ea({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ae({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t){const{inputs:e,backend:n}=t,{input:r}=e;return dV(r,!1,n)}const LNe={kernelName:n2,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jNe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sp(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||Mu(s),i==="string"){const o=_t(i,Q(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new jNe(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const zNe={kernelName:r2,backendName:"webgl",kernelFunc:Sp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WNe={kernelName:s2,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new BNe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rO="return floor(x);",UNe=Ue({opSnippet:rO,packedOpSnippet:rO,cpuKernelImpl:aCe}),VNe={kernelName:If,backendName:"webgl",kernelFunc:UNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,HNe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,KNe=In({opSnippet:GNe,packedOpSnippet:HNe,dtype:"int32"}),qNe={kernelName:Nf,backendName:"webgl",kernelFunc:KNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XNe{constructor(e){this.variableNames=["A"];const n=Jn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YNe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Jn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QNe={kernelName:poe,backendName:"webgl",kernelFunc:ZNe};let ac,xb=H().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function ZNe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,c]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[c,l],d=[c,l,i];if(a||o){const m=H().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ac==null||m!==xb)&&(xb=m,ac=document.createElement("canvas").getContext("2d",{willReadFrequently:xb})),ac.canvas.width=l,ac.canvas.height=c,ac.drawImage(s,0,0,l,c),s=ac.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=jr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const f=H().getBool("WEBGL_PACK")?new YNe(d):new XNe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r,m=go(u),x=Cn(s.shape,i.shape,l,d,c,h,!1,m);let g;const y=[],b=o!=null,w=a!=null,k=f==="leakyrelu",C=()=>{const I=[s,i],$=(E,A)=>{if(A==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const D=ae({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return y.push(D),D}return E};if(b&&I.push($(o,u)),w&&I.push($(a,u)),k){const E=n.makeTensorInfo([],"float32",ba(p,"float32"));I.push(E),y.push(E)}return I};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))g=iV({x:s,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(x.strideWidth<=2&&m==="channelsLast"&&H().getBool("WEBGL_EXP_CONV")){const I=f?_h(f,!0):null,$=new sV(x,b,I,w,k),E=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],A=C();g=n.runWebGLProgram($,A,"float32",E)}else if(H().getBool("WEBGL_CONV_IM2COL"))g=oV({x:s,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const I=f?_h(f,!1):null,$=new rV(x,b,I,w,k),E=C();g=n.runWebGLProgram($,E,"float32")}const S=ae({inputs:{x:g},backend:n,attrs:{shape:x.outShape}});return y.push(g),y.forEach(I=>n.disposeIntermediateTensorInfo(I)),S}const e$e={kernelName:Lg,backendName:"webgl",kernelFunc:JNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r,p=[];let m=u;m==null&&(m=[1,1]),T(Mn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const x=Cn(s.shape,i.shape,l,m,c,d,!0),g=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,y=h?_h(h,g):null,b=[s,i],w=o!=null,k=a!=null,C=h==="leakyrelu";if(w&&b.push(o),k&&b.push(a),C){const E=n.makeTensorInfo([],"float32",ba(f,"float32"));b.push(E),p.push(E)}let S;g?S=new cV(x,w,y,k,C):S=new lV(x,w,y,k,C);const I=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],$=n.runWebGLProgram(S,b,"float32",I);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),$}const n$e={kernelName:lj,backendName:"webgl",kernelFunc:t$e};class r$e{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=st(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=Q(r.shape),[l,c,u,d]=cI(r,s),h=ae({inputs:{x:s},backend:n,attrs:{shape:[c,o]}}),f=ae({inputs:{x:r},backend:n,attrs:{shape:[Q(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),y=n.bufferSync(r),b=lCe(g,y,r.dtype,c,o,u,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new r$e(o,d,[c,u],r.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),x=ae({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),x}const i$e={kernelName:VL,backendName:"webgl",kernelFunc:s$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o$e{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=st(this.rank),s=a$e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function a$e(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=Me(o,s.shape)[0];if(H().get("DEBUG")){const y=n.readSync(i.dataId),b=s.shape[l];for(let w=0;w<y.length;++w){const k=y[w];T(k<=b-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${b-1}]`)}}const c=RI(s,i,l,a),u=Q(i.shape),d=[],h=ae({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ae({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(h),w=cCe(b,y,p);return d.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(c.outputShape,w.dtype,w.values)}const m=new o$e(h.shape,p),x=n.runWebGLProgram(m,[h,f],h.dtype);d.push(x);const g=ae({inputs:{x},backend:n,attrs:{shape:c.outputShape}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const l$e={kernelName:Vx,backendName:"webgl",kernelFunc:hV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$e="return float(a > b);",u$e=`
  return vec4(greaterThan(a, b));
`,d$e=In({opSnippet:c$e,packedOpSnippet:u$e,cpuKernelImpl:uCe,dtype:"bool"}),h$e={kernelName:Gx,backendName:"webgl",kernelFunc:d$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$e="return float(a >= b);",p$e=`
  return vec4(greaterThanEqual(a, b));
`,m$e=In({opSnippet:f$e,packedOpSnippet:p$e,dtype:"bool",cpuKernelImpl:dCe}),g$e={kernelName:$f,backendName:"webgl",kernelFunc:m$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x$e(t){const{inputs:e,backend:n}=t,{input:r}=e;return dV(r,!0,n)}const y$e={kernelName:i2,backendName:"webgl",kernelFunc:x$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v$e="return float(!isnan(x) && !isinf(x));",b$e=Ue({opSnippet:v$e,dtype:"bool"}),w$e={kernelName:Tf,backendName:"webgl",kernelFunc:b$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$e="return float(isinf(x));",C$e=Ue({opSnippet:k$e,dtype:"bool"}),S$e={kernelName:Af,backendName:"webgl",kernelFunc:C$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$e="return float(isnan(x));",N$e=Ue({opSnippet:I$e,dtype:"bool"}),$$e={kernelName:Df,backendName:"webgl",kernelFunc:N$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E$e="return float(a < b);",T$e=`
  return vec4(lessThan(a, b));
`,A$e=In({opSnippet:E$e,packedOpSnippet:T$e,cpuKernelImpl:hCe,dtype:"bool"}),D$e={kernelName:Kx,backendName:"webgl",kernelFunc:A$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$e="return float(a <= b);",R$e=`
  return vec4(lessThanEqual(a, b));
`,P$e=In({opSnippet:O$e,packedOpSnippet:R$e,cpuKernelImpl:fCe,dtype:"bool"}),_$e={kernelName:qx,backendName:"webgl",kernelFunc:P$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=pCe(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const F$e={kernelName:GL,backendName:"webgl",kernelFunc:M$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$e=Qu+`
  return x < 0.0 ? 0./0. : log(x);
`,j$e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,z$e=Ue({opSnippet:L$e,packedOpSnippet:j$e,cpuKernelImpl:mCe}),B$e={kernelName:Of,backendName:"webgl",kernelFunc:z$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W$e=Qu+`
  return log(1.0 + x);
`,U$e=Ue({opSnippet:W$e}),V$e={kernelName:Rf,backendName:"webgl",kernelFunc:U$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e="return float(a >= 1.0 && b >= 1.0);",H$e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,K$e=In({opSnippet:G$e,packedOpSnippet:H$e,dtype:"bool"}),q$e={kernelName:Xx,backendName:"webgl",kernelFunc:K$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X$e="return float(!(x >= 1.0));",Y$e=Ue({opSnippet:X$e}),Q$e={kernelName:Yx,backendName:"webgl",kernelFunc:Y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$e="return float(a >= 1.0 || b >= 1.0);",J$e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,eEe=In({opSnippet:Z$e,packedOpSnippet:J$e,dtype:"bool"}),tEe={kernelName:Qx,backendName:"webgl",kernelFunc:eEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nEe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rEe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,c=H().getBool("WEBGL_PACK_NORMALIZATION")?new rEe(s.shape,i,o,a,l):new nEe(s.shape,i,o,a,l);return n.runWebGLProgram(c,[s],s.dtype)},iEe={kernelName:Zx,backendName:"webgl",kernelFunc:sEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oEe{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aEe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r,d=new oEe(s.shape,a,l,c,u);return n.runWebGLProgram(d,[s,i,o],s.dtype)},lEe={kernelName:a2,backendName:"webgl",kernelFunc:aEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cEe(t,e,n,r){const s=Q(e),o=Q(t.shape)/s,a=ae({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Zl(a,t.dtype,"max",r),c=ae({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=Me(i,s.shape);let c=l;const u=Et(c,a),d=u!=null,h=n.shouldExecuteOnCPU([s]);let f=s;if(d){if(h){const b=n.texData.get(f.dataId).values,w=new Array(a);for(let S=0;S<w.length;S++)w[S]=s.shape[u[S]];const k=mN(b,s.shape,s.dtype,u,w);f=n.makeTensorInfo(w,s.dtype);const C=n.texData.get(f.dataId);C.values=k}else f=Jy(s,u,n);c=Lt(c.length,a)}Sn("max",c,a);const[p,m]=fn(f.shape,c);let x=p;o&&(x=Ut(p,l));let g;if(h){const b=n.texData.get(f.dataId).values,w=gCe(b,Q(m),x,s.dtype);g=n.makeTensorInfo(x,s.dtype);const k=n.texData.get(g.dataId);k.values=w}else g=cEe(f,m,x,n);return d&&n.disposeIntermediateTensorInfo(f),g}const uEe={kernelName:Jx,backendName:"webgl",kernelFunc:fV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dEe=gN+`
  return max(a, b);
`,hEe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ql+`
  return result;
`,fEe=In({opSnippet:dEe,packedOpSnippet:hEe,cpuKernelImpl:xCe}),pEe={kernelName:Pf,backendName:"webgl",kernelFunc:fEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;wp(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,c=1;T(Mn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=$s(s.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))return $r({inputs:{x:s},backend:n});const d=new Mh(u,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const gEe={kernelName:ey,backendName:"webgl",kernelFunc:mEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=mo(s.shape,i,o,u,a,c,l),h=new yN(d,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const yEe={kernelName:ty,backendName:"webgl",kernelFunc:xEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class bEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wEe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=mo(o.shape,a,l,d,c,u),f=new yN(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new bEe(h),x=n.runWebGLProgram(m,[s,p],o.dtype);return n.disposeIntermediateTensorInfo(p),x}const kEe={kernelName:c2,backendName:"webgl",kernelFunc:wEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CEe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;wp([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=$s(a.shape,l,c,1,u,d),f=!0,p=new Mh(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),x=new vEe(h),g=n.runWebGLProgram(x,[s,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const SEe={kernelName:l2,backendName:"webgl",kernelFunc:CEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IEe(t,e,n,r){let s=new Mh(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new Mh(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NEe={kernelName:HL,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;T(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];T(Mn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=$s(r.shape,s,i,c,o),[d,h]=IEe(r,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ee(t,e,n,r){const s=Q(e),o=Q(t.shape)/s,a=ae({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Zl(a,"float32","mean",r),c=ae({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EEe={kernelName:ny,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,l=Me(i,r.shape);let c=l;const u=Et(c,a),d=u!=null,h=o.shouldExecuteOnCPU([r]),f=[];let p=r;if(d){if(h){const w=o.texData.get(p.dataId).values,k=new Array(a);for(let I=0;I<k.length;I++)k[I]=r.shape[u[I]];const C=mN(w,r.shape,r.dtype,u,k);p=o.makeTensorInfo(k,r.dtype);const S=o.texData.get(p.dataId);S.values=C}else p=Jy(r,u,o);f.push(p),c=Lt(c.length,a)}Sn("sum",c,a);const[m,x]=fn(p.shape,c);let g=m;s&&(g=Ut(m,l));const y=$Ee(p,x,g,o);for(const b of f)o.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Me(i,s.shape);let c=l;const u=Et(c,a);let d=s;u!=null&&(d=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Lt(c.length,s.shape.length)),Sn("min",c,a);const[h,f]=fn(d.shape,c),p=Q(f),m=ae({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Zl(m,m.dtype,"min",n);let g;if(o){const y=Ut(h,l);g=ae({inputs:{x},backend:n,attrs:{shape:y}})}else g=ae({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const AEe={kernelName:ry,backendName:"webgl",kernelFunc:TEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DEe=gN+`
  return min(a, b);
`,OEe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ql+`
  return result;
`,REe=In({opSnippet:DEe,packedOpSnippet:OEe,cpuKernelImpl:yCe}),PEe={kernelName:_f,backendName:"webgl",kernelFunc:REe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ee{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const s=e.length,i=st(s),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MEe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const s=e.length,i=st(s),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Kn("rc",s),c=Kn("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,h=r==="reflect"?0:1;let f="";if(s===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[s-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[s-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[s-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FEe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new MEe(r.shape,s,i):new _Ee(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},LEe={kernelName:sy,backendName:"webgl",kernelFunc:FEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jEe=`if (b == 0.0) return NAN;
  return mod(a, b);`,zEe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ql+`
  return result;
`,BEe=In({opSnippet:jEe,packedOpSnippet:zEe}),WEe={kernelName:Mf,backendName:"webgl",kernelFunc:BEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UEe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VEe=`
if (a == b) {
  return 1.0;
};
return a / b;`,GEe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,pV=In({opSnippet:VEe,packedOpSnippet:GEe,checkOutOfBounds:!0}),HEe={kernelName:bf,backendName:"webgl",kernelFunc:pV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sO="return a - b;",mV=In({opSnippet:sO,packedOpSnippet:sO,supportsComplex:!0,cpuKernelImpl:jCe}),KEe={kernelName:Zf,backendName:"webgl",kernelFunc:mV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=Me([i],s.shape),a=fV({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Ut(a.shape,o),c=ae({inputs:{x:a},backend:n,attrs:{shape:l}}),u=mV({inputs:{a:s,b:c},backend:n}),d=uV({inputs:{x:u},backend:n}),h=ev({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=ae({inputs:{x:h},backend:n,attrs:{shape:l}}),p=pV({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const qEe={kernelName:ky,backendName:"webgl",kernelFunc:gV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XEe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:gV({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new UEe(c,u,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const YEe={kernelName:KL,backendName:"webgl",kernelFunc:XEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QEe=Ts+`
  return -x;
`,ZEe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function JEe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=bCe(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return H().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Fo(r.shape,ZEe):s=new hi(r.shape,QEe),n.runWebGLProgram(s,[r],r.dtype)}const eTe={kernelName:iy,backendName:"webgl",kernelFunc:JEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe=sI;function nTe(t){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,c=n.readSync(s.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=tTe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const rTe={kernelName:u2,backendName:"webgl",kernelFunc:nTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTe=iI;function iTe(t){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(s.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=sTe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const oTe={kernelName:d2,backendName:"webgl",kernelFunc:iTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTe=oI;function lTe(t){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(s.dataId),d=n.readSync(i.dataId),h=o,f=a,p=l,m=c,{selectedIndices:x,selectedScores:g}=aTe(u,d,h,f,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const cTe={kernelName:h2,backendName:"webgl",kernelFunc:lTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uTe{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dTe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,c=Q(s.shape),u=new uTe(c,o,a,l),d=ae({inputs:{x:s},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...s.shape,o],p=ae({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},hTe={kernelName:ly,backendName:"webgl",kernelFunc:dTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Cp({inputs:{input:r},backend:n}),i=u0({inputs:{x:s},backend:n}),o=tv({inputs:{input:r},backend:n}),a=u0({inputs:{x:o},backend:n}),l=Ea({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Sp({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const fTe={kernelName:Iy,backendName:"webgl",kernelFunc:u0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Cp({inputs:{input:r},backend:n}),i=xV({inputs:{x:s},backend:n}),o=tv({inputs:{input:r},backend:n}),a=u0({inputs:{x:o},backend:n}),l=Ea({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Sp({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const pTe={kernelName:ay,backendName:"webgl",kernelFunc:xV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Gw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{RS(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=Gw({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(d),d}),c=nV({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const gTe={kernelName:cy,backendName:"webgl",kernelFunc:mTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xTe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const s=e.length,i=st(s),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yTe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,x)=>m[0]+e[x]+m[1]);const s=e.length,i=st(s),o=n.map(m=>m[0]).join(","),a=n.map((m,x)=>m[0]+e[x]).join(","),l=Kn("rc",s),c=Kn("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${u}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${u}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,x=s===1?2:4;m<x;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yV=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(Q(s.shape)===0){const c=i.map((u,d)=>u[0]+s.shape[d]+u[1]);return Sp({backend:n,attrs:{shape:c,value:o,dtype:s.dtype}})}const a=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yTe(s.shape,i,o):new xTe(s.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[s],s.dtype,l)},vTe={kernelName:uy,backendName:"webgl",kernelFunc:yV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bTe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,wTe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ql+`
  return result;
`,kTe=In({opSnippet:bTe,packedOpSnippet:wTe}),CTe={kernelName:Lf,backendName:"webgl",kernelFunc:kTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function STe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],c=Me(i,s.shape);let u=c;const d=Et(u,a);let h=s;d!=null&&(h=Qn({inputs:{x:s},backend:n,attrs:{perm:d}}),u=Lt(u.length,a),l.push(h)),Sn("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:x,outDtype:g}=kCe(h.shape,h.dtype,p,u);f=n.makeTensorInfo(x,g,m)}else{const[p,m]=fn(h.shape,u),x=Q(m),g=ae({inputs:{x:h},backend:n,attrs:{shape:[-1,x]}}),y=I2(s.dtype),b=Zl(g,y,"prod",n);f=ae({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(g),l.push(b)}if(o){l.push(f);const p=Ut(f.shape,c);f=ae({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const ITe={kernelName:hy,backendName:"webgl",kernelFunc:STe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NTe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),c=s.map(g=>g.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,p]=CCe(l,c,u,i.shape,i.dtype,d,o.shape,a),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),x=n.makeTensorInfo(p,i.dtype,f);return m.concat([x])}const $Te={kernelName:qL,backendName:"webgl",kernelFunc:NTe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ETe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[c,u]=SCe(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const TTe={kernelName:XL,backendName:"webgl",kernelFunc:ETe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ATe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.readSync(s.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(x=>n.readSync(x.dataId)),f=a.map(x=>x.shape),[p,m]=ICe(c,s.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const DTe={kernelName:YL,backendName:"webgl",kernelFunc:ATe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vV=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=NCe(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},OTe={kernelName:f2,backendName:"webgl",kernelFunc:vV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe="return 1.0 / x;",PTe=Ue({opSnippet:RTe}),_Te={kernelName:jf,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MTe=Ts+`
  return (x < 0.0) ? 0.0 : x;
`,FTe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,LTe=Ue({opSnippet:MTe,packedOpSnippet:FTe}),jTe={kernelName:zf,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe=Ts+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,BTe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,WTe=Ue({opSnippet:zTe,packedOpSnippet:BTe}),UTe={kernelName:Bf,backendName:"webgl",kernelFunc:WTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VTe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GTe{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,c]=a,u=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new GTe(s.shape,l,c,i,o):new VTe(s.shape,l,c,i,o);return n.runWebGLProgram(u,[s],"float32")}const KTe={kernelName:my,backendName:"webgl",kernelFunc:HTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qTe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],c=[r&&o>1?o-1:o,r&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XTe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new qTe(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const YTe={kernelName:g2,backendName:"webgl",kernelFunc:XTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QTe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZTe{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,c]=a,u=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ZTe(s.shape,l,c,i,o):new QTe(s.shape,l,c,i,o);return n.runWebGLProgram(u,[s],s.dtype)}const eAe={kernelName:py,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tAe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],c=[r&&o>1?o-1:o,r&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nAe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new tAe(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const rAe={kernelName:m2,backendName:"webgl",kernelFunc:nAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sAe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=st(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iAe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Kn("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=st(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${c(s.slice())};
          }
          if(${o}) {
            result.b = ${u(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function u(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const m=e.map((y,b)=>f(b,p)),x=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${g}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=Me(i,s.shape);if(o===0)return $r({inputs:{x:s},backend:n});const l=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new iAe(s.shape,a):new sAe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const aAe={kernelName:gy,backendName:"webgl",kernelFunc:oAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lAe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cAe={kernelName:C2,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=new lAe(r.shape,i),[c,u]=xI(o,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uAe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,dAe=Ue({opSnippet:uAe}),hAe={kernelName:Wf,backendName:"webgl",kernelFunc:dAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fAe="return inversesqrt(x);",pAe=Ue({opSnippet:fAe,cpuKernelImpl:$Ce}),mAe={kernelName:Uf,backendName:"webgl",kernelFunc:pAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vN{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=st(i.length),u=st(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gAe{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=st(i.length),u=st(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xAe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hl(i,s,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,s.dtype);const f=ae({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),p=ae({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;H().getBool("WEBGL_PACK")?x=new gAe(l,a,f.shape.length,p.shape.length,u,h):x=new vN(l,a,f.shape.length,p.shape.length,u,h);const g=n.runWebGLProgram(x,[p,f,m],p.dtype),y=ae({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}const yAe={kernelName:QL,backendName:"webgl",kernelFunc:xAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vAe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=H().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bAe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new vAe(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",l)}const wAe={kernelName:JL,backendName:"webgl",kernelFunc:bAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kAe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);s=l.join(),i=c.join()}const o=st(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CAe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new kAe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],Ir(s.dtype,i.dtype))}const SAe={kernelName:xy,backendName:"webgl",kernelFunc:CAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IAe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Fy};
  float scale = ${Ly};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,NAe=Ue({opSnippet:IAe}),$Ae={kernelName:Vf,backendName:"webgl",kernelFunc:NAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EAe=Qu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,TAe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,AAe=Ue({opSnippet:EAe,packedOpSnippet:TAe,cpuKernelImpl:TCe}),DAe={kernelName:qf,backendName:"webgl",kernelFunc:AAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OAe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,RAe=Ue({opSnippet:OAe}),PAe={kernelName:Kf,backendName:"webgl",kernelFunc:RAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ae=Qu+`
  return sin(x);
`,MAe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Ql}
  return result;
`,FAe=Ue({opSnippet:_Ae,packedOpSnippet:MAe}),LAe={kernelName:Gf,backendName:"webgl",kernelFunc:FAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jAe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,zAe=Ue({opSnippet:jAe}),BAe={kernelName:Hf,backendName:"webgl",kernelFunc:zAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WAe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,UAe=Ue({opSnippet:WAe}),VAe={kernelName:Xf,backendName:"webgl",kernelFunc:UAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GAe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;T(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((g,y)=>g*y),l=[[0,0]];l.push(...o);for(let g=1+i.length;g<s.shape.length;++g)l.push([0,0]);const c=[],u=yV({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=lp(u.shape,i,a,!1),h=cp(d.length,i.length,!1),f=up(u.shape,i,a,!1),p=ae({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Qn({inputs:{x:p},backend:n,attrs:{perm:h}}),x=ae({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(g=>n.disposeIntermediateTensorInfo(g)),x},HAe={kernelName:by,backendName:"webgl",kernelFunc:GAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KAe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,f,p,m]=DCe(a,r.shape,r.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const qAe={kernelName:ej,backendName:"webgl",kernelFunc:KAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=OCe(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const YAe={kernelName:tj,backendName:"webgl",kernelFunc:XAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QAe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[c,u]=UU(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const ZAe={kernelName:nj,backendName:"webgl",kernelFunc:QAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JAe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[c,u]=UU(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const eDe={kernelName:rj,backendName:"webgl",kernelFunc:JAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Hl(i,s,a),f=!1;if(i.dtype==="string"){const g=n.bufferSync(s),y=n.bufferSync(i),b=sa(n.readSync(o.dataId)[0]),w=ECe(g,y,a,h,u,c,l,d,b,f);return n.makeTensorInfo(a,w.dtype,w.values)}const p=new vN(c,l,s.shape.length,i.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[i,s,o],i.dtype),x=ae({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),x}const nDe={kernelName:sj,backendName:"webgl",kernelFunc:tDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Me(o,s.shape)[0],l=OI(s,i,a),c=s.shape.length,u=new Array(c).fill(0),d=s.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=Zu({inputs:{x:s},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const sDe={kernelName:wy,backendName:"webgl",kernelFunc:rDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iO="return sqrt(x);",iDe=Ue({opSnippet:iO,packedOpSnippet:iO,cpuKernelImpl:RCe}),oDe={kernelName:Yf,backendName:"webgl",kernelFunc:iDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aDe="return x * x;",lDe=Ue({opSnippet:aDe}),cDe={kernelName:x2,backendName:"webgl",kernelFunc:lDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oO="return (a - b) * (a - b);",uDe=In({opSnippet:oO,packedOpSnippet:oO}),dDe={kernelName:Qf,backendName:"webgl",kernelFunc:uDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=ao(i),a=PCe(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const fDe={kernelName:y2,backendName:"webgl",kernelFunc:hDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pDe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Ts+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new hi(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const mDe={kernelName:np,backendName:"webgl",kernelFunc:pDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gDe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=st(r.length),o=st(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:g,begin:y,end:b,strides:w}=pI(s.shape,i,o,a,l,c,u,d,h);let k;if(m)k=ae({inputs:{x:s},backend:n,attrs:{shape:p}});else if(x||g){T(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const S=dI(y,b,w),I=Zu({inputs:{x:s},backend:n,attrs:{begin:y,size:S}});k=ae({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([s])){const I=n.readSync(s.dataId),$=_e(s.shape,s.dtype,I),E=_Ce(f,$,w,y);k=n.makeTensorInfo(p,s.dtype,E.values)}else{const I=new gDe(y,w,f);k=n.runWebGLProgram(I,[s],s.dtype)}const C=ae({inputs:{x:k},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(k),C}const yDe={kernelName:v2,backendName:"webgl",kernelFunc:xDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=MCe(h,f,s,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const bDe={kernelName:ij,backendName:"webgl",kernelFunc:vDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=FCe(a,l,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const kDe={kernelName:oj,backendName:"webgl",kernelFunc:wDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=LCe(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const SDe={kernelName:aj,backendName:"webgl",kernelFunc:CDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IDe="return tan(x);",NDe=Ue({opSnippet:IDe}),$De={kernelName:Jf,backendName:"webgl",kernelFunc:NDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EDe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,TDe=Ue({opSnippet:EDe}),ADe={kernelName:ep,backendName:"webgl",kernelFunc:TDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hl(o,i,s.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const f=ae({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=ae({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=ae({inputs:{x:s},backend:n,attrs:{shape:h}}),x=new vN(l,a,f.shape.length,p.shape.length,u,h,!1,!0),g=n.runWebGLProgram(x,[p,f,m],m.dtype),y=ae({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}const ODe={kernelName:ZL,backendName:"webgl",kernelFunc:DDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RDe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=st(this.rank),i=PDe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function PDe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),c=s.dtype==="string"?l.map(h=>sa(h)):l,u=_e(s.shape,s.dtype,c),d=zCe(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new RDe(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const _De={kernelName:tp,backendName:"webgl",kernelFunc:bV};class MDe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class FDe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function aO(t){let e=1;for(;e<t;)e*=2;return e}function LDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=H().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=H().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([s])||u<a||i>l){const E=n.readSync(s.dataId),[A,D]=BCe(E,c,s.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(D.shape,D.dtype,D.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,s.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[s,Sp({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(s):s,m=Q(c)/u,x=ae({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&Da(n,f);const g=aO(i),y=aO(u);let b=null;const w=()=>b===null?[x,x]:[x,b],k=(E,A,D)=>{const P=w(),O=new MDe(D),U=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[E],[A]],V=b;b=n.runWebGLProgram(O,P,"int32",U),Da(n,V)};for(let E=1;E<g;E*=2){const A=E*2;for(let D=E;D>=1;D/=2)k(A,D,[m,y])}for(let E=y;E>g;E/=2){const A=w(),D=new FDe([m,E/2]),O=[[u],[b===null?1:0],[g]],F=b;b=n.runWebGLProgram(D,A,"int32",O),Da(n,F);const U=g/2,V=U*2;for(let _=U;_>=1;_/=2)k(V,_,b.shape)}let C=b;b=Zu({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,i]}}),Da(n,C);let S=hV({inputs:{x,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Da(n,x);const I=c.slice(0,-1);I.push(i),C=b,b=ae({inputs:{x:b},attrs:{shape:I},backend:n}),Da(n,C);const $=S;return S=ae({inputs:{x:S},attrs:{shape:I},backend:n}),Da(n,$),[S,b]}const jDe={kernelName:b2,backendName:"webgl",kernelFunc:LDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zDe{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=r,[u,d,h,f]=s.shape,[p,m]=c??[d,h],x=[u,p,m,f],g=new zDe(d,h,o,a,l,x);return n.runWebGLProgram(g,[s,i],"float32")}const WDe={kernelName:w2,backendName:"webgl",kernelFunc:BDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UDe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;wp(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=WCe(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const VDe={kernelName:k2,backendName:"webgl",kernelFunc:UDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GDe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const x=Zu({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),g=ae({inputs:{x},backend:n,attrs:{shape:c}});p[m]=g,d.push(x)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const HDe={kernelName:Cy,backendName:"webgl",kernelFunc:GDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KDe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",c="sumValue",u=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let c=0;const u=Et([c],a);let d=s;u!=null&&(d=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),l.push(d),c=Lt(1,a)[0]);const h=tz(d.shape,c,o),f=Q([d.shape[c]]),p=ae({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=I2(s.dtype),x=(w,k,C,S,I)=>{const $=w.shape[0],E=w.shape[1],A=ez(E,I),D={windowSize:A,inSize:E,batchSize:$,numSegments:I},P=new KDe(D,k),O=n.compileAndRun(P,[w,C],S);if(l.push(O),O.shape[1]===I)return O;const F=vV({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),U=bV({inputs:{x:F},backend:n,attrs:{reps:[E/A]}});return l.push(F),l.push(U),x(O,k,U,S,I)},g=x(p,"unsortedSegmentSum",i,m,o),y=ae({inputs:{x:g},backend:n,attrs:{shape:h}});let b=y;if(u!=null){l.push(y);const w=ka(u);b=Qn({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const XDe={kernelName:Sy,backendName:"webgl",kernelFunc:qDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YDe=[RSe,_Se,LSe,BSe,USe,HSe,qSe,YSe,e2e,n2e,i2e,l2e,d2e,m2e,y2e,b2e,k2e,N2e,E2e,A2e,P2e,B2e,U2e,K2e,X2e,tIe,rIe,aIe,gSe,uIe,mIe,vIe,IIe,EIe,AIe,OIe,PIe,LIe,BIe,VIe,HIe,qIe,YIe,JIe,tNe,iNe,aNe,uNe,fNe,mNe,vNe,CNe,$Ne,ANe,RNe,PNe,MNe,LNe,zNe,WNe,VNe,qNe,QNe,e$e,n$e,i$e,l$e,h$e,g$e,mSe,y$e,fIe,w$e,S$e,$$e,ySe,D$e,_$e,F$e,B$e,V$e,q$e,Q$e,tEe,iEe,lEe,uEe,pEe,gEe,yEe,kEe,SEe,NEe,EEe,AEe,PEe,LEe,WEe,YEe,wSe,eTe,rTe,oTe,cTe,Q2e,hTe,pTe,gTe,vTe,CTe,bSe,ITe,$Te,TTe,DTe,OTe,Z2e,HEe,_Te,jTe,UTe,CSe,KTe,YTe,eAe,rAe,aAe,cAe,hAe,mAe,yAe,wAe,SAe,$Ae,DAe,PAe,LAe,BAe,j2e,qEe,VAe,HAe,qAe,YAe,ZAe,eDe,nDe,sDe,oDe,cDe,dDe,fDe,mDe,yDe,bDe,kDe,SDe,KEe,ASe,$De,ADe,ODe,_De,jDe,WDe,DSe,VDe,HDe,XDe,fTe];for(const t of YDe)cj(t);const QDe={happy:"Happy",sad:"Sad",angry:"Angry",fearful:"Fearful",disgusted:"Disgusted",surprised:"Surprised",neutral:"Neutral"},kd={lowEnergy:"Low energy and fatigue detected",sadness:"Persistent sadness patterns",withdrawal:"Social withdrawal indicators",anxiety:"Anxiety-related expressions",hopelessness:"Signs of hopelessness",irritability:"Increased irritability",concentration:"Difficulty concentrating"};class ZDe{constructor(){ed(this,"model",null);ed(this,"isInitialized",!1)}async initialize(){if(!this.isInitialized)try{await Woe(),this.isInitialized=!0,console.log("Face analysis model initialized")}catch(e){throw console.error("Failed to initialize face analysis:",e),e}}async analyzeVideo(e){this.isInitialized||await this.initialize(),await new Promise(a=>setTimeout(a,2e3));const n=this.generateMockEmotions(),r=this.getDominantEmotion(n),s=this.assessDepressionIndicators(n),i=this.calculateOverallScore(n,s),o=this.generateBehavioralNotes(n,s);return{dominantEmotion:r,emotions:n,depressionIndicators:s,overallScore:i,behavioralNotes:o}}generateMockEmotions(){const e={happy:Math.random()*.3+.1,sad:Math.random()*.4+.2,angry:Math.random()*.2,fearful:Math.random()*.3,disgusted:Math.random()*.1,surprised:Math.random()*.2,neutral:Math.random()*.5+.2},n=Object.values(e).reduce((r,s)=>r+s,0);return Object.keys(e).forEach(r=>{e[r]=e[r]/n}),e}getDominantEmotion(e){let n="neutral",r=0;return Object.entries(e).forEach(([s,i])=>{i>r&&(r=i,n=s)}),QDe[n]}assessDepressionIndicators(e){const n=[];return e.sad>.3&&n.push(kd.sadness),e.neutral>.4&&n.push(kd.lowEnergy),e.fearful>.2&&n.push(kd.anxiety),e.angry>.2&&n.push(kd.irritability),e.happy<.1&&n.push(kd.hopelessness),n}calculateOverallScore(e,n){let r=50;return r+=e.happy*30,r+=e.surprised*10,r-=e.sad*25,r-=e.angry*20,r-=e.fearful*15,r-=n.length*5,Math.max(0,Math.min(100,Math.round(r)))}generateBehavioralNotes(e,n){const r=[];return e.sad>.3&&r.push("Frequent sad expressions detected throughout the session"),e.happy>.3&&r.push("Positive emotional expressions observed"),e.neutral>.5&&r.push("Predominantly neutral expressions, may indicate emotional numbness"),n.length>2&&r.push("Multiple depression indicators present - recommend professional consultation"),e.fearful>.2&&r.push("Anxiety-related facial expressions detected"),r}}const JDe=new ZDe,eOe=()=>{const[t,e]=N.useState(!1),[n,r]=N.useState(null),[s,i]=N.useState(!1),[o,a]=N.useState(null),[l,c]=N.useState(0),[u,d]=N.useState(0),[h,f]=N.useState("checking"),[p,m]=N.useState(null),x=N.useRef(null),g=N.useRef(null),y=N.useRef(null),{isNative:b}=OL(),w=Ce.getFaceDiaryEntries();N.useEffect(()=>(k(),()=>{C()}),[]),N.useEffect(()=>{let O;return t&&u>0&&(O=setInterval(()=>{d(F=>F<=1?($(),0):F-1)},1e3)),()=>clearInterval(O)},[t,u]);const k=async()=>{try{f("checking"),m(null);const O=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1});f("granted"),x.current&&(x.current.srcObject=O,y.current=O)}catch(O){console.error("Camera permission error:",O),O.name==="NotAllowedError"||O.name==="PermissionDeniedError"?(f("denied"),m("Camera access was denied. Please enable camera permissions in your browser or device settings.")):O.name==="NotFoundError"||O.name==="DevicesNotFoundError"?(f("denied"),m("No camera found on this device.")):O.name==="NotReadableError"||O.name==="TrackStartError"?(f("denied"),m("Camera is already in use by another application.")):(f("denied"),m("Unable to access camera. Please check your device settings."))}},C=()=>{y.current&&y.current.getTracks().forEach(O=>O.stop())},S=()=>{if(!y.current)return;c(3);const O=setInterval(()=>{c(F=>F<=1?(clearInterval(O),I(),0):F-1)},1e3)},I=()=>{if(!y.current)return;const O=new MediaRecorder(y.current),F=[];O.ondataavailable=U=>{U.data.size>0&&F.push(U.data)},O.onstop=()=>{const U=new Blob(F,{type:"video/webm"});r(U)},g.current=O,O.start(),e(!0),d(30)},$=()=>{g.current&&t&&(g.current.stop(),e(!1),d(0))},E=async()=>{if(x.current){i(!0);try{const O=await JDe.analyzeVideo(x.current);a(O);const F={id:crypto.randomUUID(),timestamp:new Date,videoBlob:n||void 0,analysis:O};Ce.saveFaceDiaryEntry(F)}catch(O){console.error("Analysis failed:",O)}finally{i(!1)}}},A=()=>{r(null),a(null),d(0),k()},D=O=>O>=70?"text-green-600":O>=40?"text-yellow-600":"text-red-600",P=O=>O>=70?"bg-green-50 border-green-200":O>=40?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200";return h==="checking"?v.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:v.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-xl shadow-md text-center",children:[v.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Checking Camera Access"}),v.jsx("p",{className:"text-gray-600",children:"Please allow camera access when prompted..."})]})}):h==="denied"?v.jsxs("div",{className:"min-h-screen bg-gray-50",children:[v.jsx("div",{className:"bg-white shadow-sm border-b",children:v.jsxs("div",{className:"max-w-md mx-auto p-4",children:[v.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Face Diary"}),v.jsx("p",{className:"text-sm text-gray-600",children:"Camera access required"})]})}),v.jsx("div",{className:"max-w-md mx-auto p-4",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 text-center",children:[v.jsx("div",{className:"p-4 bg-red-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:v.jsx(n5,{size:40,className:"text-red-600"})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Camera Access Required"}),v.jsx("p",{className:"text-gray-600 mb-4",children:p}),v.jsxs("div",{className:"space-y-3 text-sm text-gray-600 mb-6",children:[v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"font-medium mb-2",children:"To enable camera access:"}),v.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[v.jsx("li",{children:"Click the camera icon in your browser's address bar"}),v.jsx("li",{children:'Select "Allow" for camera permissions'}),v.jsx("li",{children:"Refresh the page if needed"})]})]}),b&&v.jsxs("div",{className:"text-left mt-4",children:[v.jsx("p",{className:"font-medium mb-2",children:"On mobile devices:"}),v.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[v.jsx("li",{children:"Go to your device Settings"}),v.jsx("li",{children:'Find "Mindfit AI" in your apps'}),v.jsx("li",{children:"Enable Camera permissions"}),v.jsx("li",{children:"Restart the app"})]})]})]}),v.jsx("button",{onClick:k,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})})]}):v.jsxs("div",{className:"min-h-screen bg-gray-50",children:[v.jsx("div",{className:"bg-white shadow-sm border-b",children:v.jsxs("div",{className:"max-w-md mx-auto p-4",children:[v.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Face Diary"}),v.jsx("p",{className:"text-sm text-gray-600",children:"30-second video analysis"})]})}),v.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[v.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[v.jsxs("div",{className:"relative",children:[v.jsx("video",{ref:x,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-64 bg-gray-900 rounded-lg object-cover"}),l>0&&v.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:v.jsx("div",{className:"text-white text-6xl font-bold",children:l})}),t&&v.jsxs("div",{className:"absolute top-4 right-4 bg-red-600 text-white px-3 py-1 rounded-full flex items-center space-x-2",children:[v.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),v.jsxs("span",{className:"text-sm font-medium",children:[u,"s"]})]})]}),v.jsx("div",{className:"flex justify-center space-x-4 mt-6",children:n?v.jsxs("div",{className:"flex space-x-3",children:[v.jsxs("button",{onClick:E,disabled:s,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300",children:[s?v.jsx(m5,{size:20,className:"animate-spin"}):v.jsx(d5,{size:20}),v.jsx("span",{children:s?"Analyzing...":"Analyze Video"})]}),v.jsx("button",{onClick:A,className:"flex items-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:v.jsx(v5,{size:20})})]}):v.jsx(v.Fragment,{children:t?v.jsxs("button",{onClick:$,className:"flex items-center space-x-2 bg-gray-800 text-white px-6 py-3 rounded-lg hover:bg-gray-900 transition-colors",children:[v.jsx($5,{size:20}),v.jsx("span",{children:"Stop Recording"})]}):v.jsxs("button",{onClick:S,disabled:l>0,className:"flex items-center space-x-2 bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300",children:[v.jsx(E5,{size:20}),v.jsx("span",{children:"Start Recording"})]})})})]}),o&&v.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Analysis Report"}),v.jsx("div",{className:`p-4 rounded-lg border-2 mb-6 ${P(o.overallScore)}`,children:v.jsxs("div",{className:"text-center",children:[v.jsxs("div",{className:`text-3xl font-bold ${D(o.overallScore)}`,children:[o.overallScore,"/100"]}),v.jsx("div",{className:"text-sm text-gray-600",children:"Wellbeing Score"})]})}),v.jsxs("div",{className:"mb-6",children:[v.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Dominant Emotion"}),v.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:v.jsx("span",{className:"text-blue-800 font-medium",children:o.dominantEmotion})})]}),v.jsxs("div",{className:"mb-6",children:[v.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Emotion Analysis"}),v.jsx("div",{className:"space-y-2",children:Object.entries(o.emotions).map(([O,F])=>v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-sm text-gray-600 capitalize",children:O}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:v.jsx("div",{className:"bg-blue-600 rounded-full h-2 transition-all duration-300",style:{width:`${F*100}%`}})}),v.jsxs("span",{className:"text-xs text-gray-500 w-10 text-right",children:[Math.round(F*100),"%"]})]})]},O))})]}),o.depressionIndicators.length>0&&v.jsxs("div",{className:"mb-6",children:[v.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Depression Indicators"}),v.jsx("div",{className:"space-y-2",children:o.depressionIndicators.map((O,F)=>v.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:v.jsx("span",{className:"text-sm text-yellow-800",children:O})},F))})]}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Behavioral Notes"}),v.jsx("div",{className:"space-y-2",children:o.behavioralNotes.map((O,F)=>v.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:v.jsx("span",{className:"text-sm text-gray-700",children:O})},F))})]})]}),w.length>0&&v.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Previous Entries"}),v.jsx("div",{className:"space-y-3",children:w.slice(-5).reverse().map(O=>v.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-gray-800",children:O.analysis.dominantEmotion}),v.jsxs("div",{className:"text-sm text-gray-600",children:[O.timestamp.toLocaleDateString()," at ",O.timestamp.toLocaleTimeString()]})]}),v.jsx("div",{className:`text-lg font-bold ${D(O.analysis.overallScore)}`,children:O.analysis.overallScore})]})},O.id))})]})]})]})},tOe=({onLogout:t})=>{const[e,n]=iv.useState(!1),[r,s]=iv.useState("");OL();const i=Ce.getUserProfile(),o=Ce.getMoodEntries(),a=Ce.getSleepEntries(),l=Ce.getFaceDiaryEntries(),c=Ce.getAssessment(),u=Ce.getTasks();iv.useEffect(()=>{i!=null&&i.doctorId&&s(i.doctorId)},[i]);const d=()=>{if(i){const k={...i,doctorId:r.trim()||void 0};Ce.saveUserProfile(k),Ce.updateUser(k),n(!1)}},h=Array.from({length:14},(k,C)=>{const S=iw(new Date,C),I=o.filter(D=>Ze(D.timestamp,"yyyy-MM-dd")===Ze(S,"yyyy-MM-dd")),$=a.find(D=>Ze(D.bedtime,"yyyy-MM-dd")===Ze(S,"yyyy-MM-dd")),E=l.find(D=>Ze(D.timestamp,"yyyy-MM-dd")===Ze(S,"yyyy-MM-dd")),A=I.length>0?I.reduce((D,P)=>D+{sad:1,normal:2,happy:3,excited:4}[P.mood],0)/I.length*25:0;return{date:Ze(S,"MMM dd"),fullDate:Ze(S,"yyyy-MM-dd"),moodEntries:I.length,moodScore:Math.round(A),sleepScore:($==null?void 0:$.score)||0,sleepDuration:($==null?void 0:$.duration)||0,wellbeingScore:(E==null?void 0:E.analysis.overallScore)||0}}).reverse(),f=[{name:"Sad",value:o.filter(k=>k.mood==="sad").length,color:"#EF4444",emoji:""},{name:"Normal",value:o.filter(k=>k.mood==="normal").length,color:"#F59E0B",emoji:""},{name:"Happy",value:o.filter(k=>k.mood==="happy").length,color:"#10B981",emoji:""},{name:"Excited",value:o.filter(k=>k.mood==="excited").length,color:"#F97316",emoji:""}].filter(k=>k.value>0),p=a.slice(-7).map((k,C)=>({day:Ze(k.bedtime,"EEE"),quality:k.quality,duration:k.duration,score:k.score})),m=l.slice(-10).map((k,C)=>({session:`Session ${C+1}`,wellbeing:k.analysis.overallScore,dominantEmotion:k.analysis.dominantEmotion,indicators:k.analysis.depressionIndicators.length})),x=a.length>0?Math.round(a.reduce((k,C)=>k+C.score,0)/a.length):0,g=l.length>0?Math.round(l.reduce((k,C)=>k+C.analysis.overallScore,0)/l.length):0,y=u.filter(k=>k.completed).length,b=u.length>0?Math.round(y/u.length*100):0,w=()=>{Ce.clearAuthState(),t==null||t()};return v.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50",children:[v.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white",children:v.jsx("div",{className:"max-w-md mx-auto p-6",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl",children:(i==null?void 0:i.userType)==="doctor"?v.jsx(f1,{size:32}):v.jsx(fl,{size:32})}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("h1",{className:"text-2xl font-bold",children:(i==null?void 0:i.name)||"User Profile"}),v.jsx("span",{className:"text-2xl",children:""})]}),v.jsxs("p",{className:"text-orange-100",children:[(i==null?void 0:i.userType)==="doctor"?" Doctor":" Patient","  Member since ",i?Ze(i.registeredAt,"MMM yyyy"):"Recently"]}),(i==null?void 0:i.userType)==="patient"&&v.jsxs("p",{className:"text-orange-100 text-sm flex items-center",children:[v.jsx("span",{className:"mr-1",children:""}),"ID: ",i.id.slice(0,8)]})]})]}),v.jsx("button",{onClick:w,className:"p-3 bg-white bg-opacity-20 rounded-2xl hover:bg-opacity-30 transition-colors",title:"Logout",children:v.jsx(d1,{size:24})})]})})}),v.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[v.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-red-400",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Account"}),v.jsx("p",{className:"text-sm text-gray-600",children:"Manage your account settings"})]})]}),v.jsxs("button",{onClick:w,className:"flex items-center space-x-2 bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-lg",children:[v.jsx(d1,{size:16}),v.jsx("span",{children:"Logout"})]})]})}),(i==null?void 0:i.userType)==="patient"&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Doctor Connection"})]}),e?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[v.jsx("span",{className:"mr-2",children:""}),"Doctor ID"]}),v.jsx("input",{type:"text",value:r,onChange:k=>s(k.target.value),placeholder:"Enter your doctor's ID",className:"w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-green-400 focus:border-transparent"}),v.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[v.jsx("span",{className:"mr-1",children:""}),"Your doctor will be able to view your mental health reports"]})]}),v.jsxs("div",{className:"flex space-x-3",children:[v.jsxs("button",{onClick:d,className:"flex items-center space-x-2 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-lg",children:[v.jsx(b5,{size:16}),v.jsx("span",{children:"Save"})]}),v.jsxs("button",{onClick:()=>{n(!1),s(i.doctorId||"")},className:"flex items-center space-x-2 bg-gray-200 text-gray-800 px-4 py-2 rounded-xl hover:bg-gray-300 transition-colors",children:[v.jsx(T5,{size:16}),v.jsx("span",{children:"Cancel"})]})]})]}):v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("p",{className:"text-sm text-gray-600 mb-1 flex items-center",children:[v.jsx("span",{className:"mr-2",children:""}),"Doctor ID"]}),v.jsx("p",{className:"font-medium text-gray-800",children:i.doctorId||"Not connected"}),i.doctorId&&v.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center",children:[v.jsx("span",{className:"mr-1",children:""}),"Your doctor can monitor your progress"]})]}),v.jsx("button",{onClick:()=>n(!0),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-xl transition-colors",children:v.jsx(NP,{size:20})})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("div",{className:"bg-gradient-to-br from-orange-400 to-red-400 rounded-2xl shadow-lg p-4 text-white",children:v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"text-2xl font-bold",children:o.length}),v.jsx("div",{className:"text-sm opacity-90",children:"Mood Entries"})]})]})}),v.jsx("div",{className:"bg-gradient-to-br from-green-400 to-emerald-400 rounded-2xl shadow-lg p-4 text-white",children:v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"text-2xl font-bold",children:x}),v.jsx("div",{className:"text-sm opacity-90",children:"Avg Sleep"})]})]})}),v.jsx("div",{className:"bg-gradient-to-br from-pink-400 to-rose-400 rounded-2xl shadow-lg p-4 text-white",children:v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"text-2xl font-bold",children:g}),v.jsx("div",{className:"text-sm opacity-90",children:"Wellbeing"})]})]})}),v.jsx("div",{className:"bg-gradient-to-br from-yellow-400 to-orange-400 rounded-2xl shadow-lg p-4 text-white",children:v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("div",{children:[v.jsxs("div",{className:"text-2xl font-bold",children:[b,"%"]}),v.jsx("div",{className:"text-sm opacity-90",children:"Tasks Done"})]})]})})]}),c&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-indigo-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Assessment Results"})]}),v.jsxs("div",{className:"text-center",children:[v.jsxs("div",{className:`text-4xl font-bold mb-2 ${c.riskLevel==="high"?"text-red-500":c.riskLevel==="medium"?"text-yellow-500":"text-green-500"}`,children:[c.score,"/100"]}),v.jsxs("div",{className:`text-sm font-medium flex items-center justify-center space-x-2 ${c.riskLevel==="high"?"text-red-600":c.riskLevel==="medium"?"text-yellow-600":"text-green-600"}`,children:[v.jsx("span",{children:c.riskLevel==="high"?"":c.riskLevel==="medium"?"":""}),v.jsxs("span",{children:[c.riskLevel.toUpperCase()," RISK"]})]}),v.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex items-center justify-center space-x-1",children:[v.jsx("span",{children:""}),v.jsxs("span",{children:["Completed ",Ze(c.completedAt,"MMM d, yyyy")]})]})]})]}),(i==null?void 0:i.userType)==="patient"&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-cyan-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"14-Day Wellness Trends"})]}),v.jsx("div",{className:"h-64",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsxs(fse,{data:h,children:[v.jsx(Fc,{dataKey:"date",fontSize:12}),v.jsx(Lc,{fontSize:12}),v.jsx(Kd,{type:"monotone",dataKey:"moodScore",stackId:"1",stroke:"#F97316",fill:"#FED7AA",name:"Mood Score"}),v.jsx(Kd,{type:"monotone",dataKey:"sleepScore",stackId:"2",stroke:"#10B981",fill:"#A7F3D0",name:"Sleep Score"}),v.jsx(Kd,{type:"monotone",dataKey:"wellbeingScore",stackId:"3",stroke:"#EC4899",fill:"#FBCFE8",name:"Wellbeing"})]})})}),v.jsxs("div",{className:"flex justify-center space-x-6 mt-4",children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-orange-400 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:" Mood"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:" Sleep"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:"w-3 h-3 bg-pink-400 rounded-full"}),v.jsx("span",{className:"text-xs text-gray-600",children:" Wellbeing"})]})]})]}),(i==null?void 0:i.userType)==="patient"&&p.length>0&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-indigo-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Sleep Quality Analysis"})]}),v.jsx("div",{className:"h-48",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsxs(nse,{data:p,children:[v.jsx(Fc,{dataKey:"day",fontSize:12}),v.jsx(Lc,{fontSize:12}),v.jsx(kS,{dataKey:"quality",fill:"#6366F1",radius:[4,4,0,0]})]})})}),v.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[v.jsxs("div",{className:"text-center p-3 bg-indigo-50 rounded-xl",children:[v.jsxs("div",{className:"text-lg font-bold text-indigo-600",children:[a.length>0?(a.reduce((k,C)=>k+C.duration,0)/a.length).toFixed(1):"0","h"]}),v.jsx("div",{className:"text-xs text-gray-600",children:" Avg Duration"})]}),v.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-xl",children:[v.jsxs("div",{className:"text-lg font-bold text-green-600",children:[a.length>0?(a.reduce((k,C)=>k+C.quality,0)/a.length).toFixed(1):"0","/10"]}),v.jsx("div",{className:"text-xs text-gray-600",children:" Avg Quality"})]}),v.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-xl",children:[v.jsx("div",{className:"text-lg font-bold text-orange-600",children:x}),v.jsx("div",{className:"text-xs text-gray-600",children:" Sleep Score"})]})]})]}),(i==null?void 0:i.userType)==="patient"&&f.length>0&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-yellow-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Mood Distribution"})]}),v.jsx("div",{className:"h-48",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsx(kL,{children:v.jsx(bx,{data:f,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,dataKey:"value",children:f.map((k,C)=>v.jsx(Pu,{fill:k.color},`cell-${C}`))})})})}),v.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:f.map((k,C)=>v.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-lg bg-gray-50",children:[v.jsx("span",{className:"text-lg",children:k.emoji}),v.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:k.color}}),v.jsxs("span",{className:"text-sm text-gray-600",children:[k.name," (",k.value,")"]})]},C))})]}),(i==null?void 0:i.userType)==="patient"&&m.length>0&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-pink-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Face Diary Analysis"})]}),v.jsx("div",{className:"h-48",children:v.jsx(Cc,{width:"100%",height:"100%",children:v.jsxs(wL,{data:m,children:[v.jsx(Fc,{dataKey:"session",fontSize:12}),v.jsx(Lc,{fontSize:12}),v.jsx(Mc,{type:"monotone",dataKey:"wellbeing",stroke:"#EC4899",strokeWidth:3,dot:{fill:"#EC4899",strokeWidth:2,r:4}})]})})}),v.jsx("div",{className:"mt-4",children:v.jsxs("div",{className:"text-center p-3 bg-pink-50 rounded-xl",children:[v.jsxs("div",{className:"text-2xl font-bold text-pink-600",children:[g,"/100"]}),v.jsx("div",{className:"text-sm text-gray-600",children:" Average Wellbeing Score"})]})})]}),(i==null?void 0:i.userType)==="patient"&&l.length>0&&v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-emerald-400",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Recent Face Diary"})]}),v.jsx("div",{className:"space-y-3",children:l.slice(-3).reverse().map(k=>v.jsx("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-emerald-50 rounded-xl border border-emerald-100",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("span",{className:"text-lg",children:k.analysis.dominantEmotion==="Happy"?"":k.analysis.dominantEmotion==="Sad"?"":k.analysis.dominantEmotion==="Angry"?"":k.analysis.dominantEmotion==="Surprised"?"":k.analysis.dominantEmotion==="Fearful"?"":""}),v.jsx("div",{className:"font-medium text-gray-800",children:k.analysis.dominantEmotion})]}),v.jsxs("div",{className:"text-sm text-gray-600 flex items-center space-x-1",children:[v.jsx("span",{children:""}),v.jsx("span",{children:Ze(k.timestamp,"MMM d, h:mm a")})]}),k.analysis.depressionIndicators.length>0&&v.jsxs("div",{className:"text-xs text-orange-600 mt-1 flex items-center space-x-1",children:[v.jsx("span",{children:""}),v.jsxs("span",{children:[k.analysis.depressionIndicators.length," indicators detected"]})]})]}),v.jsxs("div",{className:`text-xl font-bold ${k.analysis.overallScore>=70?"text-green-500":k.analysis.overallScore>=40?"text-yellow-500":"text-red-500"}`,children:[k.analysis.overallScore,v.jsx("div",{className:"text-xs text-gray-500 font-normal",children:"Score"})]})]})},k.id))})]}),(i==null?void 0:i.userType)==="patient"&&v.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 border-2 border-green-200 shadow-lg",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Personalized Recommendations"})]}),v.jsxs("div",{className:"space-y-3",children:[x<70&&v.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-xl border border-green-200",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-green-800",children:"Improve Sleep Quality"}),v.jsx("div",{className:"text-sm text-green-700",children:"Consider establishing a regular sleep schedule and creating a relaxing bedtime routine."})]})]}),o.filter(k=>k.mood==="sad").length>o.length*.3&&v.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-xl border border-green-200",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-green-800",children:"Consider Professional Support"}),v.jsx("div",{className:"text-sm text-green-700",children:"Your mood patterns suggest it might be helpful to speak with a mental health professional."})]})]}),v.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-xl border border-green-200",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-green-800",children:"Keep Tracking"}),v.jsx("div",{className:"text-sm text-green-700",children:"Consistent tracking helps identify patterns and monitor progress over time."})]})]}),b<50&&v.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-xl border border-green-200",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-green-800",children:"Focus on Task Completion"}),v.jsx("div",{className:"text-sm text-green-700",children:"Try breaking larger tasks into smaller, manageable steps to improve completion rates."})]})]})]})]})]})]})};function nOe(){const[t,e]=N.useState("splash"),[n,r]=N.useState(null),[s,i]=N.useState("home"),[o,a]=N.useState(0);N.useEffect(()=>{const f=Ce.getAuthState();f.isAuthenticated&&f.userType?(r(f.userType),e("app")):setTimeout(()=>e("auth"),100)},[]);const l=()=>{e("auth")},c=f=>{r(f),e("app")},u=()=>{Ce.clearAuthState(),r(null),e("auth"),i("home")},d=()=>{a(f=>f+1)};if(t==="splash")return v.jsx(D5,{onComplete:l});if(t==="auth")return v.jsx(O5,{onAuthSuccess:c});if(n==="doctor")return v.jsx(Sie,{onLogout:u});const h=()=>{switch(s){case"home":return v.jsx(SA,{onRefresh:d},o);case"chat":return v.jsx(Xie,{});case"planner":return v.jsx(qie,{onTaskUpdated:d});case"face-diary":return v.jsx(eOe,{});case"profile":return v.jsx(tOe,{onLogout:u},o);default:return v.jsx(SA,{onRefresh:d},o)}};return v.jsxs("div",{className:"min-h-screen bg-gray-50",children:[v.jsx("div",{className:"pb-20",children:h()}),v.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:v.jsx(Iie,{activeTab:s,onTabChange:i})})]})}Uie().then(()=>{console.log("Capacitor plugins initialized")}).catch(t=>{console.error("Failed to initialize Capacitor plugins:",t)});bP(document.getElementById("root")).render(v.jsx(N.StrictMode,{children:v.jsx(nOe,{})}));export{mA as E,ow as I,gA as N,AS as W,Pie as b};
